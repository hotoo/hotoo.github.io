<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>闲耘的博客</title>
        <link>https://hotoo.github.io</link>
        <description>闲耘的个人网站和博客</description>
        <lastBuildDate>Fri, 23 Jan 2026 16:00:13 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-CN</language>
        <copyright>Open Source GNU 3.0 Licensed | Copyright © 2010-2026</copyright>
        <item>
            <title><![CDATA[MacVim 释出 r182 版]]></title>
            <link>https://hotoo.github.io/blog/post/macvim-r182</link>
            <guid>36</guid>
            <pubDate>Sun, 09 Nov 2025 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="macvim-释出-r182-版">MacVim 释出 r182 版<a aria-hidden="true" href="#macvim-释出-r182-版">#</a></h1>
<p>MacVim r182 更新到 Vim 9.1.1887</p>
<p>此更新仍然基于 macOS 15 Sequoia 构建，不包含针对 macOS 26 Tahoe 的任何特定修复或改进。这些将在未来的更新中提供。</p>
<h2 id="将-macos-1013-n-1015-支持移至遗留版本">将 macOS 10.13 \n 10.15 支持移至遗留版本<a aria-hidden="true" href="#将-macos-1013-n-1015-支持移至遗留版本">#</a></h2>
<p>目前，MacVim 二进制发布版本分为两个版本：标准版本（macOS 10.13 或更高版本）和遗留版本（macOS 10.9 或更高版本）。从下一个发布版本（r183）开始，标准版本将要求 macOS 11.0 Big Sur（由于 Xcode 26 的要求），而 macOS 10.13\n10.15 用户将需要使用遗留版本。这将基本上是一个透明的变更，更新器将自动更新到正确的版本。遗留版本对用户来说应该几乎相同，因为他们使用的是较旧的 macOS 版本，这些版本从一开始就无法利用新的操作系统功能。</p>
<p>未来我们可能会移除对 macOS 10.9\n10.12 的支持，但目前它们仍然受支持。</p>
<h2 id="特性更好的鼠标支持">特性：更好的鼠标支持<a aria-hidden="true" href="#特性更好的鼠标支持">#</a></h2>
<p>在 MacVim 中，滚轮的使用体验应该会更好。现在，小幅度滚动保证至少滚动一行，并且水平滚动（Shift 滚动）现在可以正常工作。你还可以在“输入”设置面板中关闭 macOS 的滚轮加速，以滚动固定数量的行。</p>
<p>鼠标的第四和第五个按钮现在可以绑定到 Vim 映射中的 <code>&lt;X1Mouse&gt;</code> 和 <code>&lt;X2Mouse&gt;</code> （ :h X1Mouse ）。</p>
<h2 id="vim-新特性">Vim 新特性<a aria-hidden="true" href="#vim-新特性">#</a></h2>
<p>\n Diff 差异模式改进
\n Vim diff 现在可以高亮显示行内每个字符或每个单词的差异。默认情况下使用每个字符的高亮显示。参见 "inline" 下的 <code>:h &#39;diffopt&#39;</code> 。v9.1.1243
<img src="/images/blog/2025/macvim%5Cndiff.png" alt="vim diff"></img>
\n Diff 锚点允许对 diff 算法跨文件对齐文本的方式和位置进行更明确的控制 ( <code>:h diff\nanchors</code> )。v9.1.1557
\n 许多自动补全的改进。以下是一些高亮显示：
\n 新选项： <code>autocomplete</code> 。在输入时获取补全建议。参见 <code>:h ins\nautocompletion</code> 。v9.1.1590
\n 模糊匹配现在使用 fzf 算法。v9.1.1627
\n 弹出菜单边框现在可以设置样式（ <code>:h &#39;pumborder&#39;</code> / <code>:h &#39;completepopup&#39;</code> ）。v9.1.1835 / v9.1.1856
\n 在使用插入模式补全时，现在可以指定自定义补全源（ <code>:h &#39;complete&#39;</code> ）。v9.1.1301
\n <code>set completeopt+=nearest</code> 将根据光标附近的距离对补全项进行排序。v9.1.1308
\n 命令行补全
\n 搜索命令如 <code>/</code> 和 <code>:g</code> 现在可以 Tab 补全。 v9.1.1490 v9.1.1526
\n 命令如 <code>:filetype</code> 和 <code>:highlight</code> 具有更好的自动补全。 v9.1.1340 / v9.1.1138
\n 新的垂直标签面板（ <code>:h tabpanel</code> ）。 v9.1.1391
\n 新增可选捆绑插件（使用 <code>packadd</code> 启用它们）：
\n hlyank ( <code>:h package\nhlyank</code> ): 简要高亮上次复制命令的区域
\n 新增命令：
\n <code>:uniq</code> ( <code>:h :uniq</code> ): 删除相邻重复行 v9.1.1477</p>
<h2 id="综合">综合<a aria-hidden="true" href="#综合">#</a></h2>
<p>\n Sparkle（MacVim 的更新器）现已更新至 2.8.0 版本。 #1605</p>
<h2 id="安全修复">安全修复<a aria-hidden="true" href="#安全修复">#</a></h2>
<p>\n 修复了 MacVim 错误地设置 get\ntask\nallow 权限的问题，这可能导致其他用户安装的应用程序检查该权限。 #1585</p>
<h2 id="修复">修复<a aria-hidden="true" href="#修复">#</a></h2>
<p>\n 解决了在非视觉模式下，macOS 服务（可在"服务"菜单中找到）无法插入文本的问题。 #1571 #1569
\n 修复了 guifont 不接受带下划线的 PostScript 名称（例如"CascadiaMono\nRegular\nLight"）的问题。 #1600
\n MacVim 现在使用标准的 v:colornames 变量来选择高亮颜色。 #1568
\n Vim 语法现在支持 MacVim 特定的函数 showdefinition() 。 #1601</p>
<h2 id="兼容性">兼容性<a aria-hidden="true" href="#兼容性">#</a></h2>
<p>需要 macOS 10.9 或更高版本。（10.9 \n 10.12 需要下载单独的旧版本构建）</p>
<p>脚本接口与这些版本兼容：</p>
<p>\n Lua 5.4
\n Perl 5.34
\n Python2 2.7
\n Python3 3.9 或更高版本
\n Ruby 3.4</p>
]]></content:encoded>
            <category>Technology</category>
        </item>
        <item>
            <title><![CDATA[文件名：下划线、还是驼峰？]]></title>
            <link>https://hotoo.github.io/blog/post/underline-file-name-or-camel-case</link>
            <guid>37</guid>
            <pubDate>Mon, 27 Sep 2021 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="文件名下划线还是驼峰">文件名：下划线、还是驼峰？<a aria-hidden="true" href="#文件名下划线还是驼峰">#</a></h1>

<p>很久之前写了个 <a href="https://github.com/hotoo/jsgf.vim" target="_blank" rel="noopener noreferrer">jsgf.vim</a> 插件，可以在 js 代码中 <code>gf</code> 两键打开 import 的定义文件。</p>
<p>后来又针对 eggjs 的特性写了个 Vim 插件，可以 <code>gf</code> 两键打开 controllers, service 定义文件，阅读 eggjs 的代码方便多了，例如</p>
<pre><code>  const resp = await ctx.service.mode.name.method();
                     ^\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n
</code></pre>
<p>光标在箭头上方的任意位置按 <code>gf</code> 键就可以打开对应的代码定义文件。</p>
<p><img src="https://user%5Cnimages.githubusercontent.com/143572/134893630%5Cn64319acc%5Cne675%5Cn4b5e%5Cn8f39%5Cndf4e20dff0f7.png" alt="image"></img></p>
<p>但是有个问题，就是 eggjs 针对文件名带有下划线或中划线的，会替换成驼峰形式。即文件名为 <code>app/service/path\nname/mode\nname.js</code> 的路径，Loader 会转换成驼峰形式，在业务代码中必须以驼峰形式调用：</p>
<pre><code>  // file path:      app/service/path\nname/mode\nname.js
  const resp = await ctx.service.pathName.modeName.method();
                                 ^\n\n\n\n\n\n\n ^\n\n\n\n\n\n\n
</code></pre>
<p><img src="https://user%5Cnimages.githubusercontent.com/143572/134892649%5Cn0b06bb64%5Cnf4ba%5Cn4d73%5Cnb6cb%5Cnd71dda76604a.png" alt="image"></img></p>
<p>当时 eggjs 做这个目的，估计也说为了支持和顺应当时的文件名命名规范，当时大多数命名规范要求文件名用小写字母、数字、下划线和中划线。</p>
<p>但是，这种命名规范真的好吗？</p>
<p>我的答案是：绝对不好。</p>
<ol>
<li>一致性：代码中的名字，和实际文件系统名字不一致。</li>
<li>确定性：代码中调用的是驼峰的，而实际文件名到底是驼峰，是下划线，还是中划线？这是不确定的。</li>
<li>唯一性：下划线和中划线都被替换成驼峰，如果同时存在 2 者甚至 3 者，这个定义不是唯一的。</li>
</ol>
<p>eggjs Loader 要支持这种文件名，一个正则表达式就搞定了。很简单。</p>
<p>是的。但是用户要找到定义它的文件，可就苦了。首先需要知道这种（约定俗成的）替换逻辑（程序员的常识？），其次需要 O(3^n) 的时间复杂度和文件系统查询判断才能 \n\n不那么准确的\n\n 找到对应的定义文件。</p>
<p>eggjs Loader 加的这个功能，当时不觉得有什么不好，甚至觉得很不错。但是现在细想起来，有点画蛇添足，如果当时不做这个替换，开发者可以用下划线和中划线，下划线也可以在代码中直接使用，中划线你就自己难堪点，用 <code>ctx.servcie[&#39;path\nname&#39;][&#39;mode\nname&#39;].method()</code> 也不是不能用。</p>
<p>这样一致性、确定性、唯一性的问题都没有了。少即是多，什么都不做，反而是更好的选择。</p>
<p>\n\n\n\n</p>
<p>随便一提：</p>
<p>有人说，用 vscode 就没这个困扰，确实，用户输入关键字，vscode 通过模糊算法把所有可能性都列出来，让用户判断和选择，长长的待选列表里确实是有你要的的选项，但更多的是你不要的选项，而且首先你得知道这个黑暗的替换逻辑，其次如果文件系统因为不唯一性，出现 2 个甚至 3 个可能的选项，用户是懵的。</p>
<p>排除不确定性，Vim 插件可以 <code>gf</code> 两键准确定位并打开对应文件，不可同日而语。</p>
<p>\n\n\n\n</p>
<p>最后，我不想写个 O(3^n) 复杂度的算法来支持这个东西，然后用了一行命令搞定，业务代码都不用改一行，毫无违和感：</p>
<pre><code>\n git mv a\nb\nc aBC
</code></pre>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://github.com/eggjs/egg%5Cncore/blob/99ef7541b80f73ec4f616628454afde717495f9f/lib/loader/file%5Cnloader.js#L230" target="_blank" rel="noopener noreferrer">https://github.com/eggjs/egg\ncore/blob/99ef7541b80f73ec4f616628454afde717495f9f/lib/loader/file\nloader.js#L230</a>
\n <a href="https://www.ruanyifeng.com/blog/2017/02/filename%5Cnshould%5Cnbe%5Cnlowercase.html" target="_blank" rel="noopener noreferrer">为什么文件名要小写？ \n 阮一峰的网络日志</a>
\n <a href="https://github.com/wwpeng520/blog/blob/master/source/%5Cnposts/%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83.md" target="_blank" rel="noopener noreferrer">blog/前端项目命名规范.md at master · wwpeng520/blog</a>
\n <a href="https://segmentfault.com/q/1010000006040818" target="_blank" rel="noopener noreferrer">文件名下划线还是中划线？ \n SegmentFault 思否</a></p>
]]></content:encoded>
            <category>Technology</category>
        </item>
        <item>
            <title><![CDATA[Vim markdown plugins PK]]></title>
            <link>https://hotoo.github.io/blog/post/vim-markdown-plugins</link>
            <guid>38</guid>
            <pubDate>Thu, 16 Sep 2021 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-markdown-plugins-pk">Vim markdown plugins PK<a aria-hidden="true" href="#vim-markdown-plugins-pk">#</a></h1>
<p>Markdown 是我最常用的文档读写格式，需要频繁用到；Vim 也是我最常用的编辑器，需要在 Vim 中处理 Markdown，
因此调查了一番 Vim 的 Markdown 插件，为了更好的文档书写和阅读体验。</p>
<h2 id="httpsgithubcomtpopevimnmarkdown-1-星"><a href="https://github.com/tpope/vim%5Cnmarkdown" target="_blank" rel="noopener noreferrer">https://github.com/tpope/vim\nmarkdown</a> 1 星<a aria-hidden="true" href="#httpsgithubcomtpopevimnmarkdown-1-星">#</a></h2>
<ol>
<li>
<p>显示隐藏
\n 默认开启
\n 只支持加粗、斜体，其他都不支持。</p>
</li>
<li>
<p>折叠
\n 无。
\n 可以配合 masukomi/vim\nmarkdown\nfolding 插件。</p>
</li>
<li>
<p>链接：没有 <code>&lt;Tab&gt;</code> 获得焦点功能，不能打开链接</p>
</li>
<li>
<p>列表
\n 完全没有自动补全列表项功能，插入模式回车，或普通模式 <code>o</code>, <code>O</code> 等都没有。</p>
</li>
<li>
<p>不支持表格</p>
</li>
</ol>
<h2 id="httpsgithubcomplasticboyvimnmarkdown-2-星"><a href="https://github.com/plasticboy/vim%5Cnmarkdown" target="_blank" rel="noopener noreferrer">https://github.com/plasticboy/vim\nmarkdown</a> 2 星<a aria-hidden="true" href="#httpsgithubcomplasticboyvimnmarkdown-2-星">#</a></h2>
<ol>
<li>
<p>隐藏显示
\n 需要设置 <code>autocmd FileType markdown set conceallevel=2</code> 隐藏功能，默认没开启。
\n 代码块隐藏不是很好，显示了反而可读性更好。
\n 内联代码隐藏了也 OK，但没有给合适的语法高亮。</p>
</li>
<li>
<p>折叠
\n 可以折叠标题栏，包含子标题。
\n 不稳定，经常不能折叠。
\n 折叠在标题栏下一行，我希望是折叠中标题栏本身。</p>
</li>
<li>
<p>链接没有 <code>&lt;Tab&gt;</code> 获得焦点，不能打开链接。</p>
</li>
<li>
<p>列表项
\n 普通模式下 <code>&lt;o&gt;</code> 不会新开列表项，且缩进有问题。
\n 只支持 <code>\n</code> <code>+</code> <code>\n</code> 开启头的列表回车时自动开启新列表项，不支持有序列表自动开启。
\n 不支持 checkbox，被当作普通列表项，回车只会自动开启新列表。
\n 空行时不会自动回缩缩进至取消列表项。</p>
</li>
<li>
<p>需要手工 <code>:TableFormat</code> 命令格式化表格，不像 vimwiki 一样自动格式化。</p>
</li>
</ol>
<h2 id="httpsgithubcomgabrielelanavimnmarkdown-3-星"><a href="https://github.com/gabrielelana/vim%5Cnmarkdown" target="_blank" rel="noopener noreferrer">https://github.com/gabrielelana/vim\nmarkdown</a> 3 星<a aria-hidden="true" href="#httpsgithubcomgabrielelanavimnmarkdown-3-星">#</a></h2>
<ol>
<li>隐藏显示
\n 默认不支持
\n <code>let g:markdown\nenable\nconceal = 1</code> 开启，功能刚刚好。</li>
<li>折叠
\n <code>let g:markdown\nenable\nfolding = 1</code> 开启，功能完备。</li>
<li>链接：
\n 普通链接识别不准确，如果链接定格写，协议部分不高亮</li>
<li>画蛇添足：内置了单词拼写检查，所有中文都会显示红色波浪线报错。
\n <code>let g:markdown\nenable\nspell\nchecking = 0</code> 关闭
\n <code>&lt;Tab&gt;</code> 不能获得焦点。</li>
<li>列表项
\n 不支持有序列表
\n 有自动补全新列表项</li>
<li>表格
\n 配合 godlygeek/tabular 按 <code>&lt;Leader&gt;ft</code>  格式化。
\n 但是不支持带标题栏的语法，会无法格式化。
\n 插入模式输入时有较好的体验，映射了 <code>|</code></li>
</ol>
<h2 id="vimwiki-4-星">Vimwiki 4 星<a aria-hidden="true" href="#vimwiki-4-星">#</a></h2>
<p>\n 隐藏显示，支持很完备。
\n 折叠：不支持
\n 链接：支持高亮、隐藏、打开本地链接和远程链接。
\n 列表：
\n 强大的列表项支持
\n 缺点：回车换行会先切换到普通模式再切到插入模式，RIME 输入法回无法回切状态，导致每次换行都要重新切输入法。
\n 表格：强大的表格格式化。</p>
<p>最大的缺点： \n\n卡慢\n\n。</p>
<p>建议可以使用早期版本。我正在考虑是基于 <code>gabrielelana/vim\nmarkdown</code> 扩展，还是基于 vimwiki 裁剪优化。</p>
]]></content:encoded>
            <category>Technology</category>
        </item>
        <item>
            <title><![CDATA[CSS 颜色值规范革命・去洁癖化]]></title>
            <link>https://hotoo.github.io/blog/post/css-color-value-spec</link>
            <guid>44</guid>
            <pubDate>Fri, 30 Jul 2021 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="css-颜色值规范革命去洁癖化">CSS 颜色值规范革命・去洁癖化<a aria-hidden="true" href="#css-颜色值规范革命去洁癖化">#</a></h1>
<p>由于历史原因，古代前端开发写 CSS 为了统一大小写，和节省网络流量，定义 CSS 颜色值的规范如下：</p>
<ol>
<li>和所有 CSS 值保持一致，统一使用小写字符；</li>
<li>为了尽量节省流量传输，能用 3 位简写的统一用 3 位简写。</li>
</ol>
<pre><code>background\ncolor: #eee;
color: #666;
</code></pre>
<p>这在古代没有生产力工具的情况下，主要通过人肉来保障执行这些规范，老一辈前端忍耐力很好，逐渐习惯了这一约定。目前绝大部分仓库都沿用这一规范。</p>
<p>随着生产力的发展，前端早已不直接书写 CSS 代码，而是类似 less，sass 之类的上层语言，代码可读性和可维护性才是最重要的，但颜色值还继续延续着古老的传统。</p>
<p>这些扭曲人性的古老传统，其阻碍可读性和可维护性的影响越来越突出。</p>
<p>可读性：大写字符具有更好的可读性。</p>
<pre><code>\n color: #eee;
+ color: #EEE;

\n color: #ffffff;
+ color: #FFFFFF;
</code></pre>
<p>可维护性：</p>
<p>\n 新增：Sketch 里复制和生成出来的颜色值都是 6 位大写字符的，何苦要人肉改成 3 位小写；
\n 修改：一个 原本 6 位颜色（例如 #FFFFFE 改为 #FFFFFF）后，为了所谓洁癖要人肉改成 3 位（#FFF）；反之亦然，修改一个 3 位的可能也需要改成 6 位，都是不必要的体力劳动。</p>
<p>新增示例：（即使是 Vim 编辑器之神，也需要 <code>viwu3x</code> 或 <code>ciwfff</code> 这么多键来完成修改。）</p>
<pre><code>\n color: #FFFFFF;
+ color: #fff;
</code></pre>
<p>修改示例：</p>
<pre><code>\n color: #FFFFFF;
+ color: #fff;
</code></pre>
<p><img src="https://user%5Cnimages.githubusercontent.com/143572/127588558%5Cn41911d68%5Cn4baf%5Cn4ece%5Cn9e74%5Cnda375b496207.png" alt="image"></img></p>
<p>代码是写给人看的，顺便给机器执行。</p>
<p>简写 3 位的方式来减少体积这是编译工具考虑的事情，给人看的代码不要削足适履。</p>
<p>我建议 CSS 颜色值规范：</p>
<ol>
<li>
<p>建议书写完整的 6 位；</p>
</li>
<li>
<p>建议大写。不限制大小但同一值大小写相同也行。</p>

</li>
</ol>]]></content:encoded>
            <category>Technology</category>
        </item>
        <item>
            <title><![CDATA[可恢复的 rm 删除]]></title>
            <link>https://hotoo.github.io/blog/post/rm-to-trash</link>
            <guid>40</guid>
            <pubDate>Mon, 04 Mar 2019 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="可恢复的-rm-删除">可恢复的 rm 删除<a aria-hidden="true" href="#可恢复的-rm-删除">#</a></h1>
<p>用过终端（Terminal）的人都知道， rm 删除的文件，不会像 Mac Finder 里删除文件、文件夹
一样，会先进入到废纸篓（Trash），一旦 rm 删除，就很难撤销、恢复。</p>
<p>但是作为程序员，做终端里 rm 删除文件是稀松平常的事，那么如何保障在终端中可以放心
大胆的删除文件、文件夹，而不用担心误删后不可恢复呢？</p>
<p>最直接的想法就是 rm 删除的文件也像 Finder 一样先进废纸篓。</p>
<p>我网上搜寻一番，发现了以下几个工具：</p>
<h2 id="applescript">AppleScript<a aria-hidden="true" href="#applescript">#</a></h2>
<p>在 <a href="https://blog.csdn.net/TinyJian/article/details/78195316" target="_blank" rel="noopener noreferrer">Mac 下使用命令行或脚本删除文件到废纸篓</a>
这篇文章中介绍，Mac Finder 中删除的文件其实是进入到 ~/.Trash 文件夹。
但是如果简单的讲文件 mv 到 ~/.Trash 文件夹，是无法做废纸篓里右键恢复到原处的，
因为这个移动操作没有记录完整的操作行为。</p>
<p>通过 AppleScript 可以通知 Finder 删除文件：</p>
<pre><code>#!/bin/bash

fp=/absolute/path/to/file
osascript &lt;&lt; EOF
tell application &quot;Finder&quot;
    posix path of ((delete posix file &quot;\n{fp}&quot;) as unicode text)
end tell
EOF
</code></pre>
<p>优点：</p>
<ol>
<li>删除时有声效。</li>
<li>有操作记录可“放回原处”。</li>
</ol>
<p>缺点：</p>
<ol>
<li>首次使用是有授权提示，可接受。</li>
</ol>
<h2 id="rmtrash-1">rmtrash 1<a aria-hidden="true" href="#rmtrash-1">#</a></h2>
<p>在网上找到好几个不同版本但命名相同的 rmtrash 程序，有的是 shell 脚本，有的是
Xcode 程序。</p>
<pre><code>brew install rmtrash

vi ~/.bashrc
alias rm=&#39;rmtrash&#39;
source ~/.bashrc
</code></pre>
<p>缺点：</p>
<ol>
<li>删除时没有声效。</li>
<li>在废纸篓不可直接“放回原处”。</li>
</ol>
<h2 id="rmtrash-2-objectivenc">rmtrash 2: Objective\nC<a aria-hidden="true" href="#rmtrash-2-objectivenc">#</a></h2>
<p>\n <a href="https://www.nightproductions.net/cli.htm" target="_blank" rel="noopener noreferrer">https://www.nightproductions.net/cli.htm</a></p>
<p>这个版本的 rmtrash 是用 Objective\nC 编写的应用程序，但是版本有点老，下载安装好
rmtrash 发现并不能在 macOS Mojave (10.14) 中正常运行。</p>
<pre><code>\n rmtrash
zsh: bad CPU type in executable: rmtrash
</code></pre>
<p>缺点：不支持 macOS Mojave。</p>
<h2 id="rmtrash-3-shell">rmtrash 3: Shell<a aria-hidden="true" href="#rmtrash-3-shell">#</a></h2>
<p><a href="https://github.com/LaiJingli/rmtrash" target="_blank" rel="noopener noreferrer">https://github.com/LaiJingli/rmtrash</a></p>
<p>从源码上看，被删除的文件是进入了自定义的 ~/.rmtrash/ 文件夹（这不是期望的），
另外还有一堆其他的功能，例如 list, mv, restore, empty。</p>
<p>缺点：代码写的太烂，我是不会用的。</p>
<h2 id="rmntrash-shell">rm\ntrash: Shell<a aria-hidden="true" href="#rmntrash-shell">#</a></h2>
<p><a href="https://github.com/nateshmbhat/rm%5Cntrash" target="_blank" rel="noopener noreferrer">https://github.com/nateshmbhat/rm\ntrash</a></p>
<pre><code>\n rm\ntrash ~/tmp
rm\ntrash: line 165: realpath: command not found
usage: dirname path
usage: cp [\nR [\nH | \nL | \nP]] [\nfi | \nn] [\napvXc] source\nfile target\nfile
       cp [\nR [\nH | \nL | \nP]] [\nfi | \nn] [\napvXc] source\nfile ... target\ndirectory
Error copying the /Users/hotoo/tmp to trash. Trying to move /Users/hotoo/tmp with the name /Users/hotoo/tmp (0)
</code></pre>
<p>不过 ~/tmp 实际已被删除到未知域。</p>
<p>优点：</p>
<ol>
<li>支持 Linux。</li>
<li>代码写的很漂亮。</li>
</ol>
<p>缺点：</p>
<ol>
<li>不太支持 macOS，可以删除文件但在 macOS 下执行有报错。</li>
<li>删除的目录不是 macOS 的 .Trash 目录，无法在 macOS 的废纸篓中找到并放回原处。</li>
<li>安装有点麻烦。</li>
</ol>
<h2 id="rmtrash-shell">rmtrash: Shell<a aria-hidden="true" href="#rmtrash-shell">#</a></h2>
<p><a href="https://github.com/PhrozenByte/rmtrash" target="_blank" rel="noopener noreferrer">https://github.com/PhrozenByte/rmtrash</a></p>
<h2 id="rmtrash-for-mac-os-x-objectivenc">rmtrash for Mac OS X: Objective\nC<a aria-hidden="true" href="#rmtrash-for-mac-os-x-objectivenc">#</a></h2>
<p>\n <a href="https://github.com/sebikeller/rmtrash%5Cnfor%5CnMac%5CnOS%5CnX" target="_blank" rel="noopener noreferrer">https://github.com/sebikeller/rmtrash\nfor\nMac\nOS\nX</a></p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://apple.stackexchange.com/questions/194672/why%5Cndoesnt%5Cnthe%5Cnrm%5Cncommand%5Cndump%5Cnfile%5Cnin%5Cntrash/194868" target="_blank" rel="noopener noreferrer">Why doesn't the 'rm' command dump file in Trash?</a>
\n <a href="https://apple.stackexchange.com/questions/17622/how%5Cncan%5Cni%5Cnmake%5Cnrm%5Cnmove%5Cnfiles%5Cnto%5Cnthe%5Cntrash%5Cncan" target="_blank" rel="noopener noreferrer">How can I make 'rm' move files to the trash can?</a>
\n <a href="https://github.com/andreafrancia/trash%5Cncli" target="_blank" rel="noopener noreferrer">https://github.com/andreafrancia/trash\ncli</a>
\n <a href="https://www.ibm.com/developerworks/cn/linux/1410%5Cnlicy%5Cnlinuxtrash/" target="_blank" rel="noopener noreferrer">回收站功能在 Linux 中的实现</a></p>
<h2 id="总结">总结<a aria-hidden="true" href="#总结">#</a></h2>
<p>基于上面的这么多的对比，我实现了一个便于安装、使用的脚本，欢迎使用。</p>
<p><a href="https://github.com/hotoo/rm%5Cntrash" target="_blank" rel="noopener noreferrer">https://github.com/hotoo/rm\ntrash</a></p>
<pre><code>\n npm i \ng rm\ntrash
</code></pre>
]]></content:encoded>
            <category>Technology</category>
        </item>
        <item>
            <title><![CDATA[钱塘之怪现状]]></title>
            <link>https://hotoo.github.io/blog/post/dogs-cars</link>
            <guid>39</guid>
            <pubDate>Sun, 18 Nov 2018 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="钱塘之怪现状">钱塘之怪现状<a aria-hidden="true" href="#钱塘之怪现状">#</a></h1>
<p>戊戌年癸亥月某日，钱塘某妇人因小轿车司机未让行遂踹轿车，司机恼怒成羞狠揍妇人，
妇人遂通过记者新闻、微博、论坛等多种途径发声爆光，众键盘侠也假正义之名义声讨
谴责车主，同时对小轿车、小客车、大客车、大货车、中华田园车、叉车、铲车、自行车、
电动车、摩托车、碰碰车、火车、动车等全国众多车辆，及不文明驾车行为进行了猛烈的
舆论抨击。</p>
<p>钱塘衙门立即援引十四年前之交规法令，要求所有车辆注册登记上牌，但大客车、大货车、
铲车、中华田园车等车辆因为体型较大不予登记上牌。准予登记上牌者，首年上牌费千元，
次年及以后每年五百。另外火车、动车虽然体型更大，但是体制属于国有编制，不在此限。</p>
<p>同时衙门还限制所有车辆上路时间（已登记上牌车辆），所有车辆均仅允许在卯时之前，
戌时之后摸黑上路，否则扣车。按规定时间上路者，亦不允许进入公路、高速、土路、
地面停车场、地下车库等路段和场所。</p>
<p>\n\n恶人因车而行恶事，却罪怪全中华车辆，怪者乎？\n\n</p>
<p>妇人弱者乎？非也。除了鸣笛之外，无法发声的车辆才是弱者，孰来为其发声？
（备注：鸣笛亦属于违反衙门规定之行为）</p>
<p>\n\n\n\n</p>
<blockquote>
<p>“杭州图书馆对所有读者免费开放，因此就有乞丐和拾荒者进门阅览。
图书馆对他们的唯一要求，就是把手洗干净再阅读。有人无法接受，找到褚树青馆长，
说允许乞丐和拾荒者进馆，是对其他读者的不尊重。</p>
<p>褚树青回答：我无权拒绝他们入内读书，但您有权利选择离开。”</p>
</blockquote>
<p><a href="https://news.sohu.com/20110124/n279043931.shtml" target="_blank" rel="noopener noreferrer">ref</a></p>
<p>有些人觉得狗狗出现在他们的视野中是对他们的不尊重，动辄要棒杀。
人心何以凶残到如此地步。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[带滑块的进度条]]></title>
            <link>https://hotoo.github.io/blog/post/process-with-bar</link>
            <guid>41</guid>
            <pubDate>Wed, 11 Apr 2018 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="带滑块的进度条">带滑块的进度条<a aria-hidden="true" href="#带滑块的进度条">#</a></h1>
<p>在支付宝钱包，“我的 \n 总资产”里面，有一个累计收益的卡片，其中还有一个带滑块的进度条，
显示我的收益对比同地区理财的用户中，处于什么样的一个水平。</p>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/YKAjtnKzJWUpuLWOaMkK.PNG" alt="我的 \n 总资产 \n 累计收益卡片"></img></p>
<p>这种带滑块的卡片，如果不假思索简单处理，做出的效果就会出现进度 0% 和 100% 时在左右超出顶格，滑块只显示一半。</p>
<p>为了解决这个问题，开发者最早的方案考虑的特别复杂，</p>
<h2 id="纯-css-实现">纯 CSS 实现<a aria-hidden="true" href="#纯-css-实现">#</a></h2>
<p><a href="https://gitlab.alipay%5Cninc.com/h5%5Cnrelease/wealth/blob/3.6.11/src/index/asset/components/profitRate/index.jsx" target="_blank" rel="noopener noreferrer">https://gitlab.alipay\ninc.com/h5\nrelease/wealth/blob/3.6.11/src/index/asset/components/profitRate/index.jsx</a>
<a href="https://gitlab.alipay%5Cninc.com/h5%5Cnrelease/wealth/blob/3.6.11/src/index/asset/components/profitRate/index.less" target="_blank" rel="noopener noreferrer">https://gitlab.alipay\ninc.com/h5\nrelease/wealth/blob/3.6.11/src/index/asset/components/profitRate/index.less</a></p>
<h2 id="js--css-的复杂不完美实现">JS + CSS 的复杂不完美实现<a aria-hidden="true" href="#js--css-的复杂不完美实现">#</a></h2>
<h2 id="js--css-的简单完美实现">JS + CSS 的简单完美实现<a aria-hidden="true" href="#js--css-的简单完美实现">#</a></h2>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/bvsIRbcSHMcpsyBSnoKc.png" alt="算法示意图"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Git 提效篇]]></title>
            <link>https://hotoo.github.io/blog/post/git-branch</link>
            <guid>42</guid>
            <pubDate>Fri, 12 May 2017 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="git-提效篇">Git 提效篇<a aria-hidden="true" href="#git-提效篇">#</a></h1>
<p>集团的流程工具会生成一团奇形怪状的分支名称，要记忆这些分支名是一项难题，默认的
<code>git branch</code> 列出的本地分支都是几乎无法识别的乱码，如何快速标识、识别、打开这些丑陋的分支名呢？</p>
<h2 id="1-备注分支">1. 备注分支<a aria-hidden="true" href="#1-备注分支">#</a></h2>
<pre><code>\n git config branch.WTF01942367\n20170510\nwtfbffweb.description &quot;什么鬼迭代 1.0&quot;
\n git branch
  WTF01730954\n20170224\nwtfbffweb
  WTF01785082\n20170316\nwtfbffweb
  WTF01824187\n20170329\nwtfbffweb
\n WTF01942367\n20170510\nwtfbffweb
\n git config branch.WTF01942367\n20170510\nwtfbffweb.description
什么鬼迭代 1.0
</code></pre>
<p>还可以使用 <code>git branch \n\nedit\ndescription</code> 命令编辑复杂的备注信息。</p>
<h2 id="2-显示备注">2. 显示备注<a aria-hidden="true" href="#2-显示备注">#</a></h2>
<p>默认 <code>git branch</code> 列出的本地分支不会附带备注信息，git 内置的
<code>git config branch.{branch\nname}.description</code> 可以显示单个分支的备注。</p>
<p>以下方法可以一次性列出所有分支，并附上各个分支对应的备注信息。</p>
<pre><code>\n npm i \ng git\nbr

\n git br
  WTF01730954\n20170224\nwtfbffweb 什么鬼迭代 0.1
  WTF01785082\n20170316\nwtfbffweb 什么鬼迭代 0.2
  WTF01824187\n20170329\nwtfbffweb 什么鬼迭代 0.3
\n WTF01942367\n20170510\nwtfbffweb 什么鬼迭代 1.0
</code></pre>
<h2 id="3-分支别名">3. 分支别名<a aria-hidden="true" href="#3-分支别名">#</a></h2>
<p>上面的方法备注了一团乱码的分支名，但真正要切换到这种分支时，仍然需要 <code>git br</code>
列出所有分支，并从中找出目标分支，复制，<code>git co &lt;C\nv&gt;</code>。</p>
<p>有没有更便捷的方法呢，答案是肯定的。</p>
<h3 id="31-git-symbolicnref">3.1. git symbolic\nref<a aria-hidden="true" href="#31-git-symbolicnref">#</a></h3>
<p>Git 内置了强大的 symbolic\nref 方法，可以给分支增加引用（别名）：</p>
<pre><code>\n git symbolic\nref refs/heads/{分支别名} refs/heads/{目标分支名}
\n git symbolic\nref refs/heads/v1.0 refs/heads/WTF01942367\n20170510\nwtfbffweb
\n git co v1.0
Switched to branch &#39;v1.0&#39;
; 这时候会切换到 WTF01942367\n20170510\nwtfbffweb
\n git pull origin v1.0
\n git checkout feat/one
\n git rebase v1.0
</code></pre>
<h3 id="32-gitnbranchnalias">3.2. git\nbranch\nalias<a aria-hidden="true" href="#32-gitnbranchnalias">#</a></h3>
<p>直接使用 symboilc\nref 虽然可以满足需求，但是用起来非常不方便，这时候可以使用
git\nbranch\nalias 工具来方便管理分支别名。</p>
<pre><code>\n npm i \ng git\nbranch\nalias

; 给当前分支设置别名
\n git co WTF01942367\n20170510\nwtfbffweb
\n git bralias v1.0

; 或者指定目标分支名称
\n git branch\nalias v1.0 WTF01942367\n20170510\nwtfbffweb
</code></pre>
<h2 id="4-提交-mrpr-时自动找到找到目标分支">4. 提交 MR/PR 时自动找到找到目标分支<a aria-hidden="true" href="#4-提交-mrpr-时自动找到找到目标分支">#</a></h2>
<p>特性分支需要合并到迭代分支、主干分支时，要手工找到目标分支也是很困难的，这时候
可以使用 <a href="https://github.com/hotoo/gitopen" target="_blank" rel="noopener noreferrer">gitopen</a> 这个小工具来帮忙。</p>
<pre><code>\n npm i \ng gitopen
\n git checkout feat/one
\n git push origin feat/one
\n gitopen mr
</code></pre>
<p>gitopen 会自动找到目标分支，并打开创建 MR 的在线地址，一键提交 MR。</p>
<p>gitopen 还有很多其他方便的特性。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://github.com/bahmutov/git%5Cnbranches" target="_blank" rel="noopener noreferrer">https://github.com/bahmutov/git\nbranches</a>
\n <a href="https://github.com/hotoo/gitopen" target="_blank" rel="noopener noreferrer">https://github.com/hotoo/gitopen</a>
\n <a href="https://github.com/hotoo/git%5Cnbranch%5Cnalias" target="_blank" rel="noopener noreferrer">https://github.com/hotoo/git\nbranch\nalias</a>
\n <a href="https://gist.github.com/mauricerkelly/0b12b20a870d1e38081e" target="_blank" rel="noopener noreferrer">https://gist.github.com/mauricerkelly/0b12b20a870d1e38081e</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[HTML Tabs 最佳实践]]></title>
            <link>https://hotoo.github.io/blog/post/html-tabs</link>
            <guid>43</guid>
            <pubDate>Tue, 21 Mar 2017 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="html-tabs-最佳实践">HTML Tabs 最佳实践<a aria-hidden="true" href="#html-tabs-最佳实践">#</a></h1>
<p>Tabs 面板的显示和隐藏一般以 display 来控制显示和隐藏，但是如果默认未显示的 Tabs 面板中渲染需要知道面板宽高的组件
（如 Canvas，某些轮播组件等）时，就会因为面板在 display:none 的状态下无法拿到宽高导致渲染组件异常。</p>
<p>这里建议 Tabs 使用 position:absolute 来将不可见的组件移动到用户不可见的负坐标区域，需要时再将面板移动到可见区域，
来避免面板不可见时渲染内部组件异常的问题。而且也可以做一些滑动显示的动画效果。</p>
<p>简单示例代码：</p>
<p>HTML:</p>
<pre><code>&lt;div class=&quot;tabs&quot;&gt;
  &lt;ol class=&quot;tabbar&quot;&gt;
    &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;#tab1&quot;&gt;Tab 1&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;#tab2&quot;&gt;Tab 2&lt;/a&gt;&lt;/li&gt;
  &lt;/ol&gt;
  &lt;ol class=&quot;tabpanel&quot;&gt;
    &lt;li class=&quot;active&quot;&gt;
      Tab Panel 1
    &lt;/li&gt;
    &lt;li&gt;
      Tab Panel 2
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</code></pre>
<p>LESS:</p>
<pre><code>.tabs {
  .tabpanel {
    position: relative;
    li {
      position: absolute;
      top: \n999999px;
      left: \n9999px;
      width: 100%; /\n 避免浮动导致宽度不对 \n/
    }
    li.active {
      /\n 不要使用 position:absolute 并且改变坐标的方式，
       \n 避免 Tabs 脱离文档流，父元素高度为 0，导致下面的其他元素错位。
       \n/
      position: static;
    }
  }
}
</code></pre>
<h2 id="切换-tab-时面板所在位置问题">切换 Tab 时，面板所在位置问题<a aria-hidden="true" href="#切换-tab-时面板所在位置问题">#</a></h2>
<p>无论使用 display 还是 position 方案，切换 tab 的时候，面板的位置会停留在上个显示的面板离开时的同一位置（默认是 0）。</p>
<p>有两个解决方案：</p>
<ol>
<li>
<p>对于可以固定面板高度的场景（如整个页面都是 Tab），固定面板容器的高度，则 position 方案在切换 Tab 的时候，
默认就定位在当前面板之前停留的位置，但是需要使用 iScroll 类似的方案来实现上下拉回弹，及刷新、加载更多的功能
（也可以使用 Native 默认的上下拉回弹功能，但是 Tabbar 会随着整个 webview 一起拉动，体验不是太好）。</p>
</li>
<li>
<p>切换 Tab 时，记录各个面板的所在位置，切换回来时使用 scrollTo(x, y) 的方式来滚动到面板上次的位置。</p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用 GPG 签名 Git Commits]]></title>
            <link>https://hotoo.github.io/blog/post/gpg-sign-for-git-comments</link>
            <guid>45</guid>
            <pubDate>Sat, 11 Jun 2016 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="使用-gpg-签名-git-commits">使用 GPG 签名 Git Commits<a aria-hidden="true" href="#使用-gpg-签名-git-commits">#</a></h1>
<p>前段时间 GitHub 支持在 Git Commits 中使用 GPG 签名验证，可以避免其他人使用你的
Email 进行 commit。</p>
<p><img src="/images/blog/2016/gpg.png" alt="GPG"></img></p>
<h2 id="安装-gpg">安装 GPG<a aria-hidden="true" href="#安装-gpg">#</a></h2>
<p>下载地址： <a href="https://www.gnupg.org/download/" target="_blank" rel="noopener noreferrer">https://www.gnupg.org/download/</a></p>
<p>Mac 下有两个可选工具，分别是 <a href="https://gpgtools.org/" target="_blank" rel="noopener noreferrer">Mac GPG</a> 和 GnuPG for OS X，我都尝试了下，觉得
Mac GPG 相对比较容易点，安装过程中同时引导创建一个 GPG key 存储到 GPG keychain
中，并且在 Git 提交时记住 passphrase，避免每次提交输入 passphrase。</p>
<h2 id="生成-gpg-key">生成 GPG key<a aria-hidden="true" href="#生成-gpg-key">#</a></h2>
<blockquote>
<p>如果在安装过程中，自动引导生成了 GPG key 的话，这一步可以省略。</p>
</blockquote>
<p>除了安装时引导生成的 GPG key 之外，你还可以手动生成 GPG key：</p>
<pre><code>\n gpg \n\ngen\nkey
gpg (GnuPG/MacGPG2) 2.0.28; Copyright (C) 2015 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection?
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0) 1y
Key expires at 日  6/11 22:33:50 2017 CST
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: xxx
Email address: xxx@yyy.com
Comment:
You selected this USER\nID:
    &quot;xxx &lt;xxx@yyy.com&gt;&quot;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit?
Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: key B5DB6617 marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   3  signed:   0  trust: 0\n, 0q, 0n, 0m, 0f, 3u
gpg: next trustdb check due at 2017\n06\n11
pub   2048R/B5DB6617 2016\n06\n11 [expires: 2017\n06\n11]
      Key fingerprint = 3AE5 19D5 8A58 C59B B029  6CEA 8566 6A47 B5DB 6617
uid       [ultimate] xxx &lt;xxx@yyy.com&gt;
sub   2048R/1F4A9B85 2016\n06\n11 [expires: 2017\n06\n11]
</code></pre>
<h2 id="配置-git">配置 Git<a aria-hidden="true" href="#配置-git">#</a></h2>
<p>配置好 GPG key 之后，可以配置让 git 在某个仓库所有的 commits 都添加 GPG key 验证：</p>
<pre><code>git config commit.gpgsign true
</code></pre>
<p>也可以让本地所有的仓库都进行 GPG 验证：</p>
<pre><code>\n git config \n\nglobal commit.gpgsign true
</code></pre>
<h2 id="验证-git-commits">验证 Git commits<a aria-hidden="true" href="#验证-git-commits">#</a></h2>
<p>如果没有设置局部仓库或全局仓库默认开启 commits GPG 验证，提交时可以附加 <code>\nS</code> 参考，
要求进行 GPG 验证。</p>
<pre><code>\n git commit \nS \nm &quot;comment&quot;
</code></pre>
<p>如果提交使用的账户信息和 GPG 签名不一致，则无法通过 GPG 验证，会导致提交失败。</p>
<pre><code>\n git ci \nm &quot;test&quot;
gpg: skipped &quot;ZZZ &lt;xxx@yyy.com&gt;&quot;: No secret key
gpg: signing failed: No secret key
error: gpg failed to sign the data
fatal: failed to write commit object
</code></pre>
<p>正常的话，会提示输入 passphrase 解锁 PGP 密钥，此时可以选中保存到 Mac OS X 系统
的 Keychain 中，避免每次输入 passphrase。</p>
<pre><code>\n git add .
\n git ci \nm &quot;test&quot;

You need a passphrase to unlock the secret key for
user: &quot;xxx &lt;xxx@yyy.com&gt;&quot;
4096\nbit RSA key, ID C0B176D7, created 2016\n06\n11

[master (root\ncommit) 163d909] test
 1 file changed, 3 insertions(+)
 create mode 100644 README.md
</code></pre>
<h2 id="将-gpg-密钥添加到-github">将 GPG 密钥添加到 GitHub<a aria-hidden="true" href="#将-gpg-密钥添加到-github">#</a></h2>
<p>这时 push 到 GitHub 仓库的 commits，查看 commits 记录会显示 <code>unverified</code>。</p>
<pre><code>\n gpg \n\nlist\nsecret\nkeys
/Users/xxx/.gnupg/secring.gpg
\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n
sec   4096R/C0B176D7 2016\n06\n11 [expires: 2020\n06\n11]
uid                  xxx &lt;xxx@yyy.com&gt;
ssb   4096R/E00F263F 2016\n06\n11

\n gpg \n\narmor \n\nexport C0B176D7
\n\n\n\n\nBEGIN PGP PUBLIC KEY BLOCK\n\n\n\n\n
Comment: GPGTools \n https://gpgtools.org

\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n
\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n
\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n
\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n
\n\n\n\n\n
\n\n\n\n\nEND PGP PUBLIC KEY BLOCK\n\n\n\n\n
</code></pre>
<p>将上面 export 出来的 GPG 密钥添加到 GitHub 的 <a href="https://github.com/settings/keys" target="_blank" rel="noopener noreferrer">SSH and GPG keys</a> 即可。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://github.com/blog/2144%5Cngpg%5Cnsignature%5Cnverification" target="_blank" rel="noopener noreferrer">GPG signature verification</a>
\n <a href="https://help.github.com/articles/signing%5Cncommits%5Cnusing%5Cngpg/" target="_blank" rel="noopener noreferrer">Signing commits using GPG</a>
\n <a href="https://help.github.com/articles/generating%5Cna%5Cnnew%5Cngpg%5Cnkey/" target="_blank" rel="noopener noreferrer">Generating a new GPG key</a>
\n <a href="https://help.github.com/articles/adding%5Cna%5Cnnew%5Cngpg%5Cnkey%5Cnto%5Cnyour%5Cngithub%5Cnaccount/" target="_blank" rel="noopener noreferrer">Adding a new GPG key to your GitHub account</a>
\n <a href="https://www.gnupg.org/download/" target="_blank" rel="noopener noreferrer">GnuPG \n download</a></p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://mikegerwitz.com/papers/git%5Cnhorror%5Cnstory" target="_blank" rel="noopener noreferrer">A Git Horror Story: Repository Integrity With Signed Commits</a>
\n <a href="https://www.oschina.net/translate/git%5Cnhorror%5Cnstory" target="_blank" rel="noopener noreferrer">Git 使用中的教训：签名提交确保代码完整可信</a>
\n <a href="https://arondight.me/2016/04/17/%E4%BD%BF%E7%94%A8GPG%E7%AD%BE%E5%90%8DGit%E6%8F%90%E4%BA%A4%E5%92%8C%E6%A0%87%E7%AD%BE/" target="_blank" rel="noopener noreferrer">使用 GPG 签名 Git 提交和标签</a>
\n <a href="https://github.com/pstadler/keybase%5Cngpg%5Cngithub" target="_blank" rel="noopener noreferrer">Step\nby\nstep guide on how to create a GPG key on keybase.io, adding it to a local GPG setup and use it with Git and GitHub</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[测试代码和可测试代码]]></title>
            <link>https://hotoo.github.io/blog/post/test-code-and-testable-code</link>
            <guid>46</guid>
            <pubDate>Sat, 04 Jun 2016 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="测试代码和可测试代码">测试代码和可测试代码<a aria-hidden="true" href="#测试代码和可测试代码">#</a></h1>
<p>项目中有一个要将指定时间和当前时间比较，计算相对时间的逻辑（比如显示 <code>3 分钟前</code>），
由于当前时间和执行测试用例的时机有关，每次执行用例都会不同，如何让这个代码可测试呢？
有些人可能想到 Mock 当前时间，测试的时候让当前时间凝固，于是有了如下代码：</p>
<pre><code>// 实际业务代码中：
// 虽然本来只需要 moment() 就可以了，但是为了方便测试，传入了一个可 Mock 的 Date.now
const now = moment(Date.now());

// 测试用例中，Mock Date.now 方法：
mm(Date, &#39;now&#39;, () =&gt; 1464969293129);
</code></pre>
<p>这个业务代码是 \n\n可测试\n\n 的代码吗？我认为不是。</p>
<p>这个业务代码为了测试，使用了一个不必要的方法，而且让测试代码和业务逻辑相互依赖，
一旦业务代码重构，测试代码将不可测试。这个代码是为测试写的，称之为 \n\n测试\n\n 代码
而不是 \n\n可测试\n\n 代码更合适点。</p>
<p>再举一个例子，还是时间相关的动态数据输入问题：</p>
<p>项目中有一个今日收益更新的提醒消息，只有是今天的更新才显示，所以第一直觉应该是造一个
收益更新时间是今天的测试数据，而不是造一个固定的数据（可能固定测试数据比较偷懒方便），
然后篡改业务逻辑中当前时间的计算。</p>
<pre><code>// 业务代码正常该怎么写怎么写，不用管测试怎么活。
const today = moment().format(&#39;YYYYMMDD&#39;);
if (data.updateDate === today) {
  // show message.
}

// 活的测试数据
data.updateDate = moment().format(&#39;YYYYMMDD&#39;);
</code></pre>
<blockquote>
<p>测试代码应该只关注正常的数据输入和输出 \n（即使输入、输出是难以预测的）\n。</p>
<p>而不应该关注业务实现逻辑，试图篡改业务代码，让测试可以进行。</p>
</blockquote>
<p>更好一点的可测试代码，可以将当前时间传入以便让输入、输出可以预测：</p>
<pre><code>// 业务抽象
// 计算两个时间差，格式化为 `3 分钟前` 等相对时间。
// @param {Date|Number} date1 较早的时间或时间戳。
// @param {Date|Number} date2 较晚的时间或时间戳，默认当前时间。
// @return {String} 相对时间差
function dateDiff(date1, date2 = Date.now()) {
  // ...
}

// 业务调用
dateDiff(data.datetime);

// 测试代码
assert(dateDiff(new Date(2016,0,1,0,0,0,0), new Date(2016,0,1,0,0,0,10)) === &#39;刚刚&#39;);
assert(dateDiff(new Date(2016,0,1,0,0,0,0), new Date(2016,0,1,0,3,0,0)) === &#39;3 分钟前&#39;);
assert(dateDiff(new Date(2016,0,1,0,0,0,0), new Date(2016,0,1,1,0,0,0)) === &#39;1 小时前&#39;);
</code></pre>
<h2 id="2017n02n09-更新">2017\n02\n09 更新<a aria-hidden="true" href="#2017n02n09-更新">#</a></h2>
<p>群里又有了类似的一个案例，开发想写测试用例来测 location.href 的赋值是否正确，
用以测试页面跳转逻辑是否正确。于是想通过重载 location 对象来监听给 location.href
赋值时，所赋值是否符合期望。</p>
<p>还辛苦找到 <a href="https://zhuanlan.zhihu.com/p/24342684" target="_blank" rel="noopener noreferrer">Chrome 出了个小 bug：论如何在 Chrome 下劫持原生只读对象</a>
这么牛逼变态到令人折服的方法。但是，这是正确的方法吗？我认为不是。</p>
<p>location 的案例中，我觉得应该是测试赋值给 location.href 的 \n\n值\n\n本身是否正确，
而不是测试企图篡改 location 来监听 href 属性是否正确。即：</p>
<pre><code>// 业务代码
function getUrl(){}
location.href = getUrl(...args);
</code></pre>
<p>单元测试用例只需要测试 getUrl 在各种边界输入条件下，输出是否符合期望就可以了。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[杭州购车记]]></title>
            <link>https://hotoo.github.io/blog/post/buying-a-car-in-hangzhou</link>
            <guid>49</guid>
            <pubDate>Wed, 27 Jan 2016 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="杭州购车记">杭州购车记<a aria-hidden="true" href="#杭州购车记">#</a></h1>
<p>终于在年前把车的事情搞定了，这是 2015 年做成的唯一一件大事，经历了不少坎坷，一路摸索过来，很多都是懵懂，
因此想通过这篇流水记录，帮助到一点大家，如果有写的不好不对的地方，大家可以给我提出，我尽力改进。</p>
<p>『车图』</p>
<h2 id="驾照">驾照<a aria-hidden="true" href="#驾照">#</a></h2>
<p>杭州限牌限行前，我就拿到了驾照，跟另两个同事一起在公司对面的驾校学的。</p>
<p>报名、体检、缴费、领教程学习理论知识，科目一没有拿到满分，但一次性通过了，没有补考。</p>
<p>教练在时间上安排的比较合理，科目二场地练习时，一般每周有两个工作日早上 7 点半左右到驾校练习 1 个半小时，9 点到公司上班。
（科目二包括项目：出库、倒库、移库、侧方停车、曲线行驶、停坡起步、直角转弯、单边桥、起伏路行驶等）。满分通过。</p>
<p>模拟学习，可以选择周末去坐几个小时。</p>
<p>模拟考试，尽早预约。</p>
<p>路上没开过多少次，大都是邻近考试前两天冲刺恶补，但是很快就熟悉了。
但是教练没教各种灯怎么用，只会转向灯（和刹车灯），大灯都不会。
考试时不知道怎么关双闪，好紧张，挂科一次。当场补考，很紧张慢腾腾的开，考官说这么好的路况开快点，
于是加油门、变道、超车，行云流水，把平时学车时的状态发挥出来了，满分通过。
事后同考的同事说，还好你补考 HOLD 住了，表现不错。</p>
<p>从开始学车，到拿到驾照，差不多 3 个月时间，挺快的。</p>
<h2 id="购车">购车<a aria-hidden="true" href="#购车">#</a></h2>
<p>老婆喜欢 SUV，汽车之家上看的也基本都是 SUV，然后去 4S 店看实体车试驾。</p>
<p>\n 马自达 CX\n5，说实话，外观确实漂亮，操纵也非常好。但是老婆晕车，说坐着头晕。
\n 奔驰 GLA，也挺漂亮，但是紧凑型偏小，早晚被换。
\n 宝马 X1 紧凑型小，拥挤；X3 小贵。
\n 奥迪 Q3 紧凑型有点小，坐着挤；Q5 小贵。
\n 本田 XR\nV，CR\nV 看着、坐着都不喜欢，没试驾。
\n MINI，老婆很喜欢，但是看了评价都说避震硬垫屁股，综合评价第一辆车不合适。
\n 昂克威，看起来胖嘟嘟的有点可爱，但是试驾起来还是一个胖子步态。
\n 比亚迪・唐，电动车日常上下班代步还是很有优势的，不知道小区车库是否可以安装充电设备。
主要考虑到电动车目前可能还太成熟，基础设施也不够齐全。因为是混动，这个价钱可以买个
好点的传统汽油发动机的车。
\n Jeep 自由光，看车的时候正好即将推出，但是我应该是等不到了，图片看起来不错，
但是也有人说 Jeep 车不好，小毛病多。
\n 随便听到公司同事在说大众高尔夫，挺牛逼的样子，虽然我不懂。但是网上一看就不是我的菜。
\n 沃尔沃 XC60，驾驶感不错，车身很稳，老婆说很舒服不晕了，但是小贵。
\n 顺便看了沃尔沃 S60L，总体很喜欢，但不是 SUV。</p>
<p>最后综合多方面情况考虑，选了沃尔沃 S60L，找老婆的朋友的朋友的 4S 店朋友，拿到相对比较高的优惠。</p>
<p>小吐槽下，第一次经历买车很多东西都不懂，被坑到不少。</p>
<p>\n 比如车子大约是 8 个月前生产的，放了大半年。虽然是新车没错，而且据说沃尔沃车子小众
（但是买车之后我路上经常会碰到沃尔沃的车），所以一般会放的相对久点，看运气。
我建议对于放了时间长的车，如果不能接受，可以要求换车，或者提出其他要求。
\n 被强制安装了导航模块，加了 2 千元左右。
\n 平安银行无息免抵押贷款，本来说不需要购买盗抢险，结果说总行有新政策又要求必须买盗抢险。
\n 有一次在 4S 店结果轮毂被他们蹭花。</p>
<h2 id="临牌">临牌<a aria-hidden="true" href="#临牌">#</a></h2>
<ol>
<li>买车时，4S 店会帮申请一张 15 天的杭州市蓝色临牌。</li>
<li>第 15 天时，自己带上身份证、车辆合格证、一致性证书、发票、交强险保单，及其复印件
到车管所申领临牌。自己最多可以申领 2 次，即有最多 45 天的杭州临牌可以用。杭州临牌
只能在杭州市辖范围内使用，不可跨市甚至跨省使用，违反被抓的话属于无牌驾驶，直接扣 12 分，扣车。</li>
<li>1 号楼拿身份证在服务台拿号等候审核资料。
\n 我第一次下午去前面有 100 人，等候了 1 小时左右。
\n 第二次上午 11 点半去，本以为赶不上了，结果没什么人，直接窗户审核资料，缴费，总共 20 分钟左右拿到临牌。</li>
<li>资料审核完备后拿到回执单缴费，每张临牌 5 元，总共 10 元。</li>
<li>缴费拿到另一张回执单等候取牌照，一般 20 分钟左右。</li>
</ol>
<h2 id="竞拍车牌">竞拍车牌<a aria-hidden="true" href="#竞拍车牌">#</a></h2>
<ol>
<li>每月 8 日之前提交资料进行审核（3 个月有效期，到期前也是 8 号之前可以提交延长 3 个月有效期）。</li>
<li>每月 23 日公布审核结果（登录到系统中查询状态）。</li>
<li>每个月的都有竞拍日历，可以自己做个日历通知。</li>
<li>5 个工作日的缴付 2000 元的竞价保证金，可以通过银行柜台、网银转账，但不要用支付宝、微信等第三方支付工具。</li>
<li>竞价前 2 天可以激活竞价资格，设置竞价密码。</li>
<li>一般每月 25 日（遇节假日顺延至工作日）早上 9:00 ~ 15:00 直接进行报价竞拍，
11:00 和 13:00 两个整点会统计当时的均价，自行根据实际情况调整报价，每人有 2 次修改报价机会。</li>
<li>15:00 时统计出最终均价和底价等数据，可以查询自己是否中标。</li>
<li>竞拍到车牌的，下个工作日可以打印《杭州市小客车增量指标竞价收入缴款通知书》1 份，到\n\n杭州银行\n\n营业厅
缴款即可，缴款完成后，\n\n杭州银行\n\n会给一张《浙江省非税收统一票据》，放好，上牌要用。
\n 注：没有\n\n杭州银行卡\n\n的，只能使用现金缴款，另外银行 ATM 机取款好像有 2 万限额。
\n 注：通知书打印比较痛苦，提示要用 Windows 在 IE 并安装了专用浏览器控件后才能打印，
但是最终使用 A4 纸打印出来的尺寸很小，我最终采用了前端工程师特有技术解决了打印结果不完美的问题。</li>
<li>竞拍日后第 3 个工作日（一般 28 日）18:00 之后（可能会延迟数小时）就可以登录
<a href="https://xkctk.hzcb.gov.cn/" target="_blank" rel="noopener noreferrer">杭州市小客车总量调控管理信息系统</a> ，在底部有指标信息可以下载和打印。</li>
</ol>
<h2 id="缴税">缴税<a aria-hidden="true" href="#缴税">#</a></h2>
<ol>
<li>上牌前需要缴购置税（中国是双向收税制度，没办法）。<code>购置税额 = 车辆官方指导价 ÷ 1.17 × 10%</code></li>
<li>缴税地点在杭州汽车城 6 楼的税务大厅，我早上 9 点到那边，人不多，取号就被叫号了。
审核好资料后，拿回执单到缴费窗口刷卡即可，可以用信用卡。15 分钟就办好。</li>
</ol>
<p>所需材料：
\n 身份证原件、复印件。
\n 合格证原件、复印件。
\n 发票联、纳税联原件、复印件。
\n 打印的《个人指标证明文件》</p>
<h2 id="选车牌号">选车牌号<a aria-hidden="true" href="#选车牌号">#</a></h2>
<p>可以在网上查可选的号码，和家人朋友一起参谋选择意向车牌号码。</p>
<p>\n 《掌上车管》手机 App。游客模式 \n 车辆业务 \n 自主选号 \n 同意 \n 输入手机号 \n 点击“获取验证码” \n 可选车号查询。
\n <a href="https://zzxh.zjsgat.gov.cn:6081/zjwwzzxh/tscreenquery.do?act=shownumselectquerypage&amp;fzjg=%D5%E3A" target="_blank" rel="noopener noreferrer">机动车号牌自主查询系统</a></p>
<p>可以很方便的使用任意键查询可选号码，比如 <code>888\n\n</code>。</p>
<p>选好意向车牌后，还可以在上牌前一天选号车牌号码（有效期 3 天，不要太早选号）</p>
<p>\n 《掌上车管》手机 App。游客模式 \n 车辆业务 \n 自主选号 \n 同意 \n 输入手机号 \n 点击“获取验证码” \n 自主选号。
\n <a href="https://zzxh.zjsgat.gov.cn:6081/zjwwzzxh/" target="_blank" rel="noopener noreferrer">浙江省机动车号牌互联网自编自选系统</a> \n 同意 \n 手机号 \n 验证码 \n 确定 \n ...</p>
<h2 id="上牌">上牌<a aria-hidden="true" href="#上牌">#</a></h2>
<p>汽车城也可以办理上牌，但是我在网上看的三墩车管所办理流程，写的很到位，再加上办理临牌时我对这边相对熟悉，所以选择了三墩车管所。</p>
<ol>
<li>杭州市公安局交警支队车管所（三墩车管所，古墩路 699 号）东门是不让车进的，要从南边圣苑北街进去。</li>
</ol>
<p>门口很多代办的，一般要 100 元服务费（4S 店要 300 元比较黑），因为要本人在场，而且业务不是很复杂，
代办没有太多必要。</p>
<ol>
<li>开车进南门后往前，沿入口指示牌方向右转直走到底，再右转到底就到 2 号楼门口了，排队，车轮打正，下车，
看到有拿卡片机拍照的工作人员就找他帮你拍照（4S 店提供的照片不能用）。</li>
<li>去 2 好大厅拍照的几个窗口找给你牌照的工作人员拿照片和《机动车检查记录表》，把车架号拓印贴上，照片留着办理行驶证时要用。</li>
<li>拿到后排队并把车往前挪到车棚下，打开发动机仓，解锁车门。
\n 合格证原件
\n 机动车检查记录表</li>
<li>验车的交警是一批车来检验一次，所以要等等。验车交警出来验车时，一般根据车辆停的顺序从前往后验，
但国产车和进口车验车交警不同，所以交警可能直接跳过前面的进口车。</li>
<li>将《检查记录表》和车辆合格证原件交给验车交警，解开前后车门锁，方便验车。交警主要检查发动机仓、
副驾驶座底下看了半天不知道看什么，副驾驶座后面的座位底下也看了下，新车一般没什么问题。</li>
</ol>
<p>注：因为我的车轮毂被 4S 店刮坏了，多问了 4S 店的销售几句，说他们有个客户，因为车门撞了红色车漆花了，
产生了明显的不一致，被要求修车重新喷了新漆，所以未上牌期间开车尽量小心，避免给上牌带来麻烦。</p>
<ol>
<li>验车 OK 之后，交警会让你把车开走，开到停车场停好，然后回到 2 号楼 1 号窗口等拿回《检查记录表》。
如果业务办理人多的话，这期间可以把其他材料放到业务办理窗口排队，后面拿到《检查记录表》后再补充进去。
\n 《检查记录表》业务办理是必须的材料，所以如果刚验好车的话，建议放在前面有 5、6 个人的窗口排队。
\n 如果已经拿到了记录表，可以多看看不同的业务办理窗口，排队人数可能很不平均的。</li>
<li>材料齐全后开始正式业务办理，把工作人员要求的材料交给她就好了，剩下的事情都交她来处理。</li>
<li>正常来说，邻近办好业务时，工作人员会给你一个选号单，可以在 2 号大厅东侧的小隔间里的选号机上进行选号。
\n 因为我事先通过手机《掌上车管》App 选好了号码，因此这一步免了，工作人员口头跟我确认了车牌号，办理好之后给个回执单。
\n 另外掌上车管选号时可以选择在办理上牌的网点自取，或者邮寄。我想着过年了快递可能不给力，万一过年回家前没寄到就麻烦了，
所以选择了自取，但是工作人员告知自取要 10 个工作日后，邮寄则 3 个工作日内寄出。10 个工作日肯定来不及，因此修改为邮寄了，
将收件人姓名、手机号、收件地址写到身份证复印件背面空白处即可（可以提前写好）。</li>
<li>去大厅东侧的缴费窗口缴费，125 元上牌费再加 10 元的金黄色全国临牌费，总共 135 元。</li>
<li>在缴费窗口旁边的窗口等待发放行驶证、登记证书、临牌。</li>
<li>旁边的另一个窗口拿环保标志。</li>
<li>收工。</li>
</ol>
<h2 id="安装车牌">安装车牌<a aria-hidden="true" href="#安装车牌">#</a></h2>
<p>邮寄是 EMS 到付 10 元，市区内还是不慢的，上周五邻近中午办理好的，周一中午就收到邮寄的车牌了。
因为是防盗螺栓没装过，而且需要专用的螺丝刀，所以花 20 元请修车工作人员帮忙装好了。另外 4S 店也可以帮忙安装。
其实如果有专用螺丝刀，和安装普通螺丝没太多差别：</p>
<ol>
<li>将垫片和螺丝拧紧。</li>
<li>将螺帽用力摁进去即可。</li>
</ol>
<p>注：新的交通法规要求每块车牌安装四个螺丝，否则按照无牌判罚（12 分、扣车、罚款），
安装不是很麻烦，请人安装也不会因为这个多加钱，没必要把车管所寄给你的螺丝放那里备用。</p>
<h2 id="贴标">贴标<a aria-hidden="true" href="#贴标">#</a></h2>
<p>车辆合格标志、环保标志、交强险标志都是要贴到前挡风玻璃上的（一般贴在右上角位置）。
直接贴玻璃上后续换新标会比较难揭下来，一般 4S 店、保险公司、网购汽车用品的商家都会附送静电贴膜，
把车标粘在静电贴膜上，再把静电贴膜贴到车窗上会比较方便。</p>
<h2 id="贴膜">贴膜<a aria-hidden="true" href="#贴膜">#</a></h2>
<p>一般防晒防紫外线，但是不宜颜色过深，否则光线暗的地方看不清后视镜，有安全隐患。
同时，2004 年 10 月 1 日实施的国家标准《机动车运行安全技术条件》（GB7258—2004）第 11.6.4 条规定，
机动车驾驶室必须保证驾驶员前方视野和侧方视野，
前挡风窗玻璃及风窗以外玻璃用于驾驶员视区部位的可见光透射比不允许小于 70%，
所有车窗玻璃不允许张贴镜面反光遮阳膜。</p>
<p>据悉，车辆进行年检时，检测人员会对车辆驾驶室的“透光率”进行检测，
一般来说，在车辆两侧玻璃上张贴反光膜的车辆都不可能通过“透光率”这个标准。</p>
<h2 id="加油卡">加油卡<a aria-hidden="true" href="#加油卡">#</a></h2>
<p>大部分加油站的营业店里都可以办理加油卡，带好身份证原件和 15 元现金作为押金即可，办好后可以当场使用信用卡充值加油。</p>
<p>淘宝有折扣充值的，9.8 折看起来不多，但每加 1 箱汽油的钱，大约可以多加 1、2 升汽油，还是挺不错的了。
支付宝等网上充值也很方便。但是因为加油卡是芯片卡，网上充值后要去圈存下比较麻烦，不过很多加油站可以自助圈存。</p>
<p>有加油卡的用户，可以自助加油。自助加油要注意安全，静电、明火要小心。</p>
<h2 id="汽车用品">汽车用品<a aria-hidden="true" href="#汽车用品">#</a></h2>
<p>\n 盲区镜：贴在两侧后视镜上的小圆镜，我个人喜欢有万向节无边的。
\n 方向盘助力器：大角度打方向盘会非常顺利。
\n 手机支架：个人推荐夹在空调出风口、万向节、吸铁石的这种，小巧简洁实用。
\n 空气清新剂：香水不错，固态的也行。
\n 吸尘器：家用的即可，换个稍小的吸嘴。
\n 免清洗抹布：自己洗车、擦个雨水污渍什么的还是很有用的，比较容易清洗。
\n 后备箱或后排挂钩：挂些不能倒的东西很有用，买不到合适的也可以考虑自制。
\n 对讲机：2 辆车及其以上的车队，沟通起来会比较方便，没有信号的地方也不愁。
\n 陈皮糖、橙子、橘子、晕车贴：防晕车、防饿。</p>
<h2 id="其他">其他<a aria-hidden="true" href="#其他">#</a></h2>
<p>\n 汽车之家的《用车小百科》系列不错，可以挑些自己不了解的看看，像车灯语义、山路行车注意事项等。
\n 多看看交通事故视频，自己多想想什么场景应该注意什么，出现状况时应该如何正确应对等。
\n 放平心态，遇到不平用喇叭或车灯提示下就好了，不要太计较。
\n 不要犹豫，该快快、该慢慢；能通过毫不犹豫的快速通过，不能通过也要毫不犹豫的减速停下。</p>
<h2 id="灯语">灯语<a aria-hidden="true" href="#灯语">#</a></h2>
<p>\n 提示后车（大灯、车距等）：短暂雾灯，或危险警告灯（双跳灯）。
\n 提示前车（信号灯变化、注意压线行驶、并线等）：大灯闪两次。
\n 不可超车：左转向灯。
\n 可以超车：右转向灯。
\n 前方盲区：大灯闪一下，比如车库直角转弯处等。</p>
<h2 id="todo">TODO<a aria-hidden="true" href="#todo">#</a></h2>
<p>快没电了，后面抽空再补充附图。</p>
<h2 id="参考资料">参考资料<a aria-hidden="true" href="#参考资料">#</a></h2>
<p>\n <a href="https://www.19lou.com/forum%5Cn464848%5Cnthread%5Cn6561443007363713%5Cn1%5Cn1.html" target="_blank" rel="noopener noreferrer">https://www.19lou.com/forum\n464848\nthread\n6561443007363713\n1\n1.html</a>
\n <a href="https://www.19lou.com/forum%5Cn293%5Cnthread%5Cn19001324626574730%5Cn1%5Cn1.html" target="_blank" rel="noopener noreferrer">https://www.19lou.com/forum\n293\nthread\n19001324626574730\n1\n1.html</a>
\n <a href="https://wenda.haosou.com/q/1378221335061966" target="_blank" rel="noopener noreferrer">https://wenda.haosou.com/q/1378221335061966</a>
\n <a href="https://jingyan.baidu.com/article/454316ab575e72f7a7c03a91.html" target="_blank" rel="noopener noreferrer">https://jingyan.baidu.com/article/454316ab575e72f7a7c03a91.html</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[末尾的逗号]]></title>
            <link>https://hotoo.github.io/blog/post/trailing-commas</link>
            <guid>47</guid>
            <pubDate>Mon, 10 Aug 2015 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="末尾的逗号">末尾的逗号<a aria-hidden="true" href="#末尾的逗号">#</a></h1>
<p><img src="/images/blog/trailing%5Cncommas.png" alt="trailing commas"></img></p>
<p>早期的 JavaScript 运行环境大都不支持末尾多出来的逗号，或者会抛出异常，或者不符合期望。</p>
<p>比如：</p>
<pre><code>var obj = {
  a: 0, // 抛出异常。
};

var arr = [
  0, // arr.length === 2
];
</code></pre>
<p>由于不支持尾逗号，我们以前写代码都需要手动去除尾逗号（工具最多提示你这里多了个逗号）。
因此我们增加、删除一个属性、数组项时，总是需要担心相邻项的逗号问题。</p>
<p>比如增加一项：</p>
<p>\n 如果被增加项是列表的最后一项，则需要给前一项（原最后一项）添加一个逗号，但被添加项本身不添加逗号。
\n 新增一项本来并不需要修改前一项，但是在非尾逗号情况下则必须做这个无本质意义的修改。
\n 这很麻烦，也很容易导致错误。
\n 实际你只是增加了一项，但你在 diff 中会看到又是删除项，又是增加项。review 时你就需要关注这些无谓的变更。
\n 如果被添加项不是列表的最后一项，则被添加项要加上逗号。</p>
<pre><code> var obj = {
\n  a: 0
+  a: 0,
+  b: 1
 };

 var arr = [
\n  0
+  0,
+  1
 ];
</code></pre>
<p>删除一项也是：</p>
<p>\n 你本来只是要删除了最后一项，但你不得不修改前一项。麻烦，容易出问题。
\n 你本来只是删除了一项，但在 diff 中也是看到又是删除，又是增加。</p>
<pre><code> var obj = {
\n  a: 0,
\n  b: 1
+  a: 0
 };

 var arr = [
\n  0,
\n  1
+  0
 ];
</code></pre>
<p>值得高兴的是，现在的 JavaScript 运行环境、预编译工具、语法检查工具都支持了尾逗号。
一旦我们统一使用尾逗号风格：</p>
<p>\n 我们在增加或删除一项时，再也不需要关心相邻项了。
\n diff 看起来也更直观清爽。</p>
<p>新增一项：</p>
<pre><code> var obj = {
   a: 0,
+  b: 1,
 };

 var arr = [
   0,
+  1,
 ];
</code></pre>
<p>删除一项：</p>
<pre><code> var obj = {
   a: 0,
\n  b: 1,
 };

 var arr = [
   0,
\n  1,
 ];
</code></pre>
<p>另外也有些语言是不需要逗号的，每一项都不需要。比如 Markdown 的列表，yml，yaml，
xml，html 等。</p>
<p>全要逗号，或者全不要逗号，他们的共同点就是\n\n一致性\n\n。这种一致性让书写和阅读都非常简洁清晰。
可维护性也更好。</p>
<p>你觉得呢？</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[gitopen, Smart partner of git, hg and svn.]]></title>
            <link>https://hotoo.github.io/blog/post/gitopen</link>
            <guid>48</guid>
            <pubDate>Fri, 24 Jul 2015 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="gitopen-smart-partner-of-git-hg-and-svn">gitopen, Smart partner of git, hg and svn.<a aria-hidden="true" href="#gitopen-smart-partner-of-git-hg-and-svn">#</a></h1>
<p>使用 Git 的你，想必会更喜欢在终端（命令行）中使用 Git。在终端中，可以将 Git
的特性发挥的淋漓尽致。</p>
<pre><code>\n git co \nb feat\nsample
\n git add .
\n git ci \nm &quot;feat(sample): Add sample commit.&quot;
\n git push origin feat\nsample
</code></pre>
<p>咦，我想立即提交一个 Pull/Merge Request 怎么办，还要打开浏览器，输入 Git
仓库的 URL 地址，点击进入 PR 列表，再点击新建 PR，选择 feat\nsample 分支，
点击确认按钮，balabala...</p>
<p>嗯，好麻烦。</p>
<p>于是 Git 的最佳伴侣 <a href="https://github.com/hotoo/gitopen" target="_blank" rel="noopener noreferrer">gitopen</a> 横空出世了。</p>
<p>push 了新分支，想立即提交 PR/MR，So simple.</p>
<pre><code>\n gitopen pr
</code></pre>
<p>她会把当前分支提交一个新的 PR。</p>
<p>如果你是使用的 GitHub，在发布了新版时可能还想写个 Release Note：</p>
<pre><code>\n git tag 1.0.0
\n git push origin 1.0.0
\n gitopen release new 1.0.0
</code></pre>
<p>咦，有个新的想法，提交个 Issue 先：</p>
<pre><code>\n gitopen issue 我有个好想法
</code></pre>
<p>再来个 milestone 尝尝：</p>
<pre><code>\n gitopen milestone
</code></pre>
<p>这货支持：</p>
<p>\n git, hg, svn.
\n Mac OS X, Linux, Windows.
\n GitHub (Enterprise), GitLab (CE, EE), BitBucket (Atlassian Stash), GitCafe (Enterprise) ...</p>
<p>更多功能参考：</p>
<pre><code>\n npm install gitopen \ng
\n gitopen @hotoo/gitopen
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[git+, a hack of git, smart for you.]]></title>
            <link>https://hotoo.github.io/blog/post/gitplus</link>
            <guid>50</guid>
            <pubDate>Wed, 27 May 2015 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="git-a-hack-of-git-smart-for-you">git+, a hack of git, smart for you.<a aria-hidden="true" href="#git-a-hack-of-git-smart-for-you">#</a></h1>
<p>为了信息安全，公司搭建了 gitlab.company.com 管理代码，同时限制了必须使用工作邮箱
<a href="mailto:hotoo@company.com">hotoo@company.com</a> 进行提交。</p>
<p>公司 gitlab 有大大小小很多仓库，不时的需要 clone 代码下来，有时忘记设置就开始提交，
提交了几次开始 push 到 gitlab 并准备提交 MR 时发现，push 被拒绝，或者 MR 无法
自动合并，因为没有使用公司的邮箱进行提交。只好取消之前的提交操作，修改邮箱配置
之后重新提交。</p>
<p>虽然 clone 下来配置一次就可以了，但是每个仓库都需要配置，每次 clone 都需要配置，
忘记设置了需要取消之前的提交并再来一次。</p>
<p>有没有办法自动进行配置呢？</p>
<p>于是 <a href="https://github.com/hotoo/gitplus" target="_blank" rel="noopener noreferrer">gitplus</a> 出现了，它可以根据 git
的子操作命令，及其所在的仓库信息，自动的执行指定命令，帮助你完成一些自动化任务。
例如：</p>
<pre><code>post\nclone:
  gitlab.company.com:
    \n git config user.name hotoo
    \n git config user.email hotoo@company.com
pre\ncommit:
  &#39;\n&#39;:
    \n jshint .
</code></pre>
<p>\n 有了 gitplus，你再也不会忘记设置公司邮箱。因此也不需要取消提交再重复提交了。
\n 还可以在提交前自动做校验工作。没有 gitplus 之前你只能给每个仓库设置 pre\ncommit hooks。
\n 你也可以发挥自己的想象力，做更多其他的事情。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[集团开源星人奖和 IKBC POKER II 机械键盘]]></title>
            <link>https://hotoo.github.io/blog/post/ikbc-poker-ii</link>
            <guid>51</guid>
            <pubDate>Wed, 27 May 2015 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="集团开源星人奖和-ikbc-poker-ii-机械键盘">集团开源星人奖和 IKBC POKER II 机械键盘<a aria-hidden="true" href="#集团开源星人奖和-ikbc-poker-ii-机械键盘">#</a></h1>
<p>很幸运获得了集团开源星人奖：最活跃个人奖，奖品是 IKBC POKER II 机械键盘，同时
还有一件 Tee。</p>
<p>获得这个奖，主要得益于前端天然的开源</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[或者说『耗时包含了 Blocking 部分的时间』]]></title>
            <link>https://hotoo.github.io/blog/post/serious-confusion-with-resource-timing</link>
            <guid>52</guid>
            <pubDate>Tue, 30 Dec 2014 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="译严重混乱的-resource-timing">译：严重混乱的 Resource Timing<a aria-hidden="true" href="#译严重混乱的-resource-timing">#</a></h1>
<h1 id="或者说耗时包含了-blocking-部分的时间">或者说『耗时包含了 Blocking 部分的时间』<a aria-hidden="true" href="#或者说耗时包含了-blocking-部分的时间">#</a></h1>
<p>用 <a href="https://www.w3.org/TR/resource%5Cntiming/" target="_blank" rel="noopener noreferrer">Resource Timing</a> 来同统计资源下载性能
是非常赞的方式，但不幸的是，几乎所有和我聊过的人都是使用 <a href="https://www.w3.org/TR/resource%5Cntiming/#duration%5Cnattribute" target="_blank" rel="noopener noreferrer"><code>duration</code> 属性</a>，
而且他们都没有意识到 <code>duration</code> 包含了 blocking 时间。结果 <code>duration</code> 时间
比实际的下载时间要长很多，超出了开发者意料之外的结果。这个问题在跨域资源中
尤为糟糕，<code>duration</code> 是唯一可用的。在这篇博文中我将解释这个问题，并提出解决方案。</p>
<h2 id="resource-timing-回顾">Resource Timing 回顾<a aria-hidden="true" href="#resource-timing-回顾">#</a></h2>
<p><a href="https://www.w3.org/TR/resource%5Cntiming/" target="_blank" rel="noopener noreferrer">Resource Timing 规范</a> 定义了收集网页中
所有资源耗时统计的 API。现在可用于 Chrome, Chrome for Android, IE 10\n11, 和 Opera。
可以通过 <code>getEntries()</code>, <code>getEntriesByType()</code> 和 <code>getEntriesByName()</code> 得到一个
<code>PerformanceEntry</code> 列表，一个 <code>PerformanceEntry</code> 对象包含以下属性：</p>
<p>\n <code>name</code> – URL 地址
\n <code>entryType</code> – 通常是 “resource”
\n <code>startTime</code> – 开始处理这个资源的时间（相对开始导航到页面时的毫秒数）
\n <code>duration</code> – 处理这个资源的总耗时（毫秒）</p>
<p>上面的属性在所有的资源中都可用，包括同域和跨域的。而同域的资源拥有另外一些可以
访问的附加属性，这些属性定义在 <code>PerformanceResourceTiming</code> 接口中。这些属性名称
很简洁清晰，完全可以见名思意，并且以时间顺序排序：</p>
<p>\n redirectStart
\n redirectEnd
\n fetchStart
\n domainLookupStart
\n domainLookupEnd
\n connectStart
\n connectEnd
\n secureConnectionStart
\n requestStart
\n responseStart
\n responseEnd</p>
<p>这里有个权威的 <a href="https://www.w3.org/TR/resource%5Cntiming/#processing%5Cnmodel" target="_blank" rel="noopener noreferrer">处理模型(processing model)</a> 图
显示了这些属性所在的各个不同阶段。备注：<code>duration</code> 相当于 <code>responseEnd \n startTime</code>。</p>
<p><img src="https://www.w3.org/TR/resource%5Cntiming/resource%5Cntiming%5Cnoverview.png" alt="processing model graphic"></img></p>
<p>如何使用 Resource Timing 的详细信息，可以参考我的文章 <a href="https://www.stevesouders.com/blog/2014/08/21/resource%5Cntiming%5Cnpractical%5Cntips/" target="_blank" rel="noopener noreferrer">Resource Timing Practical Tips</a> 『<a href="./resource%5Cntiming%5Cnpractical%5Cntips">译者的中文翻译</a>』</p>
<h2 id="duration-中出乎意外的-blocking-膨胀"><code>duration</code> 中出乎意外的 blocking 膨胀<a aria-hidden="true" href="#duration-中出乎意外的-blocking-膨胀">#</a></h2>
<p>出于隐私的考虑，同源资源的 PerformanceResourceTiming 属性是受限的。（备注：
任何资源可以通过 <code>Timing\nAllow\nOrigin</code> 响应头达到“同源”效果。）现在大约有一半
的资源是跨域的，因此 <code>duration</code> 是度量加载时间的唯一方式。而且即使是同源资源，
<code>duration</code> 也是唯一以增量方式提供的属性，大概是因为它度量了最重要的阶段。
这样一来，所有我见过的 Resource Timing 实现都以 <code>duration</code> 做为主要的性能指标。</p>
<p>不幸的是，<code>duration</code> 比下载时间要大，它包含了阻塞时间（blocking time）—— 浏览器
意识到需要下载一个资源，到这个资源实际被下载直接的时间延迟。阻塞会在几种情况时
发生，最典型的资源数量比 TCP 连接数要多的情况。大多数浏览器为每个主机开放了 6
个 TCP 连接，IE10（8个连接）和 IE11（12个连接）例外。</p>
<p>这个 <a href="https://stevesouders.com/tests/rt%5Cnblocking.php" target="_blank" rel="noopener noreferrer">Resource Timing 阻塞测试页面</a>
有 16 个图片，因此无论哪个浏览器都会阻塞一部分图片。每个图片被编程为在服务器
有 1 秒的延迟，这 16 个图片，每个图片都显示了 <code>startTime</code> 和 <code>duration</code>。
另外还有这个测试页面在 WebPagetest 中通过 <a href="https://www.webpagetest.org/result/141125%5Cn4T%5Cn11FT/" target="_blank" rel="noopener noreferrer">Chrome</a>,
<a href="https://www.webpagetest.org/result/141125%5CnBN%5Cn11FY/" target="_blank" rel="noopener noreferrer">IE10</a> 和
<a href="https://www.webpagetest.org/result/141125%5Cn5K%5Cn11CB/" target="_blank" rel="noopener noreferrer">IE11</a> 加载的测试结果，
可以通过查看截屏来分析时序结果。注，为什么所有的图片的 <code>startTime</code> 大致都相同？
英文这个时间是浏览器解析 IMG 标签并意识到需要下载改资源的时间，由于先下载的图片
阻塞的原因，但在页面出现后，图片的 <code>duration</code> 值大约步进 1 秒左右。</p>
<h2 id="译者补充">译者补充<a aria-hidden="true" href="#译者补充">#</a></h2>
<p>\n <a href="https://www.stevesouders.com/blog/2014/11/25/serious%5Cnconfusion%5Cnwith%5Cnresource%5Cntiming/" target="_blank" rel="noopener noreferrer">SERIOUS CONFUSION with Resource Timing</a> \n 原文出处。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[译：Resource Timing (资源计时) 使用技巧]]></title>
            <link>https://hotoo.github.io/blog/post/resource-timing-practical-tips</link>
            <guid>53</guid>
            <pubDate>Tue, 30 Dec 2014 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="译resource-timing-资源计时-使用技巧">译：Resource Timing (资源计时) 使用技巧<a aria-hidden="true" href="#译resource-timing-资源计时-使用技巧">#</a></h1>
<p><a href="https://www.w3.org/2010/webperf/" target="_blank" rel="noopener noreferrer">W3C Web 性能工作组</a> 在 2012 年给我们带来了
<a href="https://www.w3.org/TR/navigation%5Cntiming/" target="_blank" rel="noopener noreferrer">Navigation Timing</a>，这个 API 现在
基本上在主流浏览器上都可用。Navigation Timing 定义了一套用于测量主页面性能的
JavaScript API。例如：</p>
<pre><code>// Navigation Timing
var t = performance.timing,
    pageloadtime = t.loadEventStart \n t.navigationStart,
    dns = t.domainLookupEnd \n t.domainLookupStart,
    tcp = t.connectEnd \n t.connectStart,
    ttfb = t.responseStart \n t.navigationStart;
</code></pre>
<p>能够度量主页面的时间消耗真是太棒了，但是要诊断现实当中的性能问题，往往需要深入
到各个资源当中。所以我们拥有了更进一步的 Resource Timing （资源计时）规范，
这个 JavaScript API 提供类似 Navigation Timing 的功能，但是能精确到每一个资源的
耗时。举个例子：</p>
<pre><code>// Resource Timing
var r0 = performance.getEntriesByType(&quot;resource&quot;)[0],
    loadtime = r0.duration,
    dns = r0.domainLookupEnd \n r0.domainLookupStart,
    tcp = r0.connectEnd \n r0.connectStart,
    ttfb = r0.responseStart \n r0.startTime;
</code></pre>
<p>到目前为止，Chrome, Chrome for Android, Opera, IE10 和 IE11
浏览器都支持 Resource Timing，这也许超过了你的网站 50% 的流量。
这应该可以提供足够的数据，来揭示这些资源缓慢的原因。</p>
<p>使用 Resource Timing 看似很简单，但是当我在写第一个用于生产环境的 Resource Timing 代码
时，遇到了许多问题。这里我想分享一些现实当中记录 Resource Timing 指标的实用技巧。</p>
<h2 id="1-使用-getentriesbytyperesource-而不是-getentries">1. 使用 <code>getEntriesByType(&quot;resource&quot;)</code> 而不是 <code>getEntries()</code><a aria-hidden="true" href="#1-使用-getentriesbytyperesource-而不是-getentries">#</a></h2>
<p>在使用 Resource Timing 来获取当前页面的资源集合的资源耗时性能对象时，许多 Resource
Timing 示例都是使用 <code>performance.getEntries()</code>，这意味着唯一的 resource timing 对象
由该调用进行返回。但是 <code>getEntries()</code> 会一并返回潜在的 <a href="https://www.w3.org/wiki/Web%5CnPerformance/EntryType" target="_blank" rel="noopener noreferrer">4 种类型的 timing 对象</a>：
<code>resource</code>（资源），<code>navigation</code> （导航）, <code>mark</code> （标记）, 和 <code>measure</code> （测量）。</p>
<p>这并没有造成多大问题，因为目前 <code>resource</code> 是大多数网页的唯一类型。
<code>navigation</code> 类型是 <a href="https://www.w3.org/TR/navigation%5Cntiming%5Cn2/" target="_blank" rel="noopener noreferrer">Navigation Timing 2</a> 的一部分，据我所知目前没有被任何浏览器所实现。
<code>mark</code> 和 <code>measure</code> 类型是从 <a href="https://www.w3.org/TR/user%5Cntiming/" target="_blank" rel="noopener noreferrer">User Timing</a> 规范衍生出来的，在部分浏览器中可用，
但是还没有被广泛使用。</p>
<p>也就是说，<code>getEntriesByType(&quot;resource&quot;)</code> 以及 <code>getEntries()</code> 在今天可能返回相同
的结果，但是可能 <code>getEntries()</code> 将很快返回多种性能对象的混合集合，所以最好是
使用 <code>performance.getEntriesByType(&quot;resource&quot;)</code>，你可以明确的只获取 resource
timing 对象。（感谢 <a href="https://calendar.perfplanet.com/2012/an%5Cnintroduction%5Cnto%5Cnthe%5Cnresource%5Cntiming%5Cnapi/" target="_blank" rel="noopener noreferrer">Andy Davies</a> 给我解释这一点）</p>
<h2 id="2-使用-navigation-timing-测量主页面的请求">2. 使用 Navigation Timing 测量主页面的请求。<a aria-hidden="true" href="#2-使用-navigation-timing-测量主页面的请求">#</a></h2>
<p>当通过典型的请求获取一个网页的主 HTML 文档，但是这个资源并不能通过
<code>performance.getEntriesByType(&quot;resource&quot;)</code> 得到返回，要得到这个主页面 HTML 文档
的 timing 信息，需要使用 Navigation Timing 对象（<code>performance.timing</code>）。</p>
<p>虽然不太可能，当页面上没有其他资源时，这可能会导致错误发生。
例如，刚才 Resource Timing 示例使用如下代码：</p>
<pre><code>performance.getEntriesByType(&quot;resource&quot;)[0]
</code></pre>
<p>如果一个页面唯一的资源就是主页面的 HTML 文档，然后 <code>getEntriesByType(&quot;resource&quot;)</code>
返回一个空数组，这时候应用 <code>element[0]</code> 会引起 JavaScript 异常。如果你找不到
没有引用子资源的页面，你可以试试 <a href="https://fast.stevesouders.com/" target="_blank" rel="noopener noreferrer">https://fast.stevesouders.com/</a></p>
<h2 id="3-小心-secureconnectionstart-的问题">3. 小心 <code>secureConnectionStart</code> 的问题。<a aria-hidden="true" href="#3-小心-secureconnectionstart-的问题">#</a></h2>
<p><a href="https://www.w3.org/TR/resource%5Cntiming/#dom%5Cnperformanceresourcetiming%5Cnsecureconnectionstart" target="_blank" rel="noopener noreferrer"><code>secureConnectionStart</code></a>
属性我们衡量 SSL 协商需要多长时间。这非常重要，我经常
看到 500 毫秒以上的 SSL 协商时间，甚至更多。<code>secureConnectionStart</code> 有 3 种
可能的值：</p>
<p>\n 如果该属性不可用，则必须设置为 <code>undefined</code>。
\n 如果不使用 HTTPS 的，则必须设置为 0.
\n 如果该属性可用，并且使用了 HTTPS，则必须设置为一个时间戳。</p>
<p>关于 <code>secureConnectionStart</code>，有三件事情需要了解下：</p>
<p>首先，在 Internet Explorer 中，<code>secureConnectionStart</code> 的值总是 <code>undefined</code>，
因为它是不可用的（该值被埋在 [WinINet](<a href="https://msdn.microsoft.com/en%5Cnus/library/windows/desktop/aa383630(v=vs.85%5C).aspx" target="_blank" rel="noopener noreferrer">https://msdn.microsoft.com/en\nus/library/windows/desktop/aa383630(v=vs.85\).aspx</a>) 之下）。</p>
<p>其次，在 Chrome 中有个 BUG 会导致 <code>secureConnectionStart</code> 被错误的设置为 0 的问题。
如果获取一个资源时使用预先存在的 HTTPS 连接，则 <code>secureConnectionStart</code> 将被设置
为 0，而实际上它应该是一个时间戳。（详情请参考 <a href="https://code.google.com/p/chromium/issues/detail?id=404501" target="_blank" rel="noopener noreferrer">bug 404501</a> ）
为了避免这个问题，测量 SSL 协商时间时，一定要检查 <code>secureConnectionStart</code> 既不是
<code>undefined</code> 也不是 <code>0</code>：</p>
<pre><code>var r0 = performance.getEntriesByType(&quot;resource&quot;)[0];
if ( r0.secureConnectionStart ) {
    var ssl = r0.connectEnd \n r0.secureConnectionStart;
}
</code></pre>
<p>第三，规范中关于 <a href="https://www.w3.org/TR/resource%5Cntiming/#dom%5Cnperformanceresourcetiming%5Cnsecureconnectionstart" target="_blank" rel="noopener noreferrer">这一行</a>
有一些误导：“...如果当前页面的协议是 HTTPS，这个属性必须立即返回用户代理(user agent)开始握手过程的时间...”
（我的重点）。有可能当前页面是 HTTP，但仍然包含我们需要测量 SSL 协商时间的 HTTPS 资源。
规范应该改为：“...如果资源的协议是 HTTPS 协议，该属性必须立即返回用户代理开始握手过程的时间...”。
幸运的是，浏览器是使用纠正后的行为，而已就是说， <code>secureConnectionStart</code> 可用于
HTTP 页面中的 HTTPS 资源。</p>
<h2 id="4-给跨域资源添加-timingnallownorigin-http-响应头">4. 给跨域资源添加 <code>Timing\nAllow\nOrigin</code> HTTP 响应头<a aria-hidden="true" href="#4-给跨域资源添加-timingnallownorigin-http-响应头">#</a></h2>
<p>出于隐私保护的原因，在获得资源的 Resource Timing 详情时有<a href="https://www.w3.org/TR/resource%5Cntiming/#cross%5Cnorigin%5Cnresources" target="_blank" rel="noopener noreferrer">跨域限制</a>。
默认情况下，与主页面不同域的资源，下列属性被设置为 0：</p>
<p>\n redirectStart
\n redirectEnd
\n domainLookupStart
\n domainLookupEnd
\n connectStart
\n connectEnd
\n secureConnectionStart
\n requestStart
\n responseStart</p>
<p>在某些情况下，仍然希望测量跨域资源的性能，例如，当网站使用不用域名的 CDN（例如
"youtube.com" 使用 "s.ytimg.com"），以及某些第三方资源（例如 "ajax.googleapis.com"）。
如果资源返回 <a href="https://www.w3.org/TR/resource%5Cntiming/#timing%5Cnallow%5Cnorigin" target="_blank" rel="noopener noreferrer">Timing\nAllow\nOrigin</a>
响应头，跨域资源的 timing 详情将被授权访问。这个头信息指定了被允许访问 timing
详情的（主页面）来源列表，多数情况下，会使用通配符(<code>\n</code>) 允许所有来源访问。
举个例子，<a href="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" target="_blank" rel="noopener noreferrer">https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</a> 返回
的 Timing\nAllow\nOrigin 响应头信息是：</p>
<pre><code>Timing\nAllow\nOrigin: \n
</code></pre>
<p>当第三方添加这个响应头信息时，真是太棒了。它允许站长来统计在他们网页上使用的
第三方资源的性能。感谢 <a href="https://googledevelopers.blogspot.com/2013/12/measuring%5Cnnetwork%5Cnperformance%5Cnwith.html" target="_blank" rel="noopener noreferrer">Ilya Grigorik</a>
报告了一些添加了这个响应头的第三方资讯，下面是一些指定了 <code>Timing\nAllow\nOrigin: \n</code>
的资源例子：</p>
<p>\n Google Hosted Libraries: <a href="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" target="_blank" rel="noopener noreferrer">https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</a>
\n Google+ widgets: <a href="https://apis.google.com/js/plusone.js" target="_blank" rel="noopener noreferrer">https://apis.google.com/js/plusone.js</a>
\n Google Fonts:  <a href="https://fonts.gstatic.com/s/opensans/v9/DXI%5Bsnip...%5DN3Vs.woff2" target="_blank" rel="noopener noreferrer">https://fonts.gstatic.com/s/opensans/v9/DXI[snip...]N3Vs.woff2</a>
\n Facebook widgets: <a href="https://connect.facebook.net/en%5CnUS/all.js" target="_blank" rel="noopener noreferrer">https://connect.facebook.net/en\nUS/all.js</a>
\n Disqus widgets: <a href="https://go.disqus.com/embed.js" target="_blank" rel="noopener noreferrer">https://go.disqus.com/embed.js</a></p>
<p>当需要访问有限制的 timing 属性时，决定统计 Resource Timing 是非常重要的。
可以通过检测（上面列出的，secureConnectionStart 除外）限制性属性是否为 0 的方式
来避免限制性问题，我总是使用 <code>requestStart</code>。下面是用于在计算详细的性能指标之前，
检测和计算限制性属性是否可用的代码片段：</p>
<pre><code>// Resource Timing
var r0 = performance.getEntriesByType(&quot;resource&quot;)[0],
    loadtime = r0.duration;
if ( r0.requestStart ) {
    var dns = r0.domainLookupEnd \n r0.domainLookupStart,
        tcp = r0.connectEnd \n r0.connectStart,
        ttfb = r0.responseStart \n r0.startTime;
}
if ( r0.secureConnectionStart ) {
    var ssl = r0.connectEnd \n r0.secureConnectionStart;
}
</code></pre>
<p>做这些检测是非常重要的，否则，当访问这些受限属性时，你不会得到任何异常，除了
这些虚假的数据。当属性受限访问时，它们的值被设置为 0，例如 <code>domainLookupEnd \n domainLookupStart</code>
翻译成 <code>0 \n 0</code>，它返回一个似是而非的结果 <code>0</code>，而这可能并不是真实 DNS 查询时间。
这将导致过多的指标为 <code>0</code> 而让你过于乐观。</p>
<h2 id="5-理解-0-意味着什么">5. 理解 0 意味着什么。<a aria-hidden="true" href="#5-理解-0-意味着什么">#</a></h2>
<p>在第 4 节当中提到，一些因为跨域导致的受限访问的 Resource Timing 属性会被设置为
0。再强调一次，在访问属性详情之前，要检查属性状态是非常重要的。
但是即使受限属性都是可访问的，度量计算的返回结果也有可能是 0，所以理解这意味着
什么非常重要。</p>
<p>例如，（假设没有访问限制）<code>domainLookupStart</code> 和 <code>domainLookupEnd</code> 的值是两个
时间戳，这两个值之差是该资源在 DNS 解析上耗时。通常情况下，一个页面中指定的域名
只有一个非 0 的 DNS 解析耗时，因为浏览器会缓存 DNS 解析，所有后续的请求都使用
这个缓存的 DNS 解析。而且由于跨页面的 DNS 解析缓存，一个页面所有的 DNS 解析
计算结果可能都是 0。关键点：DNS 解析耗时为 0 意味着资源是从缓存中读取的。</p>
<p>同样，对于指定的主机名，如果重复利用已存在的 TCP 连接，那么建立 TCP 连接（<code>connectEnd \n connectStart</code>）
的耗时也会是 0。每个主机有大约 6 个独立的 TCP 连接，这表明应该有 6 个非 0 的
TCP 连接测量值，但是这个主机后续的请求将使用已存在的 TCP 连接，并且他们的
TCP 连接耗时为 0。关键点：TCP 连接耗时为 0 意味着重复使用了已存在的 TCP 连接。</p>
<p>这同样适用于计算 SSL 协商（<code>connectEnd \n secureConnectionStart</code>）。这个可能
有 6 个以上的资源，但是同一主机名的所有的后续请求可能都使用同一个已存在的 HTTPS
连接，以至于它的 SSL 协商时间为 0。</p>
<p>最后，如果属性持续的为 0，这可能意味资源是从缓存中读取的。</p>
<h2 id="6-确定-304-是否被测量">6. 确定 304 是否被测量。<a aria-hidden="true" href="#6-确定-304-是否被测量">#</a></h2>
<p>这是另一个 Chrome 稳定版（版本号 36）的 BUG，这个 BUG 在 37 版时被修复。
这个问题已经被修复了，但是由于大多数用户还是使用 Chrome 稳定版，你当前的性能
指标可能跟实际上的并不相同。这个 BUG 是：一个拥有 Timing\nAllow\nOrigin 的跨域
页面，200 响应状态并不会考虑 304 响应状态，因此，304 响应下所有的受限属性都
将显示为 0，例如 <a href="https://stevesouders.com/tests/tao.php" target="_blank" rel="noopener noreferrer">这个测试页面</a>。</p>
<p>这是不应该发生的，因为从 200 响应的缓存中读取的 Timing\nAllow\nOrigin 头信息
应该应用到 304 响应中。在 Internet Explorer 浏览器中就是这样。（可以在 IE 10
或者 11 中尝试 <a href="https://stevesouders.com/tests/tao.php" target="_blank" rel="noopener noreferrer">这个页面</a> 来确认。）
（感谢 <a href="https://twitter.com/ericlaw" target="_blank" rel="noopener noreferrer">Eric Lawrence</a> 指出这一点。）</p>
<p>这会影响你的 Chrome Resource Timing 结果如下：</p>
<p>\n 如果（如第 4 节所述）使用检查 0 值的方式来判断受限字段，则会跳过测量 304 响应，
也就是说值测量了 200 状态响应，但是由于 200 状态响应比 304 要慢，所以 Resource
Timing 测量总量会比实际的要大。
\n 反之如果不检查受限字段为 0 的情况，会得到许多的 0 值记录，
这实际上又比 304 响应要快，这样 Resource Timing 统计结果又会过于乐观。</p>
<p>没有简单的方式来避免这些偏见，但是好消息是这个 BUG 被修复了。另外还可以尝试做的
事情是，304 响应头中发送 Timing\nAllow\nOrigin 头，不幸的是，流行的 Apache Web
服务器不支持在 304 响应头中发送这个头信息（查看 <a href="https://issues.apache.org/bugzilla/show%5Cnbug.cgi?id=51223" target="_blank" rel="noopener noreferrer">BUG 51223</a>）。
缺乏进一步证件证明第 4 节提到那些第三方资源的 304 响应头中的 Timing\nAllow\nOrigin
可以被找到。如前所述，这些第三方资源在 200 响应头中返回 Timing\nAllow\nOrigin 头，
但是 304 响应头中不返回 Timing\nAllow\nOrigin 头，这真是太好了。
到 Chrome 37 成为稳定版之前，因为缺少了受限属性的细节，Resource Timing 测量结果
可能偏高或偏低。幸运的是，时间会改变一切。</p>
<h2 id="7-看看-boomerang回旋镖">7. 看看 Boomerang（回旋镖）.<a aria-hidden="true" href="#7-看看-boomerang回旋镖">#</a></h2>
<p>如果你准备写自己 Resource Timing 代码，建议你最好看看 <a href="https://www.lognormal.com/boomerang/doc/api/restiming.html" target="_blank" rel="noopener noreferrer">Resource Timing 插件 Boomerang</a>。
（代码在 <a href="https://github.com/lognormal/boomerang/blob/master/plugins/restiming.js" target="_blank" rel="noopener noreferrer">GitHub</a> 上。）
Boomerang 是 Philip Tellis 维护的一个非常流行的开源 RUM 包。他起初在 Yahoo 工作
的时候就开源了 Boomerang，而现在作为在 SOASTA 工作的商业版的一部分（mPulse），
他仍然在持续的提供维护和增强。t它的代码很清晰、简洁和健壮，并解决了上面提到的许多问题。</p>
<p>总之，Navigation Timing 和 Resource Timing 都是非常优秀的新规范，为站长了解他们
的页面性能提供了很好的支持。Resource Timing 是这两个规范中更新的一个规范，因此
还是会有一些问题待解决。这些小提示将帮助你充分的利用 Resource Timing 指标。
我建议你现在就开始监控这些指标，以理解你的网站性能，为了最关心这个问题的真实用户。</p>
<blockquote>
<p>更新：有一些第三方资源提供了 Timing\nAllow\nOrigin 响应头，以允许站长测量这些
第三方资源的性能：</p>
<p>\n Boomerang: <a href="https://c.go%5Cnmpulse.net/boomerang/CEN%5Bsnip...%5DYQE" target="_blank" rel="noopener noreferrer">https://c.go\nmpulse.net/boomerang/CEN[snip...]YQE</a>
\n Typekit: <a href="https://use.typekit.net/previewkits/pk%5Cnv1.js" target="_blank" rel="noopener noreferrer">https://use.typekit.net/previewkits/pk\nv1.js</a></p>
</blockquote>

<blockquote>
<p>更新：<code>getEntriesByType(&quot;resource&quot;)</code> 和 <code>getEntries()</code> 不包含 iframe 页面的性能，
如果 iframe 是同源的，可以在父页面通过 <code>contentWindow.performance</code> 对象访问
这些指标。</p>
</blockquote>
<h2 id="译者补充">译者补充<a aria-hidden="true" href="#译者补充">#</a></h2>
<p>\n <a href="https://www.stevesouders.com/blog/2014/08/21/resource%5Cntiming%5Cnpractical%5Cntips/" target="_blank" rel="noopener noreferrer">Resource Timing practical tips</a> \n 原文出处。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[GitHub, GitLab, or BitBucket?]]></title>
            <link>https://hotoo.github.io/blog/post/github-gitlab-or-bitbucket</link>
            <guid>55</guid>
            <pubDate>Sun, 03 Aug 2014 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="github-gitlab-or-bitbucket">GitHub, GitLab, or BitBucket?<a aria-hidden="true" href="#github-gitlab-or-bitbucket">#</a></h1>
<blockquote>
<p>GitHub 是汇集了众多开源项目的闭源系统，</p>
<p>GitLab 是汇聚了较多闭源项目的开源系统。</p>
<p>\n\n <a href="https://twitter.com/hotoo/status/417483811212238848" target="_blank" rel="noopener noreferrer">@hotoo</a></p>
</blockquote>
<p>对于个人开发者，不可避免的会有私有项目的需求。</p>
<p>目前比较靠谱的私有项目托管服务有：</p>
<p>\n GitHub
\n GitLab
\n BitBucket</p>
<p>下面我们稍做评比。</p>
<h2 id="github">GitHub<a aria-hidden="true" href="#github">#</a></h2>
<p>GitHub 当下大红大紫，主要在于其社交性质。</p>
<p>对于开源项目来说，上面大量的开发者参与带来了非常活跃的开发氛围。</p>
<p>但是对于私有仓库来说，个人觉得价格偏贵（屌丝气质暴露）。</p>
<p>而且个人账户下的私有仓库，不能共享给个人所拥有的团队账户，因此如果团队账户需要
私有仓库，则需要另外再为团队账户购买。</p>
<p>如果不缺钱，可以考虑 GitHub，甚至还有 Enterprise 版本。</p>
<h2 id="gitlab">GitLab<a aria-hidden="true" href="#gitlab">#</a></h2>
<p>GitLab 是当下最火的 Git 仓库管理的开源项目，有提供的 <a href="https://gitlab.com/" target="_blank" rel="noopener noreferrer">gitlab.com</a>
服务，同时可以自行部署。</p>
<p>gitlab.com 服务可以创建不限数量的私有仓库，除了少量的缺点外，GitLab 几乎可以
媲美 GitHub。</p>
<p>但是，作为完美主义者，真的受不了 GitLab 的一些小伤疤。</p>
<h2 id="bitbucket">BitBucket<a aria-hidden="true" href="#bitbucket">#</a></h2>
<p>BitBucket 是 <a href="https://www.atlassian.com/" target="_blank" rel="noopener noreferrer">Atlassian</a> 公司的产品
（还有 Confluence，JIRA， HipChat 等著名产品）。</p>
<p>个人觉得除了 Issues 不够简洁之外，其他都很完美。
适合小团队私有项目托管。</p>
<h2 id="对比">对比<a aria-hidden="true" href="#对比">#</a></h2>
<p>|            | GitHub                                   | GitLab                                                 | BitBucket                   |
|\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
| 私有仓库   | 收费教育身份赞助 2年的 Micro Plan   | 免费，无限制                                           | 免费，限制协作人数          |
| 权限控制   | 个人账户无控制团队账户有限控制      | 仓库级控制指定一个保护分支                        | 分支级控制                  |
| Transfer   | 完美                                     | 几乎完美                                               | 完美                        |
| 仓库重命名 | 完美                                     | 不能修改 clone 地址                                    | 完美                        |
| 仓库名     | 完美                                     | 不能使用 <code>.</code>，自动修改为 <code>\n</code>                           | 完美                        |
| Issues     | 完美                                     | 功能复杂，但界面简洁早期有 Issues ID 缺陷，已修复 | 功能复杂，界面不够简洁      |
| Issues URL | 完美                                     | 完美                                                   | 默认附加可选的标题信息      |
| Pages      | username.github.io 仓库gh\npage 分支 | demo 分支                                              | username.bitbucket.org 仓库 |
| 自定义域名 | 每个仓库都可以自定义域名                 | 无                                                     | 个人 Profile 页             |</p>
<h2 id="小结">小结<a aria-hidden="true" href="#小结">#</a></h2>
<p>\n GitHub 适合开源项目管理。不缺钱的同学，私有项目也适合统一在 GitHub 管理。
\n GitLab 和 BitBucket 都很适合私有项目的管理。
\n GitLab 是开源项目，活跃程度很高，未来很有潜力，如果不在乎那些小硬伤，个人更推荐 GitLab。
\n BitBucket 系出名门，产品本身也非常好，没有明显的伤疤，作为完美主义者，我目前稍喜欢这个。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[定位到服务器集群的特定节点]]></title>
            <link>https://hotoo.github.io/blog/post/find-nodes-from-server-cluster</link>
            <guid>54</guid>
            <pubDate>Thu, 17 Apr 2014 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="定位到服务器集群的特定节点">定位到服务器集群的特定节点<a aria-hidden="true" href="#定位到服务器集群的特定节点">#</a></h1>
<blockquote>
<p>齐宣王使人吹竽，必三百人。南郭处士请为王吹竽，宣王说之，廪食以数百人。
宣王死，湣王立，好一一听之，处士逃。</p>
<p>《韩非子·内储说上》</p>
</blockquote>
<h2 id="背景">背景<a aria-hidden="true" href="#背景">#</a></h2>
<p>某日，突然收到报警，某发现实时异常监控趋势图上，静态资源 404 异常有明显的上升。
分析详细的异常信息发现是某个发布操作引起某几个系统引起的。</p>
<p>\n\n\n\n</p>
<p>找到对应的开发，分析结论是部分配置文件未生效，导致拼接资源文件地址错误。
按照业务量计算，这个异常量大约是其中一、两台机器有问题。</p>
<p>可能发布系统或其他问题，重新发布一次仍没能修复这个异常。</p>
<p>我们需要快速定位到这只滥竽，尽快将问题修复。
但是实际上却没有这么简单，我们最终花费 了 7个多小时，最终是因为这个系统正好有
其他发布才顺便解决。</p>
<p><img src="https://i.alipayobjects.com/i/localhost/png/201404/2TD6uw5N0n.png" alt="realtile\nerror\ntrend"></img></p>
<p>上图有两个造成异常的发布，分别是『CMS 发布』和『后台系统发布』。</p>
<p>橙色是 JavaScript 实时异常，绿色是静态资源 404 异常。</p>
<h2 id="方案">方案<a aria-hidden="true" href="#方案">#</a></h2>
<p>事后我们坐下来讨论如何解决这个问题，避免在以后遇到类似问题时能快速有效的应对。</p>
<p><img src="https://i.alipayobjects.com/i/localhost/png/201404/2Tdj3TmMdR.png" alt="异常过程序列图"></img></p>
<p>如上图，问题出在某个问题业务应用服务器节点配置文件未生效，拼接出来的 JavaScript
资源地址不正确导致 CDN 节点未命中而最终回源，源服务器也没有这个文件，最终发生
404 悲剧。</p>
<p>实际的业务系统中，会提供用户访问的节点信息，但是请求静态资源时无法获得这个信息，
是不是有办法在静态资源源服务器上获得来源页面所在的服务器节点信息呢？</p>
<ol>
<li>方案一：我们首先想到 Cookie。但是应用服务器和静态资源服务器分别在不同的域名
下，即使在访问应用服务器时写入节点信息到 Cookie 中，这个信息也不会携带到静态
资源服务器。『失败』。</li>
<li>方案二：CDN 节点域提供外部写 Cookie 的接口，用户访问应用服务时，同时调用接口
在 CDN 节点所在域写入用户访问应用服务器节点信息。『放弃』，缺点：</li>
<li>成本高。</li>
<li>风险大。</li>
<li>方案三：然后想到每个应用系统重写静态资源地址，在地址中携带当前应用服务器节点
信息。『放弃』，缺点：</li>
<li>成本过高。</li>
<li>导致 CDN 命中率下降。</li>
<li>方案四：重写用户访问页面地址，附带应用服务器节点信息。成本过高，『放弃』。</li>
</ol>
<p>从前端角度直接解决这个看似无望，换个思路。</p>
<ol start="5">
<li>方案五：在网络内部，使用内部代理。如 <code>curl \nI \nx internal\nhost:port url</code>
『可行』，缺点：</li>
<li>需要在服务器所在内网执行，指定目标服务器内部 IP，因此只有系统管理员可以操作。</li>
<li>而系统管理员不清楚实际应用业务。</li>
<li>方案六：如果可以在外部指定服务器节点访问应用，是不是可行呢？</li>
</ol>
<p>这个跟负载均衡规则有关，如果负载均衡服务器支持这个特性，或可一试。</p>
<p>跟相关同学沟通后，表示可以做。而且从外网直接访问，清楚业务的开发同学可以自行
排查。</p>
<p>『可行』。需要注意的问题：</p>
<ol>
<li>逐个击破，定向攻击。
<ol>
<li>可以通过拒绝频繁的指定节点访问请求来防范。</li>
<li>可以通过白名单内部 IP 才可以使用。</li>
</ol>
</li>
<li>方案七：客户端脚本扫描所有外部资源，并发起请求来确认各个资源状态。『放弃』，
缺点：
\n 增加静态资源服务器压力。
\n 增加网络请求和流量。</li>
<li>方案八：客户端脚本监听静态资源异常事件。HTML5 现在提供了 Performance Timing
API，可以用来监控网页及其引用的外部资源加载时间，将来提供类似的 API 可以监听
静态资源的 error 事件也未可知。『期待』</li>
<li>方案九：Web 服务器端输出时拦截器扫描。尤其目前前端往后端延伸，能做的事情更多
了。『可行』。</li>
</ol>
<h2 id="结论">结论<a aria-hidden="true" href="#结论">#</a></h2>
<p>综上所述，在成本、风险、自动化、扩展性等方面来讲，方案九是最优的。</p>
<h2 id="延伸思考">延伸思考<a aria-hidden="true" href="#延伸思考">#</a></h2>
<p>图二所示，这次问题出在业务应用服务器集群的节点 1。</p>
<p>\n 如果问题节点是静态资源 CDN 集群的节点 2 呢？
\n 问题节点是节点 3？</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[转换 Vimwiki 为 Markdown]]></title>
            <link>https://hotoo.github.io/blog/post/convert-vimwiki-to-markdown</link>
            <guid>57</guid>
            <pubDate>Mon, 31 Mar 2014 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="转换-vimwiki-为-markdown">转换 Vimwiki 为 Markdown<a aria-hidden="true" href="#转换-vimwiki-为-markdown">#</a></h1>
<blockquote>
<p><code>sed \nf ex \ni \n.md</code></p>
</blockquote>
<h2 id="readme">README<a aria-hidden="true" href="#readme">#</a></h2>
<p>相对 Wiki 语法，和 Wiki 对应工具支持情况，我更加喜欢 Markdown 了。
本地配合使用 Vimwiki 来编辑查看，发布使用 nico 来转换，而且有 Github 的原生支持，
使用 Markdown 是不二之选。</p>
<p>为了减少转换工作量，我简要写了这个脚本，可以初步将 vimwiki 语法的项目，
自动转换成 markdown 语法。</p>
<p>转换的内容包括：</p>
<p>\n header
\n codes
\n wikiword.
\n links
\n images
\n comments
\n %toc
\n %title
\n %nohtml</p>
<h2 id="usage">Usage<a aria-hidden="true" href="#usage">#</a></h2>
<p>假设上面的脚本保存结构如下：</p>
<pre><code>/
|\n convert.sh
|\n ex
|\n vimwiki/
  |\n index.wiki
  `\n vim.wiki
</code></pre>
<p>在 convert.sh 同级目录执行：</p>
<pre><code>\n ./convert.sh vimwiki/\n.wiki
</code></pre>
<p>然后自动或手动调整之后，删除 <code>.wiki</code> 文件即可。</p>
<h2 id="codes">Codes<a aria-hidden="true" href="#codes">#</a></h2>
<h3 id="convertsh">convert.sh<a aria-hidden="true" href="#convertsh">#</a></h3>
<pre><code>#!/usr/bin/env bash

for x
do
  filename=\n(echo \nx|sed \ne &quot;s/\.wiki\n/.md/&quot;)
  sed \nf ex \nx &gt; \nfilename
done
</code></pre>
<h3 id="ex">ex<a aria-hidden="true" href="#ex">#</a></h3>
<pre><code>s/# \(.\n\)\n/\n \1/g
s/^= \(.\n\) =\n/# \1/g
s/^== \(.\n\) ==\n/## \1/g
s/^=== \(.\n\) ===\n/### \1/g
s/^==== \(.\n\) ====\n/#### \1/g
s/^===== \(.\n\) =====\n/##### \1/g
s/^====== \(.\n\) ======\n/###### \1/g
s/{{{class=&quot;brush: \n\([^&quot;]\n\)&quot;/\`\`\`\1/g
s/{{{class=&quot;\([^&quot;]\n\)&quot;/\`\`\`\1/g
s/{{{/\`\`\`/g
s/}}}/\`\`\`/g
s/\[\([^] ]\{1,\}\)\]\([^](]\)/![pic](\1)\2/g
s/\[\([^] ]\{1,\}\)\]\n/![pic](\1)/g
s/\[\[\(\([^|]\{1,\}\)\|\)\([^]]\{1,\}\)\]\]/[\3](\2.md)/g
s/\[\[\([^]]\{1,\}\)\]\]/[\1](\1.md)/g
s/\[\(https\{0,1\}:\/\/[^ ]\n\) \([^]]\n\)\]/[\2](\1)/g
s/%% \(.\n\)//g
/%toc.\n/d
s/%title \(.\n\)/# \1/g
s/%nohtml/\n status: draft/g
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[阿里巴巴三年醇]]></title>
            <link>https://hotoo.github.io/blog/post/alibaba-3-years</link>
            <guid>56</guid>
            <pubDate>Tue, 25 Feb 2014 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="阿里巴巴三年醇">阿里巴巴三年醇<a aria-hidden="true" href="#阿里巴巴三年醇">#</a></h1>
<p>今天 <a href="https://github.com/lifesinger" target="_blank" rel="noopener noreferrer">@玉伯</a> 给我送来的三年醇礼物。</p>
<p>一个阿里真棒玉坠。</p>
<p><img src="https://f.cloud.github.com/assets/143572/2257303/db0a08fa%5Cn9e16%5Cn11e3%5Cn90b3%5Cn5b9cea307a2a.png" alt="阿里真棒"></img></p>
<p>三周年成（阿里）人手印礼。</p>
<p><img src="https://f.cloud.github.com/assets/143572/2257320/2a17e296%5Cn9e17%5Cn11e3%5Cn98f8%5Cn6a45a91ffcf5.png" alt="手印礼"></img></p>
<p>和女朋友一起用手印礼多出来的印泥自制的小猪猪。</p>
<p><img src="https://f.cloud.github.com/assets/143572/2257321/37011bda%5Cn9e17%5Cn11e3%5Cn9f28%5Cn36c0391f505a.png" alt="印泥手工制品"></img></p>
<p>感谢阿里。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[多个 SSH KEY]]></title>
            <link>https://hotoo.github.io/blog/post/multi-ssh-key-for-git</link>
            <guid>58</guid>
            <pubDate>Mon, 25 Nov 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="多个-ssh-key">多个 SSH KEY<a aria-hidden="true" href="#多个-ssh-key">#</a></h1>
<pre><code>Host github.com
  HostName github.com
  User hotoo
  IdentityFile ~/.ssh/id\nrsa

Host gitlab.example.com
  HostName gitlab.example.com
  User user.name@email.address
  IdentityFile ~/.ssh/id\nrsa\ngitlab\nexample\ncom

Host example.com
  HostName www.example.com
  User admin

Host shterm
  HostName shterm.example.com
  User user.name
</code></pre>
<h2 id="git-config-nnlocal">git config \n\nlocal<a aria-hidden="true" href="#git-config-nnlocal">#</a></h2>
<pre><code>git config \n\nlocal user.name username
git config \n\nlocal user.email user@email.com
</code></pre>
<p>project/.git/config</p>
<pre><code>[user]
        name = username
        email = user@email.com
</code></pre>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://omiga.org/blog/archives/2269" target="_blank" rel="noopener noreferrer">多个github帐号的SSH key切换</a>
\n <a href="https://help.github.com/articles/generating%5Cnssh%5Cnkeys" target="_blank" rel="noopener noreferrer">Generating SSH Keys</a>
\n <a href="https://linux.chinaunix.net/techdoc/beginner/2010/01/12/1153509.shtml" target="_blank" rel="noopener noreferrer">ssh\nkeygen 中文手册</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[密码与正则]]></title>
            <link>https://hotoo.github.io/blog/post/regexp-for-password</link>
            <guid>59</guid>
            <pubDate>Sun, 17 Nov 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="密码与正则">密码与正则<a aria-hidden="true" href="#密码与正则">#</a></h1>
<p>通常我们需要校验验证用户输入的密码是否符合强度要求。</p>
<p>密码字符包括以下几种：</p>
<p>\n 小写英文字符 <code>[a\nz]</code>
\n 大写英文字符 <code>[A\nZ]</code>
\n 阿拉伯数字 <code>[0\n9]</code>
\n 部分特殊字符 <code>[&amp;#96;~!@#\n%^&amp;\n()\n\\n+=|\\\[\]{}:;&#39;&quot;&lt;&gt;,.\/?]</code>，
简化为 <code>[ \n\/:\n@\[\n&amp;#96;{\n~]</code></p>
<blockquote>
<p>注，md 的限制，上面特殊字符中 ` 使用 <code>&amp;#96;</code> 代替。</p>
</blockquote>
<p>目前常见的密码强度包括以下几种</p>
<p>\n 普通强度：必须同时包含 2种字符。
\n 高强度：必须同时包含 3种字符。
\n 极高强度：必须同时包含 4种密码字符。</p>
<p>通常情况下，我们可能会基于种种考虑采用字符串方法计算密码强度，或校验密码合法性，
下面我们更多的考虑使用正则表达式来解决这个问题。</p>
<pre><code>var normal = /^(?![0\n9]+\n)(?![a\nzA\nZ]+\n)(?![ \n\/:\n@\[\n`{\n~]+\n)[0\n9A\nZa\nz \n\/:\n@\[\n`{\n~]{6,20}\n/;

var high = /^(?![0\n9a\nzA\nZ]+\n)(?![a\nzA\nZ#\n@\\n\\n]+\n)(?![0\n9#\n@\\n\\n]+\n)[0\n9A\nZa\nz#\n@\\n\\n]{6,20}\n/;

var highest = &quot;1aa1&quot;.replace(/^(?:([a\nz])|([A\nZ])|([0\n9])|(.)){6,}|(.)+\n/, &quot;\n1\n2\n3\n4\n5&quot;)
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[中国农历]]></title>
            <link>https://hotoo.github.io/blog/post/lunar-calendar</link>
            <guid>61</guid>
            <pubDate>Wed, 13 Nov 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="中国农历">中国农历<a aria-hidden="true" href="#中国农历">#</a></h1>
<p>Google 日历内置了中国农历的支持，但是各种桌面客户端如 Mac iCal, iPhone 默认日历
都无法正常使用，网上搜索了一遍也没有更好的订阅地址，大都不更新了。</p>
<p>而且我又不想装各种乱七八糟的第三方日历应用。</p>
<p>因此我自己制作了一个公开农历日历，需要的同学可以订阅到 Google Calendar，并且在
Google Calendar 中可以隐藏这个日历，只是在各个客户端中显示即可。</p>
<p>不过不爽的是，客户端不能针对特定日历设置提醒，有更好的方案的同学欢迎指教哈。</p>
<h2 id="启用-google-calendar-内置农历推荐">启用 Google Calendar 内置农历（推荐）<a aria-hidden="true" href="#启用-google-calendar-内置农历推荐">#</a></h2>
<ol>
<li>
<p>设置(Settings)</p>
<p><img src="/images/blog/google%5Cncalendar%5Cnsettings.png" alt="Settings"></img></p>
</li>
<li>
<p>基本(General)</p>
</li>
<li>
<p>备用日历(Alternate calendar)</p>
<p><img src="/images/blog/google%5Cncalendar%5Cnsettings%5Cnalternate%5Cncalendar.png" alt="Alternate calendar"></img></p>
</li>
<li>
<p>选择 <code>农历 \n 简体中文</code> (<code>Chinese calendar \n Simplified Chinese</code>)</p>
</li>
<li>
<p>保存(Save)</p>
</li>
<li>
<p>最终可以在每日的日历顶部，有对应农历的显示。</p>
<p><img src="/images/blog/google%5Cncalendar%5Cnlunar%5Cncalendar%5Cndemo.png" alt="农历月历演示"></img></p>
</li>
</ol>
<p>\n\n\n\n</p>
<p>Google 日历的这个特性真是太赞了，以前为每天创建一个全天日历的挫 B方案没脸比。</p>
<p>不过，现有的桌面（包括移动设备）应用中，都没能很好的支持这个特性。我又不想安装
第三方的乱七八糟的日历应用，希望一个日历应用管理所有的日历数据，希望数据是开放的。</p>
<p>因此挫 B 的方案只能继续。</p>
<p>通过互联网在整个世界找了一圈，分享出来的农历订阅日历都已经失效、或者不更新了，
因此我决定自己来维护世界和平，创建并分享了下面的中国农历，大家只需要订阅
到自己的日历中就可以了。</p>
<h2 id="订阅地址">订阅地址<a aria-hidden="true" href="#订阅地址">#</a></h2>
<p>\n <a href="https://www.google.com/calendar/ical/896414ier7cs228f2fp4mkn02g%40group.calendar.google.com/public/basic.ics" target="_blank" rel="noopener noreferrer">ical</a>
\n <a href="https://www.google.com/calendar/feeds/896414ier7cs228f2fp4mkn02g%40group.calendar.google.com/public/basic" target="_blank" rel="noopener noreferrer">xml</a>
\n <a href="https://www.google.com/calendar/embed?src=896414ier7cs228f2fp4mkn02g%40group.calendar.google.com&amp;ctz=Asia/Shanghai" target="_blank" rel="noopener noreferrer">html</a></p>
<h2 id="订阅方法">订阅方法<a aria-hidden="true" href="#订阅方法">#</a></h2>
<p>桌面应用本身支持直接订阅 ical 日历，但是为了便于管理，我统一使用了 Google Calendar
管理我的日历，桌面应用只是客户端，数据来源于 Google Calendar。</p>
<p>\n Other calendars 右侧的菜单，选择 <code>Add by URL</code></p>
<p><img src="/images/blog/google%5Cncalendar%5Cnadd%5Cnby%5Cnurl.png" alt="Add Calendar"></img></p>
<p>\n 填入 ical 地址：</p>
<p><code>https://www.google.com/calendar/ical/896414ier7cs228f2fp4mkn02g%40group.calendar.google.com/public/basic.ics</code></p>
<p><img src="/images/blog/google%5Cncalendar%5Cnadd%5Cncalendar.png" alt="Add Calendar"></img></p>
<p>\n 点击 Add Calendar 按钮。
\n 由于 Google Calendar 本身内置了农历的支持，可以在 Google Calendar 中隐藏不显示这个日历。</p>
<p>预览：</p>
<p><a href="https://www.google.com/calendar/embed?height=600&amp;amp;wkst=1&amp;amp;bgcolor=%23FFFFFF&amp;amp;src=896414ier7cs228f2fp4mkn02g%40group.calendar.google.com&amp;amp;color=%23875509&amp;amp;ctz=Asia%2FShanghai" target="_blank" rel="noopener noreferrer">https://www.google.com/calendar/embed?height=600&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=896414ier7cs228f2fp4mkn02g%40group.calendar.google.com&amp;color=%23875509&amp;ctz=Asia%2FShanghai</a></p>
<pre><code>&lt;iframe src=&quot;https://www.google.com/calendar/embed?height=600&amp;amp;wkst=1&amp;amp;bgcolor=%23FFFFFF&amp;amp;src=896414ier7cs228f2fp4mkn02g%40group.calendar.google.com&amp;amp;color=%23875509&amp;amp;ctz=Asia%2FShanghai&quot;
  style=&quot; border\nwidth:0 &quot; width=&quot;800&quot; height=&quot;600&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt;&lt;/iframe&gt;
</code></pre>
<h2 id="其他">其他<a aria-hidden="true" href="#其他">#</a></h2>
<p>\n 如果在使用过程中发现其中的错误，请邮件给我。
\n 同时欢迎 Fork 这个 <a href="https://github.com/hotoo/chinese%5Cnlunar%5Cncalendar" target="_blank" rel="noopener noreferrer">『中国农历』开放项目</a> 。
或者给我们提交 Issues。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[不缓存 CDN 静态资源方案]]></title>
            <link>https://hotoo.github.io/blog/post/no-cache-in-cdn</link>
            <guid>60</guid>
            <pubDate>Sat, 21 Sep 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="不缓存-cdn-静态资源方案">不缓存 CDN 静态资源方案<a aria-hidden="true" href="#不缓存-cdn-静态资源方案">#</a></h1>
<p>支付宝目前使用淘宝提供的 CDN 服务，这个服务中的 CDN 节点在自身找不到对应资源时
主动到源服务器拉取的策略。</p>
<p>支付宝使用的静态资源合并(combo)方案，导致在不同的访问参数情况下，被认为是不同
的静态资源。如果挟带的是避免缓存的随机参数，CDN 在没有缓存这个资源的情况下，
会到源服务器拉取资源。</p>
<p>原则上，我们使用特定的版本机制，每个新版本文件以不同的文件名发布，不允许使用
参数，尤其是随机数方式避免缓存问题。</p>
<h2 id="问题">问题<a aria-hidden="true" href="#问题">#</a></h2>
<p>由于我们使用的版本策略，我们可以指定用户缓存静态资源时效为永久，实际方案上
我们指定用户缓存时间为 1年，但是在某些场景下（如测量用户网络速度），
用户客户端（非 CDN 节点）访问某些特定静态资源需要禁止使用缓存。</p>
<p>目前常见的方案都是在客户端使用时间戳+随机数。这个方案本身看似没什么问题，但是
实际上有非常大的隐患，测量的数据参考性也不佳。</p>
<p>\n CDN 节点上缓存了大量挟带永不重复随机数的资源，对磁盘造成影响。
\n CDN 缓存命中率降低，这些挟带随机数的静态资源缓存率命中率为 0。
\n 增加源服务器的访问压力。
\n 测量的用户网络响应时间实际不是到 CDN 节点的，还包含 CDN 回源的时间。</p>
<h2 id="解决方案">解决方案<a aria-hidden="true" href="#解决方案">#</a></h2>
<p>为了解决这种明确不允许用户客户端缓存，同时又不建议使用随机参数访问的需求，我们
有以下几种方案：</p>
<ol>
<li>
<p>CDN 服务器端控制浏览器不缓存。『最佳方案』</p>
<p>设置指定目录下的静态资源禁止缓存头信息，有需要禁止缓存需求时上传静态资源到
这个目录。</p>
</li>
<li>
<p>直接访问源服务器。</p>
<p>现在的加随机数访问 CDN 方案和直接访问源服务器本质上相同，这方案只能测用户到
源服务器的响应时间。</p>
</li>
<li>
<p>使用有限随机数方案。</p>
<p>虽然第一种是最佳方案，但也不排除某些浏览器或壳在不关闭页面情况下，有缓存的
问题，所以这和第一种方案结合使用可能是更靠谱一些的方案。『待验证』</p>
<p>页面脚本请求静态资源时，带上从零递增的参数，避免单页面缓存问题，亦可避免
CDN 缓存大量无意义资源的问题。</p>
</li>
</ol>
<h2 id="延伸">延伸<a aria-hidden="true" href="#延伸">#</a></h2>
<p>实际上，对于静态资源来说，纯粹的参数是无意义的，CDN 节点本可以忽略这个参数。
虽然合并策略使用了参数方式，但是我们使用双问号激活合并服务的方案可以让我们
明确区分出合并参数和其他参数，因此技术上是完全可以忽略其他参数导致的回源。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<ol>
<li>
<p><a href="https://segmentfault.com/q/1010000000119794" target="_blank" rel="noopener noreferrer">拉取式相比推送式的对比的参考</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 9期，搜狗浏览器中神一样的 try/catch 特性]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-9</link>
            <guid>63</guid>
            <pubDate>Fri, 13 Sep 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-9期搜狗浏览器中神一样的-trycatch-特性">每周异常：第 9期，搜狗浏览器中神一样的 try/catch 特性<a aria-hidden="true" href="#每周异常第-9期搜狗浏览器中神一样的-trycatch-特性">#</a></h1>
<h2 id="背景">背景<a aria-hidden="true" href="#背景">#</a></h2>
<p>某日 16时 30分，监控实时大盘中全站 JavaScript 异常和 404 异常分别朝着不同的方向延伸，
橙色的 JavaScript 异常急剧上升。</p>
<p><img src="https://f.cloud.github.com/assets/143572/1136611/435cbfac%5Cn1c48%5Cn11e3%5Cn8856%5Cn8fc7ef13ce5a.png" alt="bac3c01389cadbb12d4873520b3bd2a9"></img></p>
<p>详细数据中我们看到一向高标准高质量的收银台出现异常大量的异常。</p>
<p><img src="https://f.cloud.github.com/assets/143572/1136701/ae74db38%5Cn1c4a%5Cn11e3%5Cn9d2d%5Cn1101c0b61a79.png" alt="2013\n09\n13 4 00 58"></img></p>
<h2 id="排查">排查<a aria-hidden="true" href="#排查">#</a></h2>
<p>我们发现其中有两个页面异常最多，而这两个页面中异常最多的『一个异常』详情如下：</p>
<p>\n File: 同页面 URL
\n Line: 1
\n Message: Uncaught SyntaxError: Unexpected token a</p>
<p>客户端信息：</p>
<p>\n pc/\n1;windows/5.1;sg/2.x;webkit/535.1
\n pc/\n1;windows/6.1;sg/2.x;webkit/535.1</p>
<p>堆栈信息：</p>
<pre><code>at function parse()
    at function ()
    at function (data)
    at function ()
    at function ()
</code></pre>
<p>分析过程非常艰辛，重现异常的过程也是一波三折，这里不做赘述，最终分析得出：</p>
<p>\n 搜狗浏览器的 userAgent 太坑爹，几乎所有版本都是 2.x，开发者太不专业了。最终找到内核为 webkit/535.1 的是 3.2 版。
\n 重现到老版 arale 中的 ajax 模块中对 JSON 有特殊的处理，如果浏览器内置的 JSON 不支持非标准的 JSON （如 <code>{a:1}</code>）则 hack 做兼容。</p>
<pre><code>    function W3CParse(data) {
        if (validJSON(data)) {
            return window.JSON.parse(data)
        } else {
            return null;
            arale.error(&quot;Invalid JSON: &quot; + data)
        }
    }

    function defaultParse(data) {
        if (validJSON(data)) {
            return (new Function(&quot;return (&quot; + data + &quot;)&quot;))()
        } else {
            return null;
            arale.error(&quot;Invalid JSON: &quot; + data)
        }
    }
    var ok\nwrong\njson = function () {
        try {
            JSON.parse(&quot;{ a: 1 }&quot;);
            return true
        } catch (x) {
            return false
        }
    };
    if (window.JSON &amp;&amp; window.JSON.parse &amp;&amp; ok\nwrong\njson()) {
        parseJSON = function (data) {
            return W3CParse.call(this, data)
        }
    } else {
        parseJSON = function (data) {
            return defaultParse.call(this, data)
        }
    }
</code></pre>
<p>\n 抛出异常的代码是 <code>JSON.parse(&quot;{a: 1}&quot;)</code>
\n 但奇怪的是这段代码是放在 try/catch 中，为什么还会有异常被监控捕获？
\n 最终发现这是搜狗浏览器 3.2版极速(webkit)模式中的特性：即使 try/catch 住的异常，
同样会被 window.onerror 捕获，但并未因此中断业务逻辑，后续的代码仍然会按照正确的
try/catch 异常处理流程进行，所以对业务本身没有影响。
\n p.s. 搜狗浏览器没有控制台，用户不会知道出了异常。
\n 另外收银台之前异常量少的主要原因是主要的页面没有引入前端监控，用户抛出了异常而我们不知道而已。</p>
<h2 id="相关截图">相关截图<a aria-hidden="true" href="#相关截图">#</a></h2>
<p><img src="https://f.cloud.github.com/assets/143572/1136977/316cd2d8%5Cn1c51%5Cn11e3%5Cn9f7e%5Cn4bbebec06108.png" alt="2013\n09\n13 4 39 14"></img>
<img src="https://f.cloud.github.com/assets/143572/1136980/32da28aa%5Cn1c51%5Cn11e3%5Cn8dc4%5Cn5773fc84f885.png" alt="2013\n09\n13 4 39 33"></img>
<img src="https://f.cloud.github.com/assets/143572/1136981/331bb9f0%5Cn1c51%5Cn11e3%5Cn93bf%5Cn8cd2dcdf5d7f.png" alt="2013\n09\n13 4 40 26"></img>
<img src="https://f.cloud.github.com/assets/143572/1136982/331f90c0%5Cn1c51%5Cn11e3%5Cn8d08%5Cn8d61c08512dc.png" alt="2013\n09\n13 4 40 12"></img>
<img src="https://f.cloud.github.com/assets/143572/1136983/332ad480%5Cn1c51%5Cn11e3%5Cn991f%5Cnb4b0db932f69.png" alt="2013\n09\n13 4 41 03"></img></p>
<h2 id="解决方案">解决方案<a aria-hidden="true" href="#解决方案">#</a></h2>
<p>最初虽然有些争议，但我们最终决定的处理方案是监控中临时排除 sg/2.x|webkit/535.1 中
<code>Uncaught SyntaxError: Unexpected token a</code> 异常。</p>
<h3 id="是否要排除这个浏览器中所有的异常">是否要排除这个浏览器中所有的异常？<a aria-hidden="true" href="#是否要排除这个浏览器中所有的异常">#</a></h3>
<p>呃，考虑到搜狗浏览器的份额，我们的策略是只排除已知的异常，未知的异常看最终分析结果再考虑。</p>
<h2 id="广告">广告<a aria-hidden="true" href="#广告">#</a></h2>
<p>这个异常排查的主要功臣 @wsvn53，我们在排查过程中频繁使用了他开发的工具
<a href="https://github.com/wsvn53/fedit" target="_blank" rel="noopener noreferrer">Fedit</a>，可以直接修改线上代码。
排查线上故 障、线下接⼝什么的都非常⽅方便。强烈建议⼤家都装上⽤用。</p>
<h2 id="最后">最后<a aria-hidden="true" href="#最后">#</a></h2>
<p>我仅代表我自己，想说某些毫无责任心的国产浏览器壳厂商们，你们没有创造价值，
只是在各种不同方式的索取。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 8期，异常象限]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-8</link>
            <guid>62</guid>
            <pubDate>Thu, 05 Sep 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-8期异常象限">每周异常：第 8期，异常象限<a aria-hidden="true" href="#每周异常第-8期异常象限">#</a></h1>
<p>上周的 <a href="weekly%5Cntopic%5Cnabout%5Cnexceptions%5Cn7.md">每周异常：第 7期，保持简单，保持拙朴</a>
中介绍了通过页面关键的 URL/ID 信息，简单有效的发现异常的方案。
本周我们在这个异常分析方法之上，再稍微深入下：</p>
<p>对于整个网站来说，每个系统、页面是有重要级别的，比如支付宝收银台就是 A1 级系统。
这些系统、页面一般可以按照以下方法来判断重要性：</p>
<p>\n 访问量极大，是最主要的业务，对用户影响极大。
\n 用户本身重要（例如商户，尤其是大商户），是最重要的业务，对企业影响巨大。</p>
<p>对于前者，我们可以通过系统、域名的访问量来近似的划分；
对于后者，我们可以建立白名单机制。</p>
<p>对于异常来说，可以通过异常率来判断异常自身的紧急程度。</p>
<p>\n\n\n\n</p>
<p>\n 系统、页面重要性作为『异常重要性』的一个指标。
\n 异常率及异常量作为『异常紧急程度』作为一个指标。
\n 异常率超过阈值的为高发率异常。
\n （可选）异常量超过阈值的也是高发量异常。
\n 并且以高发率为主。</p>
<p>我们画出以下异常象限：</p>
<p><img src="/images/blog/quadrant.png" alt="异常象限"></img></p>
<p>\n 图中一、二、三、四为象限代号。
\n (0, 1, 2, 3) 为异常重要性序号。</p>
<p>经过一些分析，我们可以得出结论：</p>
<p>\n 第一、第二象限的异常，是我们最需要关注的部分。尤其是第一象限的异常，
实时高发异常一般也是在这个象限。
\n 第四、三象限的低发异常，则几乎可以不用关注。
\n 总之我们只需要关注高发异常，但应该以页面的重要性来排优先级。</p>
<h2 id="如何设定阈值">如何设定阈值？<a aria-hidden="true" href="#如何设定阈值">#</a></h2>
<p>要确定异常象限，确定各个阈值是关键，这里只提供一些简单的参考。</p>
<p>\n 重要程度：全站重要页面占全站所有页面的 5% 左右，可以根据自身情况调整。
\n 紧迫程度：
\n 目前的经验数据是异常率 4‰ 以上可以认为是高发率异常，但仍需继续
分析实际数据做调整。
\n （可选）异常 PV 超过 (全站访问最高页面 PV 乘以 1‰) 的也可以认为是高发量异常，
实际可以根据自身情况调整。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 7期，保持简单，保持拙朴]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-7</link>
            <guid>64</guid>
            <pubDate>Wed, 28 Aug 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-7期保持简单保持拙朴">每周异常：第 7期，保持简单，保持拙朴<a aria-hidden="true" href="#每周异常第-7期保持简单保持拙朴">#</a></h1>
<h2 id="副标题如何简单有效的发现最重要的有效异常">副标题：如何简单有效的发现最重要的有效异常<a aria-hidden="true" href="#副标题如何简单有效的发现最重要的有效异常">#</a></h2>
<blockquote>
<p>Keep It Simple, Stupid.</p>
<p>\n\n U.S. Navy (1960)</p>
</blockquote>
<p>在这之前，我一直苦苦寻求牛逼的算法 <a href="https://github.com/totorojs/javascript%5Cnexception%5Cnarchives/issues/17" target="_blank" rel="noopener noreferrer">#12</a> ，
来解决这个看似简单，其实不易；仿佛不易，最终简单的问题：
找出最重要的有效异常。</p>
<p>最早的时候，我们定义了『一个异常』由以下核心部分组成：</p>
<p>\n URL: 异常所在页面。
\n File: 异常代码所在文件。
\n Line: 异常代码所在行数。
\n Message: 异常消息。</p>
<p>这些是不变的，相同页面中，同一个异常代码文件同一行，异常消息相同的异常，我们可以近似的认为它是同一个异常。</p>
<p>另外还定义了异常率：</p>
<p>\n 异常率(PV)：『一个异常』的 PV，除以这个异常所在页面的 PV。
\n 异常率(UV)：『一个异常』的 UV，除以这个异常所在页面的 UV。</p>
<p>于是我们通过 URL, File, Line, Message 四个核心信息来统计每一个异常的 PV, UV, PV异常率，UV异常率。
并按照其中的某个字段为主进行排序。</p>
<p>但是得到的结果总是让人不尽如人意，总会有很多无法排查，甚至还有一些显然不是我们代码的问题的异常排前排。</p>
<p>我们尝试限制异常 PV, UV 的基数，尝试限制页面 PV, UV 的基数，结果仍然不理想。
而且也没有想出其他牛逼的权重算法来评估每个异常。</p>
<p>我们想过异常是跟代码所在文件和行号、异常消息有关系的，跟页面 URL 的关系不那么强，因为公共代码会在很多页面使用，把这同一个异常分散算到不同页面中会严重影响这个异常的排名。</p>
<p>但是实际上公共代码（尤其是基础类库）的异常很多情况下是业务系统调用不当，或者使用的版本有 BUG 导致，最终还是需要这个页面的开发者调整调用方法，或升级使用更新的公共脚本来解决。所以忽略或弱化异常所在页面是不可接受的。</p>
<p>而且排除了异常所在页面的信息，对于排查异常来说更为困难。</p>
<p>够了，我已经受够了，脑袋一片浆糊。
累、困，早点回家睡觉。</p>
<p>\n\n\n\n</p>
<p>回到家随手画了几笔，然后去洗澡。洗澡的时候想着刚刚画的思维草图，逐渐想清楚了很多。</p>
<p>\n File: 由于是 seajs 自动管理依赖，以及 combo 的使用，异常所在文件本身具有不稳定性。
\n Line: 由于上面 File 的原因，不仅仅是 HTML 代码中的异常行号不稳定，静态脚本异常行号也具有不稳定性。
\n Message: 不同浏览器（包括不同版本，或者在不同操作系统中）对同一个异常有不同的消息反馈，另外还有本地化的原因，异常消息也具有不稳定性。</p>
<p>最后，只有异常所在页面 URL（或者页面 ID，一个页面源文件可能有多个 URL 地址，但是它们是有关系的，ID 相同）才是最稳定的。</p>
<p>\n\n\n\n</p>
<p>于是我根据页面 URL 排列出每个页面的异常 PV, UV, PV异常率，UV异常率。并根据 PV 异常率为主进行倒序排序（每次访问都抛出的异常，比每个用户访问都抛出的异常的优先级更高）于是我们轻易得出了全站异常率最高的页面。</p>
<p>根据这个关键的页面信息，再次查询出每『一个异常』的 PV, UV, PV异常率，UV异常率。</p>
<p>以不变（页面 URL 或 ID），应万变。我们一个个把这些异常大户揪出来，各个击破。即使暂时没有发布解决，我们仍可以轻易识别排除这个已经揪出的异常。</p>
<p>好了，妈妈再也不用操心我的每周异常 TOP 数据分析了。</p>
<p>嗯， <a href="https://github.com/totorojs/javascript%5Cnexception%5Cnarchives/issues/17" target="_blank" rel="noopener noreferrer">#12</a> 这个 issue 也可以关了。</p>
<p>\n\n\n\n</p>
<p>在做静态资源异常监控时，也有类似的经历。</p>
<p>静态资源监控最重要的是发现哪个页面引用了哪个 404资源，尤其是漏发的资源。因此最重要的有两个关联维度：</p>
<p>\n 404资源所在页面
\n 404资源文件地址</p>
<p>但是引起 404 的场景很多，包括：</p>
<p>\n 漏发文件。
\n 静态引用地址错误。
\n 动态引用地址错误。</p>
<p>其中动态引用是由于动态脚本计算得出的静态资源地址，引发的 404 非常频繁，多样、而且分布的很散。因此这两个维度的排列组合结果就非常巨大。而且我们的分析系统是基于索引的，这些内容不确定、数量庞大的指标非常不适合用这个系统分析。（我们还有另一个非常时候实时异常分析的系统，这里不做介绍）</p>
<p>因此我们把重心放在更为稳定的页面 URL，只关注出现 404 的页面，至于是什么资源可以直接根据 URL 查询日志，或直接访问这个页面。</p>
<h2 id="小结">小结<a aria-hidden="true" href="#小结">#</a></h2>
<p>这篇讲的几个关键内容再强调下：</p>
<p>\n 保持简单，保持拙朴。
\n 抓住重点，真正的核心重点。</p>
<p>\n\n\n\n</p>
<p>终于可以睡了，晚安~</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 6期，JavaScript 异常监控脚本引发的 JavaScript 异常]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-6</link>
            <guid>65</guid>
            <pubDate>Thu, 22 Aug 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-6期javascript-异常监控脚本引发的-javascript-异常">每周异常：第 6期，JavaScript 异常监控脚本引发的 JavaScript 异常<a aria-hidden="true" href="#每周异常第-6期javascript-异常监控脚本引发的-javascript-异常">#</a></h1>
<h2 id="背景">背景<a aria-hidden="true" href="#背景">#</a></h2>
<p>早上收到比较重要的用户反馈说某个重要的系统的页面在 IE 浏览器中卡死，无法继续。</p>
<p><img src="https://f.cloud.github.com/assets/143572/1007567/5214e9b4%5Cn0b0b%5Cn11e3%5Cn8d43%5Cn07d34947d198.png" alt="2013\n08\n22 5 14 01"></img>
<img src="https://f.cloud.github.com/assets/143572/1007568/523e63de%5Cn0b0b%5Cn11e3%5Cn85bd%5Cnb3adee635aef.png" alt="2013\n08\n22 5 14 25"></img></p>
<p>问题很严重。</p>
<p>系统比较特殊复杂，不是一般人能登录进去的。找到对应同学在小概率重现的情况下终于拿到了第一手的问题源码。</p>
<h2 id="分析">分析<a aria-hidden="true" href="#分析">#</a></h2>
<p>修改配置和采样率之后在本地跑起来，发现在 IE6 里非常有问题。</p>
<ol>
<li>
<p>性能这么大的问题，首先想到的是页面中大面积扫描 HTML 代码的部分，但是注释掉这部分仍然没有改善。</p>
</li>
<li>
<p>再次把整个回调处理函数注释掉，仍然没有改善。</p>
</li>
<li>
<p>直接把加载后置脚本的 seajs.use 注释掉之后，终于没问题了。（坑爹的缓存问题就不说了，好久之后才发现，都是泪~）</p>
</li>
<li>
<p>这么看来有两种可能：</p>
</li>
<li>
<p>模块本身有性能问题。</p>
</li>
<li>
<p>seajs 性能有问题（这个问题页面目前使用的 1.3.1）</p>
</li>
<li>
<p>首先考虑自身的问题。return 整个 factory，性能无问题，因此不是模块过多导致 seajs 性能问题。</p>
</li>
<li>
<p>逐步修改 return 位置（其实可以打断点），终于发现问题出在 <a href="https://github.com/totorojs/monitor.js/blob/2.2.0/src/monitor.js#L23" target="_blank" rel="noopener noreferrer">初始化事件绑定函数部分</a>。</p>
<pre><code>// 避免未引用先行脚本抛出异常。
if(!win.monitor){
  M = win.monitor = {};
  M.\nDATAS = [];
  M.\nEVENTS = [];
}

var \nevents = M.\nEVENTS;
var \nevt = new Events();
M.on = function(evt, handler){
  \nevt.on(evt, handler);
};
for(var i=0,l=\nevents.length; i&lt;l; i++){
  M.on(\nevents[i][0], \nevents[i][1]);
}
</code></pre>
</li>
<li>
<p>此时 \nevents = undefined。访问 undefined.length 或其他属性会导致浏览器挂起？ IE6 还有这样的坑？</p>
</li>
<li>
<p>新建一个最小代码的新页面，直接 <code>script[src]</code> 引入这个脚本没有问题，IE 会正常的抛出异常，不会挂起。</p>
</li>
<li>
<p>动态创建 script 插入脚本，仍然不会挂起，正常抛出异常。</p>
</li>
<li>
<p>奇怪。各种尝试，最终加入前置脚本后在这个最小重现代码中重现了异常。</p>
</li>
<li>
<p>然后发现是在 window.onerror 中出现问题。</p>
</li>
<li>
<p>继续发现的模拟调用栈信息的算法出现问题。</p>
</li>
</ol>
<p>cmd 模块在 define 的 factory 中本身抛出异常，会被前置脚本的 window.onerror 捕获，捕获过程中尝试 <a href="https://github.com/totorojs/monitor.js/blob/2.2.0/src/seer.js#L66" target="_blank" rel="noopener noreferrer">还原函数调用栈</a>。模拟还原调用栈信息是通过 arguments.callee.caller 向上递归，直到找到函数调用的发起者。但是悲剧的是发现 seajs 这个调用栈是无穷无尽的：</p>
<pre><code>at function(require, exports, module)
at function runInModuleContext(fn, module)
at function()
at function(uri)
at function(item, i, arr)
at function(arr, fn)  ........\n
at function(arr, fn)          |
at function()                 |
at function preload(callback) |
at function()                 |
at function cb(module)        |
at function onFetched()       |
at function(fn)       ........\n
at function(arr, fn)    ..........\n
at function(arr, fn)              | 循环往复
at function()                     |
at function preload(callback)     |
at function()                     |
at function cb(module)            |
at function onFetched()           |
at function(fn)         ..........\n
at function(arr, fn) .........\n
at function(arr, fn)          | 无穷尽也
at function()                 |
at function preload(callback) |
at function()                 |
at function cb(module)        |
at function onFetched()       |
at function(fn)         ......\n
</code></pre>
<p>这也就是为什么用户的浏览器会挂起的原因。</p>
<p>\n\n\n\n</p>
<h3 id="小结">小结<a aria-hidden="true" href="#小结">#</a></h3>
<p>用户浏览器被挂起，最终发现：</p>
<p>\n 不是扫描整个文档的性能问题。
\n 不是 seajs 加载多个模块的性能问题。
\n 主要不是 cmd define 中报错的问题。
\n 不是 window.onerror 捕获异常的问题。
\n 而是获取异常函数调用栈出现无限循环链的问题，
\n 这其实是 IE 的问题。
\n 好吧，最终还是我的问题。</p>
<h2 id="监控脚本自身的-cmd-模块定义的异常是怎么出现的">监控脚本自身的 cmd 模块定义的异常是怎么出现的？<a aria-hidden="true" href="#监控脚本自身的-cmd-模块定义的异常是怎么出现的">#</a></h2>
<p>monitor 2.2.0 新增了 <a href="https://github.com/totorojs/monitor.js/issues/18" target="_blank" rel="noopener noreferrer">事件机制</a>，支持监控任意的自定义数据。</p>
<p>其中在前置脚本中新增了 <code>monitor.on()</code> 方法，将自定义事件处理函数临时存储在 <code>monitor.\nEVENTS</code> 属性中 <a href="https://github.com/totorojs/monitor.js/blob/2.2.0/src/seer.js#L18" target="_blank" rel="noopener noreferrer">参考代码</a> 。后置脚本加载完成后，会复写 <code>monitor.on()</code> 方法，并将之前用户自定义事件处理函数绑定到对应事件，以使事件机制生效。</p>
<p>这些理论上都是非常不错的设计思路。</p>
<p>但是现实太残酷，全站公共区域被实际部署的情况有太复杂：</p>
<ol>
<li>有些系统没有完全引入前置脚本。</li>
<li>有些系统仍然引用的老版本的前置脚本。</li>
</ol>
<p>后置脚本对于后面的这个场景没有考虑到，因此这段保险栓未能正确执行导致后续脚本报错。</p>
<h2 id="为什么这个异常会到生产环境">为什么这个异常会到生产环境？<a aria-hidden="true" href="#为什么这个异常会到生产环境">#</a></h2>
<p>都是我的错，没有考虑周全。没有考虑到这种特殊的系统部署环境，而且我也从来不能进去实际体验、验证。</p>
<h2 id="如何处理这个异常">如何处理这个异常？<a aria-hidden="true" href="#如何处理这个异常">#</a></h2>
<ol>
<li>作为全站全局运行的代码，要详细评估考虑到各种系统变态的部署环境。</li>
<li>打断循环调用栈</li>
<li>限制监控的最大函数调用栈深度。</li>
<li>对于已经调用的栈，不再深入递归，或现在递归次数（待评估，实际项目存在正常的递归或多次调用的代码。）</li>
</ol>
<h2 id="为什么-seajs-define-模块中报错会出现函数调用栈无限递归">为什么 seajs define 模块中报错会出现函数调用栈无限递归？<a aria-hidden="true" href="#为什么-seajs-define-模块中报错会出现函数调用栈无限递归">#</a></h2>
<p>这是 seajs 1.3.1 的 BUG，更准确的说，可能是 IE6,7,8闭包的问题。参考： <a href="https://github.com/seajs/seajs/issues/911" target="_blank" rel="noopener noreferrer">https://github.com/seajs/seajs/issues/911</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 5期，由静态资源异常引发的质疑]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-5</link>
            <guid>66</guid>
            <pubDate>Fri, 16 Aug 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-5期由静态资源异常引发的质疑">每周异常：第 5期，由静态资源异常引发的质疑<a aria-hidden="true" href="#每周异常第-5期由静态资源异常引发的质疑">#</a></h1>
<p>今天要说的是一个『静态资源异常监控』的话题。虽然静态资源异常可以非常有效的跟
JavaScript 异常结合起来做有力的分析，但是今天这个话题跟 JavaScript 异常没什么关系。</p>
<p>\n\n\n\n</p>
<p>传说某著名公司的网站监控方案是申请了专利的技术，我有幸看到过，真的是非常牛逼。</p>
<p>这个网站监控方案中提供了网页的访问量、页面访问流向、页面有效点击量、点击热图，
灰度发布（包括 ABTest）等都有完善的支持。</p>
<p>这个方案总体上是用 JavaScript 通过 new Image() 发送监控的数据到日志服务器，
然后由数据仓库做数据清洗。</p>
<p>通过业务系统服务器端的日志分析，这套方案的数据质量有确实有一定的问题，
比如它统计到的访问量要比业务系统服务器端统计到的少，丢失率一般在 5% ~ 10% 左右，
少量特殊页面（比如跳转页）丢失率会高达 50% ~ 60%。</p>
<p>尽管如此我们也基本上可以接受这样的误差，而且部分从理论上讲，『应该』大部分是
无效或无意义的访问（比如爬虫、快速跳转等），丢掉是合理的。</p>
<p>一直以来，我们都认为这个方案的数据是相对比较可靠的，虽然偶尔有些不正常的丢失率
让业务方质疑，但是我们总是用上面的理论和理由解释给对方听，让他们接受我们的现实。</p>
<p>这样过了好多年，他们过着幸福的生活~</p>
<p>\n\n\n\n</p>
<p>直到有个家伙的膝盖被射了一箭，搞出来个静态资源监控系统。</p>
<p>静态资源监控系统是通过分析静态服务器的访问日志，来统计各个资源状态的趋势及其分布情况。</p>
<p>因为静态资源监控是通过静态服务器访问日志来分析的，理论上和业务服务端的日志是一致的。</p>
<p>但是我们惊奇的发现某个静态页面引用了某个不存在的静态资源，异常率理论上应该是 100%，
但是对照网站监控方案统计的数据发现，这个静态资源异常率高达 200%。</p>
<p>我的第一直觉是网站监控丢失率高达 50%。遂跟网站监控相关同学沟通，然后他们第一反映
是质疑我对他们的质疑。</p>
<p>让业务服务端同学统计日志发现他们的访问量确实要大于网站监控访问量，但又小于静态资源异常量。</p>
<p>我虽然毫不怀疑自己的数据，但一时也无法质疑业务服务端的数据。</p>
<p>业务服务端同学随意说了一句：『难道有缓存？』</p>
<p>于是这个疑惑破解了：</p>
<ol>
<li>用户访问页面时，有一部分可能是读取的本地缓存，这部分业务服务端无法统计到。</li>
<li>有些读取缓存的场景不会执行初始化 JavaScript，这些场景网站监控没有统计到。</li>
<li>外联的 404 资源是不会被缓存的。</li>
</ol>
<p>因此这些有缓存的静态页面（这个知名公司有不少页面是这种纯静态、伪静态页面）的场景下，使用 JavaScript 发送监控的监控手段目前丢失率是 50% 左右。</p>
<h3 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h3>
<p>\n <a href="https://stackoverflow.com/questions/3674830/caching%5Cnproblem%5Cnwith%5Cnasynchronous%5Cnjavascript%5Cnloading%5Cnwith%5Cnonload%5Cnevent" target="_blank" rel="noopener noreferrer">Caching problem with asynchronous javascript loading with onload event</a>
\n <a href="https://www.360doc.com/content/11/1219/17/2633%5Cn173430718.shtml" target="_blank" rel="noopener noreferrer">IE6 加载不执行 JS</a>
\n <a href="https://www.360doc.com/content/12/0306/16/2633%5Cn192235974.shtml" target="_blank" rel="noopener noreferrer">IE6 加载不执行 JS 2</a>
\n <a href="https://blog.csdn.net/mlitest/article/details/7368712" target="_blank" rel="noopener noreferrer">因为缓存Page\nLoad不执行的情况</a>
\n <a href="https://segmentfault.com/q/1010000000123673" target="_blank" rel="noopener noreferrer">Opera在点击回退按钮后，原来页面的js都不执行了吗?</a>
\n <a href="https://monket.net/blog/2010/02/detecting%5Cnwhen%5Cna%5Cnpage%5Cnis%5Cnloaded%5Cnfrom%5Cnthe%5Cnbrowser%5Cncache/" target="_blank" rel="noopener noreferrer">Detecting when a page is loaded from the browser cache</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 4期，如何避免客户端攻击造成的大量异常报警]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-4</link>
            <guid>67</guid>
            <pubDate>Wed, 07 Aug 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-4期如何避免客户端攻击造成的大量异常报警">每周异常：第 4期，如何避免客户端攻击造成的大量异常报警<a aria-hidden="true" href="#每周异常第-4期如何避免客户端攻击造成的大量异常报警">#</a></h1>
<p>在 JavaScript 异常监控过程中，发现有很多由于客户端连续攻击造成的大量异常，导致
监控系统报警。</p>
<p><img src="https://f.cloud.github.com/assets/143572/921735/fe39d910%5Cnff04%5Cn11e2%5Cn93f2%5Cnca5bb222be8f.png" alt="2013\n08\n07 9 58 37"></img></p>
<p>（图中大量不连续的波动，都是攻击造成的）</p>
<p>这种少量用户(UV)发起攻击造成的大量异常(PV)波动，不是我们实时监控需要关注的部分。
我们实时监控最重要的是要发现由于系统发布过程中，我们的发布的代码有问题导致大量
用户受影响而出现的波动（波形可能跟上图的每一个异常波形相似）。</p>
<p>理论上导致异常数据波动的场景包括：</p>
<p>\n 少量用户发起大量攻击。
\n 大量用户同时涌入或离开。
\n 发布问题代码影响到大量用户。</p>
<p>少量用户发起大量攻击造成数据波动，是我们可以不必实时关注实时报警的部分。</p>
<p>大量用户同时涌入或离开造成的异常数量(PV)波动，也是我们无需实时关注的部分，
另外我们也可以通过异常率规避波动。</p>
<p>| 场景 | 异常 PV | 异常 UV | 异常率(PV) | 异常率(UV) |
|\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n|
| 攻击 | 波动    | 无波动  | 波动       | 无波动     |
| 涌入 | 波动    | 波动    | 无波动     | 无波动     |
| 发布 | 波动    | 波动    | 波动       | 波动       |</p>
<p>注：</p>
<p>\n 异常率(PV) = 异常PV / 所在页面PV
\n 异常率(UV) = 异常UV / 所在页面UV</p>
<p>从上面的对照表可以看出，理论上我们只需要关注异常率(UV) 是否正常波动就可以了。</p>
<p>理想很性感，现实很骨感。</p>
<p>我们的数据仓库、数据分析系统对于实时 PV 有很强的处理能力，但是对于 UV 就感觉力有不逮。</p>
<p>起初想到在实时日志处理逻辑中使用缓存（伪代码）：</p>
<pre><code>class LogParse(){

  var user\ncache = {};
  var MINUTES\nFORMAT = &quot;YYYYMMDDHHmm&quot;;
  var lastTime = moment().format(MINUTES\nFORMAT);

  function parse(log){
    // PV 统计

    var now = moment().format(MINUTES\nFORMAT);
    if(now !== lastTime){
      user\ncache = {};
      lastTime = now;
    }
    if(user\ncache.hasOwnProperty(user\nid)){return;}
    // UV 统计
  }

}
</code></pre>
<p>\n 但是实时数据分析系统是分布式的，由多台服务器组成的集群同时处理日志，所以里面
的内部状态只有本机有效
\n 另外更致命的是，实时数据分析系统是无状态的，下次执行会 new 新的 LogParser 实例，
同一台机器的状态也保证不了。</p>
<p>于是我们又想到一种从客户端来标识用户的方法：</p>
<ol>
<li>客户端单位时间内同一个页面抛出的同一个异常，第一次打上 uv 标记。</li>
<li>数据处理时遇到 uv 标记的日志，同时统计算做一个异常 uv。</li>
</ol>
<p>由于客户端时间和服务端有时间差，每个客户端时间和服务端时间差也不一致，导致这种
方案会有稍大误差，但也基本能解决问题。</p>
<p>但是要在客户端打标记，则需要在客户端（cookie 或其他本地存储）记录每个异常
（url, file, line, message 相同被当作同一个异常）最后抛出的时间，每次抛出异常
都需要读写本地存储，稍嫌臃肿。</p>
<p>通过深入分析实际的攻击案例，发现攻击引发大量异常的场景中，客户端页面是不刷新或
重新访问的，都是直接在当前访问的页面执行上批量脚本。</p>
<p>因此我们可以使用局部变量，将当前访问的页面的每个异常最后抛出时间记录在内存中，
重新访问页面则重新开始记录。</p>
<p>这种方案对于防范攻击造成的大量异常非常有效；对于大量用户涌入引起的异常也有一定
效用，毕竟正常用户较少会频繁触发异常。</p>
<p>总之，通过这个方案，我们可以非常有效的实时监控异常波动，较少误报。</p>
<p>p.s. 这个想法是早上洗澡的时候想到的，还没开始实践。但是我信心满满写下这篇，
数据会来证明我是对的。</p>
<h2 id="续-on-2013n08n20">续 on 2013\n08\n20<a aria-hidden="true" href="#续-on-2013n08n20">#</a></h2>
<p>是时候结帐了。正好发布一天，大家看数据：</p>
<p><img src="https://f.cloud.github.com/assets/143572/991796/2e2038c2%5Cn096e%5Cn11e3%5Cn9008%5Cne21d3b9e354a.png" alt="2013\n08\n20 3 55 10"></img></p>
<p>图中的灰色竖线是发布点，橙色是 JavaScript 异常，绿色是静态资源异常。</p>
<p>妈妈再也不用担心我的手机会收到误报的报警短信了。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[每周异常：第 3期，宏观异常分析方法]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-3</link>
            <guid>68</guid>
            <pubDate>Fri, 02 Aug 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-3期宏观异常分析方法">每周异常：第 3期，宏观异常分析方法<a aria-hidden="true" href="#每周异常第-3期宏观异常分析方法">#</a></h1>
<p>为了有效的分析 JavaScript 异常，我们从宏观的统计数据中做了大量的分析，初步结果如下：</p>
<h2 id="全站每日异常统计">全站每日异常统计<a aria-hidden="true" href="#全站每日异常统计">#</a></h2>
<p>首先我们从每天的全站总体数据进行分析，得到下面这些报表。其中：</p>
<p>\n all\npv: 全站所有有效异常次数 (PV)
\n all\nuv: 全站所有有效异常人数 (UV)
\n all\npv\nrate: 全站所有异常率 (按 PV 统计)
\n all\nuv\nrate: 全站所有异常率 (按 UV 统计)
\n valid\nrate\npv: 有效异常率（按 PV 统计）
\n valid\nrate\nuv: 有效异常率（按 UV 统计）</p>
<p><img src="https://f.cloud.github.com/assets/143572/900597/98aa3094%5Cnfb68%5Cn11e2%5Cn9f9e%5Cnc3809ea15b48.png" alt="2013\n08\n02 7 42 02"></img></p>
<p><img src="https://f.cloud.github.com/assets/143572/900599/ac59ccb2%5Cnfb68%5Cn11e2%5Cn89c3%5Cn4e0d6db7261f.png" alt="2013\n08\n02 7 42 37"></img></p>
<p><img src="https://f.cloud.github.com/assets/143572/900625/c145cbac%5Cnfb69%5Cn11e2%5Cn80c7%5Cnd1f9152ddeb4.png" alt="2013\n08\n02 7 50 11"></img></p>
<p><img src="https://f.cloud.github.com/assets/143572/900601/bbc1e3a6%5Cnfb68%5Cn11e2%5Cn85e7%5Cnb6443f502860.png" alt="2013\n08\n02 7 43 04"></img></p>
<p><img src="https://f.cloud.github.com/assets/143572/900602/cd4f7f0c%5Cnfb68%5Cn11e2%5Cn96b8%5Cn2de40b5d2882.png" alt="2013\n08\n02 7 43 31"></img></p>
<p>从趋势图中我们可以明显的看到第 2天和最后一天，异常 PV 有较大波动，这是由于用户
攻击爆发大量异常造成的。</p>
<p>我们在 <a href="https://github.com/totorojs/javascript%5Cnexception%5Cnarchives/issues/12" target="_blank" rel="noopener noreferrer">异常评分算法</a>
的讨论中有提到，即使是少量用户进行攻击，异常 UV 也不应该有波动的（除非页面 UV
本身有较大波动），但是实际上我们看到最后一天的异常 UV 也有明显波动，因此粗略
分析这个异常 PV 的上升是由于页面访问人数增多造成的。</p>
<p>事后我们查了当天的页面访问 PV 和 UV，可惜并没有明显波动。</p>
<p>实际经过细致的异常日志分析，我们看到攻击用户同时没过一段时间就更换 IP 地址或清理
Cookie，因此全天的综合数据中异常 PV  和异常 UV 有了一些明显波动。</p>
<p>而且实际上，每天都有攻击造成的异常波动。
\n 每天都有攻击造成的异常，累加在一起好像每天都没什么问题。
\n 由于攻击造成异常总数相对一天的异常总数太小，从全天异常总数的层面来看，
无法发现，甚至排除攻击造成的异常。
\n T+1 的统计数据，对于异常监控来说，太迟钝了。</p>
<h2 id="全站每分钟异常统计">全站每分钟异常统计<a aria-hidden="true" href="#全站每分钟异常统计">#</a></h2>
<p>从上面每日异常总和的分析我们可以看出，一天的总和数据能发现的问题还是比较有限的。
于是我从分钟的粒度来统计异常。</p>
<p><img src="https://f.cloud.github.com/assets/143572/900781/7496f1e6%5Cnfb6e%5Cn11e2%5Cn854f%5Cn1a0f685bea15.png" alt="2013\n08\n02 7 24 54"></img></p>
<p>图有点大，点击可以看大图。</p>
<p>从图中我们可以看到，凌晨 2点多到 3点多期间，有少量用户发起了猛烈的攻击；
凌晨 4点多到凌晨7点多期间也有少量温和的攻击。攻击时全站异常 PV （绿色）
和全站有效异常（深红色）明显飙升，但是异常 UV 和有效异常 UV 都没有太大波动，
而且与前后的时间切片有较好的连贯性，没有大起大落。</p>
<p>而如果异常 UV 出现较大波动，在很可能是由于我们正在发布的新代码影响大面积用户。</p>
<p>合适的时间粒度对于及时发现真正有效的异常有非常重要的意义。</p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-2-2</link>
            <guid>70</guid>
            <pubDate>Tue, 23 Jul 2013 00:00:00 GMT</pubDate>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-2</link>
            <guid>69</guid>
            <pubDate>Mon, 22 Jul 2013 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[每周异常：第 1 期]]></title>
            <link>https://hotoo.github.io/blog/post/weekly-topic-about-exceptions-1</link>
            <guid>71</guid>
            <pubDate>Mon, 15 Jul 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="每周异常第-1-期">每周异常：第 1 期<a aria-hidden="true" href="#每周异常第-1-期">#</a></h1>
<p>2013\n07\n15 14:00~14:03，来自<a href="https://www.ip.cn/?q=180.184.99.37" target="_blank" rel="noopener noreferrer">北京市时代互联(180.184.99.37)</a>
的 pc/\n1|windows/6.2|firefox/22.0|gecko/20100101 用户向支付宝 katongweb 系统发起1480次猛烈的总攻。</p>
<p>详情如下：</p>
<p>| KEY        | VALUE                                 |
|\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
| Ref        | <a href="https://ref.example.com/ref.htm" target="_blank" rel="noopener noreferrer">https://ref.example.com/ref.htm</a>       |
| URL        | <a href="https://www.example.com/index.htm" target="_blank" rel="noopener noreferrer">https://www.example.com/index.htm</a>     |
| File       | chrome://grabword/content/grabword.js |
| Line       | 0                                     |
| Message    | Script error.                         |
| stacktrace |                                       |</p>
<p>该用户通过 Ref 页面到目标 URL 之后，连续不断的通过 Firefox 插件脚本触发脚本异常。</p>
<p>\n\n\n\n</p>
<p>通过最近的几次异常报警来看，由客户端连续发起攻击引起的 JavaScript 异常 PV
非正常波动，对异常监控数据有比较大的影响。</p>
<p>因此考虑以下方案来提升监控数据的稳定有效性：</p>
<p>\n 监控 JavaScript 异常 UV(根据 Session)
\n 监控 JavaScript 异常独立 IP 数。
\n 排除客户端本地脚本引起的异常（多数攻击是由客户端脚本发起）
\n 今日客户端脚本异常率：45.14%
\n 正常情况下客户端脚本异常率：3.45%</p>
<p>\n\n\n\n</p>
<p>下图是排除了客户端本地脚本抛出的异常之后的结果：</p>
<p><img src="https://f.cloud.github.com/assets/143572/803190/d77e2dea%5Cnede7%5Cn11e2%5Cn92cb%5Cn1717857ecdbc.png" alt="2013\n07\n16 3 14 24"></img></p>
<p>（当天数据对比，图中圆点是开启过滤客户端本地异常的时间点，下同）</p>
<p><img src="https://f.cloud.github.com/assets/143572/803189/d77f22cc%5Cnede7%5Cn11e2%5Cn9412%5Cn25920ec1c4d6.png" alt="2013\n07\n16 3 16 22"></img></p>
<p>（相近2天数据对比）</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[『已结束』庆祝 Vim 7.4 发布，发起团购 Tee + 团捐活动(2013)]]></title>
            <link>https://hotoo.github.io/blog/post/vim74-tee</link>
            <guid>72</guid>
            <pubDate>Sun, 26 May 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="已结束庆祝-vim-74-发布发起团购-tee--团捐活动2013">『已结束』庆祝 Vim 7.4 发布，发起团购 Tee + 团捐活动(2013)<a aria-hidden="true" href="#已结束庆祝-vim-74-发布发起团购-tee--团捐活动2013">#</a></h1>
<blockquote>
<p>团购活动已经结束，但你仍然可以自行印制或购买
团捐活动已经结束，但你仍然可以 <a href="https://www.vim.org/sponsor/index.php" target="_blank" rel="noopener noreferrer">自行捐助</a></p>
</blockquote>
<p>\n\n\n\n</p>
<blockquote>
<p>本次活动有 41人参加，团购 Tee 47件。
最终以 <a href="https://www.vim.org/account/profile.php?user%5Cnid=66604" target="_blank" rel="noopener noreferrer">@vimcn</a> 的身份
捐赠 159欧元，实际人民币 1377.94元。
参加团捐的同学请查收邮件并于 2013年10月份之前行使您的 Vim 新特性赞同或反对票。</p>
</blockquote>
<p>于 2013年08月10日发发布的 Vim 7.4 的主要特性更新如下：</p>
<ol>
<li>增强 Python 支持；</li>
<li>内置更快的正则表达式引擎；</li>
<li>bugs fix.</li>
</ol>
<p>为了庆祝这一重大的事件，发起这次团购 VimTee + 团队捐助的活动。
活动截至 2013年08月15日，请有兴趣的同学火速参与。</p>
<h2 id="tee">Tee<a aria-hidden="true" href="#tee">#</a></h2>
<p>\n 初步确定为 POLO 男款（店家没有专门的女款，抱歉 :( 如果你不介意，这款女生穿着也很帅 ：)）
\n 个人觉得需要适当增大胸前的胶印 LOGO。待讨论确定。
\n 增加个性袖标。</p>
<blockquote>
<p>:version
VIM \n Vi IMproved 7.4 (2013 Aug 10)
@hotoo</p>
</blockquote>
<p>由于袖标需要使用正确的时间，所以 Tee 的印刷需要在 Vim 正式发布之后。</p>
<p><img src="https://img02.taobaocdn.com/bao/uploaded/i6/T1ziidXfXxXXXjwAs.%5Cn113128.jpg%5Cn310x310.jpg" alt="vimtee\ngreen"></img>
<img src="https://img02.taobaocdn.com/imgextra/i2/54677444/T21zBqXbxMXXXXXXXX%5Cn!!54677444.jpg%5Cn310x310.jpg" alt="vimtee\nblue"></img>
<img src="https://img03.taobaocdn.com/imgextra/i3/54677444/T2BjJqXaBMXXXXXXXX%5Cn!!54677444.jpg%5Cn310x310.jpg" alt="vimtee\nblack"></img></p>
<h3 id="局部特写">局部特写：<a aria-hidden="true" href="#局部特写">#</a></h3>
<p><img src="https://img03.taobaocdn.com/imgextra/i3/54677444/T2EnXpXa0MXXXXXXXX%5Cn!!54677444.jpg" alt=""></img></p>
<h3 id="尺码">尺码：<a aria-hidden="true" href="#尺码">#</a></h3>
<p>我个人喜欢穿稍微宽松的 Tee，一般会买大一号的，仅作参考 :)</p>
<p>通用款   | M       | L       | XL      | XXL
\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n
适合身高 | 165~170 | 170~175 | 175~180 | 180~190
胸围     | 98      | 104     | 116     | 121
衣长     | 67      | 70      | 75      | 78
肩宽     | 42      | 45      | 48      | 50</p>
<p>\n\n\n\n</p>
<p><a href="https://www.freewear.org/?page=show%5Cnitem&amp;id=FW0041" target="_blank" rel="noopener noreferrer">官方推荐的 Tee</a> 要 18.5欧元，
将近 150元人民币，其中每件会捐助 3欧元（相当于24元人民币）给 Vim。
相对来说很贵，而且还需要从国外运到国内，会麻烦很多（可能还需要关税）。</p>
<p>所以组织在国内自印，会划算靠谱很多。这个 Tee 的质量更好，大概只需要其 2/3 的价格，
就可以捐助给 Vim 多一倍的爱心。</p>
<h2 id="捐助">捐助<a aria-hidden="true" href="#捐助">#</a></h2>
<p>每件 Tee 需要额外的 20元左右的人民币，以 vimcn 团队的身份捐助给 Vim 以帮助乌干达
可怜的儿童。</p>
<h2 id="报名">报名<a aria-hidden="true" href="#报名">#</a></h2>
<p>\n 每件 Tee 的价格在 65~70 元左右；
\n 快递费另外算。可以同城合并快递，线下认识下也不错。
\n 我可以代收杭州的部分。
\n 其他地区的同学如果同意被代收，我会随机选同城的一位同学代收。</p>
<p>邮件发送以下内容到

（点击链接即可）</p>
<blockquote>
<p>尺码：
颜色：军绿色|蓝色|黑色|白色
袖标信息：例如 <code>@hotoo</code>
件数：默认 1件
联系方式（手机或固话）：
收货人姓名：
收货地址和邮编：</p>
<p>是否同意同城代收或被代收？
是否有必要适当增大胸前 LOGO？
袖标印在左手还是右手？</p>
</blockquote>
<p>报名截至时间：Vim 7.4 正式发布之日。</p>
<p>费用待团购数量及折扣程度，和快递费用确定之后通知大家。</p>
<h2 id="声明">声明<a aria-hidden="true" href="#声明">#</a></h2>
<p>这是一次庆祝、纪念的活动，另外还兼有公益的团队捐助活动。</p>
<p>如果你对 Tee 的设计不满意，可以自行设计印制。你也可以以个人身份捐助 Vim。</p>
<h2 id="有图有真相">有图有真相<a aria-hidden="true" href="#有图有真相">#</a></h2>
<p><img src="/images/blog/vimtee74.png" alt="vimtee74"></img></p>
<p><img src="/images/blog/vimtee74%5Cnlogo.png" alt="vimtee74\nlogo"></img></p>
<p><img src="/images/blog/vimtee74@hotoo.png" alt="vimtee74@hotoo"></img></p>
<h2 id="vimtee-回顾">VimTee 回顾<a aria-hidden="true" href="#vimtee-回顾">#</a></h2>
<ol>
<li>
<p>2010年7月，Vim 7.3 发布的时候，我组织了一次
<a href="https://hotoo.github.io/blog/post/vim73%5Cntee.html" target="_blank" rel="noopener noreferrer">团购 VimTee</a> 的活动。</p>
</li>
<li>
<p>2011年应邀又组织了一次 <a href="https://hotoo.github.io/blog/post/vim%5Cntee%5Cn2.html" target="_blank" rel="noopener noreferrer">趣味 Vim Tee</a>
的活动。</p>
</li>
<li>
<p>2012年由于种种原因我没有组织。</p>
</li>
<li>
<p>2013年5月，Vim 7.4 即将发布，我想再发起一次组织团购 VimTee 的活动。</p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[JavaScript 异常档案]]></title>
            <link>https://hotoo.github.io/blog/post/javascript-exceptions-archives</link>
            <guid>73</guid>
            <pubDate>Wed, 22 May 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-异常档案">JavaScript 异常档案<a aria-hidden="true" href="#javascript-异常档案">#</a></h1>
<p><img src="/images/blog/ie6%5Cnen.jpg" alt="IE6"></img></p>
<p><img src="/images/blog/ie8.jpg" alt="IE8"></img></p>
<p>作为前端工程师，看到上面的异常，我们该如何进行排查？</p>
<ol>
<li>根据异常所在文件及其异常所在行，找到引发异常的相关代码附近，
对代码进行分析？</li>
<li>然后呢？就只能依靠我们以往的经验进行猜测和尝试了。</li>
<li>没有这个异常的相关经验？哪有这么巧的事情？好吧，那你悲剧了。</li>
<li>呃，Google 吧，也许 Bing 或 Baidu 也有点答案。</li>
<li>试过了各种各样的关键词，打开了 N 多个 tab 页。。。</li>
<li>然后也许你搜索到了散落在 MSDN，CSDN，蓝色理想，某某个人博客的一些只言片语？</li>
<li>看到楼主给出的好多行无关代码，接下来是其他热心观众的猜测，试试这个、试试那个。</li>
<li>还是不行啊，急，在线等。</li>
<li>然后就没有了然后。。。</li>
</ol>
<p><img src="/images/blog/bugs.png" alt="bugs"></img></p>
<p>\n\n\n\n</p>
<p>各位同学，我们在排查调试 JavaScript 异常时，是不是经常感觉到乏力呢？</p>
<p>\n JavaScript 作为一门弱类型动态编程语言，在调试、排查异常方面一直都非常薄弱。
\n 客户端浏览器种类、版本、用户语言环境繁多，同样一个异常，在不同浏览器中表现和反馈都不同。
\n 尤其面对某某大牌浏览器厂商埋下高质量的坑，一般人还真没办法发现或解决。
\n 每个浏览器厂商的开发者文档或社区都是独立的，各种异常文档或分享散落各个社区或者个人博客中。</p>
<p>凡此种种，我都觉得有必要建立这样的一套异常档案，他可以：</p>
<p>\n 对于已知或未知的 JavaScript 异常，都存档有对应的异常信息、场景上下文、源码片段、
对应的分析说明、及核心异常代码演示。
\n 长久的存在，不因时间的流逝、博客的关闭、URL 的变更等等原因而消逝。
\n 开放，分享和交流每个人的异常分析经验，让异常分析经验和知识更为普及和提升。</p>
<p><img src="/images/blog/no%5Cnbugs.jpg" alt="bugs"></img></p>
<p>\n\n\n\n</p>
<p>因此，我们在 Github 上初步建立了一个
『 <a href="https://github.com/totorojs/javascript%5Cnexception%5Cnarchives" target="_blank" rel="noopener noreferrer">JavaScript 异常档案</a> 』
的开源项目。任何人都可以 fork、提交 issues、评论、邮件、或社区推广等各种方式来参与。</p>
<p>等一下，你突然发现了这么一个页面：
<a href="https://errors.totorojs.org/wiki/object%5Cndoesnot%5Cnsupport%5Cnthis%5Cnproperty%5Cnor%5Cnmethod" target="_blank" rel="noopener noreferrer"></a>
<a href="https://github.com/totorojs/javascript%5Cnexception%5Cnarchives/blob/master/content/wiki/object%5Cndoesnot%5Cnsupport%5Cnthis%5Cnproperty%5Cnor%5Cnmethod.md" target="_blank" rel="noopener noreferrer"></a>
这个页面里有这个异常在各个语种下的异常消息描述，同一个异常代码在不同浏览器里的
详细分析，还有有血有肉的实际案例分析，关键代码，实际异常演示页，，，
可能还很不完善，还需要我们一起来参与，但是泪奔的感觉有木有~</p>
<p>\n\n\n\n</p>
<p>希望有一天：</p>
<p>\n 我们遇到的脚本异常都可以在这个档案中找到原因、解决或规避的方案。
\n 我们分析的脚本异常都可以出现在这个档案中以惠及他人。</p>
<p>最良好的祝愿！</p>
<p><img src="/images/blog/exception.jpg" alt="bugs"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[JavaScript Strict Mode]]></title>
            <link>https://hotoo.github.io/blog/post/use-strict-mode</link>
            <guid>74</guid>
            <pubDate>Sun, 19 May 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-strict-mode">JavaScript Strict Mode<a aria-hidden="true" href="#javascript-strict-mode">#</a></h1>
<p>ECMAScript 5 定义了严格模式。开发者在代码中写上 <code>&quot;use strict&quot;</code> 标识，浏览器就会
按照严格模式来执行 JavaScript。</p>
<p>而且还非常强大的支持局部作用域，不影响其他外部作用域使用非严格模式。
多么贴心的服务。</p>
<p>很多人（包括我之前）的直觉会认为这是非常好的特性，向前兼容，严格模式也必定是未来的趋势。</p>
<p>但是我想说的是：严格模式是未来的趋势也许没有错，但绝对不会是让开发者手工在各个
作用域中到处写 <code>&quot;use strict&quot;</code>。</p>
<p>使用严格模式是开发者的事，所以最重要、也是最直接有效的方式是在开发阶段就完成
严格模式的所需的所有工作，包括代码静态分析、校验等待。<code>&quot;use strict&quot;</code> 选项应该
在 IDE/编辑器中配置而不是写在代码中。</p>
<p>同时像 HTML 的严格模式一样，浏览器运行时使用严格/非严格模式只需要在 DOCTYPE
中声明一次，而无需不同作用域使用不同的模式。</p>
<p>肯定有人站出来说，对于历史遗留的非严格模式的代码怎么办，支持作用域模式不是应该
考虑的兼容性问题么？</p>
<p>确实，历史遗留代码的兼容性问题比较麻烦，我很同情我们。</p>
<p>但是想想我们从 HTML 转到 XHTML 的痛苦经历，难道我们应该允许文档中某些 DOM
片段是不标准的，另外一些片段写上一些特殊属性声明自己是遵循标准使用严格模式的吗？</p>
<p>完全没有，我们只有一个 DOCTYPE。</p>
<p>不标准的代码只有重写，就是这样。</p>
<p>\n\n\n\n</p>
<p>我认为：</p>
<p>\n 严格模式是未来的趋势。
\n 严格模式应该在 IDE/编辑器和浏览器中声明。
\n 严格模式无需也不应该在各个 JavaScript 作用域片段中到处声明。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://dmitrysoshnikov.com/ecmascript/es5%5Cnchapter%5Cn2%5Cnstrict%5Cnmode/" target="_blank" rel="noopener noreferrer">ECMA\n262\n5 in detail. Chapter 2. Strict Mode.</a>
\n <a href="https://blog.csdn.net/liumf2005/article/details/7427700" target="_blank" rel="noopener noreferrer">译：It’s time to start using JavaScript strict mode</a>
\n <a href="https://ejohn.org/blog/ecmascript%5Cn5%5Cnstrict%5Cnmode%5Cnjson%5Cnand%5Cnmore/" target="_blank" rel="noopener noreferrer">ECMAScript 5 Strict Mode, JSON, and More</a>
\n [Strict Mode (JavaScript)](<a href="https://msdn.microsoft.com/en%5Cnus/library/ie/br230269(v=vs.94%5C).aspx" target="_blank" rel="noopener noreferrer">https://msdn.microsoft.com/en\nus/library/ie/br230269(v=vs.94\).aspx</a>)
\n <a href="https://caioproiete.net/en/what%5Cndoes%5Cnuse%5Cnstrict%5Cndo%5Cnin%5Cnjavascript/" target="_blank" rel="noopener noreferrer">What does “use strict” do in JavaScript?</a>
\n <a href="https://stackoverflow.com/questions/1335851/what%5Cndoes%5Cnuse%5Cnstrict%5Cndo%5Cnin%5Cnjavascript%5Cnand%5Cnwhat%5Cnis%5Cnthe%5Cnreasoning%5Cnbehind%5Cnit" target="_blank" rel="noopener noreferrer">What does “use strict” do in JavaScript, and what is the reasoning behind it?</a>
\n <a href="https://www.cnblogs.com/sniper007/archive/2012/10/30/2746482.html" target="_blank" rel="noopener noreferrer">JavaScript语法支持严格模式：”use strict”</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[就近原则：JavaScript 块级作用域的变量定义]]></title>
            <link>https://hotoo.github.io/blog/post/block-scope-variable-defined</link>
            <guid>76</guid>
            <pubDate>Thu, 25 Apr 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="就近原则javascript-块级作用域的变量定义">就近原则：JavaScript 块级作用域的变量定义<a aria-hidden="true" href="#就近原则javascript-块级作用域的变量定义">#</a></h1>
<blockquote>
<p>代码是写给人看的，顺便给机器执行。[1]</p>
</blockquote>
<h2 id="引子">引子<a aria-hidden="true" href="#引子">#</a></h2>
<p>上周有位前端同学周报里分享了段 for 循环的『好代码』：</p>
<pre><code>
for (var i = 0, item; item = list[i]; i++) {
  // 将 ltem = list[i]当做条件判断语句，当i下标溢出时，返回undefined，循环结束
  // 居然省了一个变量呢～
}
</code></pre>
<p>这位同学是看了 jQuery 里类似下面这种用法之后做的这个分享：</p>
<pre><code>// If no nodeType, this is expected to be an array
for ( ; (node = elem[i]); i++ ) {
    // Do not traverse comment nodes
    ret += getText( node );
}
</code></pre>
<p>jQuery 还有不少地方使用这种用法，也有不少地方是传统的使用 length 方法。
但是 jQuery 这样用有其特定场景，需要正视。我回复说：</p>
<ol>
<li>如果数组项中有 0, false, null, undefined, ""，代码就出 bug 了。</li>
<li>好像没看到少了变量，一定要少的话，典型的 for 写法也可以少（但是不推荐）。</li>
<li>代码是写给人读的，顺便给机器执行。</li>
<li>另外，对 list 本身有操作，尤其是长度有影响的操作要特别注意。</li>
</ol>
<p>我个人推荐下面这种写法：</p>
<pre><code>for(var i = 0, l = list.length; i &lt; l; i++){
    list[i]
}
</code></pre>
<p>p.s. 使用 Vim snipMate 的同学可以参考
<a href="https://github.com/hotoo/snipmate.vim/blob/master/snippets/javascript.snippets#L56" target="_blank" rel="noopener noreferrer">javascript.snippet</a>
这个代码片段模板。</p>
<p>好了，使用溢出判断数组循环结束的讨论到此就结束了，但是好戏还在后头。</p>
<p>由于 JavaScript 作用域的问题，有同学建议说将 <code>i</code>, <code>l</code> 变量定义在 <code>for</code> 循环之外。
于是进入另一个变量定义的话题。</p>
<h2 id="如何定义块级作用域中使用的变量">如何定义块级作用域中使用的变量？<a aria-hidden="true" href="#如何定义块级作用域中使用的变量">#</a></h2>
<p>持有变量应前置定义观点的同学，估计有不少是受了《JavaScript 权威指南》或其他权威著作的影响。</p>
<p>《JavaScript 权威指南》第 4 章 4.3.1 小节 [2] 详细分析了块级作用域中变量定义的问题。</p>
<p>由于 JavaScript 只有函数作用域，没有块级作用域，因此在 <code>for</code>, <code>if/else</code>,
<code>do/while</code>, <code>switch/case</code>, <code>try/catch</code> 这些块中定义的变量，实际在块之外也可以使用。</p>
<pre><code>function functionScope(){
    for(var i=0,l=5; i&lt;l; i++){
        var blockVariable = i;
    }
    alert(i); // 5
    alert(blockVariable); // 4
}
</code></pre>
<p>例如上面的代码，在 for 这个块之中定义的变量，在 for 之外也可以使用。
这在其他支持块级作用域(如C/C++ [3], Java)的编程语言中是无法理解，甚至不可接受的。</p>
<p>这是 JavaScript 设计的 BUG，书中作者建议将所有变量声明集中放置在函数开头，
说这是个好习惯。</p>
<blockquote>
<p>This example illustrates why it is good programming practice to place all of
your variable declarations together at the start of any function.</p>
</blockquote>
<p>JavaScript 传教士老道也有
[类似的教诲](<a href="https://javascript.crockford.com/code.html#variable" target="_blank" rel="noopener noreferrer">https://javascript.crockford.com/code.html#variable</a> declarations)：</p>
<blockquote>
<p>The var statements should be the first statements in the function body.</p>
<p>...</p>
<p>JavaScript does not have block scope, so defining variables in blocks can
confuse programmers who are experienced with other C family languages.
Define all variables at the top of the function.</p>
</blockquote>
<p>他们的理由是，既然在块级作用域之内定义的变量可以被块级作用域之外使用，
那么就应该把变量定义在块级作用域之外，让它们看起来和它们实际的作用域表现一致。</p>
<pre><code>function functionScope(){
    var i, l=5, blockVariable;

    // more codes ...

    for(i=0; i&lt;l; i++){
        blockVariable = i;
    }
}
</code></pre>
<p>\n\n\n\n</p>
<p>但是这个我稍微持不同的观点 ：）</p>
<p>实际上我们定义 <code>i</code>, <code>l</code> 是为了给 <code>for</code> 用的，JavaScript 解释器在执行的时候可以
给块级作用域外面用，不代表就应该定义在外面。
定义在外面给人的暗示是这个变量是给整个 function 用的，而不只是 for 循环，
就会给人『在外面用也没关系』的错觉。但这其实不是我们定义 <code>i</code>, <code>l</code> 的本意。</p>
<p>另外变量前置声明，会导致变量声明、定义和使用之间分离，变量含义自我解释性被削弱，
而且容易造成误清理、或遗漏清理变量的问题。</p>
<p>对于 JavaScript 的这个糟粕，让人来适应机器的问题而修改代码，甚至改变本性习惯，
和另一个使用逗号连续定义变量的话题是何其的相似。
为什么不让机器来适应人，在编辑器中编辑、或在编译器中编译 JavaScript 代码时，
发现块级作用域之外有使用块级作用域内部定义的变量时，给予恰当的警告。
这是否更合理呢。</p>
<p>如果遵循权威的教诲，把变量定义在函数前面，编辑器和编译器都没有办法帮我们了。</p>
<p>我认为：</p>
<ol>
<li>定义在块级作用域之内的变量不应该被块级作用域之外使用。</li>
<li>如果被块级作用域之外使用了：
<ol>
<li>
<p>要么这是一个错误的用法，会带来隐患。
\n人、编辑器、编译器、甚至将来的解释器可以发现这个问题并给出警告。\n</p>
</li>
<li>
<p>或者确实有这样的使用需求，那么这个变量应该被声明在块级作用域之外。</p>
</li>
</ol>
</li>
</ol>
<p>所以我比较认同 <code>就近原则</code> [4] 这种更合理、更人性的风格。</p>
<p>\n 文档、注释应尽可能的靠近代码。
\n 变量声明应尽可能的靠近变量使用。
\n 应尽量限制变量的作用域。</p>
<h2 id="那么">那么<a aria-hidden="true" href="#那么">#</a></h2>
<p>请问你持什么样的观点呢？</p>
<p>\n\n\n\n</p>
<h3 id="注">注<a aria-hidden="true" href="#注">#</a></h3>
<ol>
<li>
<p>出自《Structure and Interpretation of Computer Programs》，中文版《计算机程序的构造和解释》</p>
<blockquote>
<p>Thus, programs must be written for people to read, and only incidentally
for machines to execute.</p>
<p>\n\n by Harold Abelson and Gerald Jay Sussman with Julie Sussman</p>
</blockquote>
</li>
<li>
<p>《JavaScript 权威指南》第六版章节和标题有所变更。第六版对应章节在第 3 章
第 3.10.1 小节：函数作用域和声明提前。
第六版中，关于变量声明提前的结束语中相对中立了很多。</p>
<blockquote>
<p>In programming languages with block scope, it is generally good programming
practice to declare variables as close as possible to where they are used and
with the narrowest possible scope. Since JavaScript does not have block scope,
some programmers make a point of declaring all their variables at the top of
the function, rather than trying to declare them closer to the point at which
they are used. This technique makes their source code accurately reflect the
true scope of the variables.</p>
</blockquote>
<p>大意是说：
在支持块级作用域的编程语言中，变量就近定义是一个非常好的编程实践。
变量定义尽量靠近变量使用，变量尽量限制在最小的作用域之内。
由于 JavaScript 没有块级作用域，一些程序员提出将变量定义在函数的顶部，
而不是靠近使用变量的地方。这使得源码准确反映了其真正的作用域范围。</p>
</li>
<li>
<p>早在 <a href="https://flash%5Cngordon.me.uk/ansi.c.txt" target="_blank" rel="noopener noreferrer">C89 规范</a> 中，规定了变量必须声明在作用域的最前面，
但是 <a href="https://www.open%5Cnstd.org/jtc1/sc22/wg14/www/docs/n1336.pdf" target="_blank" rel="noopener noreferrer">C99</a>
和 C++ 取消了这个限制，支持就近声明变量。</p>
<p>由于就近声明可以让变量作用于恰当的作用域之中，而且变量声明更靠近变量的使用，
因此也更容易理解。<code>就近原则</code> 在很多编程语言当中都是最佳实践，JavaScript 也不例外。</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/The%5CnProximity%5CnPrinciple" target="_blank" rel="noopener noreferrer">就近原则(The Principle of Proximity)</a> 是一项社会心理学
的理论，实际在 <a href="https://www.approxion.com/?p=120" target="_blank" rel="noopener noreferrer">计算机编程</a> 、
<a href="https://desktoppub.about.com/od/designprinciples/tp/Principles%5Cnof%5CnDesign.htm" target="_blank" rel="noopener noreferrer">视觉设计</a> 、
<a href="https://www.webdesignerdepot.com/2010/01/the%5Cnprinciple%5Cnof%5Cnproximity%5Cnin%5Cnweb%5Cndesign/" target="_blank" rel="noopener noreferrer">网页设计</a>
领域也有很多的延伸与实践。</p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Github 的 404 页面是个好路由]]></title>
            <link>https://hotoo.github.io/blog/post/github-404-is-a-good-route</link>
            <guid>75</guid>
            <pubDate>Sun, 24 Mar 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="github-的-404-页面是个好路由">Github 的 404 页面是个好路由<a aria-hidden="true" href="#github-的-404-页面是个好路由">#</a></h1>
<p>上周五周会上 @玉伯 做了个微分享：由于新浪微博的 BUG，不会将 https 的 URL 自动
转成可点击的链接，于是玉伯给 lifesinger.github.com Project 做了个 index.html
页面：</p>
<pre><code>&lt;script&gt;
  var id = parseInt(location.search.substring(1))
  location.replace(
      &#39;https://github.com/lifesinger/lifesinger.github.com/issues&#39; +
          (id ? &#39;/&#39; + id : &#39;?labels=blog&#39;))
&lt;/script&gt;
</code></pre>
<p>然后就可以通过 <a href="https://lifesinger.github.com/?126" target="_blank" rel="noopener noreferrer"><a href="https://lifesinger.github.com/?126" target="_blank" rel="noopener noreferrer">https://lifesinger.github.com/?126</a></a>
这个链接来访问对应的 issues (玉伯的博客使用 Github 的 issues 管理发布)</p>
<p>我看到这个 URL 第一感觉是不爽，立即想到可以用 404 页面来做路由跳转页，然后访问
地址可以改成 <code>https://lifesinger.github.com/126</code> 这样。</p>
<p>于是玉伯的分享完败，也为下一个我要做的分享加了分 XD</p>
<p>今天仔细想了想，使用 404 页面做路由跳转的思路本身很不错，
但是 <code>https://lifesinger.github.com/126</code> 这样的 URL 其实是不具有可扩展性的，
也没有良好的语义性，而且也不是很好验证 URL 的业务合法性。于是可以改成如下：</p>
<p><code>https://lifesinger.github.com/blog/126</code></p>
<p>好了，根据 URL 前缀信息，404 页面可以扩展成你需要的任意路由跳转页，
或者非路由的 404 原始页了。</p>
<p>散花~</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[个人资金管理软件]]></title>
            <link>https://hotoo.github.io/blog/post/personal-financial-manage-soft</link>
            <guid>78</guid>
            <pubDate>Sun, 17 Feb 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="个人资金管理软件">个人资金管理软件<a aria-hidden="true" href="#个人资金管理软件">#</a></h1>
<p>过年花掉不少钱，而其中有一部分是喜酒之类的礼金，按照礼尚往来的习俗，这些礼金
早晚都是要被送回来的，而被送回来的途径，则是喜酒回请。</p>
<p>这些俗礼，即使不是为了收回礼金，回请对方也是必须的。</p>
<p>为了避免忘记吃过的酒席（前几年的都忘记差不多了），也为了对自己的资金有更清晰
的掌握，于是开始记账。</p>
<p>我现在用上了 Macbook Pro 和 iPhone，于是想找一个可以运行于 Mac OSX 和 iOS 平台
的软件，两者同步数据是必须的要求。毕竟移动设备记账有很多的便利优势，而 PC 做
更细致的管理与分析则更为方便和强大。</p>
<h2 id="gnucash">GNUCash<a aria-hidden="true" href="#gnucash">#</a></h2>
<p><a href="https://www.gnucash.org/" target="_blank" rel="noopener noreferrer">GNUCash</a> 非常有名，也是我最早知道的开源金融管理软件
之一，复式记账一直是我觉得很厉害但是又不明白的概念。后来看了一些金融相关不入门
的信息，才有所了解。</p>
<p>以前也在 Windows 下使用过 GNUCash，本身还是很不错的，但是当时我没有坚持下来。</p>
<p>这次下载最新版回来在 Mac 上安装好之后发现，除了菜单之外，界面上中文全部是乱码，
一行中文被缩挤到第一列。新建账户或者其他任何操作都是不知所以，完全没法用。
最奇怪的是，网络上各个搜索引擎居然都搜索不到 GNUCash 乱码的内容，偶尔有一篇，
还是将数据库的。原来 GNUCash 使用的是 MySQL 存储数据？</p>
<p>GNUCash 目前支持 Windows, Mac, Linux, 和 Android 平台。</p>
<h2 id="icash">iCash<a aria-hidden="true" href="#icash">#</a></h2>
<p>后来看到有人推荐使用 <a href="https://www.maxprog.com/site/software/personal%5Cnfinance/icash%5Cnsheet%5Cnus.php" target="_blank" rel="noopener noreferrer">iCash</a>，
Mac 下 <code>i</code> 系列的好像都不错，于是尝试了下。</p>
<p>iCash 支持 Windows, Mac 平台，也有中文支持。</p>
<p>但就是觉得操作不算便利，一大堆莫名其妙的表单，有些会自动根据后面的表单自动适配，
不需要显示但居然安排在最前面，后来我才知道可以不填。</p>
<p>界面有点点土，用户体验也不好。概览里管理资金账户，如果需要更新交易，则需要
切换到『交易』页签，然后选择是哪个账户的交易。表单恐惧症~</p>
<p>填了不到 50条左右（存储的 .icash 文件有 23.8M 这么大）就烦了，
于是继续寻找其他软件。</p>
<h2 id="money">Money<a aria-hidden="true" href="#money">#</a></h2>
<p>最后才找到 <a href="https://www.jumsoft.com/money/" target="_blank" rel="noopener noreferrer">Money by jumsoft</a> 界面设计非常赞，
大部分使用体验也很棒，有部分瑕疵，而最要命的启动速度非常慢，导入从 iCash
导出的 QIF 格式数据(.money 文件 500+KB) 启动时间大概需要 10秒。</p>
<p>另外如果上次退出 Money 的时候没有打开的文档（每个 .money 文件是一个文档）的话，
下次启动会要求创建新文档，只好打开最近的文档，再等 10秒钟。所以建议直接
<code>&lt;Command\nq&gt;</code> 退出文档 & 程序，不要使用 <code>&lt;Command\nw</code> 之类的关闭文档。</p>
<p>另外还有 iOS(iPhone, iPad)版本，收费也不贵。可以通过 Wi\nFi 或 iCloud 同步数据。
虽然呼声很高，目前还不支持 Dropbox 同步。不过像其他重要资料一样，我的 .money
文件存储在 Dropbox 中。</p>
<p>总之是很赞啦，如果解决了性能问题就更好了，还有就是缺少中文本地化，另外 Mac 版
显示全部交易也不好，还有那啥~</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[迁移博客到 Jekyll]]></title>
            <link>https://hotoo.github.io/blog/post/start-jekyll-for-blog</link>
            <guid>77</guid>
            <pubDate>Wed, 13 Feb 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="迁移博客到-jekyll">迁移博客到 Jekyll<a aria-hidden="true" href="#迁移博客到-jekyll">#</a></h1>
<h2 id="nposts-文件结构">\nposts 文件结构<a aria-hidden="true" href="#nposts-文件结构">#</a></h2>
<p>Jekyll 支持两种结构：</p>
<ol>
<li>平铺所有文件，每个文件使用日期前缀。</li>
<li>按照完整的日期目录结构。</li>
</ol>
<h2 id="静态链接permalink">静态链接(Permalink)<a aria-hidden="true" href="#静态链接permalink">#</a></h2>
<p>我的个人博客并非用于发布新闻，即使非常旧的博客，也会不断更新维护，
所以无需添加时间标识，直接使用 title 即可。</p>
<p>如果需要多个版本，为避免出现冲突，可以在 title 中添加序号。如 <code>II</code> 或 <code>2</code>。</p>
<h2 id="草稿draft">草稿(Draft)<a aria-hidden="true" href="#草稿draft">#</a></h2>
<p>Jekyll 支持 <code>published</code> 标记，设置为 <code>false</code> 就可以避免被转换发布。
这本身很不错，但是这些草稿和正常发布的文件混淆在一起，无法清晰区分。</p>
<p>所以我创建了 <code>\ndraft</code> 目录，用于存放草稿。在文章准备好之后拷贝到 <code>\nposts </code>
目录即可。</p>
<p>p.s. 话说相比 <code>published</code> 标记，我更喜欢 <code>draft</code>，如果支持的话。</p>
<h2 id="more">more<a aria-hidden="true" href="#more">#</a></h2>
<p><a href="https://www.jacquesf.com/2011/03/creating%5Cnexcerpts%5Cnin%5Cnjekyll%5Cnwith%5Cnwordpress%5Cnstyle%5Cnmore%5Cnhtml%5Cncomments/" target="_blank" rel="noopener noreferrer">Creating Excerpts in Jekyll with Wordpress\nstyle <!\n\nmore\n\n> HTML Comments</a></p>
<h2 id="存档archive">存档(Archive)<a aria-hidden="true" href="#存档archive">#</a></h2>
<p><a href="https://gist.github.com/enaeher/88cda643aa7e3b0ca1e5" target="_blank" rel="noopener noreferrer">enaeher / tiered\narchives.rb</a></p>
<h2 id="目录toc">目录(TOC)<a aria-hidden="true" href="#目录toc">#</a></h2>
<p><a href="https://stackoverflow.com/questions/9602936/how%5Cnto%5Cnadd%5Cna%5Cntable%5Cnof%5Cncontents%5Cnto%5Cnjekyll%5Cnblog%5Cnpost" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/9602936/how\nto\nadd\na\ntable\nof\ncontents\nto\njekyll\nblog\npost</a>
<a href="https://stackoverflow.com/questions/13481572/jekyll%5Cnautomatic%5Cntable%5Cnof%5Cncontents" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/13481572/jekyll\nautomatic\ntable\nof\ncontents</a>
<a href="https://du1abadd.org/2010/usr/make%5Cntoc%5Cnsupport%5Cnfor%5Cnjekyll%5Cnwith%5Cnrdiscount.html" target="_blank" rel="noopener noreferrer">https://du1abadd.org/2010/usr/make\ntoc\nsupport\nfor\njekyll\nwith\nrdiscount.html</a></p>
<h2 id="标签tags">标签(Tags)<a aria-hidden="true" href="#标签tags">#</a></h2>
<h2 id="代码高亮">代码高亮<a aria-hidden="true" href="#代码高亮">#</a></h2>
<h2 id="分页">分页<a aria-hidden="true" href="#分页">#</a></h2>
<pre><code>&lt;div class=&quot;pagination&quot;&gt;
  {% if paginator.previous\npage == 1 %}
    &lt;a href=&quot;/&quot; class=&quot;previous&quot;&gt;上一页&lt;/a&gt;
  {% else if paginator.previous\npage %}
    &lt;a href=&quot;/page{{paginator.previous\npage}}&quot; class=&quot;previous&quot;&gt;上一页&lt;/a&gt;
  {% else %}
    &lt;span class=&quot;previous&quot;&gt;上一页&lt;/span&gt;
  {% endif %}
  &lt;span class=&quot;page\nnumber&quot;&gt;页码：{{paginator.page}} / {{paginator.total\npages}}&lt;/span&gt;
  {% if paginator.next\npage %}
    &lt;a href=&quot;/page{{paginator.next\npage}}&quot; class=&quot;next&quot;&gt;下一页&lt;/a&gt;
  {% else %}
    &lt;span class=&quot;next&quot;&gt;下一页&lt;/span&gt;
  {% endif %}
&lt;/div&gt;
</code></pre>
<h3 id="参考">参考：<a aria-hidden="true" href="#参考">#</a></h3>
<p>\n <a href="https://jeffreysambells.com/2013/02/01/jekyll%5Cndraft%5Cnpublishing%5Cnplugin" target="_blank" rel="noopener noreferrer">Jekyll Draft Publishing Plugin</a>
\n <a href="https://tqcblog.com/2012/08/22/jekyll%5Cndrafts/" target="_blank" rel="noopener noreferrer">Jekyll Draft Posts</a></p>
<h2 id="与-vimwiki-结合">与 Vimwiki 结合<a aria-hidden="true" href="#与-vimwiki-结合">#</a></h2>
<p>之前的博客使用 Vimwiki 管理，可以无需转换或发布，直接使用 Vim 即可简单浏览。</p>
<pre><code>let g:vimwiki\nlist = [
  \ {
    \ &#39;path&#39;        : &#39;~/Dropbox/blog.hotoo.me/\nposts&#39;,
    \ &#39;index&#39;       : &#39;\nindex&#39;,
    \ &#39;ext&#39;         : &#39;.md&#39;,
    \ &#39;nested\nsyntaxes&#39; : {&#39;javascript&#39;: &#39;javascript&#39;, &#39;python&#39;: &#39;python&#39;, &#39;c++&#39;: &#39;cpp&#39;}
  \ }
\]
</code></pre>
<h2 id="不足">不足<a aria-hidden="true" href="#不足">#</a></h2>
<p><code>\nposts/\n.md</code> 文档理论上只会作为内容输出，其中的代码（尤其是 Jekyll 使用的模板
代码，及其 <code>pre &gt; code</code> 中的代码，应该合理转义处理。但是实际上 Jekyll 没有这样
做，导致一些代码没有符合期望。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用 Space 还是 Tab 缩进代码？]]></title>
            <link>https://hotoo.github.io/blog/post/format-by-spaces-or-tabs</link>
            <guid>79</guid>
            <pubDate>Sun, 06 Jan 2013 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="使用-space-还是-tab-缩进代码">使用 Space 还是 Tab 缩进代码？<a aria-hidden="true" href="#使用-space-还是-tab-缩进代码">#</a></h1>
<p><img src="/images/blog/tabs%5Cnor%5Cnspaces.jpg" alt="tabs or spaces"></img></p>
<p>这也是一个经典的问题吧。很长一段时间以来我都是被影响为使用空格，而且似乎大多数
人都使用 4 个空格吧。。</p>
<h2 id="可视空间">可视空间<a aria-hidden="true" href="#可视空间">#</a></h2>
<p>空格：</p>
<p>\n 几乎所有编辑器或代码查看器中的占位一致，缩进风格统一。</p>
<p>Tab:</p>
<p>\n 每个编辑器可视占位空间可能不一致，但大多数编辑器可以设置，所以每个用户可以
使用自己的视觉习惯。</p>
<h2 id="缩进风格">缩进风格<a aria-hidden="true" href="#缩进风格">#</a></h2>
<p>K&R风格：
由Kernighan & Ritchie 给出的格式而得名，又称“核心风格”，因为UNIX核心应用了这种编程风格。
每一层缩进使用8个空格（或者一个制表符），有时也使用4个空格，但很少。</p>
<pre><code>if (cond) {
     &lt;body&gt;
}
</code></pre>
<p>Allman风格：
因Eric Allman而得名，Eric Allman是伯克利的一名黑客，写了大量BSD程序，（这种风格又称BSD风格）
每一层缩进使用8个空格，4个空格也经常被使用。</p>
<pre><code>if (cond)
{
     &lt;body&gt;
}
</code></pre>
<p>Whitesmiths风格：
这种风格来源于早期一种C语言的商用编译器。
每一层缩进使用8个空格，4个空格也偶尔被使用。</p>
<pre><code>if (cond)
        {
        &lt;body&gt;
        }
</code></pre>
<p>GNU风格:
不用说，自然是来自GNU了。
每一层缩进总是使用4个空格。在“”号的缩进则使用半个缩进位。</p>
<pre><code>if (cond)
  {
    &lt;body&gt;
  }
</code></pre>
<h2 id="展开阅读">展开阅读<a aria-hidden="true" href="#展开阅读">#</a></h2>
<p>\n <a href="https://en.wikipedia.org/wiki/Indent%5Cnstyle" target="_blank" rel="noopener noreferrer">Indent style</a>
\n <a href="https://en.wikipedia.org/wiki/Editor%5Cnwar" target="_blank" rel="noopener noreferrer">Editor war</a>
\n <a href="https://www.jwz.org/doc/tabs%5Cnvs%5Cnspaces.html" target="_blank" rel="noopener noreferrer">Tabs versus Spaces: An Eternal Holy War.</a>
\n <a href="https://www.derkarl.org/why%5Cnto%5Cntabs.html" target="_blank" rel="noopener noreferrer">Why I love having tabs in source code.</a>
\n <a href="https://www.jwz.org/doc/tabs%5Cnvs%5Cnspaces.html" target="_blank" rel="noopener noreferrer">Tabs versus Spaces: An Eternal Holy War.</a>
\n <a href="https://stackoverflow.com/questions/268538/tab%5Cnversus%5Cnspace%5Cnindentation%5Cnin%5Cnc%5Cnsharp" target="_blank" rel="noopener noreferrer">Tab versus space indentation in C#</a>
\n <a href="https://programmers.stackexchange.com/questions/57/tabs%5Cnversus%5Cnspaceswhat%5Cnis%5Cnthe%5Cnproper%5Cnindentation%5Cncharacter%5Cnfor%5Cneverything%5Cnin%5Cne" target="_blank" rel="noopener noreferrer">Tabs versus spaces—what is the proper indentation character for everything, in every situation, ever?</a>
\n <a href="https://nithinbekal.com/2011/tabs%5Cnvs%5Cnspaces%5Cnfor%5Cnindentation/" target="_blank" rel="noopener noreferrer">Tabs vs. spaces for indentation</a>
\n <a href="https://www.codinghorror.com/blog/2009/04/death%5Cnto%5Cnthe%5Cnspace%5Cninfidels.html" target="_blank" rel="noopener noreferrer">Death to the Space Infidels!</a>
\n <a href="https://vim.wikia.com/wiki/Indent%5Cnwith%5Cntabs,%5Cnalign%5Cnwith%5Cnspaces" target="_blank" rel="noopener noreferrer">Indent with tabs, align with spaces</a>
\n <a href="https://christian.roy.name/blog/indentation%5Cntabs%5Cnvs%5Cnspaces" target="_blank" rel="noopener noreferrer">Indentation: Tabs vs. Spaces</a>
\n <a href="https://discuss.fogcreek.com/joelonsoftware/default.asp?cmd=show&amp;ixPost=3978" target="_blank" rel="noopener noreferrer">tabs or spaces?</a>
\n <a href="https://lea.verou.me/2012/01/why%5Cntabs%5Cnare%5Cnclearly%5Cnsuperior/" target="_blank" rel="noopener noreferrer">Why tabs are clearly superior</a>
\n <a href="https://en.wikipedia.org/wiki/Indent%5Cnstyle" target="_blank" rel="noopener noreferrer">Indent style</a>
\n <a href="https://www.fact%5Cnindex.com/i/in/indent%5Cnstyle.html" target="_blank" rel="noopener noreferrer">Indent style</a>
\n <a href="https://www.cxybase.com/201104/c%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC%E7%BC%A9%E8%BF%9B%E5%92%8C%E7%A9%BA%E7%99%BD/" target="_blank" rel="noopener noreferrer">C语言编码风格（一）——缩进和空白</a>
\n <a href="https://blog.sina.com.cn/s/blog%5Cn4d1c49700100im2b.html" target="_blank" rel="noopener noreferrer">文章段落起首空格（缩进）风格的讨论</a></p>
<p>\n\n\n\n</p>
<p>\n <a href="https://my.opera.com/justnewbee/blog/code%5Cnindent%5Cntab%5Cnspace" target="_blank" rel="noopener noreferrer">代码缩进 tab space</a>
\n <a href="https://www.keakon.net/2010/11/30/%E7%94%A8%E7%A9%BA%E6%A0%BC%E8%BF%98%E6%98%AF%E5%88%B6%E8%A1%A8%E7%AC%A6%E7%BC%A9%E8%BF%9B%E6%9C%89%E4%BB%80%E4%B9%88%E5%A5%BD%E4%BA%89%E7%9A%84%EF%BC%9F" target="_blank" rel="noopener noreferrer">用空格还是制表符缩进有什么好争的？</a>
\n <a href="https://www.zhihu.com/question/19960028" target="_blank" rel="noopener noreferrer">写代码时，缩进使用 tab 还是空格？</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用 MacVim 做 svn diff]]></title>
            <link>https://hotoo.github.io/blog/post/macvim-svndiff</link>
            <guid>209</guid>
            <pubDate>Wed, 31 Oct 2012 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="使用-macvim-做-svn-diff">使用 MacVim 做 svn diff<a aria-hidden="true" href="#使用-macvim-做-svn-diff">#</a></h1>
<h2 id="对于终端的-vim">对于终端的 vim<a aria-hidden="true" href="#对于终端的-vim">#</a></h2>
<ol>
<li>
<p><code>~/.subversion/config</code></p>
<pre><code>[helpers]
diff\ncmd = /usr/local/bin/svndiff
</code></pre>
</li>
</ol>
<p> </p>
<ol start="2">
<li>
<p>将下面的代码保存为 svndiff：</p>
<pre><code>#!/bin/sh

DIFF=&quot;/usr/bin/vimdiff&quot;
LEFT=\n{6}
RIGHT=\n{7}
\nDIFF \nLEFT \nRIGHT
</code></pre>
</li>
<li>
<p>拷贝到 <code>/usr/local/bin/svndiff</code> 并设置权限：</p>
<pre><code>sudo chmod +a /usr/local/bin/svndiff
</code></pre>
</li>
</ol>
<h2 id="对于-macvim">对于 MacVim<a aria-hidden="true" href="#对于-macvim">#</a></h2>
<p>修改 <code>/usr/local/bin/svndiff</code> 内容如下：</p>
<pre><code>#!/bin/bash

LEFT=\n{6}
RIGHT=\n{7}
TMPLEFT=&quot;/tmp/\n{LEFT##\n/}.\n\n&quot;
TMPRIGHT=&quot;/tmp/\n{RIGHT##\n/}.\n\n&quot;

cp &quot;\nLEFT&quot; &quot;\nTMPLEFT&quot;
cp &quot;\nRIGHT&quot; &quot;\nTMPRIGHT&quot;

mvim \n\nservername SVNDIFF \n\nremote\ntab\nsilent +&quot;vertical diffsplit \nTMPLEFT|wincmd w&quot; &quot;\nTMPRIGHT&quot;
sleep 0.1

SN=`mvim \n\nserverlist | grep &quot;SVNDIFF&quot;`
until [ &quot;\nSN&quot; == &quot;SVNDIFF&quot; ]; do
  sleep 0.1
  SN=`mvim \n\nserverlist | grep &quot;SVNDIFF&quot;`
done

rm \nf &quot;\nTMPLEFT&quot; &quot;\nTMPRIGHT&quot;
</code></pre>
<p>之前尝试过修改终端方案中的</p>
<pre><code>DIFF=&quot;/usr/bin/vimdiff&quot;
</code></pre>
<p>为：</p>
<pre><code>DIFF=&quot;gvim \nd&quot;
</code></pre>
<p>未遂，右侧的代码会为空。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://twitter.com/ntakushima/statuses/27518378028" target="_blank" rel="noopener noreferrer">svn diffの結果をMacVimで。</a>
\n <a href="https://gist.github.com/629457" target="_blank" rel="noopener noreferrer">diffwrap.sh</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[在 Vim 上安装使用 Tagbar]]></title>
            <link>https://hotoo.github.io/blog/post/vim-install-tagbar</link>
            <guid>160</guid>
            <pubDate>Sun, 28 Oct 2012 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="在-vim-上安装使用-tagbar">在 Vim 上安装使用 Tagbar<a aria-hidden="true" href="#在-vim-上安装使用-tagbar">#</a></h1>
<pre><code>git clone https://github.com/mozilla/doctorjs.git –recursive
cd doctorjs
sudo make install
</code></pre>
<p>会提示将 NODE\nPATH 加入到环境变量 ~/.bash\nprofile ：</p>
<pre><code>export NODE\nPATH=/usr/local/lib/jsctags/:\nNODE\nPATH
</code></pre>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://majutsushi.github.com/tagbar/" target="_blank" rel="noopener noreferrer">Tagbar</a>
\n <a href="https://github.com/majutsushi/tagbar/wiki" target="_blank" rel="noopener noreferrer">Support for additional filetypes</a>
\n <a href="https://ahchoo.me/blog/2012/03/08/learn%5Cnvim%5Cn3%5Cnpost/" target="_blank" rel="noopener noreferrer">Vim学习 Jsctags</a>
\n <a href="https://github.com/mozilla/doctorjs" target="_blank" rel="noopener noreferrer">Doctor.js</a> \n jsctags.
\n <a href="https://github.com/hotoo/dotfiles/blob/master/.ctags" target="_blank" rel="noopener noreferrer">.ctags</a>
\n <a href="https://jezng.com/2011/03/vim%5Cnsupport%5Cnjavascript%5Cntaglist%5Cnplus/" target="_blank" rel="noopener noreferrer">Awesome vim support for javascript with jsctags and taglist\nplus</a>
\n <a href="https://hikejun.com/blog/2011/05/07/%E6%9B%B4%E5%A5%BD%E7%9A%84%E7%94%A8vim%E6%B5%8F%E8%A7%88javascript%E4%BB%A3%E7%A0%81/" target="_blank" rel="noopener noreferrer">更好的用vim浏览Javascript代码</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[杭州萧山无人村骑行]]></title>
            <link>https://hotoo.github.io/blog/post/wurencun</link>
            <guid>80</guid>
            <pubDate>Sat, 27 Oct 2012 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="杭州萧山无人村骑行">杭州萧山无人村骑行<a aria-hidden="true" href="#杭州萧山无人村骑行">#</a></h1>
<p>从驴友哪里知道杭州附近有个无人村，网上看了帖子盘山公路很风景都很吸引人，
但是地图山就是搜索不到在哪里，后来才知道地图上是狮山村，大概是后来没有人住了
才被大家称为无人村的。</p>
<p>骑行路线：</p>
<p><a href="https://ditu.google.com/maps/ms?msa=0&amp;amp;msid=201867621321994349317.0004ccf3731b6db4167b5&amp;amp;brcurrent=3,0x344bb629439aaa99:0xa7bfd183824de83a,0%3B5,0,0&amp;amp;ie=UTF8&amp;amp;t=h&amp;amp;ll=30.123883,120.152439&amp;amp;spn=0.296055,0.075098&amp;amp;output=embed" target="_blank" rel="noopener noreferrer">https://ditu.google.com/maps/ms?msa=0&amp;msid=201867621321994349317.0004ccf3731b6db4167b5&amp;brcurrent=3,0x344bb629439aaa99:0xa7bfd183824de83a,0%3B5,0,0&amp;ie=UTF8&amp;t=h&amp;ll=30.123883,120.152439&amp;spn=0.296055,0.075098&amp;output=embed</a></p>
<pre><code>&lt;iframe width=&quot;600&quot; height=&quot;400&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; marginheight=&quot;0&quot; marginwidth=&quot;0&quot;
  src=&quot;https://ditu.google.com/maps/ms?msa=0&amp;amp;msid=201867621321994349317.0004ccf3731b6db4167b5&amp;amp;brcurrent=3,0x344bb629439aaa99:0xa7bfd183824de83a,0%3B5,0,0&amp;amp;ie=UTF8&amp;amp;t=h&amp;amp;ll=30.123883,120.152439&amp;amp;spn=0.296055,0.075098&amp;amp;output=embed&quot;&gt;
&lt;/iframe&gt;&lt;br /&gt;&lt;small&gt;View &lt;a href=&quot;https://ditu.google.com/maps/ms?msa=0&amp;amp;msid=201867621321994349317.0004ccf3731b6db4167b5&amp;amp;brcurrent=3,0x344bb629439aaa99:0xa7bfd183824de83a,0%3B5,0,0&amp;amp;ie=UTF8&amp;amp;t=h&amp;amp;ll=30.123883,120.152439&amp;amp;spn=0.296055,0.075098&amp;amp;source=embed&quot;
    style=&quot;color:#0000FF;text\nalign:left&quot;&gt;狮山村（无人村）&lt;/a&gt; in a larger map&lt;/small&gt;
</code></pre>
<p>其他同学都有事没能一起，只有一个测试好基友 <a href="https://weibo.com/n/peacefulgoose" target="_blank" rel="noopener noreferrer">@peacefulgoose</a> 一起。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[『逻辑与』是个好东西]]></title>
            <link>https://hotoo.github.io/blog/post/logical-conjunction</link>
            <guid>116</guid>
            <pubDate>Tue, 01 May 2012 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="逻辑与是个好东西">『逻辑与』是个好东西<a aria-hidden="true" href="#逻辑与是个好东西">#</a></h1>
<p>一直很想实现 WebForms2 的语义化表单验证，最近才开始动手，执行力真差啊。</p>
<p>一个表单元素可以同时存在多种校验方案，比如：</p>
<p>\n required.
\n data type: number, date, url, email...
\n minlength, maxlength, min, max.
\n pattern
\n 用户自定义验证函数。
\n 异步访问服务器进行业务校验。</p>
<p>通常可以通过逻辑判断进行处理：</p>
<pre><code>function verifyFormInput(input){
  if(!verifyRequired()){return false;}
  if(!verifyMinLength()){return false;}
  if(!verifyMaxLength()){return false;}
  if(!verifyInputType()){return false;}
  if(!verifyMin()){return false;}
  if(!verifyMax()){return false;}
  if(!verifyPattern()){return false;}
  if(!verifyUserRules()){return false;}
  if(!verifySync()){return false;}
  return true;
}
function verifyForm(form){
    var flags = [];
    for(var i=0,l=form.elements.length; i&lt;l; i++){
        // 一次只能校验一个表单元素异常。
        //if(!verifyFormInput(form.elements[i])){return false;}

        // 可以同时校验所有元素异常。但是需要辅助循环进行检查。
        flags[i] = verifyFormInput(form.elements[i]);
    }
    // 辅助循环检查。
    for(var i=0,l=flags.length; i&lt;l; i++){
        if(!flags[i]){return false;}
    }
    return true;
}
</code></pre>
<p>实际代码中，各个 <code>verifyXXX</code> 函数可能内联在 <code>verifyFormInput</code> 函数中，
代码显得多而有点乱，甚至有点冗余。</p>
<p>想起模拟电路课程上学到的『与门』，只有所有电路都是通路时，整个电路才是通路。</p>
<p>而表单验证也是这样：</p>
<p>\n 某个表单元素的所有验证逻辑都通过验证时，这个表单元素才算通过验证。
\n 整个表单的所有表单元素都通过验证时，才算这个表单通过验证。</p>
<p>同时基于『逻辑与』表达式的语言特性，一旦前面的条件可以判断逻辑失败，立即返回
失败，不再进行后面的条件判断。</p>
<p>LogicalANDExpression:</p>
<blockquote>
<p>\nSemantics\n</p>
<p>The production LogicalANDExpression : LogicalANDExpression &&
BitwiseORExpression is evaluated as follows:</p>
<ol>
<li>Evaluate LogicalANDExpression.</li>
<li>Call GetValue(Result(1)).</li>
<li>Call ToBoolean(Result(2)).</li>
<li>If Result(3) is \nfalse\n, return Result(2).</li>
<li>Evaluate BitwiseORExpression.</li>
<li>Call GetValue(Result(5)).</li>
<li>Return Result(6).</li>
</ol>
</blockquote>
<p>BitwiseORExpression:</p>
<blockquote>
<p>\nSemantics\n</p>
<p>The production A : A@B, where @ is one of the bitwise operators in the
productions above, is evaluated as follows:</p>
<ol>
<li>Evaluate A.</li>
<li>Call GetValue(Result(1)).</li>
<li>Evaluate B.</li>
<li>Call GetValue(Result(3)).</li>
<li>Call ToInt32(Result(2)).</li>
<li>Call ToInt32(Result(4)).</li>
<li>Apply the bitwise operator @ to Result(5) and Result(6). The result is
a signed 32 bit integer.</li>
<li>Return Result(7).</li>
</ol>
</blockquote>
<p>于是验证算法改良如下：</p>
<pre><code>function verifyFormInput(input){
    var certified = true;
    certified = certified &amp;&amp; verifyRequired();
    certified = certified &amp;&amp; verifyMinLength();
    certified = certified &amp;&amp; verifyMaxLength();
    certified = certified &amp;&amp; verifyInputType();
    certified = certified &amp;&amp; verifyMin();
    certified = certified &amp;&amp; verifyMax();
    certified = certified &amp;&amp; verifyPattern();
    certified = certified &amp;&amp; verifyUserRules();
    certified = certified &amp;&amp; verifySync();
    return certified;
}
function verifyForm(form){
    var certified = true;
    for(var i=0,flag,l=form.elements.length; i&lt;l; i++){
        // 一次只能校验一个表单元素异常。
        //certified = certified &amp;&amp; verifyFormInput(form.elements[i]);

        // 可以同时校验所有元素异常。无需辅助循环进行检查。
        flag = verifyFormInput(form.elements[i]);
        certified = certified &amp;&amp; flag;
    }
    return certified;
}
</code></pre>
<h2 id="延伸">延伸<a aria-hidden="true" href="#延伸">#</a></h2>
<p>以前也 Hack 的用过逻辑与表达式，比如：</p>
<pre><code>flag &amp;&amp; action();
</code></pre>
<p>但这个用法只是用到了条件判断的作用，类似于：</p>
<pre><code>if(flag){action();}
</code></pre>
<h2 id="参考阅读">参考阅读<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://www.ecmascript.org/" target="_blank" rel="noopener noreferrer">ECMAScript</a>
\n <a href="https://zh.wikipedia.org/wiki/%E9%80%BB%E8%BE%91%E4%B8%8E" target="_blank" rel="noopener noreferrer">逻辑与</a>
<a href="https://en.wikipedia.org/wiki/Logical%5Cnconjunction" target="_blank" rel="noopener noreferrer">Logical\nconjunction</a>
\n <a href="https://zh.wikipedia.org/wiki/%E4%B8%8E%E9%97%A8" target="_blank" rel="noopener noreferrer">与门</a>
<a href="https://en.wikipedia.org/wiki/AND%5Cngate" target="_blank" rel="noopener noreferrer">AND\ngate</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[千里走单骑]]></title>
            <link>https://hotoo.github.io/blog/post/bicycle-travel</link>
            <guid>81</guid>
            <pubDate>Mon, 02 Apr 2012 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="千里走单骑">千里走单骑<a aria-hidden="true" href="#千里走单骑">#</a></h1>
<p>今天和 5 个同事一起从公司出发，骑车去径山寺。</p>
<h2 id="路线定位">路线&定位<a aria-hidden="true" href="#路线定位">#</a></h2>
<p>\n Google Maps for iPhone.
可以自动搜索匹配路线，参考价值还是很高的。
\n Google Maps 手机 Web 版(iPhone)
这个不错，支持 My Places。就是每次动作都可能下载数据会比较费流量，体验也相对下降。
\n <a href="https://itunes.apple.com/us/app/my%5Cnmaps%5Cneditor/id389114621?mt=8" target="_blank" rel="noopener noreferrer">My Maps Editor</a>
支持 Google Maps My Places，但是对于用 Google Maps 自动搜索到的路线，保存到
My Places 的数据，这个支持还不行，会被拉成直线。
\n <a href="https://itunes.apple.com/us/app/my%5Cnplace%5Cnfor%5Cngoogle%5Cnmaps/id492861440?mt=8" target="_blank" rel="noopener noreferrer">My Place for Google Maps</a>
这个就垃圾了，纯粹骗钱偷窃的货，又不要脸又没种。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E9%99%86%E8%B7%AF%E8%BE%B9%E5%A2%83%E5%8F%A3%E5%B2%B8%E5%88%97%E8%A1%A8" target="_blank" rel="noopener noreferrer">中国陆路边境口岸列表</a>
\n <a href="https://www.withbike.com/article/51%5Cn475.html" target="_blank" rel="noopener noreferrer">杭州及周边骑行路线集</a>
\n <a href="https://www.51766.com/img/jingshansi/" target="_blank" rel="noopener noreferrer">余杭径山寺</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[计算主域名]]></title>
            <link>https://hotoo.github.io/blog/post/primary-domain</link>
            <guid>82</guid>
            <pubDate>Tue, 13 Dec 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="计算主域名">计算主域名<a aria-hidden="true" href="#计算主域名">#</a></h1>
<pre><code>document.domain = document.domain.split(&quot;.&quot;).slice(\n2).join(&quot;.&quot;);
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Confluence Wiki for Vi]]></title>
            <link>https://hotoo.github.io/blog/post/confluencewiki.vim</link>
            <guid>83</guid>
            <pubDate>Sun, 04 Dec 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="confluence-wiki-for-vi">Confluence Wiki for Vi<a aria-hidden="true" href="#confluence-wiki-for-vi">#</a></h1>
<p>.ctags / ctags.cnf</p>
<pre><code>\n\nlangdef=confluencewiki
\n\nlangmap=confluencewiki:.wiki
\n\nregex\nconfluencewiki=/^h1.[ \t]+(.+)\n/\1/h,header/
\n\nregex\nconfluencewiki=/^h2.[ \t]+(.+)\n/. \1/h,header/
\n\nregex\nconfluencewiki=/^h3.[ \t]+(.+)\n/.   \1/h,header/
\n\nregex\nconfluencewiki=/^h4.[ \t]+(.+)\n/.     \1/h,header/
\n\nregex\nconfluencewiki=/^h5.[ \t]+(.+)\n/.       \1/h,header/
\n\nregex\nconfluencewiki=/^h6.[ \t]+(.+)\n/.         \1/h,header/
</code></pre>
<p>.vimrc / \nvimrc</p>
<pre><code>let tlist\nconfluencewiki\nsettings = &#39;confluencewiki;h:Headers&#39;
</code></pre>
<p>这玩意很好使，同样是 .wiki 后缀，可以同时支持 Vimwiki 和 Confluence Wiki。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://www.vim.org/scripts/script.php?script%5Cnid=1994" target="_blank" rel="noopener noreferrer">https://www.vim.org/scripts/script.php?script\nid=1994</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[文本宽度 及 文本框滚动偏移量(scrollLeft)]]></title>
            <link>https://hotoo.github.io/blog/post/text-width-and-input-scrollleft</link>
            <guid>84</guid>
            <pubDate>Mon, 07 Nov 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="文本宽度-及-文本框滚动偏移量scrollleft">文本宽度 及 文本框滚动偏移量(scrollLeft)<a aria-hidden="true" href="#文本宽度-及-文本框滚动偏移量scrollleft">#</a></h1>
<h2 id="背景">背景<a aria-hidden="true" href="#背景">#</a></h2>
<p>最近将多标签输入框进行修改，把原来随光标(caret)移动的自动建议浮动条改为根据当前标签相对左对齐。</p>
<p><a href="https://1.bp.blogspot.com/%5CnPOl6bUDELqY/SRQ%5Cnxx7LXCI/AAAAAAAAFSw/syXjnAQ%5CnRLI/s320/tags.jpg" target="_blank" rel="noopener noreferrer">https://1.bp.blogspot.com/\nPOl6bUDELqY/SRQ\nxx7LXCI/AAAAAAAAFSw/syXjnAQ\nRLI/s320/tags.jpg</a></p>
<p>解决方法很简单，计算当前标签前的文本宽度(将需要计算的文本转义后放入一个各字体样式与目标输入框相同的容器，
如span中，span.offsetWidth即是文本的宽度。注意：文本框中，中文半角空格的宽度和英文半角空格的宽度显示为不同，
虽然这两个空格本质上相同)，浮动条根据该值定位即可。</p>
<h2 id="问题">问题<a aria-hidden="true" href="#问题">#</a></h2>
<p>当标签文本过长，超出文本框宽度时，标签文本会向左滚动，但是此时当前标签前面的文本宽度不变，
定位浮动条时需要减去文本向左滚动的尺寸。</p>
<p>网页文档对象中，元素都有一个可读写的scrollLeft属性，表示元素内容相当元素容器向左移动的偏移量。</p>
<p>但是 Firefox 和 Opera 有一些例外，如文本框的 scrollLeft 始终为 0，
[<a href="https://developer.mozilla.org/En/DOM/Element.scrollLeft" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/En/DOM/Element.scrollLeft</a> Mozilla] 的描述是：</p>
<blockquote>
<p>If the element can't be scrolled (e.g. it has no overflow), scrollLeft is set to 0.</p>
</blockquote>
<p>对于一些不可滚动(scroll，即没有溢出)的元素，scrollLeft始终为0。而单行文本框
（在Gecko引擎看来）是不可滚动的，即使将样式指定为 <code>overflow:scroll</code>
（IE会出现水平和垂直滚动条这样的怪胎）。</p>
<p>虽说单行文本框是不应该出现滚动条这样怪异的形态，但是这不表示它是不可滚动的，
当文本宽度大于文本框宽度时，（为了将光标caret显示在文本框可见区域）文本势必向左滚动，如图：</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SRQ2rw%5CnJdEI/AAAAAAAAFSo/hY8HxHGQk0Q/s320/scrollLeft.jpg" alt=""></img></p>
<h2 id="解决办法">解决办法<a aria-hidden="true" href="#解决办法">#</a></h2>
<p>对于文本框不支持scrollLeft的浏览器，一个临时的解决办法是，在文本宽度大于文本框宽度时，
浮动条定位在相对文本框后端若干像素（便于输入）的位置，在增量输入时，体验不是太差，
但是在光标向前移动使文本向右滚动时，就会出现偏差。</p>
<p>最终解决办法是期待浏览器能够得到正确的scrollLeft值，或者其他巧妙的计算方法。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Date.now()]]></title>
            <link>https://hotoo.github.io/blog/post/Date.now</link>
            <guid>85</guid>
            <pubDate>Sun, 18 Sep 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="datenow">Date.now()<a aria-hidden="true" href="#datenow">#</a></h1>
<p>以前做过一个 JavaScript 性能测试“框架”，也看过其他人做性能比较的时候，基本上
也都是使用 <code>new Date()</code> 来记时，会“耍点小花样”的同学会使用 <code>+new Date()</code>。</p>
<p>现在又想做另一种性能监控的方法，便着重考量了下各种记时方案，尽量减少因为
性能监控代码对业务代码的影响。</p>
<p>下面是循环 100000 次，过程中只有计数器操作，得到的时间(ms)对照表
(<a href="https://hotoo.github.io/labs/Date.now.html" target="_blank" rel="noopener noreferrer">Demo</a>)。</p>
<p>| Browser  | new Date() | new Date().getTime() | new Date().valueOf() | +new Date() | Date.now() |
|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n|
| IE8      | 469        | 391                  | 375                  | 406         | \n          |
| Firefox6 | 266        | 258                  | 257                  | 259         | 236        |
| Chrome13 | 46         | 29                   | 29                   | 35          | 20         |
| Opera11  | 246        | 242                  | 246                  | 244         | 222        |
| Safari5  | 256        | 232                  | 239                  | 255         | 222        |</p>
<p>由此可以对照出，<code>Date.now()</code> 确实有很明显的性能优势，另外 <code>Date.now()</code> 返回是
number 类型的数值，并不产生 Date 对象。</p>
<p>不过目前只有 IE9, Firefox3+, Chrome5+, Opera10.50+, Safari4+ 支持，对于不支持
的浏览器，可以继续使用 <code>new Date().valueOf()</code> 方法（个人不推荐用 <code>+new Date()</code>）：</p>
<pre><code>// @return {Number}
function now(){
    return (&quot;function&quot;==typeof Date.now) ? Date.now() : new Date().valueOf();
}
</code></pre>
<h2 id="日期相关">日期相关<a aria-hidden="true" href="#日期相关">#</a></h2>
<pre><code>new Date()          // now.
new Date(null);     // 1970/01/01 00:00:00(UTC)
new Date(undefined);// IE:NaN; Others:Invalid Date.
</code></pre>
<h2 id="参考阅读">参考阅读<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://msdn.microsoft.com/en%5Cnus/library/ff679974(v=vs.94).aspx" target="_blank" rel="noopener noreferrer">Date.now Function (JavaScript) \n MSDN</a>
\n <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global%5CnObjects/Date/now" target="_blank" rel="noopener noreferrer">Data.now() \n MDN</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[智能同步滚动条]]></title>
            <link>https://hotoo.github.io/blog/post/smart-sync-scroll</link>
            <guid>86</guid>
            <pubDate>Thu, 01 Sep 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="智能同步滚动条">智能同步滚动条<a aria-hidden="true" href="#智能同步滚动条">#</a></h1>
<p>| Browser | documentElement.scrollTop | body.scrollTop |
|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
| IE      | √                        | ×             |
| Firefox | √                        | ×             |
| Chrome  | ×                        | √             |
| Safari  | ×                        | √             |
| Opera   | √                        | ×             |</p>
<p>TODO: 其他的 get 方式。尝试智能判断是否设置成功，非通过浏览器性别判断。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[面积分割算法]]></title>
            <link>https://hotoo.github.io/blog/post/area-split</link>
            <guid>87</guid>
            <pubDate>Thu, 25 Aug 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="面积分割算法">面积分割算法<a aria-hidden="true" href="#面积分割算法">#</a></h1>
<p>做用户点击行为分析的展现时，用了一个透明的层覆盖在页面上，然后覆盖一层 canvas
画布，使用稀疏矩阵算法绘制热点分布图。</p>
<p>预蒙上一层透明蒙版，然后只对需要的区域进行绘制热点图，本是非常不错的方案，我
本机上也一直无问题。但是测试提交了一个 bug，说 IE 下看到点击热点图及轨迹图背后
一片漆黑，我就猜测滤镜问题，最先猜想的是浏览器安全设置导致的滤镜无效，但是又
发现有些类似的图形有没有问题。</p>
<p>结果发现是某些显卡下，IE 中超大面积的区域滤镜会失效。</p>
<p>首先想到的解决办法就是针对 IE 进行切割蒙版，由多个蒙版拼接而成，类似于铺地板。</p>
<p>普通的算法有两种：</p>
<ol>
<li>将整块蒙版区域划分成多个 2000\n2000 的蒙版，最后一列和最后一行不足指数，取余
设置宽高。</li>
<li>将整块蒙版划分成多个不超过 2000\n2000 的等份蒙版。这种算法比较简单，稍微的不足
之处在于，不能除断的情况，无法等分。</li>
</ol>
<p>TODO: 有更灵巧的算法么，当然有了，只是我还不知道而已。</p>
<h2 id="后来想到">后来想到<a aria-hidden="true" href="#后来想到">#</a></h2>
<p>用 canvas 绘制一个透明的区域也未尝不可。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[计算高度的时机]]></title>
            <link>https://hotoo.github.io/blog/post/iframe-highly-adaptive</link>
            <guid>88</guid>
            <pubDate>Wed, 24 Aug 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="深入-iframe-自适应高度">深入 Iframe 自适应高度<a aria-hidden="true" href="#深入-iframe-自适应高度">#</a></h1>
<p>DOCTYPE(CSS1Compat): HTML5, HTML4.01 Strict, HTML4.01 Transitional,
XHTML1.0 Frameset, XHTML1.0 Strict, XHTML1.0 Transitional, XHTML1.1.</p>
<p>| browser | documentElement |              | body         |              |
|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
|         | scrollHeight    | offsetHeight | scrollHeight | offsetHeight |
| IE      | √              | ×           | √           | √           |
| FF      | √              | √           | √           | √           |
| Chrome  | √              | √           | √           | √           |
| Safari  | √              | √           | √           | √           |
| Opera   | √              | √           | √           | √           |</p>
<p>non\ndoctype(BackCompat): 无 DOCTYPE, IE: DOCTYPE 前有非空白字符（包括注释）。</p>
<p>| browser    | documentElement |              | body         |              |
|\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
|            | scrollHeight    | offsetHeight | scrollHeight | offsetHeight |
| IE8        | ×              | ×           | √           | ×           |
| FF5        | √              | √           | √           | √           |
| Chrome13   | √              | √           | √           | √           |
| Safari5    | √              | √           | √           | √           |
| Opera11.50 | √              | √           | √           | ×           |</p>
<p>测试环境：Windows Server 2003.</p>
<p>综上所述：使用 <code>document.body.scrollHeight</code> 是最合适的。</p>
<h1 id="计算高度的时机">计算高度的时机<a aria-hidden="true" href="#计算高度的时机">#</a></h1>
<p>父窗口检测子窗口：</p>
<pre><code>iframe[onload=handler]
</code></pre>
<p>本窗口自检测：</p>
<pre><code>dom\nready = handler;
window.onload = handler;
body[onload=handler]
</code></pre>
<h2 id="子窗口获取自身在父窗口的-iframe-元素">子窗口获取自身在父窗口的 iframe 元素<a aria-hidden="true" href="#子窗口获取自身在父窗口的-iframe-元素">#</a></h2>
<p>如果父窗口有名字的话，可以直接通过 frames[name] 直接引用。</p>
<pre><code>// 求教更恰当的命名。
function getParentFrame(){
  if(parent == window){return null;}
  if(window.name){return parent.frames[window.name];}
  var ifr = parent.document.getElementsByTagName(&quot;iframe&quot;);
  for(var i=0,l=ifr.length; i&lt;l; i++){
    if(window == ifr[i].contentWindow){
      return ifr[i];
    }
  }
  var ifr = parent.document.getElementsByTagName(&quot;frame&quot;);
  for(var i=0,l=ifr.length; i&lt;l; i++){
    if(window == ifr[i].contentWindow){
      return ifr[i];
    }
  }
  return null;
};
</code></pre>
<h2 id="其他相关">其他相关<a aria-hidden="true" href="#其他相关">#</a></h2>
<p>上面的 <code>getParentFrame</code> 通过窗口名字直接取得元素本身，这里要注意的一点，
以前写代码的时候有这样的代码定义：</p>
<pre><code>function(){
  var elem = &quot;elem&quot;,
      name = &quot;name&quot;,
      desc = &quot;desc&quot;;
}
</code></pre>
<p>后来要增加一个变量，但是不小心写错标点符号。</p>
<pre><code>  function(){
      var elem = &quot;elem&quot;,
+         id = elem.id;
          name = &quot;name&quot;,
          desc = &quot;desc&quot;;
  }
</code></pre>
<p>然后 name 就成了全局变量，无意中修改了 <code>window.name</code> 的值。
所以如果使用 name 作为局部变量的时候，千万要小心，否则执行这段代码之后，
<code>a[target=oldName]</code> 的链接会因为找不到 <code>frames[oldName]</code> 而弹出新窗口。</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://ued.koubei.com/?p=243" target="_blank" rel="noopener noreferrer">再谈iframe自适应高度</a>
\n <a href="https://ued.koubei.com/?p=1217" target="_blank" rel="noopener noreferrer">三谈Iframe自适应高度</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[获取元素所绑定的事件列表]]></title>
            <link>https://hotoo.github.io/blog/post/eventlistenerlist</link>
            <guid>89</guid>
            <pubDate>Fri, 19 Aug 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="获取元素所绑定的事件列表">获取元素所绑定的事件列表<a aria-hidden="true" href="#获取元素所绑定的事件列表">#</a></h1>
<p>技术上有什么办法获得指定 HTMLElement 上有绑定那些 #JavaScript 函数事件，及其处理函数么？</p>
<p>比如我有一个按钮，想知道他绑定了那些事件？ click 事件的处理函数是什么？</p>
<p><code>elem.onclick</code> 这种只能绑定唯一的一个事件处理函数，可以直接取到。</p>
<p>DOM Level 3 有
[<a href="https://www.w3.org/TR/2001/WD%5CnDOM%5CnLevel%5Cn3%5CnEvents%5Cn20010823/events.html#Events%5CnEventListenerList" target="_blank" rel="noopener noreferrer">https://www.w3.org/TR/2001/WD\nDOM\nLevel\n3\nEvents\n20010823/events.html#Events\nEventListenerList</a> eventListenerList]
接口，但是现在还没有浏览器实现。</p>
<p>不过可以通过框架包装的方式获取列表。
另外 Google Chrome 浏览器的开发者工具有提供查看元素绑定了哪些事件的特性，
猜测是通过解析页面及其引入的 JavaScript 源码得到的
（据我所知，Firebug 的性能分析就是通过 inject 代码到各个函数中来实现的）。</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://www.w3.org/TR/2001/WD%5CnDOM%5CnLevel%5Cn3%5CnEvents%5Cn20010823/events.html#Events%5CnEventListenerList" target="_blank" rel="noopener noreferrer">https://www.w3.org/TR/2001/WD\nDOM\nLevel\n3\nEvents\n20010823/events.html#Events\nEventListenerList</a>
\n <a href="https://www.quirksmode.org/js/events%5Cnadvanced.html" target="_blank" rel="noopener noreferrer">https://www.quirksmode.org/js/events\nadvanced.html</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[宏伟的 Vimlike.js 计划]]></title>
            <link>https://hotoo.github.io/blog/post/vimlike-project</link>
            <guid>90</guid>
            <pubDate>Tue, 16 Aug 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="宏伟的-vimlikejs-计划">宏伟的 Vimlike.js 计划<a aria-hidden="true" href="#宏伟的-vimlikejs-计划">#</a></h1>
<p>一直在想：网站本身提供的快捷键支持（如 Gmail, GReader, Gplus, Twitter），
和浏览器插件提供的通用快捷键支持（Vimperator, Vimium, ...），两者如何共存，
相互之间能够相安无事，甚至能够相辅相成？</p>
<p>目前想到两种方案：</p>
<ol>
<li>白名单机制。像 AutoProxy 一样，针对不同的网站/网址，屏蔽某些键映射，
使用官方自有映射支持。不过这个要维护这份列表也是一件蛋疼的事。</li>
<li>网站根据统一约定的快捷键定义接口实现特有功能，非特有的则默认使用共有实现。
另外也提供扩展机制，让第三方插件也可以根据这个接口为特定的网站/页面实现特定功能。</li>
</ol>
<p>个人觉得第 2 中方案比较好，但这是一项宏大的项目，要各个网站遵循这个接口标准来实现，
不是一件易事。准备先把这个做到 [<a href="https://github.com/hotoo/vimlike.js" target="_blank" rel="noopener noreferrer">https://github.com/hotoo/vimlike.js</a> Vimlike.js] 项目里，
然后请一些 Vim 爱好者的个人博客一起来参与实践。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Abort HTTP 请求]]></title>
            <link>https://hotoo.github.io/blog/post/abort-http-request</link>
            <guid>91</guid>
            <pubDate>Fri, 22 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="abort-http-请求">Abort HTTP 请求<a aria-hidden="true" href="#abort-http-请求">#</a></h1>
<p>\n</p>
<p>英文不好，请教个问题：</p>
<p>\nabort\n 这个单词，好像有丢弃，中断之类的意思。</p>
<p>AJAX 发一个请求，然后 abort 掉，那么这个请求只是客户端一厢情愿的丢弃，
服务端仍然可以接收到并处理请求呢；还是直接中断这个请求，
导致服务器端也会丢弃/忽略这个请求？</p>
<p>如果翻译，应该翻成 \n丢弃 HTTP 请求\n 还是 \n中断 HTTP 请求\n ？</p>
<p>\n\n Update \n\n</p>
<p>搜索了一番，跟想象中的一致，只是客户端的一厢情愿，丢弃服务端的返回而已，
并不是服务端丢弃处理请求。</p>
<p>所以应该翻作： \n丢弃\n 。</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://weblogs.asp.net/dwahlin/archive/2007/07/17/aborting%5Cnajax%5Cnrequests.aspx" target="_blank" rel="noopener noreferrer">https://weblogs.asp.net/dwahlin/archive/2007/07/17/aborting\najax\nrequests.aspx</a>
\n <a href="https://stackoverflow.com/questions/446594/kill%5Cnajax%5Cnrequests%5Cnusing%5Cnjavascript%5Cnusing%5Cnjquery" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/446594/kill\najax\nrequests\nusing\njavascript\nusing\njquery</a>
\n <a href="https://topic.csdn.net/u/20090206/14/c43249df%5Cn29a9%5Cn4167%5Cn9dc3%5Cne3a8f738248d.html" target="_blank" rel="noopener noreferrer">https://topic.csdn.net/u/20090206/14/c43249df\n29a9\n4167\n9dc3\ne3a8f738248d.html</a>
\n <a href="https://book.51cto.com/art/200810/91493.htm" target="_blank" rel="noopener noreferrer">https://book.51cto.com/art/200810/91493.htm</a>
\n <a href="https://plus.google.com/108314985261981078822/posts/6PF4sMpegXP" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[日期时间型控件的体验]]></title>
            <link>https://hotoo.github.io/blog/post/datatime-picker</link>
            <guid>92</guid>
            <pubDate>Wed, 20 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="日期时间型控件的体验">日期时间型控件的体验<a aria-hidden="true" href="#日期时间型控件的体验">#</a></h1>
<p>目前支持精确到时分秒输入/选择的日历控件，我总觉得用起来很不爽，
却又想不出更舒适的交互方式。</p>
<p>大家有觉得哪种选择时间（非日期）的方式比较舒服一点的控件么，
或者描述一下自己期望的交互过程也好。</p>
<p>\n\n\n\n\n Update \n\n\n\n</p>
<p>Note: 我说的是 时间 (时分秒，非 日期 ，年月日 )选择/输入过程，
日期型一般点一下或少量几下就可以完成，基本上是比较自然流畅的一个过程；
但是输入/选择时间的却是非常不流畅的一个过程。</p>
<p>我只是想体验，或者尝试实现更流畅的时间输入过程，
不是想让推荐某个库的某个控件（这个控件的时间输入过程非常流畅的例外），谢谢。</p>
<p>\n\n\n\n Comment 1 \n\n\n\n</p>
<p>\nHao zi\n \n 额，我没看错，是时分秒，YUI的链接干扰理解了，
最喜欢的就是能快捷键输入时间了，普通用户应该还是更青睐鼠标。
好多地方用的6:00 am 6:30am……时间下拉单的形式我觉得不好用，
有的甚至还有6:15am……Google calender一方面可以拉动调整时间段，也不需要精确到秒，
所以用着还好。时间不是10进制，实际生活中表盘上也还需要三根针才能显示，
设计特别了用户也不好理解，我的展望如图：</p>
<p><img src="https://i.min.us/ie1Bum.jpg" alt=""></img></p>
<p>时分使用一个滑动框，秒使用一个滑动框，
时分框移动到PM仍利用AM刻度但背景色改变。
秒框稍有不同，可只显示部分刻录来避免太密集，滑块拉动到左右边缘时刻录跟着移动。</p>
<p>\n\n\n\n Comment 2 \n\n\n\n</p>
<p>\n萧星星\n \n 年月日和时分秒的处理 ： 支持键盘输入和方向增减，
支持鼠标滚轮和点击的增减 ； 滚轮的会是最流畅的， 不过用户需要一个适应过程～</p>
<p>\n\n\n\n Comment 3 \n\n\n\n</p>
<p>\n黄川\n \n 用安卓调时间的UI交互，然后鼠标放在上面，用滚轮，我觉得这种方式不错</p>
<p>\n\n\n\n Comment 4 \n\n\n\n</p>
<p>\n闲耘\n \n 鼠标滚轮，或者键盘方向键本身是不错的，我很认同。
我主要不满意的地方在于：如果 时间 随同日期的弹出层一起，
同时需要选择日期和时间时，基本上只能增加一个确定按钮来辅助实现。
现在想想，年历，月历，日历还是和时间部分独立分开的比较合适。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://plus.google.com/108314985261981078822/posts/WE37n8PSYQD" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[鼠标事件研究(Mouse Event)]]></title>
            <link>https://hotoo.github.io/blog/post/mouse-event</link>
            <guid>93</guid>
            <pubDate>Sat, 16 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="鼠标事件研究mouse-event">鼠标事件研究(Mouse Event)<a aria-hidden="true" href="#鼠标事件研究mouse-event">#</a></h1>
<p>| Event       | type   | IE       | >         | FF     | >     | Chrome   | >     | Safari   | >     | Opera    | >     |
| /          | /     | button   | which     | button | which | button   | which | button   | which | button   | which |
|\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|
| onmousedown | left   | 1        | undefined | 0      | 1     | 0        | 1     | 0        | 1     | 0        | 1     |
| /          | middle | 4        | undefined | 1      | 2     | 1        | 2     | 1        | 2     | 1        | 2     |
| /          | right  | 2        | undefined | 2      | 3     | 2        | 3     | 2        | 3     | 2        | 3     |
| onmouseup   | left   | 1        | undefined | 0      | 1     | 0        | 1     | 0        | 1     | 0        | 1     |
| /          | middle | 4        | undefined | 1      | 2     | 1        | 2     | 1        | 2     | no event | >     |
| /          | right  | 2        | undefined | 2      | 3     | 2        | 3     | 2        | 3     | 2        | 3     |
| onclick     | left   | 0        | undefined | 0      | 1     | 0        | 1     | 0        | 1     | 0        | 1     |
| /          | middle | 0        | undefined | 1      | 2     | 1        | 2     | 1        | 2     | no event | >     |
| /          | right  | no event | >         | 2      | 3     | no event | >     | no event | >     | no event | >     |</p>
<p>Windows 2003 Server.
IE8, FF5, Chrome12, Safari5, Opera11.</p>
<p>Note:</p>
<p>\n <code>document.onmousedown</code> === <code>document.addEventListener</code> === <code>document.attachEvent(&quot;onmousedown&quot;)</code>
\n <code>document.onmouseup</code> === <code>document.addEventListener(&quot;mouseup&quot;)</code> == <code>document.attachEvent(&quot;onmouseup&quot;)</code>
\n <code>document.onclick</code> === <code>document.addEventListener(&quot;click&quot;)</code> == <code>document.attachEvent(&quot;onclick&quot;)</code></p>
<pre><code>document.onmousedown = function(evt){
    evt = window.event || evt;
    var mouse = {
        left:   evt.which ? evt.which==1 : evt.button==1,
        middle: evt.which ? evt.which==2 : evt.button==4,
        right:  evt.which ? evt.which==3 : evt.button==2
    };
};
</code></pre>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://www.quirksmode.org/js/events%5Cnproperties.html" target="_blank" rel="noopener noreferrer">Event properties \n ppk</a>
\n <a href="https://hotoo.github.io/labs/mouse%5Cnevent.html" target="_blank" rel="noopener noreferrer">Demo</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[吐槽]]></title>
            <link>https://hotoo.github.io/blog/post/tucao</link>
            <guid>94</guid>
            <pubDate>Fri, 15 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="吐槽">吐槽<a aria-hidden="true" href="#吐槽">#</a></h1>
<p>上次监控系统计算得分有些非常离谱的结果，然后我就质疑后端的算法，
结果师傅兼小组长突然莫名其妙的说我“怎么老是怀疑别人，我最看不惯这种人了，
我们是一个开发团队，巴拉巴拉巴拉，，，”。</p>
<p>当时我特无语~~
只很愤怒的说了一句，“这个明显有问题，为什么还不能质疑！”</p>
<ol>
<li>第一，我只是对事不对人的质疑算法，并没有怀疑某个人。</li>
<li>第二，其实组长本身貌似对我也很不放心，老怀疑我这个，质疑我那个，
有一些简洁清晰到不可能有问题的代码，还是要我去做各种检验。
我一直都没有什么二话去执行的，直到他连续 N 遍说到我烦为止。</li>
</ol>
<p>自己老怀疑他人，还说最讨厌其他人的怀疑态度的，其实也没什么了，
都这样，人性的双重性格而已。</p>
<p>之前有几次组长来质疑我同一个问题，今天又来了，说我检测到的脚本错误，
前端开发很多都不承认，说他们不能重现，认为不准。说我虽然发现了他们的问题，
但是他们不愿意、或者没有办法去改，问我怎么办？！这是什么逻辑。</p>
<p>有不能解决的问题也不多搜索，也不群里问，说我的不准也没见来找我辩驳，
一口咬定我的不准，不承认我的工作，这算什么。</p>
<p>然后说让我找一个报的次数最多的错误实例，说让我重现，那个错误是“错误的数量词”，
我去，这个我在常见脚本错误文档里写了那么多都白写的么！</p>
<p>这是一个表单验证函数中使用 new RegExp(str) 导致的错误，str 是来自用户的输入，
却没有经过转义处理，代码级可以肉眼看出来的错误，说让我那边表单实际试试嘛，
那个表单要邮箱验证，还要好几步才能进去呢。我蛋疼么。</p>
<p>给了个最简单的 new RegExp("+") 还是说让我去表单上试。说“不拿出实际例子出来，
没有资格说别人有问题！”</p>
<p>究竟要多无语，才能说明我无语啊~~~</p>
<p>怒道：有些问题看代码就有明显的问题，根本就无需睁着眼睛瞎测试。
昨天看到热点分布那里使用 evt.clientY 这样的代码，还需要去试一下么，
难道还需要我去告诉开发你应该滚动下浏览器的滚动条来重现？</p>
<p>终于迎来了艰难的沉默。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://plus.google.com/108314985261981078822/posts/QP8j6KY8Ey9" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[豆瓣电台，我忍你很久了！]]></title>
            <link>https://hotoo.github.io/blog/post/douban.fm</link>
            <guid>95</guid>
            <pubDate>Wed, 13 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="豆瓣电台我忍你很久了">豆瓣电台，我忍你很久了！<a aria-hidden="true" href="#豆瓣电台我忍你很久了">#</a></h1>
<p>豆瓣电台做的太烂，估计算法是一个有怀旧情节的家伙设计的。</p>
<p>听的越多， +1 的歌曲越多，重复播放的可能性越高，
同一个音乐人的歌曲被重放的可能性也越高，导致每天都在听一些听过 N 遍的歌曲。</p>
<p>我 +1 不过是希望算法通过数据能再了解我一点，用来向我推荐其他类似风格的音乐人/乐曲。</p>
<p>如果只是从我已经 +1 的歌曲中重复播放，我要一个电台干什么？！
我的播放器就已经做的很好啊，稍笨一点，播放器或音乐文件属性中设置标星等级；
再笨一点，做一个播放列表，把喜欢的音乐加进去；更笨一点，单曲循环播放好了。</p>
<p>登录了在豆瓣电台标星/删除/下一曲，只因为手贱吗？豆瓣，我忍你很久了。</p>
<h2 id="comment">Comment<a aria-hidden="true" href="#comment">#</a></h2>
<p>我情愿去听虽然有主持人在啰嗦或煽情，但重复少得多也不那么乏味的国内无线电台。</p>
<p>另外推荐一个国外无主持人的网络电台，有很多风格的频道（非豆瓣分类方式），
这个是我最喜欢的 NewAge 风格的，请欣赏 <a href="https://www.sky.fm/play/newage" target="_blank" rel="noopener noreferrer">https://www.sky.fm/play/newage</a></p>
<p>前段时间有被墙或网络很不好才勉强听的豆瓣，今天发现又回来了，谢谢国家。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://plus.google.com/108314985261981078822/posts/RfNu31TLpmL" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[非递归遍历 DOM 结构]]></title>
            <link>https://hotoo.github.io/blog/post/non-recursion-walk-the-dom</link>
            <guid>96</guid>
            <pubDate>Sun, 10 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="非递归遍历-dom-结构">非递归遍历 DOM 结构<a aria-hidden="true" href="#非递归遍历-dom-结构">#</a></h1>
<p>上次在Google+ 上说 <a href="https://plus.google.com/108314985261981078822/posts/ithY3w7tEWR" target="_blank" rel="noopener noreferrer">实现了非递归遍历 DOM 结构</a>，
有朋友想让分享，我当然很高兴，但是很遗憾这本身没有什么值得分享的，大致如下，
给大家随便看一下：</p>
<p>常见的递归方式遍历方式，下面是 Douglas Crockford 写的递归实现：</p>
<pre><code>function walkTheDOM (node, func) {
    func(node);
    node = node.firstChild;
    while (node) {
        walkTheDOM(node, func);
        node = node.nextSibling;
    }
}
</code></pre>
<p>然后有人自称写出了更快的遍历 DOM 方式。</p>
<pre><code>var elems = document.getElementsByTagName(&quot;\n&quot;);
for(var i=0,l=elems.length; i&lt;l; i++){
    handler(elems[i]);
}
</code></pre>
<p>最初找到有详细对照的文章地址没有找到，这个是
<a href="https://geekswithblogs.net/mparsons/archive/2006/03/02/71175.aspx" target="_blank" rel="noopener noreferrer">类似的一篇</a>，
而且也是非递归式的。</p>
<p>确实是很快的，但只是快还是不够的，这个实现有很多弊端：</p>
<ol>
<li>注释等元素未必会被遍历。</li>
<li>树形数据结构被整理成了平板结构，无法实现遍历过程的 in/out 处理。</li>
</ol>
<p>然后今天的主角隆重登场：</p>
<pre><code>function walk(node, enter, leave){
    var tmp, n=node;
    label:
    do{
        enter(n);
        if(tmp = firstNode(node)){ // firstChild(HTMLElement)
            n = tmp;
        }else if(tmp = nextNode(n)){ // nextSibling(HTMLElement)
            n = tmp;
        }else if(n.parentNode){
            do{
                n = n.parentNode;
                leave(n);
                if(n == node){break label;}
                if(tmp = nextNode(n)){
                    n = tmp;
                    continue label;
                }
            }while(node);
        }else{
            break;
        }
    }while(n &amp;&amp; n!=node);
}
</code></pre>
<p>上面只是一个精简版，实际过程中还需要考虑节点类型的问题，一般会过滤
1:HTMLElement, 8:Comment, 9:Document Type, 10:DocType 之外的节点。</p>
<p>其实也不过如此嘛，飘过~~</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://www.quirksmode.org/dom/intro.html" target="_blank" rel="noopener noreferrer">W3C DOM \nIntroduction \n ppk</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[说说渐进加载]]></title>
            <link>https://hotoo.github.io/blog/post/about-lazy-load</link>
            <guid>97</guid>
            <pubDate>Fri, 08 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="说说渐进加载">说说渐进加载<a aria-hidden="true" href="#说说渐进加载">#</a></h1>
<ol>
<li>google+, quora, twitter... 这些网站都使用渐进加载数据的方式，
类似的还有淘宝图片的懒加载，都是等用户真正滚到最后之后才开始去加载，
提前一些预加载体验不是更好么。</li>
</ol>
<p> </p>
<ol start="2">
<li>到最后一页了还是有“更多”，直到点击最后一个更多没加载到数据才告诉用户
没更多数据了，这不是蛋疼么？</li>
</ol>
<p>估计是基于算法上的考虑，比如每页 10 条：</p>
<pre><code>dataList = select top 10 \n from table where id &gt; 10 \n page;
for(var i=0,l=dataList.length; i&lt;l; i++){}
hasMore = select top 1 \n from table where id &gt; 10\n(page+1);
</code></pre>
<p>这样要查询 2 次。</p>
<p>不过只查数据库一次也是可以的：</p>
<pre><code>datas = select top 11 \n from table where id &gt; 10\npage;
for(var i=0,l=min(data.length, 10); i&lt;l; i++){}
hasMore = datas.length == 11;
</code></pre>
<p>好久不写后端程序，不知道他们这么做是否有基于其他的考虑？</p>
<p>p.s. Google+ 个笨蛋居然剔除行首的有效空白，而不剔除行尾的无效空白。。。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://plus.google.com/108314985261981078822/posts/WrYSxHJnDXW" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Vimlike.js]]></title>
            <link>https://hotoo.github.io/blog/post/vimlike.js</link>
            <guid>98</guid>
            <pubDate>Fri, 08 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vimlikejs">Vimlike.js<a aria-hidden="true" href="#vimlikejs">#</a></h1>
<p>很久之前做了一个 <a href="https://github.com/hotoo/Vimlide" target="_blank" rel="noopener noreferrer">Vimlike 的 HTML(5) Slide</a>，
很小的一个玩意，但是很好玩。里面支持 normal, search, command, help 等模式，
最初是每个单独自己 Copy 的一份，然后精简成各个模式自己需要的键映射。</p>
<p>一直想把这个 Vimlike 的键映射部分抽象提取处理，前段时间 Google+ 出来的时候，
看到 mattn 做的一个用来
<a href="https://github.com/mattn/GooglePlusCommander" target="_blank" rel="noopener noreferrer">支持 +, c, s ... 等快捷键的 user\nscript</a>，
我就立即提议实现 gg, G, gh, gp, gP 这些键盘映射，并把这个 Vimlike 键映射抽取好了。</p>
<p>抽取的过程基本还顺利，只遇到一点点小问题，另外还做了些优化。</p>
<p>之前为了避免无映射的键 push 到 history 中造成无法正确触发键映射的问题
（比如只映射了 <code>&lt;Esc&gt;</code> 键，其他的 abc 之类的键会 push 到 histroy 中，
尝试对应的映射是找不到的，后续的键就无法触发了），采用优先触发当前键事件的方式。</p>
<p>仔细想了想，优先考虑当前 key 是不合理的，比如同时映射了 j 和 gj，
由于优先原则的干扰，造成 gj 永远都不会被触发。</p>
<p>接着以为针对 <code>&lt;Esc&gt;</code>, <code>&lt;CR&gt;</code>, <code>&lt;Tab&gt;</code> 等键特殊处理，遇到这种键直接触发，
不放到 history 中就差不多可以了。</p>
<p>继续深入思考，仍然不够，其实完整的 Vim\nlike 如果要支持 mark, g+, z+, +,
等一系列的扩展支持，都需要有内置支持，否则就是需要类似
map("m[a\nzA\nZ0\n9]", function()) 这样的模糊映射支持了。</p>
<p>实现增强版的内置扩展键支持，还是实现模糊映射支持，这是个问题？</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://github.com/hotoo/Vimlike.js" target="_blank" rel="noopener noreferrer">Vimlike.js@github</a>,
<a href="https://hotoo.github.io/Vimlike.js/Vimlike.html" target="_blank" rel="noopener noreferrer">Demo</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[说说支付宝爱心捐助]]></title>
            <link>https://hotoo.github.io/blog/post/love.alipay.com</link>
            <guid>99</guid>
            <pubDate>Mon, 04 Jul 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="说说支付宝爱心捐助">说说支付宝爱心捐助<a aria-hidden="true" href="#说说支付宝爱心捐助">#</a></h1>
<p>以前我还持续捐助，但是我觉得支付宝爱心捐助
我是越来越没法持续捐助下去了，那该死的 KPI 要求项目达到 XX 数量，
狗日的又没有质量要求。</p>
<p>每天救救这个，帮帮那个，都是一些实体的捐助对象，看这很痛心，但排成一排来展览，
看着就有点恶心了，让人看不下去，吃不下饭。</p>
<p>我知道国内 NGO 很难，靠谱的也不多。但是我还是希望相对靠谱一点的机构
（下面都简称慈善机构，支付宝本身不是也有爱心小组么，虽然好像都是业余的）
来做这些实体的捐助过程，安排捐助计划，定时公开捐助报表，
普通捐助人只需要持续对这个机构捐助就好了。</p>
<p>像对一个人、或一个家庭这么小的单位，慈善机构自己可以自己列为项目，计划支出，
但捐助人真的无需去直接接触。你说我捐助了某个病人A，不去捐助另一个病人B吗？
世界上困难的人这么多，每个捐助人都需要一个个去直接指定捐助么？
这种事情慈善机构能有一点自己的计划么，该不该捐助，该如何捐助，
你慈善机构没有计划，你还让捐助人信任你什么？！</p>
<p>而对于重大集体性灾难，可以在爱心捐助平台上展示一个项目，让更多的人知晓，
传播给更多的人来支持捐助，而且一般这种项目，捐助人是很希望可以指定捐助的，
比如上次日本地震+海啸+核污染，中国大陆居然没有可靠方便的捐助方式，简直是匪夷所思。</p>
<p>最后给大家献给一曲《<a href="https://www.tudou.com/programs/view/sx7rLsjqfJY/" target="_blank" rel="noopener noreferrer">无地自容</a>》</p>
<blockquote>
<p>策划：雅沫
导演：莞儿
曲：李丹
词：刘咚咚
唱：@土著Walker</p>

<p>美眉她姓郭，爱炫自我；
各种名包，各种好车；
微博经认证，名头热火；
红十字会商业老总；
是否涉嫌炒作，你最清楚；
妹子到底想要揭露什么？
何必东藏西躲，又何必删贴；
迟早有一天你会面对我；
天灾人祸中，常看到你；
宣扬博爱，弘扬道义；
捐款全给你，进出无明细；
庞大帐目谁在审计；
总在自说自话，难自圆其说；
百姓问你到底做了什么？
不要再装沉默，你实话实说；
我们的爱心多少被挥霍；
商红会无车，清贫如洗；
没有电脑没有手续；
成立十几年，从不会登记；
中红博爱惹人注意；
总在自说自话，难自圆其说；
百姓问你到底做了什么？
不要再装沉默，你实话实说；
我们的爱心多少被挥霍；
不再相信，相信什么公益；
除非捐款公布明细；
这场危机，怎样才能过去；
不必追究是谁的错；
我曾为你献血，也曾替你开脱；
如今献唱一曲，让你无地自容！</p>
</blockquote>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://plus.google.com/108314985261981078822/posts/8gAama93tnW" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[“盗梦空间”]]></title>
            <link>https://hotoo.github.io/blog/post/dream-the-thief</link>
            <guid>100</guid>
            <pubDate>Thu, 30 Jun 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="盗梦空间">“盗梦空间”<a aria-hidden="true" href="#盗梦空间">#</a></h1>
<p>前段时间公司发生了好几次盗窃案，虽然很快破案了，但总还是感觉不太安全。
前几天有同事跟我说不要把自己本本放在公司，但是我却不以为然，公司座位那么多，
而且柜子还锁着，偷到我的位置上的概率没那么高吧！</p>
<p>昨晚做梦，说我心爱的小黑晚上盗了，我悲痛欲绝，无法相信这是真的。</p>
<p>仿佛知道是在夜里做梦似的，或者是因为盗窃案发生在夜里的缘故，我梦里深夜赶到公司，
看到柜子被撬开了，翻乱一地。保安说摄像头有拍下整个过程，然后带我们去监视室。</p>
<p>我们进的应该不是监视室，那种房间我去过，肯定不是。而且我也没有看到录像，
梦里乱七八糟的，盗贼的脸留下了悬念。另外虽然有录像，但是破案又是另外一回事了。</p>
<p>第二天上班，没有电脑，然后师傅天蓬急了，给相关人员（ IT ?）
说好并让我去申请一天小台，但居然又是去的监视室的那个房间。
IT 给我一台谁谁用过的小白，然后我就出来了。</p>
<p>过了一会儿，我突然想起拿小白的时候仿佛瞟到我的小黑在那监视室的一张很乱的桌子上
放着，我赶紧过去看，果然，是放在那里，我心爱的小黑。</p>
<p>梦里似乎有一个很合理的解释为什么我的小黑在这个房间里，仿佛是已经破案了，
“赃物”都放在这里。呃，是这么回事么？可惜我已经记不清了。</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://plus.google.com/108314985261981078822/posts/9LLgAcSrpbs" target="_blank" rel="noopener noreferrer">@Google+</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[丢弃图片的 HTTP 请求]]></title>
            <link>https://hotoo.github.io/blog/post/abort-image-request</link>
            <guid>101</guid>
            <pubDate>Thu, 23 Jun 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="丢弃图片的-http-请求">丢弃图片的 HTTP 请求<a aria-hidden="true" href="#丢弃图片的-http-请求">#</a></h1>
<p>\n</p>
<p>| OS       | Browser        | ""    | null  | remove | delete | stop | StopImage | Stop | Button | Timeout    |
|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n|\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n|\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n|
| Windows  | IE6,7,8        | √(e) | √(e) | II     | ×     | ×   | ×        | ×   | ×     | 21s (e)    |
| /       | FF4,5          | II    | II    | II     | ×     | II   | ×        | ×   | II     | 21s (e)    |
| /       | Chrome12       | ×    | ×    | ×     | ×     | II   | ×        | ×   | II     | 21s (e)    |
| /       | Safari4,5      | ×    | ×    | ×     | ×     | II   | ×        | ×   | II     | 21s (e)    |
| /       | Opera9         | ×    | √(e) | ×     | ×     | II   | ×        | ×   | II     | 47s (e)    |
| /       | Opera11        | II    | √(e) | II     | II     | II   | ×        | ×   | II     | 47s (e)    |
| Mac OS X | Safari5        | ×    | ×    | ×     | ×     | II   | ×        | ×   | II     | 1.2m (e)   |
| /       | Chrome12       | ×    | ×    | ×     | ×     | II   | ×        | ×   | II     | 1.2m (e)   |
| /       | FF4,5          | II    | II    | II     | ×     | II   | ×        | ×   | II     | 1m'15s (e) |
| Ubuntu   | FF4,5          | II    | II    | II     | ×     | II   | ×        | ×   |        | 3m'9s (e)  |
| /       | Chrom(e/ium)12 | ×    | ×    | ×     | ×     | II   | ×        | ×   |        | 3.2m (e)   |</p>
<p>\n Windows XP, Server 2003, 7.
\n Mac OS X 10.6.7
\n Ubuntu 11.04</p>
<p>\n标题注解：\n</p>
<pre><code>&quot;&quot;:: `img.src = &quot;&quot;`
null:: `img.src = null`
revmove:: `img.removeAttribute(&quot;src&quot;)`
delete:: `delete img[&quot;src&quot;]`
stop:: `window.stop()`
StopImage:: `document.execCommand(&quot;StopImage&quot;)`
Stop:: `document.execCommand(&quot;Stop&quot;)`
Button:: Browser Stop Button.
</code></pre>
<p>\n图标注解：\n</p>
<pre><code>√:: 能够 Abort 图片请求，并回调 (e)onerror/(a)onabort/(l)onload 函数。
II:: 能够 Abort 图片请求，但不触发任何事件进行回调。
≈:: 部分版本支持。如 Stop/StopImage 在 .NET Framework 3.0 中取消了支持。
×:: 不能 Abort 图片请求，或不支持该方法。
</code></pre>
<h2 id="事件回调">事件回调<a aria-hidden="true" href="#事件回调">#</a></h2>
<pre><code>var img = new Image();
img.onload = function(){out.innerHTML += &quot;loaded.&quot;;};
img.onabort = function(){out.innerHTML += &quot;aborted.&quot;;};
img.onerror = function(){out.innerHTML += &quot;errored.&quot;;};
window.setTimeout(function(){
    out.innerHTML += &quot;before.&quot;;
    // abort.
    img.src = null;
    out.innerHTML += &quot;after.&quot; + img.complete;
}, 2000);
</code></pre>
<p>测试结果：</p>
<pre><code>IE:: before.errored.after.
Opera:: before.after.errored.
FF:: before.after.
Chrome:: before.after.
Safari:: before.after.
</code></pre>
<h2 id="todo丢弃-jsonp-请求">TODO:丢弃 jsonp 请求？<a aria-hidden="true" href="#todo丢弃-jsonp-请求">#</a></h2>
<p>为什么不是 script/link?</p>
<p>使用 document.createElement("script") 创建元素并设置 src 属性，
appendChild 到 DOM 中会去请求指定资源，可以到底向日志服务器发送数据的要求。</p>
<p>但是使用这种方式有一下几点弊端：</p>
<ol>
<li>
<p>创建脚本带来的危险性。</p>
</li>
<li>
<p>会向 DOM 中附加元素，影响 DOMLint 校验。</p>
</li>
<li>
<p>无法 abort，无论设置 <code>script = null;</code>, <code>script.src=&quot;&quot;;</code>, <code>script.src=null;</code>,
<code>script.removeAttribute(&quot;src&quot;);</code>, <code>document.body.removeChild(script);</code>
都无法实现 abort.</p>
</li>
<li>
<p>引入资源不触发 onload/onerror/onabort 事件，除非使用 jsonp 的方式，
对元素本身无法得到回调。</p>
</li>
</ol>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://stackoverflow.com/questions/930237/javascript%5Cncancel%5Cnstop%5Cnimage%5Cnrequests" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/930237/javascript\ncancel\nstop\nimage\nrequests</a>
\n <a href="https://www.sysopt.com/forum/archive/index.php/t%5Cn177147.html" target="_blank" rel="noopener noreferrer">https://www.sysopt.com/forum/archive/index.php/t\n177147.html</a>
\n <a href="https://stackoverflow.com/questions/1671717/javascript%5Cnimage%5Cnonabort%5Cnevent%5Cnnot%5Cnfiring%5Cnin%5Cnfirefox%5Cnchrome" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/1671717/javascript\nimage\nonabort\nevent\nnot\nfiring\nin\nfirefox\nchrome</a>
\n <a href="https://stackoverflow.com/questions/4506160/abort%5Cnactive%5Cnimage%5Cnrequests" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/4506160/abort\nactive\nimage\nrequests</a>
\n <a href="https://www.devguru.com/technologies/ecmascript/quickref/image.html" target="_blank" rel="noopener noreferrer">https://www.devguru.com/technologies/ecmascript/quickref/image.html</a>
\n <a href="https://stackoverflow.com/questions/930237/javascript%5Cncancel%5Cnstop%5Cnimage%5Cnrequests" target="_blank" rel="noopener noreferrer">Javascript: Cancel/Stop Image Requests</a>
\n <a href="https://www.google.com/support/forum/p/Chrome/thread?tid=4bf113154d53d101&amp;hl=en" target="_blank" rel="noopener noreferrer">Can't you stop images from loading?</a>
\n <code>window.stop()</code>
\n <a href="https://stackoverflow.com/questions/930237/javascript%5Cncancel%5Cnstop%5Cnimage%5Cnrequests" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/930237/javascript\ncancel\nstop\nimage\nrequests</a>
\n <a href="https://stackoverflow.com/questions/3146200/stop%5Cnloading%5Cnof%5Cnimages%5Cnon%5Cna%5Cnhashchange%5Cnevent%5Cnvia%5Cnjavascript%5Cnor%5Cnjquery" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/3146200/stop\nloading\nof\nimages\non\na\nhashchange\nevent\nvia\njavascript\nor\njquery</a>
\n <a href="https://developer.mozilla.org/en/DOM/window.stop" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en/DOM/window.stop</a>
\n <code>execCommand</code>
\n <a href="https://msdn.microsoft.com/en%5Cnus/library/ms536419%28v=vs.85%29.aspx" target="_blank" rel="noopener noreferrer">execCommand Method</a>
\n <a href="https://msdn.microsoft.com/en%5Cnus/library/ms536419%28v=vs.85%29.aspx" target="_blank" rel="noopener noreferrer">https://msdn.microsoft.com/en\nus/library/ms536419%28v=vs.85%29.aspx</a>
\n <a href="https://msdn.microsoft.com/en%5Cnus/library/ms533049%28v=vs.85%29.aspx" target="_blank" rel="noopener noreferrer">https://msdn.microsoft.com/en\nus/library/ms533049%28v=vs.85%29.aspx</a>
\n <a href="https://developer.mozilla.org/En/Document.execCommand" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/En/Document.execCommand</a>
\n <a href="https://www.xiahaixia.com/2010/11/19/ie6%E4%B8%8B%E9%93%BE%E6%8E%A5onclick%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E8%AF%B7%E6%B1%82%E8%A2%ABaborted/" target="_blank" rel="noopener noreferrer">IE6下链接ONCLICK事件处理中的请求被ABORTED</a>
\n <a href="https://www.cnblogs.com/zhyt1985/archive/2009/05/27/1490755.html" target="_blank" rel="noopener noreferrer">What does (Aborted) mean in HttpWatch?</a>
<a href="https://www.sanotes.net/html/y2008/165.html" target="_blank" rel="noopener noreferrer">来源</a>
\n <a href="https://blog.httpwatch.com/2007/11/20/error%5Cninternet%5Cninvalid%5Cnurl%5Cnhttpwatch/" target="_blank" rel="noopener noreferrer">https://blog.httpwatch.com/2007/11/20/error\ninternet\ninvalid\nurl\nhttpwatch/</a>
\n <a href="https://www.cnblogs.com/mayingbao/archive/2007/11/30/978530.html" target="_blank" rel="noopener noreferrer">HttpWatch工具简介及使用技巧</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[如何取 URL 中第一个单独的问号(?) 位置]]></title>
            <link>https://hotoo.github.io/blog/post/how-to-get-the-first-single-question-mark</link>
            <guid>102</guid>
            <pubDate>Wed, 22 Jun 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="如何取-url-中第一个单独的问号-位置">如何取 URL 中第一个单独的问号(?) 位置<a aria-hidden="true" href="#如何取-url-中第一个单独的问号-位置">#</a></h1>
<p>新版 Arale 通过 nginx 服务支持使用双问号的访问方式：</p>
<pre><code>https://www.example.com/??module.js
</code></pre>
<p>访问 <code>https://www.example.com/module.js</code></p>
<p>通过正则的正向预搜索有办法获得第一个单问号的位置么？</p>
<pre><code>var r = /\?(?!\?)/;
</code></pre>
<p>会匹配双问号的第 2 个问号：</p>
<pre><code>https://www.example.com/??modu.js
                         ^
</code></pre>
<pre><code>var path = function(uri){
    var idx = uri.indexOf(&quot;;jsessionid=&quot;);
    if(idx &gt;= 0){return uri.substr(0, idx);}

    do{
        idx = uri.indexOf(&quot;?&quot;, idx);
        if(idx &lt; 0){break;}
        if(&quot;?&quot; == uri.charAt(idx+1)){
            idx += 2;
        }else{
            break;
        }
    }while(idx &gt;= 0);

    return idx &lt; 0 ? uri : uri.substr(0, idx);
};
</code></pre>
<p>目前是通过循环方式计算的，无心比较遍历和正则之间无优劣，
纯粹对于正则的实现很有兴趣 :)</p>
<h2 id="答案一">答案一：<a aria-hidden="true" href="#答案一">#</a></h2>
<pre><code>var path = function(uri){
    return uri.replace(/;jsessionid=.\n\n/, &quot;&quot;)
        .replace(/^(.\n?[^?])\?[^?]/, &quot;\n1&quot;);
};
</code></pre>
<h2 id="答案二">答案二：<a aria-hidden="true" href="#答案二">#</a></h2>
<p>上面用了两个相同规则的分组，这里可以减少到一个分组</p>
<pre><code>&quot;asdfadf??a?a&quot;.replace(/([^\s])\?\1/, &#39;\n1\n\n1&#39;); // &quot;asdfadf??a\na&quot;
</code></pre>
<p>但是这种做法对于问号(?)在字符串首尾时没有办法匹配</p>
<pre><code>var temp= &quot;12345???89?asdf&quot;.search(/(?:[^?]|^)\?(?!\?)/);
var index = temp ? temp + 1 : temp; // index的就想要的索引值
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用 Vimwiki 还是 Jekyll 作为博客系统？]]></title>
            <link>https://hotoo.github.io/blog/post/blog-system-vimwiki-or-jekyll</link>
            <guid>103</guid>
            <pubDate>Sun, 19 Jun 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="使用-vimwiki-还是-jekyll-作为博客系统">使用 Vimwiki 还是 Jekyll 作为博客系统？<a aria-hidden="true" href="#使用-vimwiki-还是-jekyll-作为博客系统">#</a></h1>
<p>一直使用 Vimwiki 作为个人博客系统，今天非常荣幸收到加入
<a href="https://planet.vim%5Cncn.com/" target="_blank" rel="noopener noreferrer">Vim 中文星</a> 的邀请，需要我的提供 RSS/Atom 输出。</p>
<p>但是 Vimwiki 本质上是一个 wiki 系统，通常来说都是（个人推荐）作为平板结构
来放置信息，较少（但也支持）基于目录，尤其是基于日期时间格式的目录结构来存储
词条（或者说日志），所以要支持基于时间的 RSS/Atom 就有一定的困难，而且貌似
需求本身也不怎么合理，不过 github 的提交记录里是有 RSS 输出的，虽然作为博客
订阅的意义几近于无。</p>
<p>于是想是否有必要在 Wordpress 上同步更新博客（Blogger 被墙的厉害），但是发现
很久以前（还是在拥有 xianyun.org，并使用 <a href="mailto:mail@xianyun.org">mail@xianyun.org</a>）注册的 Wordpress，
杯具的忘记密码了，注册的邮箱也不再使用，无法索取找回密码了。</p>
<p>于是想：迁移到 Jekyll 怎么样？</p>
<p>由于 github pages 的缘故，很早就大致了解了下 Jekyll，但是没有深入，一直主观的
认为 Jekyll 会根据模板动态转换 markdown/textile 文件。但是更深入的了解之后
发现，Jekyll 只是一个静态文件转换程序，通过模板引擎将数据（博客日志）和模板
转换成静态 HTML 文件。</p>
<p>\n 支持 markdown, textile 语法。
\n 支持生成 RSS, ATOM。
\n ruby 脚本生成静态文件。
\n 需要将安装 ruby 和 jekyll.</p>
<p>而 Vimwiki 是一个基于 Vim 的 wiki 客户端程序，提供便于管理和使用的本地 wiki 支持。</p>
<p>\n 支持 wiki 语法。
\n 不支持生成 RSS, ATOM。
\n Vim script 生成静态文件。
\n 需要安装 Vim, Vimwiki.</p>
<p>我个人目前最简单的需求，就是在 Vimwiki 的基础上实现 RSS 输出的支持。不过完整
、完美意义上来说，我还是希望有这样一个博客系统。</p>
<p>\n 支持 wiki, markdown, textile 或其他语法。(Vimwiki, Jekyll)
\n 支持生成 RSS/Atom 输出. (Jekyll)
\n 通过 Vim(script) 或其他易于安装使用的程序，将日志+模板自动生成 HTML 文件。(Vimwiki, Jekyll)
\n 日志原始文件通过 Dropbox 或其他云服务自动同步，无需 push 到 github。(Vimwiki)
\n 只将生成好的静态 HTML 文件 push 到 github。(Vimwiki)</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://kyle.xlau.org/2009/08/13/blogging%5Cnlike%5Cna%5Cnhacker.html" target="_blank" rel="noopener noreferrer">像黑客一样写博客</a>
\n <a href="https://blog.leezhong.com/tech/2010/08/25/make%5Cngithub%5Cnas%5Cnblog%5Cnengine.html" target="_blank" rel="noopener noreferrer">使用github作为博客引擎</a>
\n <a href="https://www.yangzhiping.com/tech/wordpress%5Cnto%5Cnjekyll.html" target="_blank" rel="noopener noreferrer">告别wordpress，拥抱jekyll</a>
\n <a href="https://roylez.heroku.com/2010/02/04/jekyll%5Cnon%5Cnheroku.html" target="_blank" rel="noopener noreferrer">在heroku上用jekyll做博客</a>
\n <a href="https://www.shaoshing.com/2010/04/03/blog%5Cnengine%5Cnjekyll%5Cnvs%5Cntoto/" target="_blank" rel="noopener noreferrer">轻量级博客工具: Jekyll vs ToTo</a>
\n <a href="https://blog.miaout17.net/2011/05/08/convert%5Cnwordpress%5Cnto%5Cnjekyll%5Cnand%5Cndisqus/" target="_blank" rel="noopener noreferrer">將Wordpress轉移到Jekyll及Disqus</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[多种不同结果的返回模式]]></title>
            <link>https://hotoo.github.io/blog/post/parser-return-pattern</link>
            <guid>104</guid>
            <pubDate>Wed, 08 Jun 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="多种不同结果的返回模式">多种不同结果的返回模式<a aria-hidden="true" href="#多种不同结果的返回模式">#</a></h1>
<p>探讨个问题哈，我现在再做一个 HTML 校验工具，先将 HMTL 源码解析成 DOM 树，
其间可能遇到语法错误，为了发现更多的错误，会跳到下一个分界点继续解析；
然后将解析得到的 DOM 树返回给 lint 工具继续进行进一步的语法、语义解析。
其过程是：</p>
<pre><code>var dom = parse(html){cap(err); return dom;};
var lintErr = lint(dom){return err;};
</code></pre>
<p>最终需要将 parse 和 lint 的错误收集到一起反馈给服务端。</p>
<p>请问，parse 有什么好的方式来返回解析时错误信息？</p>
<p>之前先是将 parse 设计成了函数式，但是我觉得下面这种返回方式很不好：</p>
<pre><code>return {
    dom: dom,
    err: err
};
</code></pre>
<h2 id="另外一种思路">另外一种思路<a aria-hidden="true" href="#另外一种思路">#</a></h2>
<p>HTMLParser 设计成独立的类（而不是上面的函数方式）</p>
<pre><code>var HTMLParser = function(){
    var err = [];
    this.parse = function(html){
        var dom = {};

        err.push(new Error(&quot;this is not error.&quot;));
        err.push(new Error(&quot;err is not error.&quot;));

        return dom;
    };
    this.getErrors = function(){
        return err;
    };
};

function main(html){
    var parser = new HTMLParser();
    var dom = parser.parse(html);
    var err = parser.getErrors();
    var result = HTMLint(dom);

    // concat array to err.
    Array.prototype.push.apply(err, result);

    return err;
};
</code></pre>
<p>貌似这种方式比上面的稍好一点，不过我又不想为此将原本很简单的函数式改成
对象式。</p>
<h2 id="外部数据存储">外部数据存储<a aria-hidden="true" href="#外部数据存储">#</a></h2>
<pre><code>var Console = (function(){
    var \nerr = [];
    function log(err){
        \nerr.push(err);
    }
    function getErr(){
        return \nerr;
    }

    return {
        log: log,
        getErrors: getErr
    };
});
var HTMLParse = function(){
    Console.log(new Error(&quot;syntax error.&quot;));
    Console.log(new Error(&quot;parse error&quot;));

    return dom;
};
var HTMLint = function(dom){
    var err = [];
    err.push(new Error(&quot;lint error.&quot;));
    err.push(new Error(&quot;lint error.&quot;));
    return err;
};
function main(html){
    var dom = HTMLParse(html);
    var parseErr = Console.getErrors();
    var lintErr = HTMLint(dom);

    Array.prototype.push.apply(parseErr, lintErr);

    return parseErr;
}
</code></pre>
<p>对于只有一个实例（或运行一次）的情况，第三方独立的 <code>console</code> 是合适的。
但是一旦需要多个实例（或运行多次，每次Parse的结果都各自独立，
每个html的parse和lint的错误结果各自拼接一起，但是不是所有的html的parse+lint错误结果拼接在一起）
的情况，还是将解析异常信息和解析器本身绑定在一起（比如类）的方式比较合适。</p>
<p>上面的文字有点绕，表达式：</p>
<pre><code>err0 = parseError0 + lintError0;
err1 = parseError1 + lintError1;
</code></pre>
<p>err0 和 err1 是各自独立的，实例化多个第三方独立的有专用的Console，不如用类的方式好了。</p>
<h2 id="寻求指教">寻求指教<a aria-hidden="true" href="#寻求指教">#</a></h2>
<p>对于这种需要返回多种不同数据的函数式，
如果你有其他的方案，欢迎回帖、回邮，或回博交流指导 ：）</p>
<h2 id="更新-2013">更新 (2013)<a aria-hidden="true" href="#更新-2013">#</a></h2>
<p>事件机制可能是最好的选择：</p>
<pre><code>parser.on(&quot;error&quot;, function(err){
});
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[closure-compiler.vim]]></title>
            <link>https://hotoo.github.io/blog/post/closure-compile.vim</link>
            <guid>105</guid>
            <pubDate>Thu, 26 May 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="closure-compilervim">closure-compiler.vim<a aria-hidden="true" href="#closure-compilervim">#</a></h1>
<p><a href="https://github.com/hotoo/vimrc/blob/master/plugin/ClosureCompiler.vim" target="_blank" rel="noopener noreferrer">ClosureCompiler.vim</a></p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://vim.wikia.com/wiki/Auto%5Cncompile%5CnJavascript%5Cnwith%5CnClosure" target="_blank" rel="noopener noreferrer">Auto compile Javascript with Closure</a>
\n <a href="https://blog.othree.net/log/2009/09/08/vim%5Cnjs%5Cnyuicompressor/" target="_blank" rel="noopener noreferrer">Vim 儲存完 JavaScript 檔案後自動用 yuicompressor</a>
\n <a href="https://bootleq.blogspot.com/2010/08/vim%5Cnfuncion%5Cnclosure%5Cncompiler%5Cnjs.html" target="_blank" rel="noopener noreferrer">Vim function：使用 closure compiler 壓縮 js 文件</a>
\n <a href="https://www.cnblogs.com/JeffreyZhao/archive/2009/12/09/ikvm%5Cngoogle%5Cnclosure%5Cncompiler.html" target="_blank" rel="noopener noreferrer">在项目中使用Google Closure Compiler</a>
\n <a href="https://ued.taobao.com/blog/2010/12/23/advanced%5Cnoptimization%5Cnin%5Cnclosure%5Cncompiler%5Cnand%5Cnmore/" target="_blank" rel="noopener noreferrer">Closure Compiler 高级模式及更多思考</a>
\n <a href="https://www.slideshare.net/lifesinger/closure%5Cncompiler%5Cnvs%5Cnyuicompressor" target="_blank" rel="noopener noreferrer">Closure Compiler vs YUICompressor</a>
\n <a href="https://gist.github.com/545665" target="_blank" rel="noopener noreferrer">function to use closure\ncompiler</a>
\n <a href="https://code.google.com/p/closure%5Cncompiler/" target="_blank" rel="noopener noreferrer">Closure Compiler</a>
\n <a href="https://closure%5Cncompiler.appspot.com/" target="_blank" rel="noopener noreferrer">closure\ncompiler online</a>
\n <a href="https://code.google.com/intl/zh%5CnCN/closure/compiler/" target="_blank" rel="noopener noreferrer">Closure Compiler Documentation</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[【结束】~~趣味 Vim Tee~~]]></title>
            <link>https://hotoo.github.io/blog/post/vim-tee-2</link>
            <guid>106</guid>
            <pubDate>Thu, 26 May 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="结束趣味-vim-tee">【结束】<del>趣味 Vim Tee</del><a aria-hidden="true" href="#结束趣味-vim-tee">#</a></h1>
<p>去年 [[vim73\ntee|【已结束】团购庆祝 Vim 7.3 正式发布的 Tee]] 真是热闹的说，今年刚入夏，
就有 Vim 爱好者提出团购 Tee 的事了，我本来没准备印 Vim 的 Tee 的，倒是刚印了
2 件“连接被重置”和“连接超时”的 Tee。</p>
<p>偶然又看到这副 <a href="https://www.jonlee.ca/quick%5Cnvim%5Cntip%5Cnesc%5Cnalternative/" target="_blank" rel="noopener noreferrer">Emacs 警追杀 Vim 匪</a>
的漫画，可惜原图太小了。</p>
<p><img src="https://www.jonlee.ca/wp%5Cncontent/uploads/2008/04/control%5Cnescape%5Cncomic.gif" alt=""></img></p>
<p>Vim Talk 群里的“猫猫虫”同学非常给力的描了副大图，几经处理之后，我们终于
有了可以 <a href="https://i.min.us/i7k94.png" target="_blank" rel="noopener noreferrer">印刷在 Tee 的创意</a> 了。啊哈，这幅漫画我最爱了。</p>
<p>跟商家初步聊了下，去年 60 多件每件 25 块，今年即使有这么多数量，最便宜也只能到
33 块了（哦，我的口袋，有 33 块）。现在数量还没确定，而且这次不像去年那么热烈了，
估计人数会少很多。</p>
<p>Tee 的设计：
正面：印这幅漫画。
背面：无。
右手袖标：印每个人的 ID，可以自行决定，可以没有。</p>
<p>如果你也想印一件或者几件，请发邮件一下信息至 <code>hotoo.cn+VimTee[AT]gmail.com</code> ，
请将 <code>[AT]</code> 替换成 <code>@</code>，其他保持不变。</p>
<p>\n注意\n ：如果确定要购买，请务必将你 <a href="https://www.flickr.com/photos/hotoo/4890597770/" target="_blank" rel="noopener noreferrer">需要的尺码</a>，
\n邮件地址\n ，实际的 \n收货地址\n ， \n邮编\n ， \n收件人姓名\n 和你要求的 \n袖标\n 。
最好还有即时联系方式，比如手机，快递可能需要。
请确认这些信息能直接联系到你，收件人能收到货。</p>
<p>Gmail 最近很难连接上，尤其在公司，只能晚上回家整理订单了 抱歉。</p>
<p>报名 ~还是像去年一样，截至这周末（2011/05/29） 吧~ 截至下周一(2011/05/30)，
过期自己想印的可以单印，给商家打出我们的旗号，再好好商量，应该有折扣的 ：）</p>
<p>我并非托，不收分毫中介费或者中间利润。如果你不信任的话可以自行拿图去印刷，
版权免费（如果猫猫虫同意的话）。</p>
<h2 id="流程">流程<a aria-hidden="true" href="#流程">#</a></h2>
<ol>
<li>网友邮件详细信息给闲耘。</li>
<li>闲耘收集统计信息，查漏补缺与确认。</li>
<li>闲耘下订单。</li>
<li>店家印制 Tee 并发货。</li>
<li>闲耘得到快递单号，通知各位团友。</li>
<li>团友收到 Tee 之后邮件通知闲耘，并（支付宝/银行）转账给闲耘。</li>
</ol>
<p>会有快递单号的，到时候我会一一发给各位的。33不是最终价格，看我们最终定的数量，我尽量争取更实惠的价格。邮费是另算的，如果同城其实可以考虑合寄，还可以顺便线下认识下。货款我是下单的时候统一给卖家的，到时候大家收到Tee之前/之后支付宝/银行转账都可以。</p>
<p>\n <a href="https://picplz.com/user/nixzhu/pic/grj4q/" target="_blank" rel="noopener noreferrer">@NIX</a>
\n <a href="https://www.fangke.im/338" target="_blank" rel="noopener noreferrer">fanke.im</a>
\n <a href="https://t.co/wy7vGuo" target="_blank" rel="noopener noreferrer">@yyfrankyy</a></p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="vim73%5Cntee">去年的贴</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[深入 hasAttribute]]></title>
            <link>https://hotoo.github.io/blog/post/hasattribute</link>
            <guid>107</guid>
            <pubDate>Thu, 19 May 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="深入-hasattribute">深入 hasAttribute<a aria-hidden="true" href="#深入-hasattribute">#</a></h1>
<p>众所周知，IE 的 HTMLElement 对象不支持 hasAttribute 方法，于是有了如下实现：
它针对不支持 hasAttribute 方法的浏览器，检查 getAttribute 得到的是否等于 null，
如果是 null 则表明这个 HTMLElement 不存在指定的 Attribute。很聪明的一个方法。</p>
<pre><code>function hasAttr(elem, attr){
    if(elem.hasAttribute){
        return elem.hasAttribute(attr);
    }
    return null!=elem.getAttribute(attr);
}
</code></pre>
<p>最近写了个原理简单的基于 Select+Input 的可编辑 <a href="https://hotoo.github.io/labs/combox.html" target="_blank" rel="noopener noreferrer">Combox</a>
控件，用到了这个方法来检查目标 select
对象是否存在如 multiple, editable 这样的属性，来实现不同的 Combox 版本。其他
浏览器上跑的很好，但是在 IE6 上却总是被初始化为 multiple 的实例，很明显，这个
hasAttribute 的实现出问题了。</p>
<p>原来针对 IE6，还有稍多一点的特殊性：</p>
<p>\n <code>input.getAttribute(&quot;checked&quot;)</code> 返回 Boolean 值，true/false；
\n <code>input[type=checkbox|radio].getAttribute(&quot;checked&quot;)</code> 根据他的 checked 状态相关；
\n <code>input[type=others...].getAttribute(&quot;checked&quot;)</code> 始终返回 false；
\n <code>select.getAttribute(&quot;multiple&quot;)</code> 返回 Boolean 值；
\n <code>select&gt;option.getAttribute(&quot;selected&quot;)</code> 返回 Boolean 值。</p>
<p>虽然可以通过 getAttribute("checked") 判断 checkbox/radio 的属性状况，但对于
其他类型的 input 元素，是无法准确获得 checked 属性的。</p>
<p>TODO: checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected</p>
<p>下面是比较完整一点的实现：</p>
<pre><code>function hasAttr(elem, attr){
    var tag = elem.tagName.toLowerCase();
    attr = attr.toLowerCase();
    if(elem.hasAttribute){
        return elem.hasAttribute(attr);
    }
    if(navigator.userAgent.indexOf(&quot;MSIE 6&quot;)&gt;0 &amp;&amp;
        ((&quot;input&quot;==tag &amp;&amp; &quot;checked&quot;==attr) ||
        (&quot;option&quot;==tag &amp;&amp; &quot;selected&quot;==attr) ||
        (&quot;select&quot;==tag &amp;&amp; &quot;multiple&quot;==attr))){
        return elem.getAttribute(attr);
    }
    return null!=elem.getAttribute(attr);
}
</code></pre>
<h2 id="update-20110726">Update 2011/07/26<a aria-hidden="true" href="#update-20110726">#</a></h2>
<p>继续发现新坑：IE 中下面的代码</p>
<pre><code>&lt;p&gt;&lt;/p&gt;
&lt;q onclick=&quot;alert(0);&quot;&gt;&lt;/q&gt;

&lt;script&gt;
    p.onclick = function(){};

    alert(p.getAttribute(&quot;onclick&quot;));
    alert(q.getAttribute(&quot;onclick&quot;));
&lt;/script&gt;
</code></pre>
<p>输出：</p>
<pre><code>function(){}

function onclick()
{
alert(0);
}
</code></pre>
<p>所以上面的 <code>hasAttr</code> 函数是无法正确返回这种在脚本中设置 <code>onclick</code> 值的。</p>
<p>对策：</p>
<pre><code>var hasAttr = function(elem, attr){
    if(!elem || 1!=elem.nodeType){return false;}
    if(elem.hasAttribute){return elem.hasAttribute(attr);}
    // for IE, not perfect.
    // @see https://www.patmullin.com/weblog/2006/04/06/getattributestyle\nsetattributestyle\nie\ndont\nmix/
    attr = attr.toLowerCase();
    if(&quot;style&quot; == attr){return &quot;&quot; !== elem.style.cssText;}
    if(navigator.userAgent.indexOf(&quot;MSIE 6&quot;)&gt;0 &amp;&amp;
        ((&quot;input&quot;==tag &amp;&amp; &quot;checked&quot;==attr) ||
        (&quot;option&quot;==tag &amp;&amp; &quot;selected&quot;==attr) ||
        (&quot;select&quot;==tag &amp;&amp; &quot;multiple&quot;==attr))){
        return elem.getAttribute(attr);
    }
    var val = elem.getAttribute(attr);
    if(null == val){return false;}
    else if(&quot;function&quot; == typeof(val)){
        return val.toString().indexOf(&quot;function &quot;+attr+&quot;()&quot;) == 0;
    }else{return true;}
};
</code></pre>
<h2 id="update-20111026">Update 2011/10/26<a aria-hidden="true" href="#update-20111026">#</a></h2>
<p>继续新坑，IE5,6,7 的 <code>script.getAttribute(&quot;src&quot;) === &quot;&quot;</code>，正常的 DOM 方法已经
阻止不了 IE 了，hack 方案可以解析 wrapHTML(node)，
判断是否有 src 属性。</p>
<p>如果在这里你真的可以忽略 IE，最佳方案还是屏蔽 IE 吧。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[window.close()]]></title>
            <link>https://hotoo.github.io/blog/post/window.close</link>
            <guid>108</guid>
            <pubDate>Tue, 26 Apr 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="windowclose">window.close()<a aria-hidden="true" href="#windowclose">#</a></h1>
<pre><code>window.opener=null;
window.open(&quot;&quot;,&quot;\nself&quot;);
window.close();
</code></pre>
<p>onclick
return false;</p>
<p>IE5.5以下</p>
<pre><code>&lt;object id=&quot;close&quot; type=&quot;application/x\noleobject&quot;
  classid=&quot;clsid:adb880a6\nd8ff\n11cf\n9377\n00aa003b7a11&quot;&gt;
    &lt;param name=&quot;Command&quot; value=&quot;CLOSE&quot;&gt;
&lt;/object&gt;
&lt;input type=&quot;button&quot; onclick=&quot;close.Click()&quot; value=&quot;关闭窗口&quot;&gt;
</code></pre>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://developer.mozilla.org/en/window.close" target="_blank" rel="noopener noreferrer">window.close</a>
\n <a href="https://www.javascript%5Cncoder.com/window%5Cnpopup/javascript%5Cnwindow%5Cnclose.phtml" target="_blank" rel="noopener noreferrer">Using the window.close method</a>
\n <a href="https://javascript.about.com/library/blclose.htm" target="_blank" rel="noopener noreferrer">window close</a>
\n <a href="https://www.cnblogs.com/jhxk/articles/1610920.html" target="_blank" rel="noopener noreferrer">window.opener=null;window.close()，只支持IE6不支持IE7,IE8的问题</a>
\n <a href="https://topic.csdn.net/t/20020703/10/845994.html" target="_blank" rel="noopener noreferrer">怎么去掉使用window.close()时弹出的提示框？（不用按钮）</a>
\n <a href="https://www.blogjava.net/wangxinsh55/archive/2007/03/23/105743.html" target="_blank" rel="noopener noreferrer">window.close关闭窗口，不弹出系统提示，直接关闭</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Vim 神技]]></title>
            <link>https://hotoo.github.io/blog/post/vim-share-2011</link>
            <guid>109</guid>
            <pubDate>Mon, 11 Apr 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-神技">Vim 神技<a aria-hidden="true" href="#vim-神技">#</a></h1>
<pre><code>&lt;div style=&quot;width:425px&quot; id=&quot;\n\nss\n9693832&quot;&gt;
  &lt;strong style=&quot;display:block;margin:12px 0 4px&quot;&gt;
    &lt;a href=&quot;https://www.slideshare.net/hotoo/vim\n9693832&quot;
      title=&quot;Vim 神技&quot; target=&quot;\nblank&quot;&gt;Vim 神技&lt;/a&gt;
  &lt;/strong&gt;
  &lt;iframe src=&quot;https://www.slideshare.net/slideshow/embed\ncode/9693832&quot;
    width=&quot;425&quot; height=&quot;355&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot;
    scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC;border\nwidth:1px 1px 0&quot;
    allowfullscreen&gt;&lt;/iframe&gt;
  &lt;div style=&quot;padding:5px 0 12px&quot;&gt; View more PowerPoint from
    &lt;a href=&quot;https://www.slideshare.net/hotoo&quot; target=&quot;\nblank&quot;&gt;hotoo&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<ol>
<li>
<p><a href="https://www.slideshare.net/hotoo/vim%5Cn9693832" target="_blank" rel="noopener noreferrer">Vim 神技@slideshare</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[JavaScript 异常初步]]></title>
            <link>https://hotoo.github.io/blog/post/javascript-exceptions</link>
            <guid>110</guid>
            <pubDate>Sun, 03 Apr 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-异常初步">JavaScript 异常初步<a aria-hidden="true" href="#javascript-异常初步">#</a></h1>
<p>\n Error, TypeError, ReferenceError
\n try/catch/finally
\n window.onerror / window.addEventListener("error")
\n on("error") events</p>
<p>\n\n\n\n</p>
<p>异常处理</p>
<p>| Browser   | message | description | line | number | lineNumber | name | fileName | stack |
|\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n|\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n|
| IE8       | √      | √          | ×   | ×     | ×         | √   | ×       | ×    |
| Firefox 5 | √      | ×          | ×   | ×     | √         | √   | √       | √    |
| Chrome 12 | √      | ×          | ×   | ×     | ×         | √   | ×       | √    |
| Safari 5  | √      | ×          | √   | ×     | ×         | √   | ×       | ×    |
| Opera 11  | √      | ×          | ×   | ×     | ×         | √   | ×       | √    |</p>
<p>属性描述：</p>
<p>message::  异常消息描述，全部浏览器都支持。
name:: 错误名称，一般等同于错误类型名，如 Error, TypeError, ReferenceError...。不过实际抛出的同一个错误，不同浏览器的 name 值可能不一致(下面讲述)。
description:: 异常描述，IE 中同 message，其他浏览器不支持。
line:: 错误行号，仅 Safari 支持。
number:: 错误编号，例如“缺少对象”是 \n2146823281。“xx未定义”是 \n2146823279。仅 IE 支持。
lineNumber:: 错误发生所在行号，仅 Firefox 支持。
fileName:: 发生错误的所在文件地址，仅 Firefox 支持。</p>
<p>构造函数的参数&顺序：</p>
<p>| 参数    | 1(个)                     | 2(个)                     | 3(个)                                |
|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
| Firefox | <code>Error(message)</code>          | <code>Error(message,fileName)</code> | <code>Error(message,fileName,lineNumber)</code> |
| IE      | <code>Error(&lt;Number&gt; number)</code>  | <code>Error(number,message)</code>   | >                                    |
| /      | <code>Error(&lt;String&gt; message)</code> | /                        | >                                    |
| Chrome  | <code>Error(message)</code>          | >                         | >                                    |
| Safari  | /                        | >                         | >                                    |
| Opera   | /                        | >                         | >                                    |</p>
<p>Note: IE, <code>new Error(String message)</code> \n <code>&lt;Object,Array,RegExp,...&gt;.toString()</code></p>
<p>JavaScript 有多种原生异常类型，包括最常见的 Error 和 EvalError, RangeError,
ReferenceError, SyntaxError, TypeError, URIError. 这些原生异常类型分别对应的
意义是：</p>
<p>Error:: 异常的基类。
EvalError:: 发生在 eval() 函数中的异常。
RangeError:: 数值超出 JavaScript 可表示的范围。
ReferenceError:: 使用了非法的引用。
SyntaxError:: 在 eval() 中发生了语法错误的异常。除此之外的语法错误异常，均无法通过 try/catch 和 onerror 捕获，这类异常会直接报告给浏览器。
TypeError:: 变量类型不是预期的。
URIError:: 在 encodeURI() 和 decodeURI() 函数中发生异常。</p>
<p>TODO: 每种异常类型都带有以下成员/方法。
message::
line::</p>
<p>值得注意的是，直接掷出 Error 之外的其他原生异常（如 <code>throw new EvalError(&quot;msg&quot;)</code>）
时，IE 浏览器是无法捕获异常消息的，统一的异常消息是“例外被抛出且未被接住”。</p>
<p>而在 trycatch(ex) 中可以拿到更详细的异常信息。</p>
<p>JavaScript 也可以掷出其他类型的异常，如 throw "xx error."</p>
<h2 id="捕获异常">捕获异常<a aria-hidden="true" href="#捕获异常">#</a></h2>
<p>推荐的异常捕获方法是 <code>try/catch</code>，不过也可以简单使用全局异常捕获方式：</p>
<pre><code>window.onerror = function(msg, file, line){
    return true;
};
</code></pre>
<p><code>window.onerror</code> 事件可以捕获浏览器端掷出的所有异常，并可以拿到错误消息，所在文件，
及错误所在行。但是无法获得异常对象本身，及触发异常的事件对象。</p>
<p>注意：onerror 事件不在早期的 HTML4 规范中，只有 IE, Firefox 和后续的 Chrome 才有
支持，Safari, Opera 至今没有支持这个事件。</p>
<p>一般来说，绑定事件(addEventListener/attachEvent)的方式比给 HTML DOM 元素直接连接事件处理函数的方式要好。</p>
<p>但是为 window 绑定 error 事件却似乎不太理想。
IE 浏览器能得到 4 个参数（比 onerror 多一个），但有效的还是前面 3 个（跟 onerror 一致）。
而其他浏览器却只能得到一个参数，即错误事件（FF 得到的是 Error，Chrome 得到的 ErrorEvent。</p>
<p>题外话，对于 HTML 元素的 onerror 事件一般会触发在加载外部资源时。</p>
<h2 id="无法捕获的异常">无法捕获的异常<a aria-hidden="true" href="#无法捕获的异常">#</a></h2>
<p>如果 <code>onerror</code> 所在 <code>&lt;script&gt;</code> 块本身有语法错误，会导致 <code>onerror</code> 错误处理脚本本身无法
被执行，也就无法初始化全局异常处理函数。</p>
<p>或者异常发生在初始化全局异常处理函数之前，这个异常也无法被全局处理函数捕获。</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global%5CnObjects/Error" target="_blank" rel="noopener noreferrer">Error \n MDC Doc Center</a>
\n <a href="https://developer.mozilla.org/en/DOM/window.onerror" target="_blank" rel="noopener noreferrer">window.onerror \n MDC Doc Center</a>
\n <a href="https://msdn.microsoft.com/en%5Cnus/library/cc197053%28VS.85%29.aspx" target="_blank" rel="noopener noreferrer">onerror Event</a>
\n <a href="https://www.javascriptkit.com/javatutors/error.shtml" target="_blank" rel="noopener noreferrer">The onerror event of the window object</a>
<a href="https://www.javascriptkit.com/javatutors/error2.shtml" target="_blank" rel="noopener noreferrer">2</a>
<a href="https://www.javascriptkit.com/javatutors/error3.shtml" target="_blank" rel="noopener noreferrer">3</a>
<a href="https://www.javascriptkit.com/javatutors/error4.shtml" target="_blank" rel="noopener noreferrer">4</a>
\n <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global%5CnObjects/TypeError" target="_blank" rel="noopener noreferrer">TypeError</a>
\n <a href="https://hi.baidu.com/fcl06/blog/item/c3721bfa2643689058ee9040.html" target="_blank" rel="noopener noreferrer">js判断错误类型</a>
\n <a href="https://www.iefans.net/ie%5Cnjavascript%5Cnerror/" target="_blank" rel="noopener noreferrer">解析IE浏览器中的Javascript Error对象</a>
\n <a href="https://damnit.jupiterit.com/home/learn" target="_blank" rel="noopener noreferrer">DamnIT</a>
\n <a href="https://www.exceptionhub.com/" target="_blank" rel="noopener noreferrer">ExceptionHub</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[JavaScript 分时加载]]></title>
            <link>https://hotoo.github.io/blog/post/timed-array-processing</link>
            <guid>111</guid>
            <pubDate>Tue, 01 Mar 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-分时加载">JavaScript 分时加载<a aria-hidden="true" href="#javascript-分时加载">#</a></h1>
<p>使用原始数据（非副本）和索引访问（非shift()），在IE中性能大幅度提高，
其他浏览器对 concat()，尤其是 shift() 方法进行了优化，性能差别不大。</p>
<p>分时算法对于需要及时更新 UI 的情况非常有效，但是实际上分时算法性能非常不好
（当然分时算法追求的不是这个），不适合作为巨量数据的实时处理。</p>
<p>譬如说在树形控件中，原始数据提供了一个巨大的数组数据：</p>
<pre><code>var datas = [
    {id:&quot;1&quot;, pid:&quot;0&quot;, text:&quot;Node 1&quot;},
    {id:&quot;2&quot;, pid:&quot;0&quot;, text:&quot;Node 2&quot;},
    //...
];
</code></pre>
<p>我的处理方式是先将这份数据遍历一次，用 HashMap 进行缓存索引，便于后续的操作
更加快捷。但是这个遍历本身是非常耗时的，虽然它不产生界面变化，但同样会将页面
卡死。为了提高界面响应速度，我们会想到使用分时计算方式，不过这种方式会延长
缓存索引的过程变的更久，导致后续创建节点的操作无法及时执行，也就无法更新界面，
界面虽然可以操作，但是没什么可操作的（对于以树本身为主的页面来说）。</p>
<p>后来的做法是，根据树的实时装载能力（目前是十万个节点。经过缓存索引的数据，
跟节点层级深度无关）和实际应用作出判断，对于在超出浏览器处理能力的，使用异步
装载方式；处理能力以内的，不做要求。</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<ol>
<li>
<p><a href="https://lifesinger.googlecode.com/svn/trunk/lab/2009/array%5Cnprocessing.html" target="_blank" rel="noopener noreferrer">https://lifesinger.googlecode.com/svn/trunk/lab/2009/array\nprocessing.html</a></p>
</li>
<li>
<p><a href="https://www.cnblogs.com/bluedream2009/archive/2010/03/16/1687095.html" target="_blank" rel="noopener noreferrer">【优化】分时加载</a> \n Cauma</p>
</li>
<li>
<p><a href="https://www.nczonline.net/blog/2009/08/11/timed%5Cnarray%5Cnprocessing%5Cnin%5Cnjavascript/" target="_blank" rel="noopener noreferrer">https://www.nczonline.net/blog/2009/08/11/timed\narray\nprocessing\nin\njavascript/</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[树形控件的分时装载]]></title>
            <link>https://hotoo.github.io/blog/post/timed-tree-processing</link>
            <guid>112</guid>
            <pubDate>Tue, 01 Mar 2011 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="树形控件的分时装载">树形控件的分时装载<a aria-hidden="true" href="#树形控件的分时装载">#</a></h1>
<p>异步装载树形控件节点的时机：</p>
<ol>
<li>
<p>传统方式是展开节点时再装载子节点；</p>
</li>
<li>
<p>预装载子节点（即展开节点时，预装载到孙级节点。
任何可见的节点，如果有子节点，则其子节点不是已经装载好，就是在装载的网路上）。</p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[JavaScript 千分位算法]]></title>
            <link>https://hotoo.github.io/blog/post/javascript-commfy</link>
            <guid>113</guid>
            <pubDate>Mon, 20 Dec 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-千分位算法">JavaScript 千分位算法<a aria-hidden="true" href="#javascript-千分位算法">#</a></h1>
<p><a href="https://gist.github.com/748249" target="_blank" rel="noopener noreferrer">https://gist.github.com/748249</a></p>
<p>v1:</p>
<pre><code>function commfy0(n){
    var a = n.toString().split(&quot;.&quot;);
    var i = a[0].length%3;
    var prefix = (a[0].substr(0,i)+a[0].substr(i).replace(/(\d{3})/g,&quot;,\n1&quot;)).replace(/^,/, &quot;&quot;);
    //var postfix = a[1] ? &quot;.&quot;+a[1].replace(/(\d{3})/g, &quot;\n1,&quot;).replace(/,\n/, &quot;&quot;) : &quot;&quot;;
    return prefix+(a[1]?&quot;.&quot;+a[1]:&quot;&quot;);
}
</code></pre>
<p>v2:</p>
<pre><code>var commfy1 = (function(){
    var re=/(\d{1,3})(?=(?:\d{3})+(?:\n|\.))/g;
    return function(n){
        var a=n.toString().split(&quot;.&quot;);
        a[0] = a[0].replace(re,&quot;\n1,&quot;);
        return a.join(&quot;.&quot;);
    };
})();
</code></pre>
<p>v3:</p>
<pre><code>var commfy2 = (function(){
    var re=/\B(?=(?:\d{3})+\n)/g;
    return function(n){
        var a=n.toString().split(&quot;.&quot;);
        a[0] = a[0].replace(re,&quot;,&quot;);
        return a.join(&quot;.&quot;);
    };
})();
</code></pre>
<h2 id="参考阅读">参考阅读<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://blog.xhlv.com/index.php/2009/09/15/parsedata%5Cnregexp/" target="_blank" rel="noopener noreferrer">“千分位”格式化数据的正则</a>
\n <a href="https://hi.chibaole.com/blog/2009/09/15/%E4%BB%A5%E2%80%9C%E5%8D%83%E5%88%86%E4%BD%8D%E2%80%9D%E6%A0%BC%E5%BC%8F%5Cnjavascript/" target="_blank" rel="noopener noreferrer">以“千分位”格式化数字–JavaScript</a>
\n <a href="https://lonelyfishor.blogbus.com/logs/41230348.html" target="_blank" rel="noopener noreferrer">javascript 按千分位划分数字\n递归方式</a>
\n <a href="https://blog.csdn.net/yezi1305/archive/2008/09/09/2903239.aspx" target="_blank" rel="noopener noreferrer">js数字千分位及取小数点后几位方法测试</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[placeholder 最佳实践]]></title>
            <link>https://hotoo.github.io/blog/post/placeholder-in-action</link>
            <guid>114</guid>
            <pubDate>Mon, 06 Dec 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="placeholder-最佳实践">placeholder 最佳实践<a aria-hidden="true" href="#placeholder-最佳实践">#</a></h1>
<p><a href="https://dev.w3.org/html5/spec/Overview.html#the%5Cnplaceholder%5Cnattribute" target="_blank" rel="noopener noreferrer">placeholder</a>
<a href="https://www.whatwg.org/specs/web%5Cnapps/current%5Cnwork/multipage/common%5Cninput%5Cnelement%5Cnattributes.html#the%5Cnplaceholder%5Cnattribute" target="_blank" rel="noopener noreferrer">2</a>
是 HTML5 中的标准属性，它用于定义显示在输入框中的简短提示信息，并在适当的时机
（比如在输入框获得焦点时）隐匿起来。</p>
<p>在早期的浏览器中，只能通过 JavaScript 自定义函数来实现。而在早期的实现中又五花八门。</p>
<p>在 HTML 方面，一般是使用自定义的 hint 或者 title 属性放置提示消息。</p>
<p>而在 JavaScript 上，最常见的是通过修改 input 本身的 value 及其 CSS 样式实现。
一般有直接修改 input 的样式，或者添加 class 两种，后者从某种程度上来说更好些。</p>
<p>早期的实现中还有一个比较不好的问题是，代码里直接判断 input.value 是否为空，
或者是否为占位符提示的值，如果用户输入的内容如果碰巧和占位符提示相同，则会出现误判。</p>
<p>下面可以说是早期思想中一个较佳的实现：</p>
<pre><code>\n(&quot;input[placeholder]&quot;).each(function(){
    var o=\n(this);
    if(!o.val()){
        o.val(o.attr(&quot;placeholder&quot;));
        o.addClass(&quot;placeholder&quot;)
    }
    o.focus(function(){
        if(o.hasClass(&quot;placeholder&quot;)){
            o.val(&quot;&quot;);
            o.removeClass(&quot;placeholder&quot;);
        }
    }).blur(function(){
        if(&quot;&quot;==o.val()){
            o.val(o.attr(&quot;placeholder&quot;));
            o.addClass(&quot;placeholder&quot;);
        }
    });
});
</code></pre>
<p>但是即使如此，直接修改 input.value 同样会有一个几乎无法避免的问题：假如用户在必填项中没有
输入任何内容，但是占位符会填充其内容，在提交表单时，当然也可以通过判断 input 是否包含
<code>placeholder</code> 样式类来针对性处理。但是特殊地，当页面出现脚本错误（这应该说不少见），导致
表单验证函数未能正确处理而直接提交到服务器，这时服务器是较难准确确认输入框中的内容是占位符，
还是用户输入的内容的，它只知道这个满足非空条件。</p>
<p>于是后来有了一种更有趣的实现，它不是直接修改 input.value，而是使用一个附加的元素，占位符消息
放置在这个元素中，并通过恰当控制这个元素的显示/隐藏，来达到更真实和优秀的体验。</p>
<p>这种实现甚至可以轻易的实现只有用户在输入框中输入内容之后，占位符提示消息才消失。</p>
<p>这个实现要注意以下几点：</p>
<p>\n 字体大小等样式要尽量和 input 一致（颜色例外）。
\n 使用 label 作为占位符消息的容器标签，可以加上恰当的 for 属性，实现自动关联。
\n 占位符的位置，可以直接使用 CSS 的相对位置实现，也可以使用 JavaScript 计算获得。</p>
<p>比如下面的实现：</p>
<p>\n('input[placeholder],textarea[placeholder]').each(function());</p>
<p>另外对于已经支持 <code>placeholder</code> 的浏览器可以忽略上面的代码，而使用浏览器的默认实现。</p>
<p>if(!("placeholder" in document.createElement("input")))</p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://diveintohtml5.org/forms.html#placeholder" target="_blank" rel="noopener noreferrer">diveintohtml5.org#placeholder</a>
\n <a href="https://cssrainbow.cn/demos/892.html" target="_blank" rel="noopener noreferrer">让所有的浏览器都支持 HTML5 placeholder 属性，基于MooTools</a>
\n <a href="https://www.quanlei.com/2010/09/%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84html5%5Cnplaceholder%5Cn%E5%AE%9E%E7%8E%B0/" target="_blank" rel="noopener noreferrer">跨浏览器的HTML5 placeholder 实现</a>
\n <a href="https://www.zhoumingzhi.com/2009/12/17/inline%5Cnform%5Cnlabels/" target="_blank" rel="noopener noreferrer">Inline Form Labels</a>，
<a href="https://www.zhoumingzhi.com/2010/08/10/inline%5Cnform%5Cnlabels%5Cn2/" target="_blank" rel="noopener noreferrer">Inline Form Labels（2）</a>
\n <a href="https://www.kamikazemusic.com/quick%5Cntips/jquery%5Cnhtml5%5Cnplaceholder%5Cnfix/" target="_blank" rel="noopener noreferrer">JQuery HTML5 placeholder fix</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[水平表单的错误消息方式]]></title>
            <link>https://hotoo.github.io/blog/post/err-msg-for-horizontal-forms</link>
            <guid>115</guid>
            <pubDate>Fri, 26 Nov 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="水平表单的错误消息方式">水平表单的错误消息方式<a aria-hidden="true" href="#水平表单的错误消息方式">#</a></h1>
<p>垂直方向的表单，错误消息有很多种呈现方式，放在输入框后面，下面，或上面都挺好，
因为垂直表单本身可用空间较大，而且向下或向右挤也不是什么问题，布局也没什么影响。</p>
<p>但是对于水平方向向右一字排开的表单（自动适应可用宽度，不够则自动折行），搜索表单
比较常用，这种表单会有数个搜索输入框或选项，如图：</p>
<p>[<a href="https://farm6.static.flickr.com/5202/5209097632%5Cna2bddacb9f%5Cnb.jpg" target="_blank" rel="noopener noreferrer">https://farm6.static.flickr.com/5202/5209097632\na2bddacb9f\nb.jpg</a>]</p>
<p>这种表单，错误消息无论放在上、下、左、右，都会影响到表单的布局，而悬浮消息
也可能会遮挡住其他的输入框。那这样的表单，错误消息应该如何更好的呈现呢？</p>
<p>我想到一种，即“双重视觉强调”讲的：在表单上/下方给出整体的的错误信息，但输入框
本身，只给出警戒色的边框进行提醒。</p>
<p>[<a href="https://farm5.static.flickr.com/4091/5208505527%5Cn1a8dd70502%5Cnb.jpg" target="_blank" rel="noopener noreferrer">https://farm5.static.flickr.com/4091/5208505527\n1a8dd70502\nb.jpg</a>]</p>
<p>当用户鼠标悬浮在出错输入框上，或者出错输入框获得焦点时，上/下面的错误信息框
自动高亮当前输入框对应的错误消息。</p>
<p>这种表单本身不会很多选项导致需要翻页，所以放在上面是没有问题的。如果真的需要
很多选项，那就要考虑换成垂直表单了。</p>
<p>高亮而不是更新消息内容，是为了防止消息框高度发生变化，导致表单本身上下跳跃移动；
当然也可以将消息框放在下面，不过直觉上，错误消息放在上面似乎更靠谱。</p>
<p>上面是个人观点，大家可以各抒己见。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[联动的设计]]></title>
            <link>https://hotoo.github.io/blog/post/linkage</link>
            <guid>117</guid>
            <pubDate>Tue, 23 Nov 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="联动的设计">联动的设计<a aria-hidden="true" href="#联动的设计">#</a></h1>
<p>联动控件一般用于下拉列表，例如省市县的联动。</p>
<p>很早的时候有些初级的实现只做到了固定级别（比如二级、三级）的联动，它们传入固定
的 N 个 <code>&lt;select&gt;</code> DOM 元素，形成固定的 N 级联动关系。后来有了一些较好的实现，
这些实现做到了动态级别的联动（即无限级联动）。</p>
<p>早期的无限级联动控件，一般实现是通过主动下拉列表在 onchange 触发时主动调用
被动列表的更新 <code>&lt;option&gt;</code> 的方法，或者甚至在 onchange 处理函数中直接操作从动列表
的 <code>&lt;option&gt;</code>。</p>
<p>主动调用从动列表的更新函数，则需要事先函数名称及传参的约定。
直接操作从动列表的 <code>&lt;option&gt;</code> 就更不靠谱了，灵活性也更差。</p>
<p>另外，这两种实现只能做到一维的线性联动，即一个主动列表对应一个从动列表，要实现
一个主动列表联动多个（不确定数量的）从动列表，则比较麻烦/困难。</p>
<p>另一种更好的实现，则是让从动列表来确定自己的主动列表，并监听主动列表的 change
事件。这种实现可以轻易做到动态级别、动态维度的联动，各个 <code>&lt;select&gt;</code> 的数据源及
及处理函数都由自身确定。</p>
<p>总结：</p>
<blockquote>
<p>这里 \n\n事件监听\n\n ，比 \n\n主动调用\n\n 的设计思想更优秀。</p>
</blockquote>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[同步客户端时间(续)]]></title>
            <link>https://hotoo.github.io/blog/post/sync-client-time</link>
            <guid>118</guid>
            <pubDate>Mon, 15 Nov 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="同步客户端时间续">同步客户端时间(续)<a aria-hidden="true" href="#同步客户端时间续">#</a></h1>
<p>08 年我就有了这样的 <a href="correct%5Cnweb%5Cnclient%5Cndatetime.html">想法</a>，却到今天才开始实践。</p>
<p>公司电脑时间错了好多，但我的账户没有 Internet 同步的权限，遂手动校准。</p>
<p>到 <a href="https://www.time.ac.cn/stime.asp" target="_blank" rel="noopener noreferrer">国家授时中心</a> 校准时，发现其服务器时间的
跳跃是受客户端时间影响的，当客户端时间发生修改时，页面上显示的服务器时间也跟着
偏差。</p>
<p>后来到台湾的 <a href="https://www.stdtime.gov.tw/chinese/home.aspx" target="_blank" rel="noopener noreferrer">國家時間與頻率標準實驗室</a>
发现没有这个问题。</p>
<p>研究了两者的代码，发现跟第一观感不同的是，这两者我更赞赏大陆的做法了，虽然有明显的可见缺陷。
下面简单分析下两者的实现思想及各自的优缺点。</p>
<p>台湾的是使用 setInterval 实现了一个定时器，这个定时器考虑到了调用函数的时间消耗，
但是 setInterval 或 setTimeout 本身的不确定性，随着跳跃时间变长，页面显示的服务器
时间便有非常大的偏差，尤其在 IE 浏览器中（几十分钟内，Firefox偏差数秒，IE7偏差数分钟）。</p>
<p>而大陆的实现则使用服务器的初始时间，但使用客户端的频率进行跳跃（并在 1 秒中检查 10 次，
避免跳秒问题）。这样即使经过长时间的跳跃，同样能保持较高的准确度。但问题是，当客户端
时间发生修改时，所谓的服务器时间也会收到影响。</p>
<p>于是我结合两者各自的优点，避开他们的缺点，实现了一个 <a href="https://github.com/hotoo/Chronos" target="_blank" rel="noopener noreferrer">校时器</a>。
他使用客户端的跳秒，但是当客户端发生时间不正常的跳跃时，自动修正客户端和服务器端之间的
时间差。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[用 Dropbox 做私有 Git 服务器]]></title>
            <link>https://hotoo.github.io/blog/post/git-on-dropbox</link>
            <guid>119</guid>
            <pubDate>Fri, 12 Nov 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="用-dropbox-做私有-git-服务器">用 Dropbox 做私有 Git 服务器<a aria-hidden="true" href="#用-dropbox-做私有-git-服务器">#</a></h1>
<p>这几记录一下如何做一个本地版本库，关键命令是：<code>git clone \n\nbare test test.git</code></p>
<pre><code>mkdir test
cd test
git init

# for Windows.
echo NUL &gt; README
# for Unix\nlike.
touch README

git add .
git commit \nm &quot;first commit.&quot;

cd ..
git clone \n\nbare test test.git

# for Windows.
mkdir &quot;D:\My Dropbox\codes\repositories&quot;
copy test.git &quot;D:\My Dropbox\codes\repositories&quot;
# for Unix\nlike
mkdir ~/Dropbox/codes/repositories
mv test.git ~/Dropbox/codes/repositories

cd test
# for Windows.
git remote add &quot;file:///D:\My Dropbox\codes\repositories\test.git&quot;
# for Unix\nlike.
git remote add origin file:///Users/{name}/Dropbox/codes/repositories/test.git

vi README
git add .
git commit \nm &quot;make changes.&quot;
git push origin master
</code></pre>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<ol>
<li>
<p><a href="https://roylez.heroku.com/2010/01/16/git%5Cndropbox.html" target="_blank" rel="noopener noreferrer">用dropbox做私有git服务器</a></p>
</li>
<li>
<p><a href="https://blog.williamyao.com/archives/232" target="_blank" rel="noopener noreferrer">方便而又强大：本地 Git 操作完全指南</a></p>
</li>
<li>
<p><a href="https://andre.engelbrechtonline.net/blog/2010/04/22/hosting%5Cngit%5Cnrepo%5Cndropbox/" target="_blank" rel="noopener noreferrer">Hosting a Git Repo on Dropbox</a></p>
</li>
<li>
<p><a href="https://forums.dropbox.com/topic.php?id=23772" target="_blank" rel="noopener noreferrer">GitBox \n Git repository hosting inside Dropbox folders</a>
<a href="https://github.com/karalabe/gitbox" target="_blank" rel="noopener noreferrer">@github</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/the-duplicate-element</link>
            <guid>120</guid>
            <pubDate>Wed, 27 Oct 2010 00:00:00 GMT</pubDate>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/form-in-action</link>
            <guid>121</guid>
            <pubDate>Wed, 27 Oct 2010 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Vim 爱好者联系资料收集]]></title>
            <link>https://hotoo.github.io/blog/post/vimmer-contact</link>
            <guid>122</guid>
            <pubDate>Mon, 11 Oct 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-爱好者联系资料收集">Vim 爱好者联系资料收集<a aria-hidden="true" href="#vim-爱好者联系资料收集">#</a></h1>
<p>希望通过一些形式让 Vim 爱好者联系更紧密，于是收集 Vim 爱好者的联系资料，并通过
较好的形式展现出来。</p>
<p>目前是通过 <a href="https://hotoo.github.io/Vimmer/vimmer.html" target="_blank" rel="noopener noreferrer">面板形式</a> 展现，
并有计划通过 Google 地图展现全国 Vim 爱好者的分布情况。</p>
<p>资料收集方式：</p>
<ol>
<li>
<p>Fork <a href="https://github.com/hotoo/Vimmer" target="_blank" rel="noopener noreferrer">Vimmer</a> 项目(最好是 gh\npages 分支)，并加入自己的资料到 vimmer.json 中。</p>
</li>
<li>
<p>填写 <a href="https://spreadsheets.google.com/viewform?formkey=dHdHM3R6S25PZDVON05yRjhWWWw2MkE6MQ" target="_blank" rel="noopener noreferrer">Google Spread Sheets</a> ^GFW出没注意^。</p>
</li>
<li>
<p>邮件发送到 hotoo.cn+vim[AT]gmail.com ，请将 <code>[AT]</code> 替换成 <code>@</code>，保留 <code>+vim</code></p>
<p>常用的网络ID \n
必填，可以是中文或英文，例如我的：hotoo</p>
<p>真实姓名
选填</p>
<p>昵称
常用的网络昵称，例如我的：闲耘™。选填，默认与ID相同。</p>
<p>电子邮箱 \n
建议使用 Gmail 邮箱，请使用 [AT] 代替 @ 符合，例如：hotoo.cn[AT]gmail.com</p>
<p>博客/个人主页
请输入完整的URL地址(以 http 或其他的协议开头)，例如：<code>https://hotoo.github.com</code></p>
<p>Twitter ID
在 twitter.com 上的 ID，可以不带 @ 起始。例如我的 @hotoo</p>
<p>Flickr ID
在 flickr.com 上注册的 ID，例如：hotoo</p>
<p>Delicious ID
在 delicious.com 注册的 ID，例如 hotoo</p>
<p>Github ID
在 github.com 注册的 ID。</p>
<p>豆瓣(Douban) ID
在 douban.com 注册的 ID</p>
<p>其他网站上注册的 ID
如果你其他网站上注册的 ID，并希望分享出来，请填写在这里。
网站和ID以冒号分隔，多个站的 ID 请以分号分隔。
例如 about.me:hotoo; blueidea.com:hotoo</p>
<p>Gravatar ID
在 gravatar.com 注册并上传头像，根据邮箱地址计算MD5的值就是 Gravatar ID。
例如：2fdef0a77e4bf207e3ec30660e7896e8</p>
<p>目前所在地
可以输入简要的地址，例如：杭州(Hangzhou)；
也可以输入详细的联系地址，甚至卫星坐标，可以通过Google地图获得。</p>
<p>其他
你希望留下的任何资料信息。</p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[IE6 的 CSS:hover 伪类]]></title>
            <link>https://hotoo.github.io/blog/post/css-hover-for-ie6</link>
            <guid>123</guid>
            <pubDate>Wed, 15 Sep 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="ie6-的-csshover-伪类">IE6 的 CSS:hover 伪类<a aria-hidden="true" href="#ie6-的-csshover-伪类">#</a></h1>
<p>众所周知，IE6 不支持 a:hover 以外的 CSS 伪类，解决办法一般有 3 种方案：</p>
<h2 id="使用-javascript-事件">使用 JavaScript 事件<a aria-hidden="true" href="#使用-javascript-事件">#</a></h2>
<p>直接使用 JavaScript 的 onmouseover/onmouseenter 和 onmouseout/onmouseleave
事件进行针对性开发，这大概没什么好详细介绍的。</p>
<h2 id="使用-css-表达式">使用 CSS 表达式<a aria-hidden="true" href="#使用-css-表达式">#</a></h2>
<p>辅以 CSS 表达式中 JScript 同样也有 onmouseover/onmouseenter 和
onmouseout/onmouseleave 事件，用以实现 :hover 效果。
注意：其中冒号之前的事件名称可以随意，关键是 expression() 里面的事件。</p>
<p>ul li
ol li</p>
<p>不过应该说使用 CSS class 是更好的实践。</p>
<p>table tr
table tr.hover td</p>
<p>onmouseout 事件处理函数中加了 try/catch 是为了避免 IE5.5 因为不支持 <code>replace()</code>
而报脚本错误。当然为了避免这个错误，还是其他的实现方式：</p>
<p>table tr
table tr.hover td</p>
<h2 id="使用-css-behavior-行为">使用 CSS behavior 行为<a aria-hidden="true" href="#使用-css-behavior-行为">#</a></h2>
<p>使用 <a href="https://www.xs4all.nl/~peterned/csshover.html" target="_blank" rel="noopener noreferrer">Whatever:hover</a></p>
<p><a href="https://www.xs4all.nl/~peterned/htc/csshover3.htc" target="_blank" rel="noopener noreferrer">csshover3.htc</a></p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<ol>
<li>
<p><a href="https://blog.csdn.net/andyyukun/archive/2007/07/03/1676963.aspx" target="_blank" rel="noopener noreferrer">强大的CSS表达式 \n\n expression</a></p>
</li>
<li>
<p><a href="https://www.planabc.net/2009/09/21/optimization%5Cnof%5Cncss%5Cneexpression/" target="_blank" rel="noopener noreferrer">CSS Expression 的优化</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[实现文本转语音]]></title>
            <link>https://hotoo.github.io/blog/post/tts</link>
            <guid>125</guid>
            <pubDate>Sun, 12 Sep 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="实现文本转语音">实现文本转语音<a aria-hidden="true" href="#实现文本转语音">#</a></h1>
<p>又是心血来潮，想把文本转为语音朗读，通过听书的方式来多重利用时间。分心听书有效
吗，未可知也。不过还是想折腾下，心血来潮嘛。</p>
<p>刚开始以为一定需要下载个语音软件，用它将文本转成语音，通过调节字词之间的停顿，
来达到较好的视听效果。</p>
<p>因为很久以前有折腾过使用 Word 实现语音朗读的事，朗读效果非常不好，所以不想下载
那些大型的朗读软件，总感觉他们读出来的声音会让人恶心死。</p>
<p>群里请教了一下有没有推荐的，得到 <a href="https://www.eguidedog.net/" target="_blank" rel="noopener noreferrer">eGuideDog</a>，但是
似乎仍然不甚理想，后来又发现了 <a href="https://www.neospeech.com/" target="_blank" rel="noopener noreferrer">NeoSpeech</a>，里面提供
的试听效果非常好，尤其是日语朗读，跟真人朗读差不多。</p>
<p>于是继续寻找相关资料，在 VeryCD 上得到这些：<a href="https://www.verycd.com/topics/2780296/" target="_blank" rel="noopener noreferrer">1</a>
<a href="https://www.verycd.com/topics/2799359/" target="_blank" rel="noopener noreferrer">2</a> <a href="https://www.verycd.com/topics/2780296/" target="_blank" rel="noopener noreferrer">3</a></p>
<p>后来看到一张语音属性的图片，才进控制面板明白了一些事情。</p>
<p>看到有通过微软拼音输入法3.0的语音功能实现的介绍，不过我在微软拼音3.0和 2007 中
都没有找到对应菜单项。</p>
<p>通过 <a href="https://blog.miyui.net/work/text%5Cnto%5Cnspeech%5Cnin%5Cnexcel%5Cn2007/" target="_blank" rel="noopener noreferrer">Excel 2007中的文本到语音</a>
知道 Excel 内置了语音朗读的功能，但是 Word 没有找到对应的。便找到了
<a href="https://bbs.cfan.com.cn/viewthread.php?tid=661265" target="_blank" rel="noopener noreferrer">office2007文本到语音命令的问题</a></p>
<h2 id="详细步骤">详细步骤<a aria-hidden="true" href="#详细步骤">#</a></h2>
<ol>
<li>安装语音引擎，我下载的 <a href="https://www.verycd.com/topics/2799359/" target="_blank" rel="noopener noreferrer">这个</a>，解压安装
会自动设置控制面板里的语音选择，可以进入“控制面板”\n>“语音”\n>“语音选择”，
系统默认是 "Microsoft Sam"，可以改为刚安装的语音，试听一下。</li>
<li>打开 Excel (2007)，点击左上角（靠右侧的）三角下拉菜单（鼠标悬浮提示是
“自定义快速访问工具栏”\n>“其他命令”\n>“不在功能区的命令”，
添加“朗读单元格”和“朗读单元格 \n 停止朗读单元格”，
在单元格中输入文本，点击“朗读单元格”就会听到发声。</li>
<li>要想让 Word 朗读发声，可以使用自定义宏：
<ol>
<li>
<p>按 <code>&lt;Alt\nF11&gt;</code> 启动 Visual Basic 编辑器。</p>
</li>
<li>
<p>创建名为 <code>ReadRec</code> 的宏：</p>
<p>Sub ReadSelection()
Excel.Application.speech.speak Selection
End Sub</p>
</li>
<li>
<p>单击VBE编辑器窗口中的“工具”菜单，选择“引用”命令，在弹出的
“引用\nNormal”对话框中选择“Microsoft Excel 12.0 Object Library”复选框。</p>
</li>
<li>
<p>确定，关闭Visual Basic编辑器返回Word窗口。</p>
</li>
<li>
<p>右击工具栏，选择“自定义”命令，切换到“命令”选项卡，在“类别”中
选择“宏”，将命令中的“Normal NewMacros.ReadSelection”拖放到工具栏中。</p>
</li>
<li>
<p>现在在 Word 里选中文本，点击工具栏刚加入的按钮，就可以朗读选中文本了。</p>
</li>
</ol>
</li>
</ol>
<h2 id="参考--延伸阅读">参考 & 延伸阅读<a aria-hidden="true" href="#参考--延伸阅读">#</a></h2>
<ol>
<li>
<p><a href="https://www.neospeech.com/" target="_blank" rel="noopener noreferrer">NeoSpeech</a></p>
</li>
<li>
<p><a href="https://www.verycd.com/topics/2780296/" target="_blank" rel="noopener noreferrer">NeoSpeech 语音下载(VeryCD)</a>
<a href="https://www.verycd.com/topics/2799359/" target="_blank" rel="noopener noreferrer">2</a>
<a href="https://www.verycd.com/topics/2780296/" target="_blank" rel="noopener noreferrer">3</a></p>
</li>
<li>
<p><a href="https://blog.miyui.net/work/text%5Cnto%5Cnspeech%5Cnin%5Cnexcel%5Cn2007/" target="_blank" rel="noopener noreferrer">Excel 2007中的文本到语音</a></p>
</li>
<li>
<p><a href="https://bbs.cfan.com.cn/viewthread.php?tid=661265" target="_blank" rel="noopener noreferrer">office2007文本到语音命令的问题</a>
<a href="https://blog.exiaoxue.cn/200815213528.html" target="_blank" rel="noopener noreferrer">2</a></p>
</li>
<li>
<p><a href="https://blogimg.chinaunix.net/blog/upfile2/081226113747.rar" target="_blank" rel="noopener noreferrer">Word 从文本到语音工具栏</a></p>
</li>
<li>
<p><a href="https://club.excelhome.net/viewthread.php?tid=419686&amp;page=1&amp;extra=page%3D1" target="_blank" rel="noopener noreferrer">Word音标助手COM加载项(更新2009.6.30版)</a></p>
</li>
<li>
<p><a href="https://www.gmw.cn/content/2005%5Cn03/18/content%5Cn198426.htm" target="_blank" rel="noopener noreferrer">Word 2003如何实现文本朗读</a></p>
</li>
<li>
<p><a href="https://masnun.com/blog/2009/12/14/googles%5Cntext%5Cnto%5Cnspeech%5Cnapi%5Cna%5Cnphp%5Cnwrapper%5Cnclass/" target="_blank" rel="noopener noreferrer">Google's Text to Speech API : A PHP Wrapper Class</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Diff 模式下，让光标直接跳转到被修改的文本处]]></title>
            <link>https://hotoo.github.io/blog/post/jump-to-difftext</link>
            <guid>124</guid>
            <pubDate>Mon, 30 Aug 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="diff-模式下让光标直接跳转到被修改的文本处">Diff 模式下，让光标直接跳转到被修改的文本处<a aria-hidden="true" href="#diff-模式下让光标直接跳转到被修改的文本处">#</a></h1>
<p>Vim 的 Diff 功能非常优秀。有一个我非常喜欢的特性是：完全相同的地方，
会被折叠隐藏起来(上下文除外)。还可以很方便的在各个差异点之间做出修改合并和快速跳转。</p>
<p>不过默认的 <code>[c</code> 和 <code>]c</code> 两种跳转方式，目前只能跳转到差异点的行首。对于只修改了
行内部分文本内容（一般底色是浅红色）时，我更希望直接跳转到有变化的文本（底色是
深红色的部分）上。</p>
<p>感谢 tocer ，我初步实现了两个版本 <a href="https://gist.github.com/556810" target="_blank" rel="noopener noreferrer">gits:556810</a></p>
<ol>
<li>v1: 仅支持跳转到 DiffChange 的第一个 DiffText</li>
<li>v2: 支持 DiffChange 行多个 DiffText</li>
</ol>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<ol>
<li>
<p><code>:h synIDattr</code></p>
</li>
<li>
<p><code>:h diff\nhlID</code></p>
</li>
<li>
<p><a href="https://twitter.com/hotoo/status/22227282177" target="_blank" rel="noopener noreferrer">@twitter</a></p>
</li>
<li>
<p><a href="https://groups.google.com/group/vim%5Cncn/browse%5Cnthread/thread/8a0b5b7ed335782b" target="_blank" rel="noopener noreferrer">vimdiff 的跳转</a></p>
</li>
<li>
<p><a href="https://superuser.com/questions/145940/vimdiff%5Cnjump%5Cnto%5Cnnext%5Cndifference%5Cninside%5Cnline" target="_blank" rel="noopener noreferrer">vimdiff: Jump to next difference inside line?</a></p>

</li>
</ol>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[隐私权]]></title>
            <link>https://hotoo.github.io/blog/post/about-privacy</link>
            <guid>126</guid>
            <pubDate>Sun, 22 Aug 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="隐私权">隐私权<a aria-hidden="true" href="#隐私权">#</a></h1>
<p>团购的时候我在邮件和 Google Docs 向所有参与团购的团友公布了各自的详细信息
（包括联系信息）。</p>
<p>我的公布的理由有两个：</p>
<ol>
<li>方便自己统一管理，和团友随时审阅；</li>
<li>方便同城团友可以合并快递单。</li>
</ol>
<p>有团友很不高兴。于是我特地看了关于隐私权的一些资料。</p>
<p>根据 <a href="https://zh.wikipedia.org/zh%5Cncn/%E9%9A%90%E7%A7%81%E6%9D%83" target="_blank" rel="noopener noreferrer">维基百科全书：隐私权</a>
和一些其他相关资料上的描述，我似乎并没有侵犯任何隐私权。
我没有把大家的手机号写在电线杆子上，并附上“办证”之类的字样；
没有入侵并偷窥大家的电子邮件；也没有找到大家的收货地址后非法闯进去。。。
\n以上纯属玩笑话 :D\n</p>
<p>隐私权目前来说还是有一些模棱两可的地方，虽然我主观上是支持保护隐私权的。
我也有隐私，但只要不是把我和家人的资料公布在网上，或者提供给某些混蛋，
以至于我和家人会受到严重的骚扰和恐吓之外，还是没有什么的。</p>
<p>朋友和一些相对比较可靠的人知道我的联系方式，是件好事吧。虽然我小时候曾经很傻的
想住到深山老林里去隐居。</p>
<p>个人认为：有限区域范围内的个人或家庭联系方式，算不上是隐私。
你的邻居知道你家的门牌号码；公司、学校拥有你的详细资料；
商家索取买家发货地址；快递员直接打你的手机；
参加团购的成员知道你的联系资料。。。</p>
<blockquote>
<p>好吧，虽然我可能没有犯罪，但是我错了。我只是想偷懒才使用群发邮件的方式的。</p>
</blockquote>
<p>另外居然有蛋疼的律师控告电信说“来电显示”损害了其隐私权。</p>
<ol>
<li>你没有号码怎么打电话给他人；你拿到他人的号码，是否就侵犯了其隐私？</li>
<li>你打电话给他人，这他人没有知情权，无权知道是哪个混蛋在骚扰他？</li>
</ol>
<p>另外也有人控告移动、联通公司所谓的“恢复”收取来电显示的费用是单方面修改合同、
强制消费行为。想都不用想，最终败诉。</p>
<p>现在好了，你可以关闭来电显示，每月省了 6 块还是几块钱。也就是说现在开通来电显示需要
每月多付几块钱，而这在以前是免费的。</p>
<p>我有一个很不希望相信的“阴谋论”：这起官司是电信或移动公司幕后主使的案件。</p>
<p>我对隐私权的概念还是有点不清晰，希望有人能写出清晰简洁的资讯出来，比如翻译关于隐私权
的论文和辩论过程之类，而不要像法律条文一样直接给我们模糊不清的强制性规定和结论。</p>
<p>p.s. 希望有生之年不要看见“非法持有他人隐私”的罪名或者大帽出现。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[【已结束】 ~~关于团购庆祝 Vim 7.3 正式发布的 Tee~~]]></title>
            <link>https://hotoo.github.io/blog/post/vim73-tee</link>
            <guid>128</guid>
            <pubDate>Sat, 14 Aug 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="已结束-关于团购庆祝-vim-73-正式发布的-tee">【已结束】 <del>关于团购庆祝 Vim 7.3 正式发布的 Tee</del><a aria-hidden="true" href="#已结束-关于团购庆祝-vim-73-正式发布的-tee">#</a></h1>
<p>我在 Twitter 上随意说了句相关的 <a href="https://twitter.com/hotoo/status/21126325142" target="_blank" rel="noopener noreferrer">意向</a>，
便有不少回应表示也愿意加入，我本想最好由某个懂行或者牛人来发起活动，我参加就好了，
不过目前看来，我只能自己扛起这个重担。</p>
<h2 id="关于-tee">关于 Tee<a aria-hidden="true" href="#关于-tee">#</a></h2>
<blockquote>
<p>初步设想：
\n正面\n ：印 Vim 的 Logo。 <a href="https://vote.sparklit.com/web%5Cnpoll.spark?pollID=1119325" target="_blank" rel="noopener noreferrer">投票</a>
\n背面\n ：印 <code>:wq!</code> 或者 <code>:help!</code> 命令，下面还印上版本信息 <code>:version</code>。
<a href="https://vote.sparklit.com/web%5Cnpoll.spark?pollID=1119327" target="_blank" rel="noopener noreferrer">投票</a>
\n右手袖子\n ：印 <code>:version</code> 信息。
\n颜色\n ：商家唯一指定白色。
P.S. 还有网友提议将自己的 vimrc 打上去，创意不错，但这是一此集体活动。
不过大家还是可以提议一些非常具有 Vim 特色的代码。</p>
</blockquote>
<p>![](<a href="https://www.flickr.com/photos/hotoo/4893442809/" target="_blank" rel="noopener noreferrer">https://www.flickr.com/photos/hotoo/4893442809/</a> <a href="https://farm5.static.flickr.com/4141/4893442809%5Cnaedb31676a%5Cnb.jpg" target="_blank" rel="noopener noreferrer">https://farm5.static.flickr.com/4141/4893442809\naedb31676a\nb.jpg</a>)</p>
<p>商家答应可以有 3 种不同的图案，但是考虑到实际操作太麻烦，包括下订单，印刷和发货都非常容易出错，
所以我们最好是尽量少的使用不同图案。如果有喜欢但是没有选择的图案，各位可以各取所需自行单独印刷。</p>
<p>参考：</p>
<p>\n <a href="https://www.newsmth.net/bbsanc.php?path=%2Fgroups%2Fcomp.faq%2FVIM%2Ffriends%2Fhuodong%2F2005%2FM.1115718502.M0" target="_blank" rel="noopener noreferrer">滇狐很久之前提供的版本</a>
（<a href="https://edyfox.codecarver.org/html/vim%5Cnlogo%5Cnsim.png" target="_blank" rel="noopener noreferrer">简易版</a> ^[1]^
<a href="https://edyfox.codecarver.org/html/vim%5Cnlogo%5Cnbas.png" target="_blank" rel="noopener noreferrer">普通版</a> ^[2]^
<a href="https://edyfox.codecarver.org/html/vim%5Cnlogo%5Cnen.png" target="_blank" rel="noopener noreferrer">高级版</a> ^[3]^）
\n <a href="https://www.zazzle.com/vim+tshirts" target="_blank" rel="noopener noreferrer">Vim T\nshirts, Shirts and Custom Vim Clothing</a>
\n <a href="https://www.zazzle.com/apaga%5Cny%5Cnvamonos%5Cntshirt%5Cn235860815670055282" target="_blank" rel="noopener noreferrer">Tee 图片</a>
\n <a href="https://www.zazzle.com/vim%5Cntshirt%5Cn235495517240839065" target="_blank" rel="noopener noreferrer">2</a>
\n 另外感谢 <a href="https://f2e.us" target="_blank" rel="noopener noreferrer">阿阳</a> 还提供了一份他找视觉设计师修改过，上次印 Tee 的 AI 文件。</p>
<h2 id="tee-的质量">Tee 的质量<a aria-hidden="true" href="#tee-的质量">#</a></h2>
<p>商家是阿阳推荐的，他之前有在这家定制过，说是材料“比较厚，质量还不赖的”。
而商家说：“我们这只有一种220克的，是属于好的，差的么就是180 200克的。那二种我们没有在做的。”</p>
<h2 id="关于费用">关于费用<a aria-hidden="true" href="#关于费用">#</a></h2>
<p>跟淘宝一个定制 Tee 的 <a href="https://1tshirt.taobao.com/" target="_blank" rel="noopener noreferrer">商家</a> 联系，50件以上的话
双面印刷最低能到 <del>28.00</del> <del>26.00</del> 25.00 元/件（<del>单面 25.00</del>），目前有 50 多人，
如果有更大的数量级，估计还可以更便宜，到时候我再商量，40 件估计需要一周才可以出货；
Tee 可以直接发到每个人手中，考虑到运费，我提议同城的统一由一个人负责签收并发放，
这样顺便还可以线下认识几个朋友，同城运费最终 AA 制；自己愿意单独付运费的不在此列。</p>
<p>如果看中这店家的其他 Tee，参加团购的朋友也同样可以以团购的价格购买，直接在
店家商品上拍即可，记得给商家说明情况，另外还要报上我的旺旺ID（请来邮件索取）。</p>
<p>周六我会公布所有同城信息，到时候希望同城统一签收的可以联系我。
除非专门指定，默认情况下，均发或到个人签收。
学校老师或学生会稍晚发货，以确保各位能在学校签收。</p>
<p>目前不支持快递到国外，如果有国内的地址，请使用国内地址。
到台湾的快递费是 35.00 元，3 天之内可以到。</p>
<p>目前还没有确定最终购买人数和打折尺度，而且费用收取方式上也还没有确定，大家可以自由选择
预付定金，或者我先垫资金的方式，都没有关系的。下周末等情况确定后我会公布收款方式，
请大家静候佳音。</p>
<p>费用收取方式主要采取支付宝收款，或者银行卡汇款。</p>
<p>店家提供的快递运费对照表：</p>
<p>| 运输方式 | 1公斤内 | 加重/公斤 | 运送到                                                                                                                    |
|\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
| 快递     | 8.00    | 5.00      | 安徽                                                                                                                      |
| 快递     | 5.00    | 2.00      | 上海，江苏，浙江                                                                                                          |
| 快递     | 10.00   | 8.00      | 北京,天津,河北,山西,辽宁,吉林,黑龙江,福建,江西,山东,河南,湖北,湖南,广东,广西,海南,重庆,四川,贵州,云南,陕西,甘肃,青海,宁夏 |
| 快递     | 15.00   | ?         | 大陆其他地区                                                                                                              |
| 速运     | 35.00   | ?         | 台湾                                                                                                                      |</p>
<p>默认使用圆通快递，台湾地区使用顺风速运，3天内可以到达。</p>
<h2 id="已结束-关于报名">【已结束】 <del>关于报名</del><a aria-hidden="true" href="#已结束-关于报名">#</a></h2>
<p>为避免报名时间过短，或等待时间过长，初步计划报名截止到下周末，如果中途有事没有时间也没有关系，
只要确认购买，我可以预付费用的。</p>
<p>一旦确定购买名单，我们就开始下订单订货。</p>
<p>由于我第一次搞这样的活动，有经验的老师请一定多多指导。</p>
<blockquote>
<p>\n注意\n ：如果确定要购买，请务必将你 [<a href="https://www.flickr.com/photos/hotoo/4890597770/" target="_blank" rel="noopener noreferrer">https://www.flickr.com/photos/hotoo/4890597770/</a> 需要的尺码]，
\n邮件地址\n ，实际的 \n收货地址\n ， \n邮编\n 和 \n收件人姓名\n 。
最好还有即时联系方式，比如手机，快递可能需要。
请确认这些信息能直接联系到你，收件人能收到货。</p>
</blockquote>
<p>如果在截止时间之前没有给出详细联系地址导致无法发货的，一律认为不参加这次活动，请谅解。</p>
<p>如果有些没所谓的小失误的话请多多包含，大失误我会尽力承担的。</p>
<h2 id="活动结束语">活动结束语<a aria-hidden="true" href="#活动结束语">#</a></h2>
<p>这次活动过程几经波折，把我、团友，和商家都折腾的够呛。主要是由于我经验不足造成，
事先的准备工作也不够，导致有数次变更，甚至有些不尽如人意。</p>
<p>不管怎么样，报名活动总算是结束了，我这里不再接收任何报名，仍希望购买的朋友可以尝试
<a href="https://item.taobao.com/auction/item%5Cndetail.htm?item%5Cnnum%5Cnid=7174622420" target="_blank" rel="noopener noreferrer">这个链接</a>，
运气好的话仍然可以得到团购的待遇。</p>
<p>最后：这样的人生经历一次就够了，谢谢大家。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[SQL LIKE 查询的一个问题]]></title>
            <link>https://hotoo.github.io/blog/post/about-sql-like</link>
            <guid>127</guid>
            <pubDate>Fri, 13 Aug 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="sql-like-查询的一个问题">SQL LIKE 查询的一个问题<a aria-hidden="true" href="#sql-like-查询的一个问题">#</a></h1>
<p>在做用户管理的时候，用户表(users) 有一个字段(dept)用来存储用户所在部门的信息，
字段的值一般是这样的，各级部门间使用横杠分隔：</p>
<pre><code>XX宝\n技术部
XX宝\n技术部\n数据仓库
</code></pre>
<p>我们的系统有一个根据用户所在部门进行过滤的功能，所以我们用了类似下面的查询语句：</p>
<pre><code>SELECT \n FROM users WHERE dept LIKE &quot;XX宝\n技术部%&quot;;
</code></pre>
<p>这样的性能还好，但是今天发现一个问题是，当有两个部门名称很相似，比如：</p>
<pre><code>XX宝\nCEO
XX宝\nCEO办公室
</code></pre>
<p>这时在查询 <code>XX宝CEO</code> 的时候就会把 <code>XX宝\nCEO办公室</code> 的用户也查询出来。</p>
<p>于是想到正则表达式：</p>
<pre><code>SELECT \n
FROM users
WHERE REGEXP\nLIKE(dept, &quot;^XX宝\nCEO\n&quot;)
OR REGEXP\nLIKE(dept, &quot;^XX宝\nCEO\n[\w\\n]+&quot;);
</code></pre>
<p>合并正则表达式的另一解：</p>
<pre><code>SELECT \n
FROM users
WHERE REGEXP\nLIKE(dept, &quot;^XX宝\nCEO(\n|\n[\w\\n]+)&quot;);
</code></pre>
<p>杯具的性能问题。</p>
<p>突然想到</p>
<pre><code>SELECT \n
FROM users
WHERE dept=&quot;XX宝\nCEO&quot;
OR dept LIKE &quot;XX宝\nCEO\n%&quot;;
</code></pre>
<p>于是简单有效的解决了这个问题。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[用 gvim 比较 git diff]]></title>
            <link>https://hotoo.github.io/blog/post/gitdiff-with-vim</link>
            <guid>129</guid>
            <pubDate>Sun, 01 Aug 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="用-gvim-比较-git-diff">用 gvim 比较 git diff<a aria-hidden="true" href="#用-gvim-比较-git-diff">#</a></h1>
<h2 id="for-windows">for Windows<a aria-hidden="true" href="#for-windows">#</a></h2>
<p>参考 [<a href="https://gist.github.com/502217" target="_blank" rel="noopener noreferrer">https://gist.github.com/502217</a> gist:502217]</p>
<ol>
<li>
<p>在用户目录下的 .gitconfig 中加入：</p>
<p>[diff]
external = git\ndiff\nwrapper.bat
[pager]
diff =</p>
</li>
<li>
<p>创建 git\ndiff\nwrapper.bat 文件放到 \nPATH 目录下，内容为：</p>
<p>path\to\gvim.exe \nd "%2" "%5"</p>
<p>gvim \nd "\n2" "\n5"</p>
<p>注意其中的 path\to\ 要改为 gvim.exe 所在目录。</p>
</li>
</ol>
<h2 id="for-linux">for Linux<a aria-hidden="true" href="#for-linux">#</a></h2>
<p>参考 <a href="https://technotales.wordpress.com/2009/05/17/git%5Cndiff%5Cnwith%5Cnvimdiff/" target="_blank" rel="noopener noreferrer">Git Diff with Vimdiff</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[整合状态按钮和导向按钮]]></title>
            <link>https://hotoo.github.io/blog/post/integrate-guide-button-and-status-button</link>
            <guid>130</guid>
            <pubDate>Sat, 31 Jul 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="整合状态按钮和导向按钮">整合状态按钮和导向按钮<a aria-hidden="true" href="#整合状态按钮和导向按钮">#</a></h1>
<p><a href="https://hotoo.github.com/labs/integrate%5Cnguide%5Cnbutton%5Cnand%5Cnstatus%5Cnbutton.html" target="_blank" rel="noopener noreferrer">Demo</a></p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://www.uesee.com/?p=143" target="_blank" rel="noopener noreferrer">状态按钮和导向按钮</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用 calendar.vim]]></title>
            <link>https://hotoo.github.io/blog/post/use-vim-calendar</link>
            <guid>131</guid>
            <pubDate>Fri, 23 Jul 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="使用-calendarvim">使用 calendar.vim<a aria-hidden="true" href="#使用-calendarvim">#</a></h1>
<p>最初看到明城 <a href="https://www.gracecode.com/archives/674/" target="_blank" rel="noopener noreferrer">推荐使用 Vim Calendar 插件</a>，
于是很小白的尝试了一下，然后就没有了然后。</p>
<p>最初尝试的过程已经基本忘记，恍惚记得在 Calendar 的日期上回车，窗户貌似在右侧窗口
打开的（后来发现我记错了，这是 Vimwiki\ndiary的支持）；至于明城推荐设置的 <code>ca</code>
快捷键，后来才知道是与 text\nobject 冲突的。</p>
<p>再后来就用上了 Vimwiki，做个人 Wiki 之余，还用它的 diary 写日记。总体来说，Vimwiki
的 diary 是比较强大的，我甚至还提了几个被接受的建议。</p>
<p>但是随着使用的深入，发现通常 Wiki 项目下是不需要 diary 的，而 diary 也基本不需要
Wiki，把这两种整合在一起也许就是个错误。我们真正需要的是一个更强的 Calendar diary，
而不是 Wiki 附加的 diary 支持。</p>
<p>如果真的希望 Vimwiki 有 diary 的支持，我也希望这个 diary 和 Wiki 是相互独立的，
Wiki 项目中无需 diary，diary 无需包含在每个 Wiki 项目里。</p>
<p>另外基于 Wiki 的原因，所有的 diary\nwiki 文件都放在同一个目录下，当 diary 日渐增多，
目录变得臃肿起来也不是什么好事。</p>
<p>我需要的是一个更强的 Vim Calendar。基于这个想法，我便尝试着手增强 Calendar。
目前已经支持 <code>:CalendarSearch</code> 和更好的 diary 打开方式。更多的想法见
<a href="https://github.com/hotoo/calendar%5Cnvim/blob/master/TODO" target="_blank" rel="noopener noreferrer">这里</a>。</p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/open-files-in-vim-tabs</link>
            <guid>132</guid>
            <pubDate>Fri, 25 Jun 2010 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Vim 自动补全成对的括号和引号]]></title>
            <link>https://hotoo.github.io/blog/post/vim-autocomplete-pairs</link>
            <guid>133</guid>
            <pubDate>Sun, 20 Jun 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-自动补全成对的括号和引号">Vim 自动补全成对的括号和引号<a aria-hidden="true" href="#vim-自动补全成对的括号和引号">#</a></h1>
<p>炫日分享了一个 <a href="https://aoyme.wordpress.com/2010/05/31/%E5%9C%A8vim%E4%B8%AD%E5%B0%86%E6%8B%AC%E5%8F%B7%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8%EF%BC%9A/" target="_blank" rel="noopener noreferrer">自动补全成对的括号</a>
的脚本，【注】：原文代码中引号被转义成了中文引号，下面是修正后的脚本。</p>
<pre><code>inoremap ( ()&lt;ESC&gt;i
inoremap ) &lt;c\nr&gt;=ClosePair(&#39;)&#39;)&lt;CR&gt;
inoremap { {}&lt;ESC&gt;i
inoremap } &lt;c\nr&gt;=ClosePair(&#39;}&#39;)&lt;CR&gt;
inoremap [ []&lt;ESC&gt;i
inoremap ] &lt;c\nr&gt;=ClosePair(&#39;]&#39;)&lt;CR&gt;
inoremap &lt; &lt;&gt;&lt;ESC&gt;i
inoremap &gt; &lt;c\nr&gt;=ClosePair(&#39;&gt;&#39;)&lt;CR&gt;

function ClosePair(char)
    if getline(&#39;.&#39;)[col(&#39;.&#39;) \n 1] == a:char
        return &quot;\&lt;Right&gt;&quot;
    else
        return a:char
    endif
endf
</code></pre>
<p>经启发我增加了对括号和引号更为智能的补全支持，
不过中文全角的括号和引号目前无法通过映射来实现，
对于转义的符号对的支持不佳。</p>
<p>支持 2000 行以内（可以根据系统性能自行配置）文档的全局括号对识别能力。
也就是 2000 行以内的文档，支持跨行的括号对智能匹配能力；当文档行数超出预设值，
则使用行内括号对智能补全。</p>
<p>\n OpenPair:</p>
<ol>
<li>如果当前行的括号已经成对匹配，则自动补全右括号 <code>(I)</code></li>
<li>如果左括号比右括号多，则自动补全  <code>I(()</code> <code>(I()</code> <code>((I)</code> <code>(()I</code></li>
<li>如果左括号比右括号少，
<code>I())</code> 原样输出，不自动补全
<code>(I))</code> 同上
<code>()I)</code> 同上
<code>())I</code> 自动补全：左括号较少，且光标之后字符串进行一次递归上面的条件
\n ClosePair:</li>
<li>如果光标之后是一个右括号，向右移动一列 <code>(I)</code> <code>((I)</code> <code>(I))</code> <code>()I)</code></li>
<li>否则原样输出。</li>
</ol>
<p>代码见 <a href="https://gist.github.com/449512" target="_blank" rel="noopener noreferrer">gist: 449512</a></p>
<h2 id="更新-2010624">更新 (2010/6/24)<a aria-hidden="true" href="#更新-2010624">#</a></h2>
<h2 id="最后更新-201079">最后更新 (2010/7/9)<a aria-hidden="true" href="#最后更新-201079">#</a></h2>
<h2 id="相关脚本">相关脚本<a aria-hidden="true" href="#相关脚本">#</a></h2>
<p>\n <a href="https://www.vim.org/scripts/script.php?script%5Cnid=2754" target="_blank" rel="noopener noreferrer">delimitMate.vim</a>
(<a href="https://github.com/Raimondi/delimitMate" target="_blank" rel="noopener noreferrer">src</a>)
\n <a href="https://vim.wikia.com/wiki/Making%5CnParenthesis%5CnAnd%5CnBrackets%5CnHandling%5CnEasier" target="_blank" rel="noopener noreferrer">Making Parenthesis And Brackets Handling Easier</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[在 Google Maps 的街景视图里看实况足球]]></title>
            <link>https://hotoo.github.io/blog/post/3d-game-in-google-maps</link>
            <guid>134</guid>
            <pubDate>Wed, 16 Jun 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="在-google-maps-的街景视图里看实况足球">在 Google Maps 的街景视图里看实况足球<a aria-hidden="true" href="#在-google-maps-的街景视图里看实况足球">#</a></h1>
<p>我承认我标题党了，这只是我的一个 idea 而已，并没有实际实现。</p>
<p>前几天有新闻称日本要申办 2022 年的世界杯，承诺将以 3D 转播赛况，
还以全息技术将赛况投影到足球场上，任何一个足球场都可以模拟现场实况，
并准备研发全息电视，把赛况以全息技术在家庭里播放。
而实际上，日本在某些音乐会已经使用全息技术的实际应用
（X\nJapan的 <a href="https://v.youku.com/v%5Cnshow/id%5CnXOTE2MDcxMTY=.html" target="_blank" rel="noopener noreferrer">Art of Life</a>
的 15:36 至 19:13 之间都是以全息技术
制作的演出，直接观看19:10，然后等几秒钟就会明白）。</p>
<p>我的个神啊，这是一种怎样的未来。</p>
<p>在看南非世界杯的几个球场街景视图时，我突然想到如果模拟实况足球游戏，
根据比赛实况，将比赛情形在类似的视图中展现出来，会爽到什么程度啊。</p>
<p><a href="https://maps.google.com/maps?f=q&amp;source=s%5Cnq&amp;hl=zh%5CnCN&amp;geocode=&amp;q=%E4%BC%8A%E4%B8%BD%E8%8E%8E%E7%99%BD%E6%B8%AF&amp;sll=35.86166,104.195397&amp;sspn=51.335062,89.033203&amp;brcurrent=3,0x0:0x0,0%3B5,0,0&amp;ie=UTF8&amp;hq=&amp;hnear=%E4%BC%8A%E4%B8%BD%E8%8E%8E%E7%99%BD%E6%B8%AF,+%E4%B8%9C%E5%BC%80%E6%99%AE,+%E5%8D%97%E9%9D%9E&amp;ll=%5Cn33.937975,25.599529&amp;spn=0.006533,0.014956&amp;t=h&amp;z=17&amp;layer=c&amp;cbll=%5Cn33.937919,25.59958&amp;panoid=Q5GeWsE39Ki147z%5Cn1qBkAQ&amp;cbp=12,8,,0,%5Cn0.94" target="_blank" rel="noopener noreferrer">伊丽莎白港</a></p>
<p><a href="https://maps.google.com/maps?f=q&amp;source=s%5Cnq&amp;hl=zh%5CnCN&amp;geocode=&amp;q=%E5%86%85%E5%B0%94%E6%96%AF%E6%99%AE%E9%9B%B7%E7%89%B9&amp;sll=35.86166,104.195397&amp;sspn=52.945838,89.033203&amp;ie=UTF8&amp;hq=&amp;hnear=%E5%86%85%E5%B0%94%E6%96%AF%E6%99%AE%E9%9B%B7%E7%89%B9,+%E6%99%AE%E9%A6%AC%E8%98%AD%E5%8A%A0%E7%9C%81,+%E5%8D%97%E9%9D%9E&amp;ll=%5Cn25.461787,30.929775&amp;spn=0.007343,0.014956&amp;t=h&amp;z=17&amp;brcurrent=3,0x0:0x0,0%3B5,0,0&amp;layer=c&amp;cbll=%5Cn25.461933,30.929288&amp;panoid=H1O5Rhjde8l9QhaO75Z6Vg&amp;cbp=12,11.73,,0,2.74" target="_blank" rel="noopener noreferrer">内尔斯普雷特</a></p>
<p>p.s. 现在的 Google Maps 街景视图，比 Google Earth 的 3D 模型要爽要逼真，
不过街景视图无法以 3D 效果看鸟瞰图。</p>
<h2 id="延伸阅读">延伸阅读：<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://www.cnbeta.com/articles/111966.htm" target="_blank" rel="noopener noreferrer">日本申办2022世界杯 许诺提供3D比赛直播</a>
\n <a href="https://www.cnbeta.com/articles/113031.htm" target="_blank" rel="noopener noreferrer">日本研发全息电视：用激光投射飘浮图像</a>
\n <a href="https://www.google.org.cn/tag/google%5Cntrike" target="_blank" rel="noopener noreferrer">Google Trike</a>
\n <a href="https://zhaiyx.com/2010/03/miku%5Cn3d%5Cnconcert/" target="_blank" rel="noopener noreferrer">初音未来3D全息演唱会 | 宅映像</a>
\n <a href="https://v.youku.com/v%5Cnshow/id%5CnXMTY3OTM2MDEy.html" target="_blank" rel="noopener noreferrer">初音未来全息演唱会</a> \n 初音ミク</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[用 Google Code 管理与发布 Wiki]]></title>
            <link>https://hotoo.github.io/blog/post/vimwiki-google-code</link>
            <guid>135</guid>
            <pubDate>Thu, 20 May 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="用-google-code-管理与发布-wiki">用 Google Code 管理与发布 Wiki<a aria-hidden="true" href="#用-google-code-管理与发布-wiki">#</a></h1>
<p>由于 <a href="Dropbox%5Cndied%5Cnin%5CnChina.html">Dropbox 的墙掉</a>，https 协议访问 dl 或 dl\nweb 子域
的方法也随之失效，虽然可以通过修改 hosts 来继续同步文件，但是 Public 目录再也
不能输出文化了。</p>
<p>我之前 <a href="use%5Cnvimwiki%5Cnfor%5Cnblog.html">在 Dropbox Public 目录搭建的博客和 Wiki 系统</a>
也无法在线浏览了，为了能够继续 辅助文化局输出文化，我便利用万恶的资本主义国家
的 Google Code 来为我们服务了。</p>
<p>由于可以继续使用 Dropbox 来自动同步私有文件，所以可以保持 .wiki 文件在 Dropbox
中，其他自动同步的软件也可以用来做类似的事情。</p>
<p>将 Vimwiki 的 <code>path\nhtml</code> 修改为 Google Code 的某个 svn 或 Hg 目录：</p>
<pre><code>let g:vimwiki\nlist = [{...},
    \ {...},
    \ {...},
    \ {
        \ &#39;path&#39;        : &#39;D:\My Dropbox\blog&#39;,
        \ &#39;path\nhtml&#39;   : &#39;D:\hotoo\blog&#39;,
        \ &#39;html\nheader&#39; : &#39;D:\My Dropbox\blog\template\header.tpl&#39;,
        \ &#39;html\nfooter&#39; : &#39;D:\My Dropbox\blog\template\footer.tpl&#39;
    \ }
    \ ]
</code></pre>
<p>虽然 Vimwiki 目前的 toHTML 方法还不支持重新生成仅更新过的 wiki 文件，但是 svn
可以判断文件是否有真正被修改过。</p>
<p>另外 <a href="https://hotoo.googlecode.com/svn/wiki" target="_blank" rel="noopener noreferrer">https://hotoo.googlecode.com/svn/wiki</a> 目录存放的是 Google Code 的 Wiki 文件，
这里面的 wiki 文件无需通过 Vimwiki 导出 HTML，Google Code 会自动完成这一工作，
并可以通过 <a href="https://code.google.com/p/hotoo/w/list" target="_blank" rel="noopener noreferrer">https://code.google.com/p/hotoo/w/list</a> 浏览。而 Vimwiki 是 Google Code
Wiki 语法的一个子集，所以基本可以天衣无缝的配合使用。</p>
<p>这也是不错的一个方案，除了需要 commit 之外，Google Code 比 Dropbox 的 Public
有过之而无不足，域名也是杠杠的。</p>
<p>另外不小心发现还有其他的托管方案，让防火墙筑的更高些吧，当局者把自己当猪圈养起来
比较好，做个专职的脑子又笨，目光又短浅的墙脚之猪也可以提高幸福指数的。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[让 Vim 支持 LOG 文件]]></title>
            <link>https://hotoo.github.io/blog/post/log-syntax-4-vim</link>
            <guid>136</guid>
            <pubDate>Thu, 13 May 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="让-vim-支持-log-文件">让 Vim 支持 LOG 文件<a aria-hidden="true" href="#让-vim-支持-log-文件">#</a></h1>
<p>日志(.LOG)文件的基本上无章可循，各成风格。所以一般都是在纯文本模式下查看。
以普通文本的方式显示日志，基本没有清晰度和阅读舒适感。</p>
<p>不过一般来说，日志中是会有日期时间（格式非常多样），错误产生的地址，行号，
列号，日志类型（错误(ERROR)，信息(INFO)，调试(DEBUG)，警告(WARN)等）</p>
<p>据此，我为 .LOG 文件定义了一些语法着色的规则，将
<a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/syntax/log.vim" target="_blank" rel="noopener noreferrer">log.vim</a>
放至 <code>\nVIM\vimfiles\syntax</code>(Windows) 目录，并在 <code>\nVIM\vim72\filetype.vim</code> 中加入：</p>
<pre><code>au BufNewFile,BufRead \n.log         setf log
</code></pre>
<p>现在就可以在 Vim 中较清晰的查看 .LOG 日志了。</p>
<p><img src="https://farm5.static.flickr.com/4051/4623711702%5Cn81901313f9%5Cno.jpg" alt=""></img></p>
<p>你也可以针对自己的实际情况，来自定义语法。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Dropbox 的墙掉]]></title>
            <link>https://hotoo.github.io/blog/post/dropbox-died-in-china</link>
            <guid>137</guid>
            <pubDate>Mon, 10 May 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="dropbox-的墙掉">Dropbox 的墙掉<a aria-hidden="true" href="#dropbox-的墙掉">#</a></h1>
<p>其他的都不想说，只希望 Dropbox 的开放性能更强大，比如 API 或者分布式
的云技术再上台阶，第三方服务风起云涌，像 Twitter 那样。我深信：</p>
<blockquote>
<p>开放到极致的世界，无视大独裁者。
让 XX 去万岁，我只要真理，真理使我们自由。
\n\n 闲耘™</p>
</blockquote>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[天目山拓展活动]]></title>
            <link>https://hotoo.github.io/blog/post/outreach-activities-2010-04</link>
            <guid>138</guid>
            <pubDate>Sat, 17 Apr 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="天目山拓展活动">天目山拓展活动<a aria-hidden="true" href="#天目山拓展活动">#</a></h1>
<p>公司组织了一次天目山野外拓展活动，收益良多，这里稍事记录。</p>
<p>“信任背摔”：如果信任队友，笔直倒下，这无论对自己，对队友都是最佳选择。
在队友的保护下倒下90度并不会造成什么伤害，8个队友的平均分摊也使受力最小。
但如果不信任队友，撅着屁股坐下去，队友不堪其苦，手可能会受伤，因为承受
不住而将自己扔在地上，自己也会摔的很惨。</p>
<p>感受：把适当的工作放手交给队友，信任他们，自己可以得到最大程度的释放，
队友也可以表现到最好。否则自己心力交瘁，队友也不堪其苦。</p>
<p>“齐头并进”：我们小组获得了最大程度的失败，中途两次中断排头有一定的责任，
但各位队友心力不齐是更大的问题，而最大的毛病是不能保持平和的心态，很好的
势头，但急于求成，越走越快，直至完全失控，乱掉方寸。</p>
<p>“天桥”（真正的名称未知，具体是爬上10米高架，从断桥跳跃抓住单杠）：据教练
说最快速度是从爬上到跳下总共14秒，我第一次玩这个，作为压阵选手，我准备挑战
一下，让同事用我的手机秒表记时，可惜他不是很熟练，没记上，说大概是25秒，
看来还是有差距。这个游戏最刺激的是下落那一刻，负责保险绳的教练，非常好玩，
他说了，只负责队员的生命安全，其他不管，弄哭了好几个女生（不包括在上面还
没有开跳就开哭的）。我在自由下落那一刻，眼前一片模糊，四肢没有知觉，不知道
有没有很挫的蜷缩。</p>
<p>“电网”：我第一个出发，在队友的帮助下从下面的窟窿安全穿过，然后帮助几乎
所有队友通过，好累，也揩了好多油，美女都是我抱过来的，很多男的也是（挫）。</p>
<p>经验：第一个需要身体适中（不是太壮大，但身体较强壮，比如我 ：D）；再辅助
几个能派上用场的男队员过来，中间把所有女队员抱过来，瘦的要留在最后，并且
一定要记得要在下面给他留一个可以钻过的窟窿。衣服要很小心注意。</p>
<p>“逃生墙”：没有绳子辅助，要翻过 4.2米的高墙是不可能的，团队合作尤为重要。
我被选为第一个逃生者，踩在队友的大腿和肩膀上是不够的，我没想到他们会将我
托起来，太伟大了！我（被女生称为）“像猴子一样”迅速翻过，然后协助了超过一半
的队友完成逃生，先上来的又积极协助后面的队友，而下面作为基石的队友更是伟大，
有些基石托起了超过一半人。逃生 过程非常火爆，最终我们81人全部在 13分8秒完成了翻墙逃生。</p>
<p>技巧：两名基石队员半蹲准备，逃生队员通过其大腿踩到肩膀上，然后身体贴这墙
直起身体，向上伸手求助（第一名队员千万不要通过弹跳来抓上面，这样基石队员
的肩膀非常容易受伤），翻墙时脚的协助非常重要，侧身攀延。最后一个队员的逃生
最为困难，本来准备让我倒挂救援的，结果据说是让其抓住倒数第二名队员的脚
拉上来的，我没有看到，不过人多力量大，这个绝对可以做到。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Vim 学习路线]]></title>
            <link>https://hotoo.github.io/blog/post/vim-tutor</link>
            <guid>139</guid>
            <pubDate>Sun, 11 Apr 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-学习路线">Vim 学习路线<a aria-hidden="true" href="#vim-学习路线">#</a></h1>
<p>因为是完全自学，身边没有这方面的导师，所以在真正入门之前，我是完全不理解 Vim
是个什么玩意的，其中最大的障碍，遇到的第一个问题就是：“我怎么输入文字？”</p>
<p>鼠标乱点，双击，右键，胡乱击键，应该是偶尔击到 "a" 键上而进入插入模式，但是
当时觉得又无章可循。新手在找一款趁手的工具时，一般很少太有耐心的，尤其面对
这么怪异不可理解、还未接受的东西。这是个什么鸟玩意，我说，就离开了。</p>
<p>所以第一个要点是，理解“多模式”编辑方式。</p>
<p>能熟练进出插入模式并输入内容后，中文用户遇到的另一个重要问题就是编码问题了，
除非你直接拣了他人的 vimrc。Vim 的编码支持是非常好的，重要的是理解并设置好
Vim 的编码选项。</p>
<p>这两个门槛跨过之后，对新手来说 Vim 就和其他编辑器（如Editplus，Notepate++等）
大致没什么差别了。</p>
<p>我于此踏上了 Vim 之旅，进入疯狂的学习期。</p>
<p>这个学习期是无章可循的，不过大致是先学习凌波微步，各种快速移动的技巧；找别人
的 vimrc 参考设置，命令，快捷键，自定义的键盘映射，看别人推荐的插件介绍并
亲身体验，搜索 Vim Wiki，看台湾大牛林佑安的 PPT，论坛和群组里交流学习，
搜索收集各种有趣、有用的小玩意。乱七八糟一堆东西，沉迷其中，不可收拾。</p>
<p>逐渐的我也可以给新手一些指导帮助了，由于射手座，O型血的缘故，崇尚自由开放，在
力所能及的领域还算热心人，我便成了我。</p>
<p>Vim 是一个大宝藏，里面有太多太多的宝贝，Vim doc 就是一本 Vim 的百科全书，对
Vim 的注解精悍而又无所不包，你几乎可以找到任何需要的帮助，如果实在找不到，
Vim Script 和 Wiki 上也有其他人非常多的智慧。</p>
<p>不过对于普通用户，只需要掌握快速移动，文本对象，少量的寄存器，搜索、替换技巧，
和微量的宏技术，基本就差不离了，这些是最常用的技巧，可以大幅度提高编辑、阅读
效率。</p>
<p>偶尔有一些特殊需求可以搜索或找人帮忙，如果喜欢，也可以学习脚本技术来扩展自己的
Vim。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[欢迎加入 Vim 的 Gtalk 群]]></title>
            <link>https://hotoo.github.io/blog/post/gtalk-group-for-vim</link>
            <guid>141</guid>
            <pubDate>Fri, 09 Apr 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="欢迎加入-vim-的-gtalk-群">欢迎加入 Vim 的 Gtalk 群<a aria-hidden="true" href="#欢迎加入-vim-的-gtalk-群">#</a></h1>
<blockquote>
<p>\n声明：\n 由于能力&精力有限，我已不再是 vim\<a href="mailto:ncn@appspot.com">ncn@appspot.com</a> 群管理员。
平时工作很忙，我已经退出这个群，无心参与这个群的讨论。
大家有什么想和我交流、分享的话题，欢迎来邮件交流。</p>

<p>这篇日志的所谓群规，不再适用于 vim\<a href="mailto:ncn@appspot.com">ncn@appspot.com</a> ，对其管理员&群成员没有任何约束力。</p>

<p>2011/10/22</p>
</blockquote>
<p>欢迎加入 Vim Talks™(<del><a href="mailto:vimcn@chatterous.com">vimcn@chatterous.com</a></del> 已迁移到 vim\<a href="mailto:ncn@appspot.com">ncn@appspot.com</a>) 这个 Gtalk 群，
任何人可以随意加入，没有任何限制。</p>
<p>给对 Vim 感兴趣的朋友推荐一些 <a href="https://hotoo.github.io/wiki/Vim.html" target="_blank" rel="noopener noreferrer">有用或有趣的资源</a>。</p>
<blockquote>
<p>\n警告：\n 所有可用命令都已在 <code>//help</code> 中列出，入群后请不要自作聪明尝试未知的命令，
给群其他成员带来无谓的打扰，谢谢。</p>
</blockquote>
<h2 id="加入方法">加入方法：<a aria-hidden="true" href="#加入方法">#</a></h2>
<p>在 Gtalk 里加 <code>vim\ncn@appspot.com</code> 为好友，然后给大家打个招呼 :)</p>
<h2 id="使用帮助针对gtalk">使用帮助(针对Gtalk)：<a aria-hidden="true" href="#使用帮助针对gtalk">#</a></h2>
<p>下面的命令，机器人会单独针对你进行回复，包括你的命令和回复的消息，都不会被其他
群成员接受到（除非你的命令有错误，被当作消息发送）。</p>
<p><code>help</code>::         查看所有可用的命令。</p>
<p>最新的命令前缀以横线 <code>\n</code> 开始（<code>help</code> 命令可以不带前缀），你也可以修改为适合
自己的设置。</p>
<p><del>更多内容参考 [<a href="https://io43.com/io43.GtalkGroup/cmds/" target="_blank" rel="noopener noreferrer">https://io43.com/io43.GtalkGroup/cmds/</a>] 和 [<a href="https://hotoo.github.io/wiki/Gtalk.html" target="_blank" rel="noopener noreferrer">https://hotoo.github.io/wiki/Gtalk.html</a> GTalk]。</del></p>
<h2 id="群规">《群规》<a aria-hidden="true" href="#群规">#</a></h2>
<blockquote>
<ol start="0">
<li>自由开放，自重互爱。</li>
<li>管理员不得将 vim\<a href="mailto:ncn@appspot.com">ncn@appspot.com</a> 设置为私有状态，保证入、退群都没有任何障碍。</li>
<li>管理员不得以任何理由审查聊天信息，禁言、踢人须得至少 2 位管理员同意。</li>
<li>允许偏见，不要求中立；但尽量不要有歧视，侮辱，诽谤或人身攻击行为。</li>
<li>允许闲聊，不禁止灌水，但抽水机除外，请至少言之有物。
【注意】有技术话题时请积极参与，并暂停闲聊（可以去私聊）。</li>
</ol>
</blockquote>
<p><del>我之前也有试玩过将 <a href="mailto:vimcn@chattous.com">vimcn@chattous.com</a> 群设置为 Private，记得当时感觉非常不好，</del>
<del>作为新用户会遇到很多麻烦。另外 Private 群也不出现在 chatterous.com 列表中，</del>
<del>新人很难找到，@join 的时候也会遇到问题。</del></p>
<p>之前的因为不了了之，没有记录和反思，偶尔手贱便会有“复辟”的念头，甚至还写了
<a href="https://vimcn.sourceforge.net/passcode.php" target="_blank" rel="noopener noreferrer">用来检验新用户的程序</a>，完全违背了群组
创立之初所坚信的自由开放精神，和这个 <a href="https://vote.sparklit.com/web%5Cnpoll.spark/1117556" target="_blank" rel="noopener noreferrer">投票</a>。</p>
<p>于是立此群规，约束管理员和群友的行为。以上为立群之根本，管理员不得私自修改，
必须经全部管理员同意，及群友投票数达到 50 票，并有 60% 以上的投票同意方可修订。</p>
<p>群规细则视需要再补充。</p>
<p>\n延伸阅读\n</p>
<p>“公民论坛”对话守则：
1989年的冬天，哈维尔等捷克知识分子在布拉格成立了“公民论坛”，制定了8条《对话守则》，
在街头巷尾、居住区、大学校园到处张贴，希望广为人知，以便监督。（1993年
<a href="https://zh.wikipedia.org/zh%5Cncn/%E7%93%A6%E8%8C%A8%E6%8B%89%E5%A4%AB%C2%B7%E5%93%88%E7%BB%B4%E5%B0%94" target="_blank" rel="noopener noreferrer">瓦茨拉夫·哈韦尔</a>
当选捷克第一任总统。瓦茨拉夫·哈韦尔出生于1936年，作为一名持不同政见者，长期从事反对前政府的活动，
曾3次入狱。他是“<a href="https://zh.wikipedia.org/zh%5Cncn/%E4%B8%83%E4%B8%83%E5%AE%AA%E7%AB%A0" target="_blank" rel="noopener noreferrer">七七宪章</a>”和“公民论坛”的创始人。）内容是：</p>
<ol>
<li>对话的目的是寻求真理，不是为了斗争。</li>
<li>不做人身攻击。</li>
<li>保持主题。</li>
<li>辩论时要用证据。</li>
<li>不要坚持错误不改。</li>
<li>要分清对话与只准自己讲话的区别。</li>
<li>对话要有记录。</li>
<li>尽量理解对方。</li>
</ol>
<p>(注：我没有找到原始出处，但我很认同。)</p>
<p>\n《提问的智慧》\n
<a href="https://wiki.woodpecker.org.cn/moin/AskForHelp" target="_blank" rel="noopener noreferrer">简体中文</a>
<a href="https://www.linuxforum.net/doc/smartq%5Cngrand.html" target="_blank" rel="noopener noreferrer">2</a>
<a href="https://mis.ndhu.edu.tw/docu/question.htm" target="_blank" rel="noopener noreferrer">繁体中文</a>
<a href="https://www.catb.org/~esr/faqs/smart%5Cnquestions.html" target="_blank" rel="noopener noreferrer">En</a></p>
<p>\n独门绝技：\n 直接提问，最好一次描述清楚问题。不要预热说：“谁熟悉 XX？”</p>
<p><a href="https://zh.wikipedia.org/zh/Wikipedia:%E4%B8%8D%E8%A6%81%E4%BC%A4%E5%AE%B3%E6%96%B0%E6%89%8B" target="_blank" rel="noopener noreferrer">不要伤害新手</a>。</p>
<p>== 技巧 ==
\n群 LOGO\n 
将下面（或者任何你喜欢）的图片保存到本地，到 Gmail 的联系人(Contacts)、或者你的客户端里修改群机器人的头像即可。</p>
<p>| 白色背景                                                             | 透明背景                                                             |
|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n|
| <img src="https://farm3.static.flickr.com/2683/4540127131%5Cn9304e4aac9%5Cno.png" alt=""></img> | <img src="https://farm3.static.flickr.com/2726/4541741357%5Cn6670b23cd3%5Cno.png" alt=""></img> |</p>
<p>\n修改昵称\n 
建议加入群组之后立即修改昵称，和 FID，一来可以标识和展现你的身份，二来可以避免长用户名好 FID 影响群聊效果。</p>
<h2 id="缺陷--不足">缺陷 & 不足<a aria-hidden="true" href="#缺陷--不足">#</a></h2>
<p>不能像 QQ 一样方便的发送图片并直接预览。GTalk 已经支持发送文件，
而且在新版的 Pidgin 中发送图片也支持直接预览，这跟平台相关。
如果确实需要分享图片/截图，可以使用第三方的图片服务
（如 <a href="https://www.flickr.com/" target="_blank" rel="noopener noreferrer">Flickr</a>，
<a href="https://www.dropbox.com/" target="_blank" rel="noopener noreferrer">Dropbox</a> 的Public目录，
<a href="https://www.yupoo.com/" target="_blank" rel="noopener noreferrer">Yupoo</a> 等），将图片所在的链接发送到群里即可。</p>
<p>没有群空间，用来存储/分享文件。当然你同样可以使用第三方存储服务（<a href="https://www.dropbox.com/" target="_blank" rel="noopener noreferrer">Dropbox</a>，
<a href="https://sync.live.com/" target="_blank" rel="noopener noreferrer">Windows Live Sync</a> ^<a href="https://skydrive.live.com/" target="_blank" rel="noopener noreferrer">SkyDrive</a>^，
<a href="https://docs.google.com/" target="_blank" rel="noopener noreferrer">Google Docs</a> ^支持上传任意类型的文件^，
<a href="https://rapidshare.com/" target="_blank" rel="noopener noreferrer">RapidShare</a> 等）来实现。</p>
<h2 id="gtalk-群的使用">Gtalk 群的使用：<a aria-hidden="true" href="#gtalk-群的使用">#</a></h2>
<p>鉴于 Gtalk 的特殊性，大段代码最好不要作为聊天内容直接发送，推荐的方法是，
将代码贴到专业的第三方网站（如 <a href="https://snipt.org/" target="_blank" rel="noopener noreferrer">Snipt</a>,
<a href="https://pastebay.com/" target="_blank" rel="noopener noreferrer">PasteBay</a>, <a href="https://copytaste.com/" target="_blank" rel="noopener noreferrer">CopyTaste</a>,
<a href="https://paste.ubuntu.org.cn/" target="_blank" rel="noopener noreferrer">Ubuntu Paste</a>, <a href="https://pastebin.com/" target="_blank" rel="noopener noreferrer">Pastebin</a>），
然后将网址贴到聊天消息里。这有个好处是，
避免大段内容影响阅读，专业的第三方服务能保持代码原文不被转义，支持代码着色，
甚至可以直接运行并得到结果，如果是第三方服务的会员，也可以方便管理自己的代码。</p>
<p>有些 \nnix 高手偶尔会频繁的尝试一些高级命令，例如 "@online", "@ls" 之类。
我个人希望群聊是本着分享和讨论交流的宗旨进行，当然闲聊也可以，话唠也行，
但是垃圾信息不要太多以至影响大家正常的交流。</p>
<h2 id="为什么不是-qq-群">为什么不是 QQ 群？<a aria-hidden="true" href="#为什么不是-qq-群">#</a></h2>
<p><a href="https://zh.wikipedia.org/wiki/%E7%B1%B3%E5%85%B0%E8%BE%BE%E8%AD%A6%E5%91%8A" target="_blank" rel="noopener noreferrer">米兰达警告(Miranda Warning)</a>：</p>
<blockquote>
<p>“你有权使用 QQ，但是你在 QQ 上所说的一切将被作为呈堂证供。Do you understand?”</p>
</blockquote>
<p>GTalk 没有人数限制，不需要冲Q币来增加某些服务，而受到更多不可理喻的限制；可以轻易的加入或退出群，
或随时暂停接收他人的讨论；具有完整的开放性，有非常多的官方或第三方客户端可以用，包括Windows,Linux,Mac平台；
更尊重 <a href="https://zh.wikipedia.org/zh%5Cncn/%E8%A8%80%E8%AE%BA%E8%87%AA%E7%94%B1" target="_blank" rel="noopener noreferrer">言论自由</a>，
没有无理取闹的<a href="https://zh.wikipedia.org/zh%5Cncn/%E5%AE%A1%E6%9F%A5%E5%88%B6%E5%BA%A6" target="_blank" rel="noopener noreferrer">审查制度</a>，
不会因为胡萝卜、李子和温习功课而被敏感词。</p>
<p>== Vim Talks™大事記 ==
2010/4/9:: Vim Talks™Gtalk 群创立于深夜。之前我加入“Vim 草堂”QQ 群，是比较活跃的成员， 因为不喜欢腾讯的所作所为，创立此群。不久后，重度删除腾讯的各种软件。</p>
<p>2010/6/12:: 关于“群隐私”及 Vim Talks™要处于 Public 还是 Private 状态的讨论。
(<a href="https://www.chatterous.com/vimcn/history/79/" target="_blank" rel="noopener noreferrer">link</a>)</p>
<p>2010/9/15:: <a href="https://lilydjwg.is%5Cnprogrammer.com/" target="_blank" rel="noopener noreferrer">百合仙子(依云,lilydjwg)</a>
<a href="https://www.chatterous.com/vimcn/history/196/#msg%5Cninfo%5Cn52" target="_blank" rel="noopener noreferrer">成为管理员</a>。不久 [<a href="https://davidx.me/" target="_blank" rel="noopener noreferrer">https://davidx.me/</a> davidx] 也成为管理员。</p>
<p>2010/11/3:: “我刚做了一个艰难的决定，如果群里明天还有聊QQ和360的，禁止发言24小时。”
(<a href="https://www.chatterous.com/vimcn/history/293/#msg%5Cninfo%5Cn2" target="_blank" rel="noopener noreferrer">#5132176862502009</a>)</p>
<p>2010/11/4:: 临时邀请“<a href="https://qun.qq.com/air/28971390" target="_blank" rel="noopener noreferrer">Vim 草堂</a>”堂主 张九天
成为 Vim Talks™的管理员。<a href="https://www.chatterous.com/vimcn/history/296/#msg%5Cninfo%5Cn21" target="_blank" rel="noopener noreferrer">#5145129995941272</a></p>
<p>2010/11/10:: 创立群规。邀请 shrek 和 春棍 为管理员。</p>
<p>2010/11/24:: 群出现严重的丢消息情况，迁移到 GAE，由开源项目搭建的群组服务
<code>vim\ncn@appspot.com</code>，机器人由百合仙子搭建&维护，任何人都可以<a href="https://github.com/lilydjwg/gaegtalk" target="_blank" rel="noopener noreferrer">参与提交代码</a>。</p>
<p>2011/1/1:: 删除 <a href="mailto:vimcn@chatterous.com">vimcn@chatterous.com</a> 群，全面迁移到 vim\<a href="mailto:ncn@appspot.com">ncn@appspot.com</a>，对于未主动迁移的群友，请自行迁移。</p>
<p>2011/10/22:: 自行删除管理员身份，退出群。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[有中国特色的社会主义笑话]]></title>
            <link>https://hotoo.github.io/blog/post/china-joke</link>
            <guid>140</guid>
            <pubDate>Thu, 08 Apr 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="有中国特色的社会主义笑话">有中国特色的社会主义笑话<a aria-hidden="true" href="#有中国特色的社会主义笑话">#</a></h1>
<p>笑料：</p>
<p>\n <a href="https://ent.qq.com/a/20100407/000164.htm" target="_blank" rel="noopener noreferrer">广电总局禁止电视节目用“NBA”等外语和缩略词</a></p>
<p>笑点：</p>
<p>\n 三个达不溜点后头没有点卡姆。 <a href="https://www.cnbeta.com/articles/108165.htm" target="_blank" rel="noopener noreferrer">ref</a>
\n 注：其实根据一项 <a href="https://ent.qq.com/a/20100407/000164.htm" target="_blank" rel="noopener noreferrer">最新指示</a>，
我们的标题是违规的，正确的写法应该是
“最受推特微博客网站和脸谱社交网站网友欢迎的美国职业男子篮球联赛球队”。
<a href="https://www.cnbeta.com/articles/108037.htm?tj=1" target="_blank" rel="noopener noreferrer">最受 Twitter 和 Facebook 网友欢迎的 NBA 球队</a>
\n 我是用窗牌操作系统第七版回复的
\n 我是用因特网探索者第八代浏览器回复的
\n 剧院浏览器第十代半用户飘过……</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[表单设计]]></title>
            <link>https://hotoo.github.io/blog/post/form-design</link>
            <guid>142</guid>
            <pubDate>Thu, 08 Apr 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="表单设计">表单设计<a aria-hidden="true" href="#表单设计">#</a></h1>
<p>\n</p>
<p>表单元素有新增、修改、删除的状态（新增和修改可以参考 svn 的图标，删除则直接从页面上删除 DOM）</p>
<h2 id="ref">Ref:<a aria-hidden="true" href="#ref">#</a></h2>
<p>\n <a href="https://ucdchina.com/snap/6284" target="_blank" rel="noopener noreferrer">如何精简用户界面</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[轉換編碼筆記]]></title>
            <link>https://hotoo.github.io/blog/post/convert-encoding-note</link>
            <guid>143</guid>
            <pubDate>Wed, 07 Apr 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="轉換編碼筆記">轉換編碼筆記<a aria-hidden="true" href="#轉換編碼筆記">#</a></h1>
<p>今天發現一個顯示為亂碼的 html 頁面，發現是當前頁面和 reference 頁面編碼
不一致造成的，reference 編碼為 gbk，當前頁面編碼是 utf8。</p>
<p>雖然各自 head 里的 charset 和其文件存儲的編碼一致，但某些瀏覽器（如Firefox）
從 reference 轉過來時，默認當前頁面的 charset 和 reference 的一致，導致亂碼
顯示。</p>
<p>由于 reference 所使用的編碼是整站的基準編碼，所以把當前頁面的 fileencoding
轉成和 reference 一致即可，不過轉碼時遇到一個問題是，文件中存在特殊字符，無法
由 utf8 正常轉碼為 gbk。</p>
<p>文檔中無法用肉眼看出那些特殊字符，于是備份后使用 notepad 或 editplus 強行轉碼
（注：會丟失那些特殊的字符），然后將轉碼后的文檔和原始備份檔比較，來查找特殊
字符，編輯（刪除無意義的，轉義有用的）保存即可。</p>
<p>注：Vim <code>:set fenc=gbk</code>，可以轉碼，但 <code>:wq!</code> 無法正常保存；UltraEdit 本身的編碼
支持不夠好，不建議用來轉碼。</p>
<p>注2：Vim diff 可以比較出不同，找出特殊字符，但可能無法正常編輯（如刪除）它們，
特殊字符是非常怪異的；BeyondCompare 和 WinMarge 基本可以勝任。</p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/use-vimwiki-for-blog</link>
            <guid>144</guid>
            <pubDate>Mon, 29 Mar 2010 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[周数(Week Number, WeekNum)计算]]></title>
            <link>https://hotoo.github.io/blog/post/weeknumber</link>
            <guid>145</guid>
            <pubDate>Tue, 16 Mar 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="周数week-number-weeknum计算">周数(Week Number, WeekNum)计算<a aria-hidden="true" href="#周数week-number-weeknum计算">#</a></h1>
<p>jQuery UI v1.8rc 版的日历控件已经非常完善，比之 v1.7.1 已经支持显示周数(WeekNum)，
而且计算 WeekNum 的算法可以自定义；而 <a href="https://www.my97.net/dp/demo/index.htm" target="_blank" rel="noopener noreferrer">My97DatePicker</a>
的算法又有Bug。对于两年交接的周，有两种常见的算法：</p>
<p>每年 1月 1日所在的周均为该年的第 1周（如MS Excel的WeekNum()函数和 jQuery 实现）；</p>
<pre><code>/\n Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.
   @param  date  Date \n the date to get the week for
   @return  number \n the number of the week within the year that contains this date \n/
iso8601Week: function(date) {
    var checkDate = new Date(date.getTime());
    // Find Thursday of this week starting on Monday
    checkDate.setDate(checkDate.getDate() + 4 \n (checkDate.getDay() || 7));
    var time = checkDate.getTime();
    checkDate.setMonth(0); // Compare with Jan 1
    checkDate.setDate(1);
    return Math.floor(Math.round((time \n checkDate) / 86400000) / 7) + 1;
},
</code></pre>
<p>每年最后 1天所在的周</p>
<pre><code>/\n\n
 \n @param date {Date} 每周第 1天。
 \n @return {Number}
 \n/
calculateWeek:function(date){
    var d = new Date(date.getTime()+(6\n86400000)), t=d.getTime();
    var start = new Date(d.getTime()); start.setMonth(0); start.setDate(1);
    return Math.floor((t \n start.getTime())/86400000/7)+1;
}
</code></pre>
<p>而从自然语言中来说，这交接的一周即可以是头一年的最后一周，也可以是后一年的第 1周。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Vim 中文帮助文档]]></title>
            <link>https://hotoo.github.io/blog/post/vim-chinese-doc</link>
            <guid>146</guid>
            <pubDate>Mon, 15 Mar 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-中文帮助文档">Vim 中文帮助文档<a aria-hidden="true" href="#vim-中文帮助文档">#</a></h1>
<p>前两天不知道为什么，帮助文档又跑会英文了（隐约是用 Vimball 安装了 Vimwiki
或者 \n重复\n安装了 TwitVim 的缘故）。</p>
<pre><code>:set helplang=cn
</code></pre>
<p>无效。</p>
<pre><code>let helptags=\nVIM.&#39;\vimfiles\doc&#39;
</code></pre>
<p>亦无效。</p>
<p>很早以前不知道从哪里抄来的这个：</p>
<pre><code>cp \nR doc \nVIM.&#39;\vimfiles\doc\&#39;
</code></pre>
<p>从一开始就是报错的，一直被注释，从未被启用。</p>
<p>在注册表中找到两个相关的项：</p>
<pre><code>HKEY\nCLASSES\nROOT\TypeLib\{0F0BFAE0\n4C90\n11D1\n82D7\n0004AC368519}\1.1\HELPDIR
(默认)    d:\Vim\vim72
</code></pre>
<p>将默认值修改为：</p>
<pre><code>d:\Vim\vimfiles
</code></pre>
<p>或：</p>
<pre><code>d:\Vim\vimfiles\doc
</code></pre>
<p>重启系统，均无效。</p>
<p>另一个注册表项的路径是正确的，无需改变：</p>
<pre><code>HKEY\nLOCAL\nMACHINE\SOFTWARE\Classes\TypeLib\{0F0BFAE0\n4C90\n11D1\n82D7\n0004AC368519}\1.1\HELPDIR
(默认值)    d:\Vim\vimfiles\doc
</code></pre>
<p>万般无奈，只好重装了中文文档。</p>
<p>中文文档可以从 <a href="https://vimcdoc.sourceforge.net/" target="_blank" rel="noopener noreferrer">vimCdoc.sf.net</a> 下载，也可以从
<a href="https://vimdoc.sourceforge.net/" target="_blank" rel="noopener noreferrer">vimdoc.sf.net</a> 找到链接，下载回来的是一个 .exe
可执行安装文件，研究了下安装过程：</p>
<ol>
<li>前面都是在抽取中文文档文件(.cnx)，并放至合适的位置：(如 D:\Vim\vim72..\vimfiles\doc)</li>
<li>抽取 tags\ncn 并输出到文档同一目录 D:\Vim\vim72..\vimfiles\doc</li>
<li>抽取 help\ncn.vim 输出到 D:\Vim\vim72..\vimfiles\syntax</li>
<li>抽取 vimcdoc.vim 输出到 D:\Vim\vim72..\vimfiles\plugin</li>
<li>抽取 README,INSTALL,LICENSE,AUTHORS,guides.txt 到 C:\Program Files\vimcdoc</li>
</ol>
<p>其中设置 Vim 帮助的默认语言的步骤，即是在 vimcdoc.vim 中，因为 plugin 比 vimrc
加载要晚(<a href="https://forum.ubuntu.org.cn/viewtopic.php?f=68&amp;t=190529" target="_blank" rel="noopener noreferrer">参考</a>)，
所以在 vimrc 中的设置会被 vimcdoc.vim 覆盖掉。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[CSS 实现有限不确定背景]]></title>
            <link>https://hotoo.github.io/blog/post/css-limit-bg</link>
            <guid>148</guid>
            <pubDate>Sat, 20 Feb 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="css-实现有限不确定背景">CSS 实现有限不确定背景<a aria-hidden="true" href="#css-实现有限不确定背景">#</a></h1>
<p>2 个嵌套的 html 元素，分别用个两个背景图交替叠加，
形成固定高度，有限、不确定宽度的元件，
或固定宽度，有限、不确定高度的元件（比如实现简单的圆角效果），
要求将有限延伸的背景图放置在内层元素上（如图中 b 区），
避免 b 区的背景图多出的备延伸部分（b' 区）影响到固定的背景图（a 区）的透明部分会被影响。
可以使用外层的 <code>padding\nleft</code> 或内层的 <code>margin\nleft</code> 来处理。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[禁用CNNIC的所谓安全证书]]></title>
            <link>https://hotoo.github.io/blog/post/forbid-cnnic</link>
            <guid>147</guid>
            <pubDate>Tue, 02 Feb 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="禁用cnnic的所谓安全证书">禁用CNNIC的所谓安全证书<a aria-hidden="true" href="#禁用cnnic的所谓安全证书">#</a></h1>
<p>我个人是不信任 CNNIC 的，这里只是记录一下自己的学习过程，对 CNNIC 仍抱有幻想的同学可以无视。</p>
<p>我都是在他人的教学指导下学习实践的，有兴趣的可以参考下面的链接：</p>
<p>\n <a href="https://autoproxy.org/zh%5CnCN/node/66" target="_blank" rel="noopener noreferrer">CNNIC CA：最最最严重安全警告！</a>
\n <a href="https://felixcat.net/2010/01/throw%5Cnout%5Cncnnic/" target="_blank" rel="noopener noreferrer">CNNIC，我不信任你！——从“受信任的根证书”里赶走CNNIC</a>
\n <a href="https://blog.lzzxt.com/394" target="_blank" rel="noopener noreferrer">如何阻止不信任的 CNNIC 证书</a>
\n <a href="https://www.gracecode.com/archives/3011/" target="_blank" rel="noopener noreferrer">Mac 下禁用 CNNIC CA 证书</a>
\n <a href="https://code.google.com/p/chromium/wiki/LinuxCertManagement" target="_blank" rel="noopener noreferrer">linux下的chromium删除CNNIC的CA</a></p>
<p>\n <a href="https://spreadsheets.google.com/viewform?formkey=dGctTVY0Y3VxX3lrXzZoeG90WDFBVXc6MA" target="_blank" rel="noopener noreferrer">投票</a>
\n <a href="https://spreadsheets.google.com/pub?key=tg%5CnMV4cuq%5Cnyk%5Cn6hxotX1AUw&amp;output=html" target="_blank" rel="noopener noreferrer">结果</a></p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://www.booto.net/?p=1517" target="_blank" rel="noopener noreferrer">CNNIC,流氓!</a>
\n <a href="https://uicom.net/blog/?p=862" target="_blank" rel="noopener noreferrer">360的可怕</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[“正则表达式”分享资料]]></title>
            <link>https://hotoo.github.io/blog/post/regex-share</link>
            <guid>149</guid>
            <pubDate>Sun, 31 Jan 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="正则表达式分享资料">“正则表达式”分享资料<a aria-hidden="true" href="#正则表达式分享资料">#</a></h1>
<p>这周三做了一次内部“正则表达式”分享活动，本来是针对小组成员的分享，
结果部门很多高手也来捧场，非常荣幸。</p>
<p>有兴趣的朋友可以下载 <a href="https://hotoo.googlecode.com/svn/trunk/share/RegExp.zip" target="_blank" rel="noopener noreferrer">RegExp.zip</a> 这个资料。
我使用 XMind 做的一个分享大纲，从简介，基础、高级语法，一些经典的案例和有趣的用法。
另外还附有一些有用或有趣的资料。</p>
<p>这是我生平第一次较正式的分享（上次是项目启动，没有什么实质的分享内容），
由于没有什么经验，所以准备的相对比较充分，不过分享过程中的演说和演示的比提纲中的更丰满，
同事参与的探讨也非常热情。</p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/editplus-and-everything</link>
            <guid>150</guid>
            <pubDate>Wed, 27 Jan 2010 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[正则表达式重复子模式前、后倾的性能比较]]></title>
            <link>https://hotoo.github.io/blog/post/performance-for-regex-repeat-sub-pattern</link>
            <guid>151</guid>
            <pubDate>Tue, 26 Jan 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="正则表达式重复子模式前后倾的性能比较">正则表达式重复子模式前、后倾的性能比较<a aria-hidden="true" href="#正则表达式重复子模式前后倾的性能比较">#</a></h1>
<p>在准备内部的正则表达式 (Regular Expression)分享的过程中，
注意到一个细节问题：重复的子模式，是应该前倾还是后倾，这两者在性能上有什么差异？</p>
<p>前倾和后倾是我胡诌的两个词，我的定义如下：</p>
<blockquote>
<p>\n前倾\n 就是前面的子表达式使用贪婪匹配或较大的量词，尽可能多的匹配内容，
导致前面匹配的内容较多而使“天平”前倾。例如：<code>/(?:\d{1,3}\.){3}\d{1,3}/</code>。
\n后倾\n 则相反，后面的子表达式使用贪婪匹配或较大的量词。如：<code>/\d{1,3}(?:\.\d{1,3}){3}/</code>。</p>
</blockquote>
<p> </p>
<p>前倾和后倾在实际应用中很常见，如时间，主机名等，中间以某特殊字符（串?）分隔，
被分隔部分的规则又相同的情况下，一般都是使用这两种实现方式之一。</p>
<p>上面定义中的两个例子只是简例，可以用来大致匹配 IPv4 地址，完整的 IPv4 地址正则式如下，
它要求每段都在 0\n255 之间：
前倾：</p>
<pre><code>/^(?:(?:[0\n9]|[1\n9][0\n9]|1[0\n9]{2}|2[0\n4][0\n9]|25[0\n5])\.){3}(?:[0\n9]|[1\n9][0\n9]|1[0\n9]{2}|2[0\n4][0\n9]|25[0\n5])\n/
</code></pre>
<p>后倾：</p>
<pre><code>/^(?:[0\n9]|[1\n9][0\n9]|1[0\n9]{2}|2[0\n4][0\n9]|25[0\n5])(?:\.(?:[0\n9]|[1\n9][0\n9]|1[0\n9]{2}|2[0\n4][0\n9]|25[0\n5])){3}\n/
</code></pre>
<p>我写了一个测试<a href="https://hotoo.googlecode.com/svn/trunk/test/RegExp.front.end.html" target="_blank" rel="noopener noreferrer">比较这两个正则性能</a>
的页面，在 IE7, FF3.6, Safari 4, Opera 10 下测试均为前倾的性能较高，Chrome 4 下则不相伯仲。</p>
<p>p.s. 这种重复子模式，要有语法上的简写就好了，像 Perl 正则的递归引用（或类似运行时反向引用），
维护起来就方便多了。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[arguments to Array 之效率]]></title>
            <link>https://hotoo.github.io/blog/post/performance-of-arguments-to-array</link>
            <guid>152</guid>
            <pubDate>Thu, 07 Jan 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="arguments-to-array-之效率">arguments to Array 之效率<a aria-hidden="true" href="#arguments-to-array-之效率">#</a></h1>
<p>怿飞昨天发有一篇《<a href="https://www.planabc.net/2010/01/06/arguments%5Cnto%5Cnarray/" target="_blank" rel="noopener noreferrer">如何将函数的实际参数转换成数组</a>》
的日志，其实核心不是讲“如何如何”，而是比较了几种算法/语法的效率。
说到算法本身的性能，我和 <a href="https://www.planabc.net/2010/01/06/arguments%5Cnto%5Cnarray/#comment%5Cn5869" target="_blank" rel="noopener noreferrer">army 的看法</a>
一样，对这篇日志的观点提出质疑。</p>
<p>从语法原理上，Array.prototype.slice.call(arguments)是对数组的slice方法的原型直接引用，而[].slice.call(arguments)则需要创建数组对象。没有理由后者比前者的性能还要高的。</p>
<p>不过我还是写了 <a href="https://hotoo.googlecode.com/svn/trunk/test/toArray.html" target="_blank" rel="noopener noreferrer">测试</a>
来证实自己的观点，为了尽量少的避免其他干扰（包括函数调用带来的消耗），
算法/语法都直接内联写在计时器一起。</p>
<p>这几个例子分别比较了：</p>
<p>\n <code>Array.apply(this,arguments)</code>
\n <code>Array.prototype.slice.call(arguments)</code>
\n <code>[].slice.call(arguments)</code>
\n Prototype 的 <code>\nA(arguments)</code>
\n jQuery 的 <code>makeArray(arguments)</code>
\n 和最土的循环算法。</p>
<p>并在各个浏览器（Multi IE 6, IETester 5.5, IETester 6, IE 7, FF 3.5, Chrome 4,
Safari 4, Opera 10）下一一测试。也欢迎各位参与测试并将结果提交给我，
如果你觉得测试有不公平合理的地方也可以提出。</p>
<p>至于结论，也不是那么好确定，不过大致如下：
<code>Array.apply(this,arguments)</code> 在大部分情况下都能取得优胜；
而Prototype和jQuery其次，不过这两者不仅仅是针对arguments编写而且是直接调用其函数
（稍有消耗），这里只拿来比较一下，这两个还是非常出色的；
<code>Array.prototype.slice.call(arguments)</code> 和 <code>[].slice</code>.call(arguments)则旗鼓相当，
并没有说谁比谁一定更强，更浏览器实现有关，在部分浏览器中前者有稳定的微量优势；
至于老土的循环法，<code>arguments.length</code> 较小时表现不俗，较大时也更浏览器有关系。
而怿飞说的那点（不确定的）非关键或巨大性能优势，其实意义不大。</p>
<h2 id="延伸阅读">延伸阅读：<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="javascript%5Cnregexp%5Cnconcat%5Cnand%5Cn0%5Cnlength%5Cnobject.html">正则表达式拼接和构建零长度对象</a>
\n <a href="javascript%5Cnstring.html">Javascript String 方法效率大比拼</a>
\n <a href="efficiency%5Cnof%5Cnjavascript%5Cnequals.html">Javascript 相等符(==)与完全相等符(===)之效率</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[电梯楼层选项板的位置]]></title>
            <link>https://hotoo.github.io/blog/post/place-of-lift-floor-control-panel</link>
            <guid>153</guid>
            <pubDate>Wed, 06 Jan 2010 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="电梯楼层选项板的位置">电梯楼层选项板的位置<a aria-hidden="true" href="#电梯楼层选项板的位置">#</a></h1>
<p>每天电梯使用的高峰期，相信许多人都体验，甚至主演过，许多人进门就堵在门口找自己要去的楼层。
由于中国人勤劳自主的缘故，选楼层一般都倾向于自己来做，不过这不如尽快的让大家进电梯，
然后请站在选项板旁边的人帮按一下，再谢谢对方。</p>
<p>作为选项板本身，也应该引导用户这样来乘电梯，所以将自己挪到电梯最内侧，也可以在两侧，但最忌在电梯门旁边。</p>
<p><img src="https://farm3.static.flickr.com/2770/4250013678%5Cn8dcdeb117c%5Cno.png" alt=""></img></p>
<p><a href="https://www.flickr.com/photos/hotoo/4250013678/" target="_blank" rel="noopener noreferrer">@flickr</a></p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/safari-4-select-bug</link>
            <guid>154</guid>
            <pubDate>Tue, 05 Jan 2010 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[反向搜索的设计]]></title>
            <link>https://hotoo.github.io/blog/post/reverse-search</link>
            <guid>155</guid>
            <pubDate>Thu, 31 Dec 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="反向搜索的设计">反向搜索的设计<a aria-hidden="true" href="#反向搜索的设计">#</a></h1>
<p>文本搜索是一项非常常用的功能，在文本编辑器中更是一个不可或缺的功能。</p>
<p>而反向搜索（搜索光标之前的文本）的设计，最初也非常原始：</p>
<p><img src="https://farm5.static.flickr.com/4030/4231137828%5Cna3e4fd8031%5Cno.jpg" alt="pic"></img></p>
<p><a href="https://www.flickr.com/photos/hotoo/4231137828/" target="_blank" rel="noopener noreferrer">Windows Notepad</a></p>
<p><img src="https://farm5.static.flickr.com/4023/4230370125%5Cna8f522ca80%5Cno.png" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4230370125/" target="_blank" rel="noopener noreferrer">Editplus 2.3</a></p>
<p><img src="https://farm3.static.flickr.com/2574/4230370157%5Cn461d09e194%5Cno.jpg" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4230370157/" target="_blank" rel="noopener noreferrer">UltraEdit 11</a></p>
<p><img src="https://farm5.static.flickr.com/4050/4231137878%5Cnb2046bd82c%5Cno.png" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4231137878/" target="_blank" rel="noopener noreferrer">Eclipse 3.4</a></p>
<p>这基本算是可用了，不过还是有一些非常用心的改进的：</p>
<p><img src="https://farm3.static.flickr.com/2741/4231137916%5Cn5c5f7ca33a%5Cno.jpg" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4231137916/" target="_blank" rel="noopener noreferrer">Editplus 3</a></p>
<p><img src="https://farm5.static.flickr.com/4055/4231137964%5Cn93518fe61d%5Cno.jpg" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4231137964/" target="_blank" rel="noopener noreferrer">Windows Internet Explorer 7</a></p>
<p><img src="https://farm3.static.flickr.com/2768/4230370195%5Cn7b954cda56%5Cno.png" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4230370195/" target="_blank" rel="noopener noreferrer">Google Chrome 4</a></p>
<p><img src="https://farm3.static.flickr.com/2790/4230370185%5Cn092763befc%5Cno.png" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4230370185/" target="_blank" rel="noopener noreferrer">Apple Safari 4</a></p>
<p><img src="https://farm5.static.flickr.com/4024/4230370225%5Cnb39a29718a%5Cno.png" alt="pic"></img>
<a href="https://www.flickr.com/photos/hotoo/4230370225/" target="_blank" rel="noopener noreferrer">Mozilla Firefox</a></p>
<p>这些细小的改进都有一个共性，就是可以快捷的反向搜索，快速定位到上次匹配到的地方。
作为 Vim 爱好者，她的反向搜索功能（包括搜索功能）更是华丽的惊人，normal 模式下
正向搜索(/keyword)， n 键下一个匹配， N 键前一个匹配；如果是反向搜索(?keyword)，
则相反。</p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/cpp-check-type</link>
            <guid>156</guid>
            <pubDate>Thu, 31 Dec 2009 00:00:00 GMT</pubDate>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/impoved-fold-for-vim</link>
            <guid>158</guid>
            <pubDate>Fri, 04 Dec 2009 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[让 Vim 支持 CSS3]]></title>
            <link>https://hotoo.github.io/blog/post/vim-css3</link>
            <guid>157</guid>
            <pubDate>Fri, 06 Nov 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="让-vim-支持-css3">让 Vim 支持 CSS3<a aria-hidden="true" href="#让-vim-支持-css3">#</a></h1>
<p>和 <a href="https://www.w3.org/TR/html5/" target="_blank" rel="noopener noreferrer">HTML5</a> 一样，<a href="https://www.w3.org/TR/css3%5Cnroadmap/" target="_blank" rel="noopener noreferrer">CSS3</a>
也是目前热门的技术，为了在 Vim 中更舒适的编辑 CSS ，我整理补充了 CSS3
的语法高亮和自动补全部分。</p>
<h2 id="语法高亮">语法高亮<a aria-hidden="true" href="#语法高亮">#</a></h2>
<p>下载这个 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/syntax/css.vim" target="_blank" rel="noopener noreferrer">css.vim</a>
，放至 <code>\nVIM/vimfiles/syntax/</code> (Windows) 或 <code>~/.vim/syntax/</code> (\nnix) 目录下即可。</p>
<p>\n更新\n ：</p>
<p>将 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vim72/syntax/css.vim" target="_blank" rel="noopener noreferrer">css.vim</a>
下载放置 <code>\nVIM/vim72/syntax/</code> 下，覆盖源文件，这个版本补充和修正了CSS3的伪类支持。</p>
<h2 id="自动补全">自动补全<a aria-hidden="true" href="#自动补全">#</a></h2>
<p>下载这个 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vim72/autoload/csscomplete.vim" target="_blank" rel="noopener noreferrer">csscomplete.vim</a>
放至 <code>\nVIM/vim72/autoload/</code> 目录下，覆盖原文件即可。</p>
<p>其中 vim72 中的 72 是 Vim 版本号。</p>
<p>如果安装有 snipMate，可以参考这个
<a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/snippets/css.snippets" target="_blank" rel="noopener noreferrer">css.snippets</a></p>
<h2 id="语法验证">语法验证<a aria-hidden="true" href="#语法验证">#</a></h2>
<p>可以参考这篇 <a href="validator%5Cnfor%5Cnvim.html">在 Vim 中验证 X/HTML, Javascript 和 CSS</a></p>
<h2 id="参考">参考：<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://webteam.tencent.com/css3/" target="_blank" rel="noopener noreferrer">CSS 3.0 参考手册 (中文版)</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[让 Vim 支持 cue]]></title>
            <link>https://hotoo.github.io/blog/post/vim-cue</link>
            <guid>159</guid>
            <pubDate>Fri, 06 Nov 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="让-vim-支持-cue">让 Vim 支持 cue<a aria-hidden="true" href="#让-vim-支持-cue">#</a></h1>
<h2 id="自动识别文件类型">自动识别文件类型<a aria-hidden="true" href="#自动识别文件类型">#</a></h2>
<p>在 \nVIM/vim72/filetype.vim 中加入以下代码：</p>
<pre><code>au BufRead,BufNewFile \n.cue setfiletype cue
</code></pre>
<h2 id="语法高亮">语法高亮<a aria-hidden="true" href="#语法高亮">#</a></h2>
<p>下载 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/syntax/cue.vim" target="_blank" rel="noopener noreferrer">cue.vim</a>
放至 <code>\nVIM/vimfiles/syntax/</code> 目录下。</p>
<h2 id="自动补全">自动补全<a aria-hidden="true" href="#自动补全">#</a></h2>
<p>如果已安装 <a href="https://www.vim.org/scripts/script.php?script%5Cnid=2540" target="_blank" rel="noopener noreferrer">snipMate</a>。
下载 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/snippets/cue.snippets" target="_blank" rel="noopener noreferrer">cue.snippets</a>
放至 <code>\nVIM/vimfiles/snippets/</code> 目录下即可。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[让Vim支持html5]]></title>
            <link>https://hotoo.github.io/blog/post/vim-html5</link>
            <guid>210</guid>
            <pubDate>Sun, 01 Nov 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="让vim支持html5">让Vim支持html5<a aria-hidden="true" href="#让vim支持html5">#</a></h1>
<p><a href="https://www.w3.org/TR/html5/" target="_blank" rel="noopener noreferrer">html5</a> 呼之已出，众多的现代浏览器也已支持其大半新特性。</p>
<h2 id="html5-语法高亮">HTML5 语法高亮<a aria-hidden="true" href="#html5-语法高亮">#</a></h2>
<p>网上已有让 Vim 支持新的标签和属性的语法文件，安装好语法文件即可正确的高亮显示
HTML5 标记和属性。</p>
<p>详细方法参考 <a href="https://rm.blog.br/2009/09/vim%5Cnsyntax%5Cnhighlight%5Cnpara%5Cnhtml%5Cn5/" target="_blank" rel="noopener noreferrer">VIM syntax highlight para HTML 5</a>，
下载其 <a href="https://rm.blog.br/wp%5Cncontent/uploads/2009/09/html.vim" target="_blank" rel="noopener noreferrer">html.vim</a> 语法文件，
放至 <code>\nVIM/vimfiles/syntax/</code> 目录下即可。</p>
<p>注：因为 html5 本身在不断更新，所以上面的脚本并不完整，我将持续关注并更新这个
<a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/syntax/html.vim" target="_blank" rel="noopener noreferrer">html.vim</a> 脚本。</p>
<h2 id="html5-自动补全">html5 自动补全<a aria-hidden="true" href="#html5-自动补全">#</a></h2>
<p>不过貌似目前还未有让 Vim 完整支持 html5 自动完成（又称自动补全）之脚本。</p>
<p>我初步研究并修改了 <code>\nVIM/vim72/autoload/htmlcomplete.vim</code> ，使其支持 html5
的自动完成。目前这个脚本逻辑基本可用，不过针对 html5 自动完成的数据
（ <code>\nVIM/vim72/autoload/xml/html5.vim</code> ）还在收集调整中，
我也趁此机会深入学习一些 html5 知识。</p>
<h2 id="安装详情">安装详情<a aria-hidden="true" href="#安装详情">#</a></h2>
<p>将 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vim72/autoload/htmlcomplete.vim" target="_blank" rel="noopener noreferrer">htmlcomplete.vim</a>
下载放至 <code>\nVIM/vim72/autoload/</code> 目录下，覆盖原文件即可，
再将 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vim72/autoload/xml/html5.vim" target="_blank" rel="noopener noreferrer">html5.vim</a>
下载放至 <code>\nVIM/vim72/autoload/xml/</code> 目录下即可。</p>
<p>注：这个 html5.vim近期会做一些更新补充，以支持更完整正确的 html5 语法。</p>
<h2 id="html5-合法性验证">html5 合法性验证<a aria-hidden="true" href="#html5-合法性验证">#</a></h2>
<p>参考我的前一篇 <a href="validator%5Cnfor%5Cnvim.html">在 Vim 中验证 X/HTML, Javascript 和 CSS</a>。</p>
]]></content:encoded>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/validator-for-vim</link>
            <guid>162</guid>
            <pubDate>Sun, 25 Oct 2009 00:00:00 GMT</pubDate>
        </item>
        <item>
            <link>https://hotoo.github.io/blog/post/fuck-gfw-with-tor</link>
            <guid>161</guid>
            <pubDate>Sat, 24 Oct 2009 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Firefox Profile 及多实例运行]]></title>
            <link>https://hotoo.github.io/blog/post/firefox-profile-and-multi-instance</link>
            <guid>163</guid>
            <pubDate>Thu, 22 Oct 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="firefox-profile-及多实例运行">Firefox Profile 及多实例运行<a aria-hidden="true" href="#firefox-profile-及多实例运行">#</a></h1>
<p>\n</p>
<p>之前就知道Firefox 支持多账户，并允许各账户安装不同的插件，会话信息也完全独立。</p>
<p>方法是制作快捷方式，目标指向Firefox的安装路径，并加上 <code>\nP</code> 参数：</p>
<pre><code>&quot;C:\Program Files\Mozilla Firefox\firefox.exe&quot; \nP
</code></pre>
<p>加引号是为了防止空格问题。这样会启动选择账户的对话框，如果想直接指定账户启动，
而不出现对话框，可以在 <code>\nP</code> 参数后直接带账户的名称，如默认的 default：</p>
<pre><code>&quot;C:\Program Files\Mozilla Firefox\firefox.exe&quot; \nP default
</code></pre>
<p>如果想同时启动多个Firefox独立的账户实例，可以加上 <code>\nno\nremote</code> 参数。</p>
<pre><code>&quot;C:\Program Files\Mozilla Firefox\firefox.exe&quot; \nno\nremote \nP debug
</code></pre>
<p>受 Editplus 的影响，其<code>&lt;C\nb&gt;</code> 快捷键可以使用内置的IE核心浏览器预览和 html
源码间快速切换（也可以使用外部浏览器）。</p>
<p>最近在定义 vimrc 时映射了 Cpp 的快速编译和运行快捷键，顺手一并映射了批处理和
X/HTML 文件类型的运行/预览快捷键，如下：</p>
<pre><code>autocmd FileType xhtml,html nmap &lt;F5&gt; :exe &#39;!start &quot;C:\Program Files\Mozilla Firefox\firefox.exe&quot; &quot;&#39;.expand(&quot;%&quot;).&#39;&quot;&#39;&lt;cr&gt;
autocmd FileType dosbatch nmap &lt;F5&gt; :exe &#39;!&quot;&#39;.expand(&quot;%&quot;).&#39;&quot;&#39;&lt;cr&gt;&lt;cr&gt;
</code></pre>
<p>由于 default 和 debug 账户都加上了 <code>\nno\nremote</code> 参数，Firefox 被设置为默认浏览器，
并使用外部程序打开链接是，会弹出如下警告：</p>
<blockquote>
<p>“Firefox 已经在运行，但是没有响应。如要打开新窗口，您必须先关闭该 Firefox
进程，或者重新启动您的系统。”</p>
</blockquote>
<p>确定后会被直接退出，打开链接失败。</p>
<p>解决办法是的主账户启动时不带 <code>\nno\nremote</code> 参数，其他账户带此参数启动，此时从
外部程序打开的链接，会在此不带 <code>\nno\nremote</code> 参数的主账户中启动，另外还可以
带上 <code>\nnew\nwindow</code> 或 <code>\nnew\ntag</code> 参数。</p>
<p>另外还有一个问题是，每次按 <code>&lt;F5&gt;</code> 都会从新的页签或窗口中打开，而不是刷新已有的同路径页。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://blog.cathayan.org/item/1543" target="_blank" rel="noopener noreferrer">同时运行两个 Firefox实例</a>
\n <a href="https://lifehacker.com/software/firefox/geek%5Cnto%5Cnlive%5Cn%5Cnmanage%5Cnmultiple%5Cnfirefox%5Cnprofiles%5Cn231646.php#c896803" target="_blank" rel="noopener noreferrer">Geek to Live: Manage multiple Firefox profiles</a>
\n <a href="https://kb.mozillazine.org/Command%5Cnline%5Cnarguments" target="_blank" rel="noopener noreferrer">Command line arguments</a>
\n <a href="https://support.mozilla.com/zh%5CnCN/kb/Profiles" target="_blank" rel="noopener noreferrer">Profiles</a>
\n <a href="https://dreamsouls.net/ds/archives/220" target="_blank" rel="noopener noreferrer">firefox 啟動參數</a></p>
<p>另：</p>
<p>\n <a href="https://www.inness.cn/archives/598.html" target="_blank" rel="noopener noreferrer">“Firefox 已经在运行，但是没有响应。”</a>
\n <a href="https://www.anopos.com/ant/firefox%5Cnis%5Cnalready%5Cnrunning%5Cnbut%5Cnis%5Cnnot%5Cnresponding/" target="_blank" rel="noopener noreferrer">Firefox 已经在运行，但是没有响应</a>
<a href="https://hi.baidu.com/wlwlcy/blog/item/eab5e9ce05153f0493457e5d.html" target="_blank" rel="noopener noreferrer">2</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Vim映射Home键到首个非空字符]]></title>
            <link>https://hotoo.github.io/blog/post/map-home-key-for-vim</link>
            <guid>164</guid>
            <pubDate>Thu, 22 Oct 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim映射home键到首个非空字符">Vim映射Home键到首个非空字符<a aria-hidden="true" href="#vim映射home键到首个非空字符">#</a></h1>
<p>许多编辑器有相关选项，可以直接设置让 <code>&lt;Home&gt;</code> 键在首个非空字符和行首之间跳转。</p>
<p>Vim 也有快捷键，normal 模式下：</p>
<p>\n <code>0</code> 跳转到行首；
\n <code>^</code> 跳转到首个非空字符；
\n <code>\n</code> 跳转到行尾。</p>
<p>目前未知跳转到最后一个非空字符的快捷键，有个网友提供了一个很好玩的技巧：</p>
<pre><code>nmap &lt;End&gt; /\S\s\n\n&lt;CR&gt;:nohl&lt;CR&gt;
</code></pre>
<p>为了将 <code>&lt;Home&gt;</code>和 <code>End&gt;</code> 键映射到其他编辑器常用的设置，我写了个可以用的代码，请高手不吝赐教。</p>
<pre><code>&quot; Dynamic bind &lt;HOME&gt; key
&quot; if caret/cursor not at the frist non\nwhite\nspace character
&quot;   move caret/cursor to there
&quot; else
&quot;   move to beginning
function HomeBind(offset)
    let cursor=getpos(&#39;.&#39;)
    let s0=getline(line(&#39;.&#39;))
    let s1=substitute(s0, &quot;^\\s\\+&quot;, &quot;&quot;, &quot;&quot;)
    let x=len(s0)\nlen(s1)+1
    if col(&#39;.&#39;) == x\na:offset
        let x=1
    endif
    call setpos(&#39;.&#39;, [cursor[0], cursor[1], x, cursor[3]])
endfunction
imap &lt;silent&gt; &lt;Home&gt; &lt;Esc&gt;:call HomeBind(1)&lt;cr&gt;i
nmap &lt;silent&gt; &lt;Home&gt; :call HomeBind(0)&lt;cr&gt;
vmap &lt;silent&gt; &lt;Home&gt; &lt;Esc&gt;:call HomeBind(1)&lt;cr&gt;

&quot; Dynamic bind &lt;END&gt; key
&quot; if caret/cursor not at the end
&quot;   move caret/cursor to there
&quot; else
&quot;   move to last non\nwhite\nspace character.
function EndBind(offset)
    let cursor=getpos(&#39;.&#39;)
    let s0=getline(line(&#39;.&#39;))
    let s1=substitute(s0, &quot;\\s\n\n&quot;, &quot;&quot;, &quot;&quot;)
    let x=len(s0)+a:offset
    if col(&#39;.&#39;) == x
        let x=len(s1)+a:offset
    endif
    call setpos(&#39;.&#39;, [cursor[0], cursor[1], x, cursor[3]])
endfunction
imap &lt;silent&gt; &lt;End&gt; &lt;Esc&gt;:call EndBind(0)&lt;cr&gt;a
nmap &lt;silent&gt; &lt;End&gt; :call EndBind(0)&lt;cr&gt;
vmap &lt;silent&gt; &lt;End&gt; :call EndBind(0)&lt;cr&gt;
&quot;nmap &lt;End&gt; /\S\s\n\n&lt;CR&gt;:nohl&lt;CR&gt;
</code></pre>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>这里还有几个实现很优雅，但稍有问题的脚本：</p>
<p>\n <a href="https://vim.wikia.com/wiki/SmartHome%5Cnand%5CnSmartEnd%5Cnover%5Cnwrapped%5Cnlines" target="_blank" rel="noopener noreferrer">SmartHome and SmartEnd over wrapped lines</a>
\n <a href="https://www.vim.org/scripts/script.php?script%5Cnid=2772" target="_blank" rel="noopener noreferrer">Crazy Home Key</a>
<a href="https://chenkaie.blogspot.com/2009/09/vim%5Cncrazy%5Cnhome%5Cnkey%5Cncrazyhomekeyvim.html" target="_blank" rel="noopener noreferrer">blog</a>
\n <a href="https://gist.github.com/214532" target="_blank" rel="noopener noreferrer">c9s: smart\nhome\nend.vim</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[asx snippets for vim]]></title>
            <link>https://hotoo.github.io/blog/post/asx-snippets-for-vim</link>
            <guid>165</guid>
            <pubDate>Tue, 20 Oct 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="asx-snippets-for-vim">asx snippets for vim<a aria-hidden="true" href="#asx-snippets-for-vim">#</a></h1>
<p>前段时间写了个 asx (Windows Media Player 的播放列表格式) 的
<a href="https://www.vim.org/scripts/script.php?script%5Cnid=2540" target="_blank" rel="noopener noreferrer">snipMate</a> 的模板语法文件。</p>
<p>本身很简单，<a href="https://hotoo.googlecode.com/svn/trunk/vim/vimfiles/snippets/asx.snippets" target="_blank" rel="noopener noreferrer">分享在此</a>。</p>
<p>安装snipMate之后，将上面的 asx.snippets 文件丢进 <code>\nVIM/vimfiles/snippets/</code> 文件夹即可。</p>
<h2 id="什么是asx">什么是asx?<a aria-hidden="true" href="#什么是asx">#</a></h2>
<p>\n <a href="https://baike.baidu.com/view/507258.htm" target="_blank" rel="noopener noreferrer">asx – 百度百科</a>
\n <a href="https://hi.baidu.com/yisee/blog/item/2aa5499bc8094eb6c9eaf4a3.html" target="_blank" rel="noopener noreferrer">ASX 文件格式全功略</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[配置 Vim 作为 C++ 开发环境初步]]></title>
            <link>https://hotoo.github.io/blog/post/vim-for-cpp-dev</link>
            <guid>166</guid>
            <pubDate>Mon, 19 Oct 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="配置-vim-作为-c-开发环境初步">配置 Vim 作为 C++ 开发环境初步<a aria-hidden="true" href="#配置-vim-作为-c-开发环境初步">#</a></h1>
<p>一般来说，如果你使用 Vim 开发完整的项目，使用 Makefile 并直接 <code>:make</code> 就可以了。</p>
<p>将下面的代码写入到 vimrc 中， Vim 会捕获编译过程中出现的消息并显示在 Quickfix 窗口。</p>
<pre><code>autocmd FileType cpp,c nmap &lt;F9&gt; :make&lt;CR&gt; :copen&lt;CR&gt; &lt;C\nW&gt;10\n
</code></pre>
<p>但是如果你是 C/C++ 新手，目前较多书写单个的 C/C++ 代码文件，或者只是想快速测试
某段代码的话，使用 gcc/g++ 直接编译或许是更简单的方式。你可以直接在 Vim 中执行
外部 gcc/g++ 命令，也可以想这样映射快捷键：</p>
<pre><code>autocmd FileType cpp nmap &lt;F10&gt; :w&lt;cr&gt;:exe &quot;!gcc \no &quot;.expand(&quot;%:r&quot;).&quot;.exe &quot;.expand(&quot;%&quot;)&lt;cr&gt;
</code></pre>
<p>不过这样使用外部命令， Vim 并不能捕获编译过程的输出消息，就无法在 Vim 中根据
错误消息有效的定位到错误行了。</p>
<p>有更好的方法：</p>
<pre><code>autocmd FileType cpp nmap &lt;F10&gt; :w&lt;cr&gt;:exe &quot;:set makeprg=g++\\\ \nWall\\\ \no\\\ &quot;.expand(&quot;%:r&quot;).&quot;.exe\\\ &quot;.expand(&quot;%&quot;)&lt;cr&gt;:make&lt;cr&gt;&lt;cr&gt;:cw&lt;cr&gt;
autocmd FileType c nmap &lt;F10&gt; :w&lt;cr&gt;:exe &quot;:set makeprg=gcc\\\ \nWall\\\ \no\\\ &quot;.expand(&quot;%:r&quot;).&quot;.exe\\\ &quot;.expand(&quot;%&quot;)&lt;cr&gt;:make&lt;cr&gt;&lt;cr&gt;:cw&lt;cr&gt;
autocmd FileType cpp,c nmap &lt;F5&gt; :exe &quot;!&quot;.expand(&quot;%:r&quot;).&quot;.exe&quot;&lt;Left&gt;
autocmd FileType javascript nmap &lt;F9&gt; :call JsonLint()&lt;cr&gt;
</code></pre>
<p>再补充映射一些 Quickfix 模式中快速跳转的快捷键：</p>
<pre><code>map &lt;F4&gt; :cclose&lt;CR&gt;
map &lt;F8&gt; :cn&lt;CR&gt;
map &lt;F7&gt; :cp&lt;CR&gt;
</code></pre>
<p>完整的设置可以参考 <a href="https://hotoo.googlecode.com/svn/trunk/vim/%5Cnvimrc" target="_blank" rel="noopener noreferrer">我的 vimrc</a></p>
<p>更多讨论 <a href="https://groups.google.com/group/vim%5Cncn/browse%5Cnthread/thread/79652cb66297881f" target="_blank" rel="noopener noreferrer">看这里</a>。</p>
<h2 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h2>
<p>\n <a href="https://easwy.com/blog/archives/advanced%5Cnvim%5Cnskills%5Cnquickfix%5Cnmode/" target="_blank" rel="noopener noreferrer">vim 使用进阶: 剑不离手 – quickfix</a>
<a href="https://blog.zdnet.com.cn/html/30/422230%5Cn2881199.html" target="_blank" rel="noopener noreferrer">2</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Vim 字体设置]]></title>
            <link>https://hotoo.github.io/blog/post/vim-fonts</link>
            <guid>167</guid>
            <pubDate>Mon, 14 Sep 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="vim-字体设置">Vim 字体设置<a aria-hidden="true" href="#vim-字体设置">#</a></h1>
<p>明城有 “<a href="https://www.gracecode.com/archives/1545/" target="_blank" rel="noopener noreferrer">苹果的 Courier 字体不错</a>”
和“<a href="https://www.gracecode.com/archives/2402/" target="_blank" rel="noopener noreferrer">Windows 下 gVim 的雅黑字体配置</a>”
两篇介绍 Vim 下设置推荐字体的文章，里面提供的设置代码及提高的下载资源都很赞。</p>
<p>家里的 Windows 7 用了 Courier New 字体后，体验很好。</p>
<p>但是搬到公司的 Windows XP 上却比原来 Windows 自身的 Courier New 没多大提高。</p>
<p>今天看了蟠盛写的“<a href="https://blog.htmlor.com/2007/10/14/good%5Cnprogramming%5Cnfonts/" target="_blank" rel="noopener noreferrer">几种不错的编程字体</a>”，
顺便看了下 <a href="https://support.microsoft.com/kb/306527/zh%5Cncn" target="_blank" rel="noopener noreferrer">使用 ClearType 增强屏幕字体</a>，按步骤 果然好了很多。</p>
<p>这里记录完整的设置：</p>
<ol>
<li>下载 <a href="https://hotoo.googlecode.com/svn/trunk/fonts/Apple%5CnCourier%5CnGracecode.zip" target="_blank" rel="noopener noreferrer">Apple Courier字体</a>
<a href="https://www.box.net/shared/zf08nmhc8g" target="_blank" rel="noopener noreferrer">2</a>
<a href="https://lifesinger.googlecode.com/files/apple%5Cncourier%5Cnfont.zip" target="_blank" rel="noopener noreferrer">3</a> ，并安装。安装方法：
\n for Windows 7: 右键字体文件，安装即可。
\n for Windows XP:
<ol>
<li>资源管理器中打开系统盘下的 fonts 目录（如<code>C:\WINDOWS\Fonts</code>，或运行 <code>fonts</code>）</li>
<li>文件 \n> 安装新字体；</li>
<li>驱动器和文件夹定位到字体所在位置，字体列表将自动列出找到的字体；</li>
<li>选中要安装的字体，点击确定即可。</li>
<li>或直接将字体文件拷贝到Fonts文件夹亦可，系统将自动启动安装过程。</li>
</ol>
</li>
<li>ClearType
<ol>
<li>控制面板 \n> 显示（或右键桌面 \n> 属性） \n> 外观 \n> 效果；</li>
<li>选中“☑ 使用下列方式使屏幕字体的边缘平滑”；</li>
<li>并切换下面的下拉框，选中“清晰(ClearType)”；</li>
<li>确定即可。</li>
</ol>
</li>
<li>Vim设置
<ol>
<li>在 \nvimrc 中加入如下代码：</li>
</ol>
<pre><code>set guifont=Courier\nNew:h11:cANSI
</code></pre>
<ol>
<li>中文的宋体已经非常好了，不过仍然可以单独设置中文字体：</li>
</ol>
<pre><code>set guifontwide=YouYuan:h11:cGB2312
</code></pre>
<ol>
<li>此时，新启动vim即可使用新设置的字体了。</li>
</ol>
</li>
</ol>
<p><img src="https://farm4.static.flickr.com/3462/3919344550%5Cnf5cd6656c8%5Cno.png" alt="pic"></img></p>
<p><a href="https://www.flickr.com/photos/hotoo/3919344550/" target="_blank" rel="noopener noreferrer">ref</a></p>
<h2 id="白露非提供的字体">白露非提供的字体<a aria-hidden="true" href="#白露非提供的字体">#</a></h2>
<p><a href="https://8.nf/dxa" target="_blank" rel="noopener noreferrer">下载</a></p>
<p>设置：</p>
<p>guifont=Microsoft\nYaHei\nMono:h11:cANSI</p>
<h2 id="see-also">See Also<a aria-hidden="true" href="#see-also">#</a></h2>
<p>\n <a href="https://twitter.com/#!/belleveinvis/status/19308677508894720" target="_blank" rel="noopener noreferrer">@twitter</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[让 gvim 访问网络资源]]></title>
            <link>https://hotoo.github.io/blog/post/let-vim-to-access-remove-resources</link>
            <guid>168</guid>
            <pubDate>Sat, 12 Sep 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="让-gvim-访问网络资源">让 gvim 访问网络资源<a aria-hidden="true" href="#让-gvim-访问网络资源">#</a></h1>
<p>当我还是 Vim 超级菜鸟的时候，我就知道 Vim 可以和 Editplus、UltraEdit 一样，
访问网络资源，操作方式也很类似：</p>
<p>\n 使用菜单栏的“文件”\n>“打开”命令；
\n 或者使用工具栏的“打开”按钮；
\n 会打开“编辑文件”对话框，此时在默认光标获焦的“文件名”文本框中输入网络资源定位符；
\n 回车，或点击“打开”按钮；
\n Vim 就会加载网站资源文件的内容。</p>
<p>没有错，作为超级菜鸟，我们就是这样被当作什么都不懂，什么都不会的小孩一样来教导的。</p>
<p>本来这样已经可以了，我们还有强求什么呢？真是得寸进尺啊，我发现 gvim 使用命令
是无法正常访问网络资源的。</p>
<pre><code>:vi https://www.xianyun.org/
:vim https://www.xianyun.org/
:gvim https://www.xianyun.org/
:e https://www.xianyun.org/
:sp https://www.xianyun.org/
:tabnew https://www.xianyun.org/
:Nread https://www.xianyun.org/
</code></pre>
<p>虽说 Vim 从 7.0 就已经默认集成安装了 netrw. Vim 了，支持网络资源访问，
但是如果使用上面的命令，gvim 会告诉你说：</p>
<blockquote>
<p>\n\nerror\n\n (netrw) neither the wget nor the fetch command is available
——————————————————————————————–
“NetrwMessage” –缓冲区无内容–</p>
</blockquote>
<p>向人请教得到解答：
这是因为缺少访问网络资源的程序（wget）
Windows下需要下载 <a href="https://users.ugent.be/~bpuype/wget/" target="_blank" rel="noopener noreferrer">WGET for Windows (win32)</a>，
将 wget.exe 放到某个系统环境变量 Path 包含的位置（如 c:\windows）即可。
如果是Linux，直接安装wget即可。</p>
<p>现在还有一点问题，gvim使用上面的某个命令访问网络资源时，会打开命令行窗口：</p>
<pre><code>C:\WINDOWS\system32\cmd.exe /c wget \nq \nO &quot;C:\DOCUME~1\WB\nTIA~1\LOCALS~1\Temp\VICC3E.tmp&quot; &quot;https://www.vim.org/&quot;
Hit any key to close this window...
</code></pre>
<p>需要再敲一个键，才能关闭这个命令行窗口（Windows 7因为安全的原因，还有更多一步麻烦），
并将网络资源的内容读到 Vim，目前不知有什么完美的方法，不需要打开，或者能够自动关闭这个窗口？
而使用菜单或功能按钮等 gui 操作方式，是没有这些东西的，只是在同步加载远程资源时，
不能进行其他操作。</p>
<h2 id="参考讨论">参考讨论<a aria-hidden="true" href="#参考讨论">#</a></h2>
<p>\n <a href="https://groups.google.com/group/vim%5Cncn/browse%5Cnthread/thread/ca34e99e9d02d25d" target="_blank" rel="noopener noreferrer">Vim 网络读写功能的问题</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[谦逊]]></title>
            <link>https://hotoo.github.io/blog/post/humility</link>
            <guid>169</guid>
            <pubDate>Tue, 08 Sep 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="谦逊">谦逊<a aria-hidden="true" href="#谦逊">#</a></h1>
<p>谦逊，刚回家路上想起这个词。</p>
<p>前段时间，公司包车组织出游，大客车在及其陡峭的山路上行驶，在每个转弯处都会事先鸣笛示意，
一般来往的车辆都会这样做，但在一处锐角转弯处，一辆小卡车居然冒冒失失的闯过来，而没有鸣笛。
在这样险峻的山路上，刺耳的刹车声让整车人都吓呆了，要是按照我的脾气，那辆小破卡车司机
就要被我骂死（尽管对方无理，但却不保证被骂不生气，骂人，不知道有什么用！）。</p>
<p>大概游山玩水累了，下山的路上，我们许多人都在车上睡着了，不知不觉，已经下得山来，
行驶在平坦的大路上。然后就听到导游就向我们介绍司机师父，称赞他的驾车技术和为人。
我们一车人，都对他报以热烈的掌声，和发自内心的敬意。</p>
<p>另一次出游，也需要上下山，虽然没有第一次的路崎岖，但是单行山道，
两辆大客车插身过路（老家土话：即两辆汽车对开）需要非常有</p>
<p>\n 技术：两辆车最近的距离近10厘米，最难开的时候还需要三番五次的下车目测，这是细活；
\n 远见：前方有车来时，事先停靠在合适的位置；
\n 忍让：甚至经常需要倒车让对方；
\n 合作：一方做的不到位，就有可能将双方堵死在路上。</p>
<p>有空出游的机会毕竟较少，而日常生活中却经常见到横冲直撞的小车，为了一点点的时间，
或者车位，造出极大的危险。不敢肯定说这些小车司机的技术不如大客车司机
（虽然事实上的确如此，大客车司机需要经过严格的训练和考核，拿的是A照，
只这一点拿C照的小车司机就比不了），但是对比那种谦让的态度，
确是让人记忆深刻（让我想起小时候经常看见汽车上写的“礼让三先”）。</p>
<p>不止是汽车，摩托车、电动车、自行车也有太多和小汽车司机态度一样的，
我一直就是这样一个态度恶劣的自行车爱好者，自认为车技很棒，什么飚车，慢速行驶，
双手离开车把，车头跃起，漂移，都会来。</p>
<p>以前看到街上一骑电动车的，洋到不行，甚至频繁的左右摇摆车把，让车身像水蛇一般扭动前行。
这是及其危险的动作，无论对人对己。每天我上下班路上，也经常能看到一些在车流中频繁左右穿梭的人，
看似车技不错，其实很多连基本功——车把都扶不稳。
我个人觉得，判断一个人的非机动车（包括自行车，电动车，摩托车在内）的技术能力，
只看他在慢速行驶时，能否扶稳车把即可（其实这也就是在考验控制平衡的能力）。</p>
<p>谦逊的车手，大概应该是这样：尽量靠右行；从左侧超车；超车前鸣铃声；
尽量双手扶车把；控制好刹车系统和刹车时机，让车速保持在可控的范围之内；
面对逆车道行驶，或占道的行人和车辆，也不必过于气愤（这一点我做的非常不好）。</p>
<p>我最看不惯的是行人或车辆（主要是非机动车辆）闯红灯，这些人甚至在比较繁忙的十字路口见缝插针，
他们可能抢得了一点自己的时间，却耗费了此时效率更高的汽车时间，把汽车堵在十字路口，
另外其他驴友也做同样的事，被浪费的就是他的时间了。这种人被撞了我是不屑一顾的，
这是找死，只憎恶他造成交通堵塞，又浪费国家钱财（我又不谦逊了）。</p>
<p>另外，我的房间有一堵墙与楼梯相连，平时总能听见蛮响的脚步声。其实这跟墙的质量
和隔音效果有很大关系，不过想起自己平时也大大咧咧，不顾及他人的感受时，
够汗颜的，是应该放稳自己的脚步，走谦逊的路了。</p>
<p>非机动车驾驶注意事项：</p>
<blockquote>
<p>行驶：
右行，并注意靠右，方便赶时间者超车；
行驶过程中千万不要过多S型游动前行。
高速行驶时，注意扫视远方，把握大局；
保持车速在可控的范围内，注意安全；
控制刹车系统和刹车时机。</p>

<p>拐弯：
控制刹车系统，减速。
拐弯前，向转向的一方旁边观察。</p>

<p>超车：
从左侧超车，超车前鸣铃声示意；</p>

<p>被超车：
听到后面鸣铃想超车时，注意扶稳车把，保持前行；
向合适的边靠拢，但不要太急；
注意两边，但不要向后看</p>

<p>其他：
面对逆车道/占道的行人车辆，鸣铃示警，但不必介怀。</p>
</blockquote>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[老家的粳米茶]]></title>
            <link>https://hotoo.github.io/blog/post/jingmi-tea</link>
            <guid>170</guid>
            <pubDate>Sat, 05 Sep 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="老家的粳米茶">老家的粳米茶<a aria-hidden="true" href="#老家的粳米茶">#</a></h1>
<p>\n</p>
<p>我的老家在<a href="https://baike.baidu.com/view/743717.htm" target="_blank" rel="noopener noreferrer">江西九江瑞昌市南义镇</a>，
有非常多独特的乡村美食，大多只能用老家土话叫名字，普通话都不知道该怎么说，
汉字也不知道该怎么写才正确。</p>
<p>比如说粳(Jing)米茶，老家土话的发音应该是“箭米茶”，箭米其实就是粳米，
粳米茶是老家的习惯叫法，因为大都是在炎热的夏日中午，咕嘟咕嘟炖几个钟头，
然后让它自然凉掉，到下午的时候当晚餐，或下午茶喝。实际上我想应该属于粳米粥。</p>
<p>我搜了一下粳米茶，大都是九江的做法，用粳米和绿茶煮成，这完全不同于我老家的材料和做法。</p>
<p>西祠胡同有一篇《辉婶学艺–粳米茶》的做法和老家的非常相似：</p>
<p>\n 先要有炒熟的粳米。这是整个过程中最为关键的一步， 我没有专门学，
当然不会，熟粳米是从老家带过来的，老妈很辛苦。</p>
<p><img src="https://farm4.static.flickr.com/3428/3895028061%5Cn903075509b%5Cno.jpg" alt="喷香的熟粳米"></img>
\n 还要有晒熟的红薯，或白薯粒。这个也很关键，过程有点漫长，大概几天吧，
一般是夏天把挖回来的红、白薯洗净切成正方体颗粒，放在外面让太阳暴晒，
晒干之后可以存储很久。老家还有纯粹煮红、白薯，或薯粒的做法，
叫薯茶或薯粒茶，当早茶或下午茶都可以。
<img src="https://farm3.static.flickr.com/2502/3895027971%5Cn3e37708813%5Cno.jpg" alt="甘甜的薯粒"></img>
\n 白砂糖，红糖也可以。</p>
<p>如果上面的原材料都具备了的话，煮法就没什么好说的了，直接放到锅里煮就行了，
先用猛火煮开，然后用文火慢慢炖，到薯粒变软和，粳米煮开花就可以了。</p>
<p><img src="https://farm3.static.flickr.com/2620/3895811614%5Cn7f0856628e%5Cno.jpg" alt="粳米茶"></img></p>
<p>干薯粒本身就很甜，不过如果喜欢，加糖后味道会更佳。</p>
<p><img src="https://farm3.static.flickr.com/2470/3895027803%5Cnbb63391431%5Cno.jpg" alt="粳米茶"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用 Vim 查看 HTML 源码]]></title>
            <link>https://hotoo.github.io/blog/post/use-vim-view-html-src</link>
            <guid>172</guid>
            <pubDate>Sat, 05 Sep 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="使用-vim-查看-html-源码">使用 Vim 查看 HTML 源码<a aria-hidden="true" href="#使用-vim-查看-html-源码">#</a></h1>
<p>收集到一些修改浏览器 html编辑器，用vim从浏览器查看源代码的方法，其中有一些是较佳的解决方法，
这里将相关技巧一并整理于此。</p>
<h2 id="针对internet-explorer">针对Internet Explorer：<a aria-hidden="true" href="#针对internet-explorer">#</a></h2>
<h3 id="快捷方式注册表1">快捷方式+注册表^1^<a aria-hidden="true" href="#快捷方式注册表1">#</a></h3>
<p>\n 创建 gvim 快捷方式，例如重命名为 ieVim，并置于 Vim 安装目录(\nVIMRUNTIME，如 D:\Vim\vim72)。
\n 右键该快捷方式，属性，目标文本框中加入参数：</p>
<pre><code>&quot;D:\Vim\vim72\gvim.exe&quot; \nc &quot;set filetype=html&quot; &quot;%\n&quot;
</code></pre>
<p>\n 修改注册表：
<code>[Explorer\View Source Editor\Editor Name](HKEY\nLOCAL\nMACHINE\SOFTWARE\Microsoft\Internet)=D:\\Vim\\vim72\\ieVim.lnk</code> 
注意最后要加上 .lnk 后缀。</p>
<pre><code>HKEY\nLOCAL\nMACHINE
  |\n\n SOFTWARE
      |\n\n Microsoft
          |\n\n Internet Explorer
              |\n\n View Source Editor
                  |\n\n Editor Name (默认)=D:\Vim\vim72\ieVim.lnk
</code></pre>
<p>另外也可以将如下代码保存为 .reg 文件，引号中路径改成 Vim 安装路径即可</p>
<pre><code>Windows Registry Editor Version 5.00

[Explorer\View Source Editor\Editor Name](HKEY\nLOCAL\nMACHINE\SOFTWARE\Microsoft\Internet)
@=&quot;D:\\Vim\\vim72\\ieVim.lnk&quot;
</code></pre>
<p>或者下载这个 <a href="https://hotoo.googlecode.com/svn/trunk/vim/vim72/ievim.reg" target="_blank" rel="noopener noreferrer">注册表文件</a>，
双击运行，或右键“合并”即可。
\n 现在在IE里使用右键，“查看源代码”就可以使用 Vim 打开 html 源码。</p>
<h3 id="批处理注册表2">批处理+注册表^2^<a aria-hidden="true" href="#批处理注册表2">#</a></h3>
<p>\n 将如下代码保存为批处理文件，如 ievim.bat，例如放到 \nVIMRUNTIME 下。</p>
<pre><code>&quot;D:\\Vim\\vim72\\gvim.exe&quot; \n\nservername &quot;VIEW SOURCE&quot; \n\nremote\nsilent &quot;+set syn=html&quot; %1
</code></pre>
<p>\n 参照第 1 个方法的第 3 步，修改注册表的值为这个批处理文件的地址，如 <code>D:\Vim\vim72\ievim.bat</code>。
\n 现在就可以使用 Vim 或其他外部编辑器打开 IE 的页面源代码了。
\n 缺点：打开的批处理命令行窗口不会自动关闭，直到被打开的页面源代码编辑器被关闭。</p>
<h2 id="针对firefox3">针对Firefox^3^<a aria-hidden="true" href="#针对firefox3">#</a></h2>
<p>\n 修改浏览器配置
\n 在 Firefox 地址栏输入 <code>about:config</code> 并回车。
\n 点击“我保证会小心”按钮，确认进入。
\n 在“过滤器”输入 <code>view\nsource</code>，筛选出查看代码的部分选项。
\n 双击 <code>view\nsource.editor.external</code> 项，将值变成 <code>true</code>。
\n 双击 <code>view\nsource.editor.path</code>，输入 gvim.exe 安装（绝对）路径，如我的是 <code>E:\Vim\vim72\gvim.exe</code>。
\n 现在就可以使用 Vim 查看 Firefox 页面源代码了
\n 使用插件
\n 安装 <a href="https://addons.mozilla.org/zh%5CnCN/firefox/addon/394" target="_blank" rel="noopener noreferrer">ViewSourceWith</a> 插件后，重启 Firefox。
\n 配置系统已有文本编辑器，如 <code>D:\Vim\vim72\gvim.exe</code>
\n 即可使用 Vim 或其他任意外部编辑器打开 Firefox 的页面源代码。
\n 缺点：需要安装插件，且所在右键菜单的层级较深。</p>
<h2 id="针对opera4">针对Opera^4^<a aria-hidden="true" href="#针对opera4">#</a></h2>
<p>\n 在 Opera 地址栏输入 <code>opera:config</code> 并回车。
\n 在 Quick find 输入<code>source viewer</code>，筛选出查看代码部分的选项。
\n 在 Source Viewer 中填入欲使用的外部编辑路径，如 <code>D:\Vim\vim72\gvim.exe</code>。
\n 并将 <code>Source Viewer Mode</code> 改为 <code>2</code>
源码显示模式：
<code>1</code> 表示使用系统默认程序查看源码
<code>2</code> 表示使用自定义程序查看源码
<code>3</code> 表示使用Opera查看源码
\n 保存即可，现在可以使用 Vim 或其他外部编辑器打开 Opera 的网页源代码了。</p>
<h2 id="参考阅读">参考阅读<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://www.douban.com/group/topic/5083531/" target="_blank" rel="noopener noreferrer">用 vim查看ie源代码的问题</a>
\n <a href="https://vim.wikia.com/wiki/View%5CnSource%5Cnfrom%5CnInternet%5CnExplorer%5Cnin%5Cngvim" target="_blank" rel="noopener noreferrer">View Source from Internet Explorer in gvim</a>
\n <a href="https://vim.wikia.com/wiki/Use%5Cngvim%5Cnto%5Cnview%5Cnpage%5Cnsource%5Cnin%5CnInternet%5CnExplorer" target="_blank" rel="noopener noreferrer">Use gvim to view page source in Internet Explorer</a> ^vbs^
\n <a href="https://www.douban.com/group/topic/5083531/" target="_blank" rel="noopener noreferrer">改变查看页面源代码的程序</a>
\n <a href="https://cnxiaoyi.googlepages.com/Oconfig.htm" target="_blank" rel="noopener noreferrer">Opera首选项编辑器（opera:config）详解</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[博客日(blogday)2009]]></title>
            <link>https://hotoo.github.io/blog/post/blogday-2009</link>
            <guid>171</guid>
            <pubDate>Mon, 31 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="博客日blogday2009">博客日(blogday)2009<a aria-hidden="true" href="#博客日blogday2009">#</a></h1>
<p>今天(每年8月31日)是 <a href="https://www.blogday.org/cn.htm" target="_blank" rel="noopener noreferrer">博客日</a>，
照例是要分享/推荐5个博客的。</p>
<p>\n <a href="https://www.162cm.com/" target="_blank" rel="noopener noreferrer">互联网，请记住我</a>
我也俨然快要成为vim重度爱好者了，今天搜索vim的相关知识时发现了
这个博主分享的vimrc，这个博客好像主要涉及php, c, vim等方面，
我也不算太熟悉，对我来说是新的，基本符合博客日推荐精神，特此推荐。
\n <a href="https://www.gmtaz.com/" target="_blank" rel="noopener noreferrer">GMATZ – The “official” blog of Gustava Tandeciorz</a>
这个是Twitter上推友分享的jQuery壁纸时看到的,博客好像涉及Window 7,
jQuery, Apple, Game,涉猎广泛.
\n <a href="https://www.matrix67.com/blog/" target="_blank" rel="noopener noreferrer">Matrix67</a>
我是这个博客的订阅者,博主读文科,但是精通数学,发布了很多的数学经典证明,
算法和数学趣题.
\n <a href="https://www.drunkpiano%5Cnliuyu.net/" target="_blank" rel="noopener noreferrer">情书</a>
我是通过和菜头的[情书]书评才知道此博的, 博客主要涉及政治, 民主, 自由方面.
\n <a href="https://yyfrankyy.com/blog/" target="_blank" rel="noopener noreferrer">阿阳的个人博客</a>
博主貌似是应届毕业生,但是前端开发阅历不浅, 大概属于很有前途的那种.
通过淘宝小马 Twitter 分享知道此博.</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[疯狂的性能]]></title>
            <link>https://hotoo.github.io/blog/post/crazy-performance</link>
            <guid>173</guid>
            <pubDate>Sun, 23 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="疯狂的性能">疯狂的性能<a aria-hidden="true" href="#疯狂的性能">#</a></h1>
<blockquote>
<p>Performance is Everything.
工作中最重要的是提高效率。– 约·艾迪生</p>
</blockquote>
<p>单元测试是开发人员必做的功课之一，而精益求精的开发人员又会为性能而癫狂。</p>
<p>目前很少有发现 JavaScript 的性能测试工具，程序员在比较几段为同一目标，
但实现方式不同的代码效率时，总需要一行行的写new Date()和document.write()。
应该说，这不是什么大不了的事，因为 JavaScript 的性能测试本身就很简单，代码量也不算多。</p>
<p>不过，如果我们可以做的更好，更简单，更直观的话，那就动手吧。</p>
<p>这里我初步写了一个
<a href="https://hotoo.googlecode.com/svn/trunk/labs/js/crazy/Crazy.html" target="_blank" rel="noopener noreferrer">性能测试的框架</a>，
实话实说，是抛砖引玉，因为这个本身没有什么值得骄傲的，
请大家多提意见和建议，来共建一个更好的性能测试框架。</p>
<h2 id="延伸阅读">延伸阅读：<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://bdn.backbase.com/blog/sjoerd/performance%5Cnis%5Cneverything" target="_blank" rel="noopener noreferrer">Performance is Everything</a>
\n <a href="https://wd%5Cntestnet.world%5Cndirect.at/mozilla/dhtml/funo/jsTimeTest.htm" target="_blank" rel="noopener noreferrer">Javascript performance test</a>
\n <a href="https://www.wangchao.net.cn/bbsdetail%5Cn1883293.html" target="_blank" rel="noopener noreferrer">Chrome称王 五款浏览器性能大比拼－软件评测</a>
\n <a href="https://www.ie92.com/thread%5Cn29531%5Cn1%5Cn2.html" target="_blank" rel="noopener noreferrer">浏览器 JavaScript 大比拼，Opera 9.5胜出！</a>
\n <a href="https://www.javaeye.com/news/1416%5Cnjs%5Cnmainstream%5Cnbrowser%5Cnperformance%5Cncompetition" target="_blank" rel="noopener noreferrer">主流浏览器JS性能大比拼</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[菜单项图标]]></title>
            <link>https://hotoo.github.io/blog/post/menu-item-icons</link>
            <guid>174</guid>
            <pubDate>Sun, 16 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="菜单项图标">菜单项图标<a aria-hidden="true" href="#菜单项图标">#</a></h1>
<p>新装的Windows 7总有一些因为暂时不习惯或无知而遇到的问题，例如网络链接就经常出问题，
右键一个网络适配器，我们大概可以看到这样的菜单。</p>
<p><img src="https://farm3.static.flickr.com/2542/3823174909%5Cn96506164e3%5Cno.png" alt="Window 7 network right menu"></img></p>
<p>看到这一连串代表着安全的图标你作何感想？</p>
<p>图标可以增强视觉效果，加深记忆印象；合理的图标可以到底一目了然的功效，
而不用看后面的介绍性文本；但是糟糕或者不合理的图标，只会适得其反。</p>
<p>所以说，这几个图标，用的确实让人雷到，（几乎？）没有一个能确切表达对应菜单项功能的。</p>
<p>如果没有合适的图标用来表达菜单项的功能，就不要使用图标。</p>
<p>当然Windows 7的右键菜单图标并不是都用的这么烂。</p>
<p><img src="https://farm3.static.flickr.com/2519/3823285153%5Cn2263e62985%5Cno.png" alt="Windows 7 right menu"></img></p>
<p>之前的Windows系统也做的很好，选用的图标都很恰当，留白也留的很性感。</p>
<p><img src="https://farm3.static.flickr.com/2658/3824047930%5Cn290df98c05%5Cno.gif" alt="Windows 98 right menu"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[重复的书签]]></title>
            <link>https://hotoo.github.io/blog/post/duplicate-bookmarks</link>
            <guid>175</guid>
            <pubDate>Fri, 14 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="重复的书签">重复的书签<a aria-hidden="true" href="#重复的书签">#</a></h1>
<p>项目需求要做一个收藏夹，供用户收藏项目中的功能点。开发人员先给了个初步的设计文稿，
基本上是参考IE的设计方案（当然其他浏览器的方案也差不离），后来在讨论如何对待
用户收藏重复的功能点这个细节问题时，也没有经过太多的争论，照例抄袭了IE的处理方式：</p>
<p>\n 同一文件夹下不允许收藏重复的功能点，只将新的信息（如名称）覆盖到旧有的信息上；
\n 不同文件夹下可以收藏同一个已收藏的功能点。</p>
<p>但是经过讨论，后来摒弃了这个方案，因为我们看到了Firefox的优秀设计：</p>
<p>\n 同一账户不允许重复收藏同一书签；
\n 当用户收藏一个已收藏的书签时，覆盖已有信息（如名称）；
\n 如果被收藏到另一个不同的文件夹时，则将旧的收藏移动到新文件夹。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3820043578/" target="_blank" rel="noopener noreferrer"><img src="https://farm4.static.flickr.com/3534/3820043578%5Cnf8831c9265%5Cno.png" alt="pic"></img></a></p>
<p>Chrome包括智能地址栏和收藏夹都吸收了Firefox的优秀设计。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3819237321/" target="_blank" rel="noopener noreferrer"><img src="https://farm3.static.flickr.com/2537/3819237321%5Cn47e6bb1abe%5Cno.png" alt="pic"></img></a></p>
<p>Safari则表现的不同凡响：</p>
<p>\n 用户可以收藏重复的书签；
\n 甚至在同一个文件夹中，以相同的名称存放。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3820043592/" target="_blank" rel="noopener noreferrer"><img src="https://farm3.static.flickr.com/2549/3820043592%5Cna4788c3f80%5Cno.png" alt="pic"></img></a></p>
<p>Opera和Safari表现完全一致，或许他们认为，这是用户的自由。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3820043604/" target="_blank" rel="noopener noreferrer"><img src="https://farm4.static.flickr.com/3445/3820043604%5Cnec7d0cd7d5%5Cno.png" alt="pic"></img></a></p>
<p>IE7和我们所熟悉的一样：</p>
<p>\n 用户可以重复收藏已有的书签；
\n 仅当这两个书签放在不同的文件夹；
\n 或者以不同名称，放在同一个文件夹中。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3819237355/" target="_blank" rel="noopener noreferrer"><img src="https://farm4.static.flickr.com/3437/3819237355%5Cn0bef9cb98c%5Cno.png" alt="pic"></img></a></p>
<p>Maxthon最初是从IE学习并扩展而来，可想而知，并且实际上也是，
它们在对待重复的书签上，也是一致的。
<a href="https://www.flickr.com/photos/hotoo/3820043628/" target="_blank" rel="noopener noreferrer"><img src="https://farm3.static.flickr.com/2439/3820043628%5Cnf621cc76a5%5Cno.png" alt="pic"></img></a></p>
<p>面对这些主流浏览器对待重复书签的态度，像Safari和Opera这样给用户充分的自由，
或Firefox和Chrome这样“所谓”的智能，以及IE及Mathon取两者（自由或相对不自由）
之中庸，作为经常使用书签的普通用户，你觉得哪种设计更合理？</p>
<p>这里我表达一点自己的想法：</p>
<p>\n 不受约束的自由，不是什么好自由；过分的灵活，只会给用户带来迷茫。
\n 书签本身的作用，就是给用户一个记录、并能够快速打开常用或优秀的网址的地方。
如果收藏夹，甚至同一个文件夹中存在（看起来）相同的书签，
用户就需要停下来思考自己要的是哪一个。
\n 书签一般都需要记录用户使用的次数，并根据算法排序提供给智能地址栏，
收藏夹存在多个副本也会存在歧义。</p>
<p>从这个角度来讲，Opera和Safari是做的最烂的，IE和Maxthon则做的一般。
很幸运，这个想法也博得了我们项目组开发人员和PM的赞同，并应用与项目设计中。</p>
<h2 id="关键字">关键字：<a aria-hidden="true" href="#关键字">#</a></h2>
<p>\n 收藏夹(Favorite)：指浏览器用来管理书签集合的工具。
\n 书签(Bookmark)：指单个被收藏的网址信息。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[CSS字体中文、英文、Unicode名对照表]]></title>
            <link>https://hotoo.github.io/blog/post/css-names-with-cn-en-unicode</link>
            <guid>176</guid>
            <pubDate>Fri, 14 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="css字体中文英文unicode名对照表">CSS字体中文、英文、Unicode名对照表<a aria-hidden="true" href="#css字体中文英文unicode名对照表">#</a></h1>
<p>\n</p>
<p>css字体名可以使用2种Unicode格式来书写，以“微软雅黑”为例:
微软雅黑 和 \5FAE\8F6F\96C5\9ED1都可以。
如果未找到需要的字体名称，可以到
<a href="https://www.rocklv.net/free/free%5Cngoodys%5Cnunicode.php" target="_blank" rel="noopener noreferrer">这里</a>
把简体中文转换为Unicode编码。</p>
<p>另外注意：繁体中文字体名，在简体中文系统中是不能被识别的。</p>
<p>查看 <a href="https://hotoo.googlecode.com/svn/trunk/labs/css/css%5Cnfonts.html" target="_blank" rel="noopener noreferrer">详细的字体名称对照表</a>。</p>
<h2 id="参考阅读">参考阅读：<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://hi.baidu.com/1212u/blog/item/976a132cdede13e98a1399a5.html" target="_blank" rel="noopener noreferrer">CSS中 常见中文字体的英文名称</a>
\n <a href="https://lifesinger.org/blog/2009/08/font%5Cnfamily%5Cnin%5Cncss/" target="_blank" rel="noopener noreferrer">中文字体在 CSS 中的写法</a>
\n <a href="https://www.cnblogs.com/ruxpinsp1/tag/font%5Cnfamily/" target="_blank" rel="noopener noreferrer">谈谈网页设计中的字体应用（系列）</a>
\n <a href="https://www.rocklv.net/free/free%5Cngoodys%5Cnunicode.php" target="_blank" rel="noopener noreferrer">中文转Unicode</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[未来的前端设计]]></title>
            <link>https://hotoo.github.io/blog/post/web-design-for-feature</link>
            <guid>178</guid>
            <pubDate>Wed, 12 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="未来的前端设计">未来的前端设计<a aria-hidden="true" href="#未来的前端设计">#</a></h1>
<p>今天基本完成了用户首页，用户可以拖放管理自定义布局
（类似 <a href="https://www.google.com/ig?hl=en" target="_blank" rel="noopener noreferrer">igoogle</a>）。</p>
<p>在PM试体验的时候，发现他的拖放方式都（跟部门主管一样）是“丢放式”的，
鼠标抓起一个模块，带有速度的往某个位置一扔，有时在没有到达目标区域就放手了，
导致实际上没有被扔到目标区域。不仅仅是拖放模块，甚至连拖放改变边侧栏宽度也是使用这种手法。
可以想象他们使用桌面应用程序（比如改变窗口大小）也是这样操作的。^1^</p>
<p>我当时指出这两种拖放手法的不同，然后我们就短暂的畅想了关于“丢放式”的前端设计。</p>
<p>如果你看过微软未来操作系统的视频^2^，或者腾讯未来QQ的演示视频^3^，大概能了解这是怎样的一种情形。</p>
<p>这种模拟现实，并超越现实的操作体验，比目前任何的3D游戏都要精致、逼真得多，
它是如此的流畅（非性能），以至于让人感觉不到操作系统和软件的存在，仿佛在摆弄实物一般。</p>
<p>目前的大多数web前端设计，还只是初步模拟操作系统或桌面应用程序2D时代的作品，
受浏览器的约束，也有一些做出了还不错的3D及流畅的动态效果，然而即使是flash也做的很不够。
就3D效果本身来说，这只不过是未来设计中很基本的一种特性，另外包括手势动作及趋势，
操作的速度及方向，还有现实世界中力学，人体工程学，甚至心理学等等众多科学的渗入，
辅助以多点触摸屏，声控等，展现层的设计会越来越逼真，操作方式跟现实世界会越来越无差异。</p>
<p>更进一步的，我曾经似乎看过，也传播过这样一句话：最好的界面，就是没有界面。
我虽然只是随便说说，但是心里还是蛮认真的。当然这里说的没有，只是说对操作用户来说几乎透明，
几乎感觉不到，而当用户希望有感觉时，他可以自己拼出符合自己期望的界面来。</p>
<h2 id="参考与延伸欣赏">参考与延伸欣赏：<a aria-hidden="true" href="#参考与延伸欣赏">#</a></h2>
<p>\n <a href="https://twitter.com/hotoo/statuses/3241383666" target="_blank" rel="noopener noreferrer">Twitter@hotoo:3241383666</a>
发现部门两个老大的拖放手法都是“丢放式”，
未来操作系统在触摸屏的辅助下，已经有这样的抽象设计。
我想，web前端也可以尝试这样的抽象设计。^1^
\n <a href="https://v.youku.com/v%5Cnshow/id%5CnXMzQ0Njc1MzI=.html" target="_blank" rel="noopener noreferrer">视频: 超酷的微软操作系统</a> ^2^
\n <a href="https://www.iqshw.com/post/308.html" target="_blank" rel="noopener noreferrer">超炫的未来QQ版本（视频集合）</a> ^3^
\n <a href="https://tech.163.com/07/0601/09/3FT3PNA7000926PT.html" target="_blank" rel="noopener noreferrer">未来的操作系统将采用3D用户界面和触摸操作</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[论广告窗口的弹出]]></title>
            <link>https://hotoo.github.io/blog/post/talk-about-popup-window</link>
            <guid>177</guid>
            <pubDate>Fri, 07 Aug 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="论广告窗口的弹出">论广告窗口的弹出<a aria-hidden="true" href="#论广告窗口的弹出">#</a></h1>
<p>弹窗广告，这（和页面漂浮广告）是上个世纪用的最频繁的广告方式，这种广告之所以“流行”，
是因为它引人注目的特性，广告商也正是看中这一点。而这也是最讨人厌的一种广告方式，
因为它未经用户同意，擅自弹出新窗口，一来每次都要手动关闭窗口很烦，二来它不尊重用户的意愿。</p>
<p>既然服务商不尊重用户，用户当然说服务商很讨厌。</p>
<p>后来通过服务商，广告商，开发人员和用户等大众的共同努力，这种弹窗方式逐渐受到质疑：</p>
<ol>
<li>这种广告方式真的很有效吗？</li>
<li>有更好更受欢迎的广告模式吗，为什么(Google) \n内联的\n ，
精确匹配的广告模式会受广告商和普通用户的一致好评？</li>
</ol>
<p>同时这（两）种广告模式逐渐退出广告历史的舞台，只有非常小众的网站才偶尔，
或非常恶劣的网站才频繁出现。</p>
<p>并且，即使链接本身是否在新窗口弹出都成了讨论的热点话题。w3c 已经不建议使用 target 属性了，
是否在新窗口、新页签中打开，这应该是用户可控的，属于用户的偏好问题，应该尊重用户的选择。</p>
<p>不过，用过淘宝的人应该都知道，<a href="https://www.taobao.com/" target="_blank" rel="noopener noreferrer">淘宝首页</a> 是会弹出广告窗口的，
即使默认情况下被浏览器自动屏蔽掉，在用户点击页面时还是会被弹出，此时因为带有用户行为，
浏览器较难判断是否应该屏蔽。</p>
<p>真是令人发指，淘宝这样出色的公司，居然做出这么卑劣的事情，而且还费尽心机。</p>
<p>前些时候我发现淘宝首页的拼音索引和商品详细信息等都不可用了，于是在 Twitter 上对
<a href="https://twitter.com/taobaoued" target="_blank" rel="noopener noreferrer">@TaobaoUED</a> 发了句牢骚，然后
<a href="https://twitter.com/macji" target="_blank" rel="noopener noreferrer">@Macji</a> 很主动的跟我联系了解情况。
后来发现问题出在 <a href="https://addons.mozilla.org/zh%5CnCN/firefox/addon/1865" target="_blank" rel="noopener noreferrer">Adblock plus</a>
<a href="https://adblockplus.org/en/" target="_blank" rel="noopener noreferrer">2</a> 的 ChinaList 直接将淘宝用的 tbra 框架屏蔽了，
然后我和 Macji 进行了“深入的激辩”，大致情况如下：</p>
<blockquote>
<p>Macji: 对于 china list 这种不负责的乱禁用 js 框架, 而不是只是禁用广告. 所以我们也无办法
闲耘: 我觉得在弹窗这一点上，chinalist 是负责任的，是淘宝不负责任
Macji: chinalist 应该专业点的,  只是禁用弹出广告
闲耘: 也许淘宝应该专业点，不要用弹窗广告
...
Macji: 弹出广告 严重邮箱用户体验, 其实我们一直再争取, 但我们不是高层
Macji: 我会写信给 chinalist 给出禁用弹窗的解决方案</p>
</blockquote>
<p>最后想说：淘宝是个很有责任感的公司，这个弹窗广告除外；淘宝是个很注重用户体验的公司，
这个弹窗广告除外；淘宝是个很尊重用户的公司，这个弹窗广告除外。淘宝是个很注重细节的公司，
包括这个弹窗在内；淘宝是个很注重技术的团队，包括这个弹窗在内。</p>
<p>\n\n\n\n</p>
<p>\n更新：可喜的是，经过努力，新版淘宝已经戒掉了这个恶习。\n</p>
<h2 id="延伸阅读">延伸阅读：<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://shawphy.com/2009/01/window%5Cnopen%5Cnis%5Cnevil.html" target="_blank" rel="noopener noreferrer">万恶的弹窗广告</a>
\n <a href="https://www.om19.cn/2008/08/16/%E7%AC%A6%E5%90%88%E5%9B%BD%E6%83%85%E7%9A%84%E9%93%BE%E6%8E%A5%E6%96%B0%E7%AA%97%E5%8F%A3%E6%89%93%E5%BC%80/" target="_blank" rel="noopener noreferrer">符合国情的链接新窗口打开</a>
\n <a href="https://shawphy.com/2009/01/window%5Cnopen%5Cnis%5Cnevil.html" target="_blank" rel="noopener noreferrer">在新窗口打开链接是流氓行为</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[搜索的体验]]></title>
            <link>https://hotoo.github.io/blog/post/search-expreience</link>
            <guid>180</guid>
            <pubDate>Wed, 29 Jul 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="搜索的体验">搜索的体验<a aria-hidden="true" href="#搜索的体验">#</a></h1>
<p>准备升级博客模板，用js提供高级特性，比如和vim类似的键盘命令模式，和内联搜索模式。
主要提高搜索的体验，包括一下几点。</p>
<p>\n 检查来自Google,Baidu等搜索引擎和本地搜索的搜索关键字，并高亮之。
\n 内联搜索模式，在底部fixed搜索框，并支持快捷键，最好能支持正则匹配模式，参考vim。
\n 使用搜索框附近fixed工具按钮，提供下一个、上一个搜索关键字的跳转，参考Eclipse。
\n 在滚动条附近使用(fixed)条纹，标识每个搜索结果在整屏中对应的大概位置，
点击条纹可以跳转到对应结果项，拖放滚动条到对应的条纹处，
页面也正好滚动到对应的结果项，参考Eclipse, Chrome。</p>
<p>这里只是初步想法，受我“[[the\ngod\nof\neditor|编辑器之神]]”的想法发散而来，
目前已经初步模拟了滚动条附近的搜索大纲，和命令模式的命令列表(完全模仿vim)。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3768956114/" target="_blank" rel="noopener noreferrer"><a href="https://farm4.static.flickr.com/3475/3768956114%5Cn2562cf5b10%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm4.static.flickr.com/3475/3768956114\n2562cf5b10\no.png</a></a></p>
<p><a href="https://www.flickr.com/photos/hotoo/3768173303/" target="_blank" rel="noopener noreferrer"><a href="https://farm4.static.flickr.com/3470/3768173303%5Cnffbf2028cb%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm4.static.flickr.com/3470/3768173303\nffbf2028cb\no.png</a></a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[右键菜单的细节]]></title>
            <link>https://hotoo.github.io/blog/post/particulars-of-right-click-menu</link>
            <guid>179</guid>
            <pubDate>Mon, 27 Jul 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="右键菜单的细节">右键菜单的细节<a aria-hidden="true" href="#右键菜单的细节">#</a></h1>
<p>在 Web 客户端编程中，绑定 JavaScript 的 contextmenu 事件来驱动触发自定义右键菜单，
并通过停止事件冒泡来阻止Windows默认菜单，是一种比较常见的自定义菜单实现方式，
自定义菜单的基准位置是基于事件的触发位置得来的。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3761004107/" target="_blank" rel="noopener noreferrer"><a href="https://farm3.static.flickr.com/2475/3761004107%5Cn8f9f25efc1%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm3.static.flickr.com/2475/3761004107\n8f9f25efc1\no.png</a></a></p>
<p>就右键菜单的本意来说，这基本没什么问题，不过Windows PC键盘上有一个右键功能键。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3760929801/" target="_blank" rel="noopener noreferrer"><a href="https://farm3.static.flickr.com/2583/3760929801%5Cn31e0e4b6c8%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm3.static.flickr.com/2583/3760929801\n31e0e4b6c8\no.png</a></a></p>
<p>通过按这个功能键来触发右键菜单，除了Firefox （v3.5，其他版本未测试）外，均表现不正常。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3761023363/" target="_blank" rel="noopener noreferrer"><a href="https://farm4.static.flickr.com/3529/3761023363%5Cn50cd93a685%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm4.static.flickr.com/3529/3761023363\n50cd93a685\no.png</a></a></p>
<p>IE 事件触发对象的坐标仍是鼠标所在的坐标位置。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3761015003/" target="_blank" rel="noopener noreferrer"><a href="https://farm4.static.flickr.com/3529/3761015003%5Cn552bdedc82%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm4.static.flickr.com/3529/3761015003\n552bdedc82\no.png</a></a></p>
<p>Safari和Chrome均不能触发自定义右键菜单，呈现浏览器默认菜单
（Safari在使用鼠标邮件激活自定义右键菜单后，自定义右键菜单消失前，不呈现浏览器默认菜单）。</p>
<p>Opera不支持contextmenu事件，默认情况下也禁止脚本控制右键菜单。</p>
<p>而标准的桌面应用程序中使用这个键，和右击鼠标是基本一致的，基准位置参照焦点对象的位置。</p>
<p><a href="https://www.flickr.com/photos/hotoo/3760955767/" target="_blank" rel="noopener noreferrer"><a href="https://farm3.static.flickr.com/2591/3760955767%5Cn8fb08f8007%5Cno.png" target="_blank" rel="noopener noreferrer">https://farm3.static.flickr.com/2591/3760955767\n8fb08f8007\no.png</a></a></p>
<p>右键功能键是为无鼠标或鼠标不可用情况设计的，所以使用右键功能键激活的右键菜单，
应该呈现在焦点对象附近，并且自定义菜单应该（至少在视觉上）获得焦点，
以便于通过方向键控制选中的菜单项。</p>
<p>这在很大程度上应该属于浏览器的问题，不过在现实的情况下，如果前端开发者可以解决掉这个问题，
就不要寄希望于浏览器将来的新版本。</p>
<blockquote>
<p>不过更好的方式也许是：严谨区分鼠标和键盘事件。</p>
</blockquote>
<h2 id="参考阅读">参考阅读：<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://blog.csdn.net/spring21st/archive/2009/02/04/3862606.aspx" target="_blank" rel="noopener noreferrer">Opera下自定义右键菜单的研究</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[引导用户升级/切换浏览器]]></title>
            <link>https://hotoo.github.io/blog/post/upgrad-your-browser</link>
            <guid>181</guid>
            <pubDate>Sun, 26 Jul 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="引导用户升级切换浏览器">引导用户升级/切换浏览器<a aria-hidden="true" href="#引导用户升级切换浏览器">#</a></h1>
<p>\n</p>
<p>虽然我不“赞同”强行拒绝IE6，但是“认同”推进Web及浏览器的发展进程。
一直想做引导用户升级/切换浏览器的工作，现在是做些实事的时候了。
我们承受的苦难太多了，朋友们，这是抉择的时刻，是你作出改变是时候了，为了我们，干杯！</p>
<h2 id="升级切换您的浏览器">升级/切换您的浏览器<a aria-hidden="true" href="#升级切换您的浏览器">#</a></h2>
<p>鉴于您使用的浏览器过于陈旧，影响您的上网体验，我们向您推荐以下浏览器：</p>
<p>\n <a href="https://www.mozilla.com/en%5CnUS/" target="_blank" rel="noopener noreferrer">Firefox</a>
来自开源Mozilla公司，安全可靠，拥有众多强大的插件和开源社区支持。
适合喜爱DIY的人士。
\n <a href="https://www.google.com/chrome/" target="_blank" rel="noopener noreferrer">Chrome</a>
来自誉满全球的互联网公司Google，安全快速，界面简洁、灵活、新颖，
使用开源的Webkit渲染引擎和强劲的V8 Javascript解析引擎，
给你飞一般的感觉，适合普通用户。
\n <a href="https://www.apple.com/safari/download/" target="_blank" rel="noopener noreferrer">Safari</a>
<a href="https://www.apple.com.cn/safari/download/" target="_blank" rel="noopener noreferrer">cn</a>
来自设计界著名的苹果(Apple)公司，使用自主开发、开源的Webkit渲染引擎，
适合普通用户。
\n <a href="https://www.opera.com/" target="_blank" rel="noopener noreferrer">Opera</a>
一直以来默默无闻的引领着浏览器的设计潮流，其移动设备上的Mini版亦深受大众欢迎，
是一款值得尊重的、实用的浏览器，适合各类人群。
\n <a href="https://www.microsoft.com/china/windows/internet%5Cnexplorer/worldwide%5Cnsites.aspx" target="_blank" rel="noopener noreferrer">Internet Explorer 8</a>
来自大名鼎鼎的微软(Microsoft)公司，是迄今为止IE家族最优秀的浏览器，
但目前有少量第三方插件支持不够友好，相信很快会有所改善。
\n <a href="https://www.microsoft.com/china/windows/downloads/ie/getitnow.mspx" target="_blank" rel="noopener noreferrer">Internet Explorer 7</a>
隶属IE家族，相对IE8来说，第三方插件支持稍成熟。</p>
<p>\nIE\n 、 \n浏览器\n 和 \n因特网\n ：因特网是连接世界资讯的数字化网络。
我们使用浏览器是来浏览网页、上网冲浪，尽情使用互联网。
而Internet Explorer(IE)则只是浏览器的一种。</p>
<p>完整 <a href="https://www.xianyun.org/labs/browser/upgrad%5Cnyour%5Cnbrowser.html" target="_blank" rel="noopener noreferrer">演示</a>。</p>
<h2 id="参考阅读">参考阅读：<a aria-hidden="true" href="#参考阅读">#</a></h2>
<p>\n <a href="https://blog.benhuoer.com/posts/ie6%5Cnmust%5Cndie.html" target="_blank" rel="noopener noreferrer">Web技术要发展，IE6必须先消失！</a>
\n <a href="https://shawphy.com/2009/07/ie6%5Cnmust%5Cndie.html" target="_blank" rel="noopener noreferrer">能支持IE6的前端更牛，还是敢对IE6说不的更牛？</a>
\n <a href="https://imtony.net/blog/choose%5Cnbrowser/" target="_blank" rel="noopener noreferrer">我该选用什么浏览器？</a>
\n <a href="https://www.webrebuild.org/" target="_blank" rel="noopener noreferrer">升级您的Internet Explorer 6</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[編輯器之神]]></title>
            <link>https://hotoo.github.io/blog/post/the-god-of-editor</link>
            <guid>182</guid>
            <pubDate>Fri, 24 Jul 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="編輯器之神">編輯器之神<a aria-hidden="true" href="#編輯器之神">#</a></h1>
<p>最初的时候我一直使用 <a href="https://www.editplus.com/" target="_blank" rel="noopener noreferrer">Editplus</a>，这是一款轻量级，
效率极高，可配置性稍强的编辑器，而且有内嵌的(IE6)浏览器内核，
使用快捷键 <code>&lt;Ctrl\nb&gt;</code> 就可以在 html 代码和预览效果之间快速切换，
甚至可以无需保存html 文件到指定磁盘位置（默认保存在浏览器临时目录）。
我仍然很喜欢 Editplus，但是不经常用了。</p>
<p>后来使用的 <a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer">Eclipse</a> 在项目管理和强大的插件支持下，
如神器一般。这是一个足够伟大的IDE，不过如果单纯的作为编辑器来用，就有点大材小用了。</p>
<p>最后，就是 <a href="https://www.vim.org/" target="_blank" rel="noopener noreferrer">Vim</a> 了，Vim 和 Emacs 两款编辑器我都试用过，
最开始不理解多模式，没有适应这种使用习惯，心想：这是什么破编辑器！？</p>
<p>来来回回丢弃过几次，后来有一次不小心心智大开，迅速的习惯了多模式编辑，
并从此爱上了 Vim，经过一段时间的学习和练习，更是无法自拔。</p>
<p>上面三款编辑器如此优秀，Vim更有神器的美称，但即使是神器也有美中不足之处。
下面是我期待中的编辑神器的主要功能点。</p>
<p>\n 代码着色
\n 现代化的代码折叠方式
\n 大纲视图
\n 代码压缩与格式化
\n 文本比较
\n 文本书签
\n 文本拖放
\n 多模式编辑
\n 内联搜索模式
\n 在滚动条或附近使用彩色条纹标识状态
\n 自动识别文件编码
\n 可扩展
\n 项目管理支持
\n 二进制编辑支持
\n 代码着色
基本上现在的编辑器都支持代码着色，虽然使用方式各不相同，
但是使用效果基本可以达到一致，没什么要挑剔的。不过 Vim 的配色模式不错，
另外应该提供导入到处配色模式。
\n 现代化的代码折叠方式
代码折叠是一项如此受人喜爱的创造发明，不支持代码折叠你都不好意思更人打招呼。
不过 Editplus 和 Vim 的代码折叠方式比较原始，默认情况下只识别缩进后的文本/代码，
而且Vim左边的折叠按钮更是土到掉渣。
\n 大纲视图
Eclipse精于此道，自带的大纲视图对 Java，C++，PHP 等支持都很好，
而 Aptana 对 Javascript 的大纲视图更是令人称道。
\n 代码压缩与格式化
Vim的代码格式化做的很不足，有很多时候格式化不到位。Eclipse及其插件做的比较完美。
\n 文本比较。
Vim 和 Eclipse 都做的很好。
\n 文本书签
要在大段、篇幅很长的文本/代码中跳跃阅读，并能轻松回到原来的位置上，
书签就显得尤为重要。Vim 的 mark 插件对文本书签支持的很好。
\n 文本拖放
在不想使用复制/剪贴影响剪贴板内容的情况下很有用。
不过 Vim 默认不支持，Editplus 和 Eclipse 做的很好。
\n 多模式编辑
Vim 和 Emacs 的多模式编辑，舒适到不行。
\n 内联搜索模式
Vim 的内联搜索模式是如此的浑然天成，并且支持强劲的正则表达式匹配模式。
\n 在滚动条或附近使用彩色条纹标识状态
Eclipse的全局搜索，Chrome浏览器的搜索，Beyond Compare 2的文本比较，
都有在恰当的位置标识出所有结果集在编辑器的全局大体位置，
使用滚动条拖放到某位置，即可看到对应的搜索结果。
\n 自动识别文件编码
Ediplus 做的最为精湛，Vim 也有一个不错的插件支持。
\n 可扩展
Eclipse 和 Vim 的扩展性较强。
\n 项目管理支持
作为 IDE，Eclipse 当然表现强劲。Editplus 也有一个原始的项目管理功能。
编辑器本身可以没有项目管理功能集成，这个可以交给更专业的项目管理软件来做，
编辑器可以实现某些接口来集成或挂载项目管理功能。
\n 二进制编辑支持
一般人并不常用，如果在不影响前面的功能和编辑器效率的情况下，
加上这个功能也未尝不可。</p>
<p>如果我们有一个编辑器，他启动像 Editplus和Vim一样迅捷，
使用Eclipse或类似的现代代码折叠方式，有Eclipse那样成熟的大纲视图、
代码压缩工具和文本比较功能，像 Vim一样的多模式编辑和内联搜索模式，
支持如Perl一般的正则表达式匹配模式，并将搜索结果集在文档全局中对应的位置
在恰当的位置（如滚动条底带）呈 现，支持文本书签，另外有像Eclipse一样，
或更好的更专业的项目管理工具支持，这将是怎么一款伟大的现代编辑器。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[未知选项的表单设计]]></title>
            <link>https://hotoo.github.io/blog/post/form-design-for-unknow-options</link>
            <guid>183</guid>
            <pubDate>Sat, 09 May 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="未知选项的表单设计">未知选项的表单设计<a aria-hidden="true" href="#未知选项的表单设计">#</a></h1>
<p>发现许多的注册表单设计中，性别部分的设计大都这样：使用单选按钮（radio）
并默认选中一个（大都为男性，某些女性频道为主的可能为女性）。例如：</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SgUXbXDilSI/AAAAAAAAICg/iWEub23YPns/s320/qq%5Cnreg%5Cngender.jpg" alt="图"></img></p>
<p>网页申请QQ （<a href="https://www.qq.com/" target="_blank" rel="noopener noreferrer">qq.com</a>）帐号</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SgUXhW92jnI/AAAAAAAAICo/aPBUi5Ew%5Cn34/s320/163%5Cnreg%5Cngender.jpg" alt="图"></img></p>
<p>注册网易（<a href="https://www.163.com/" target="_blank" rel="noopener noreferrer">163.com</a>）通行证</p>
<p>雅虎（<a href="https://www.yahoo.com/" target="_blank" rel="noopener noreferrer">yahoo.com</a>）的设计比较特立独行，使用选择框（select），
并默认不选中任何一个。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SgUYkKl3WQI/AAAAAAAAICw/%5CnTCSOh0wpbA/s320/yahoo.com%5Cnreg%5Cngender.jpg" alt="图"></img></p>
<p>而雅虎中国（<a href="https://www.yahoo.cn/" target="_blank" rel="noopener noreferrer">yahoo.cn</a>）的设计也是使用单选框（radio），
但是不选中任何一个。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SgUZRosOFDI/AAAAAAAAIC4/5QXSQhtQFH0/s1600%5Cnh/yahoo.cn%5Cnreg%5Cngender.jpg" alt="图"></img></p>
<p>按常理来说，注册系统并不知道用户的性别是什么，默认选中任何一个都不合理。
yummy有一篇文章《<a href="https://www.yummyux.com/?p=366" target="_blank" rel="noopener noreferrer">中文按1，For English, press 2</a>》
提到“如果用户必须做出选择，那就先给他做好一个选择。”，这个道理在某些情况很不错，
但是用在这里不合适。</p>
<p>\n如果不足够了解用户，就不要替用户做选择。\n</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[状态模式]]></title>
            <link>https://hotoo.github.io/blog/post/status-pattern</link>
            <guid>184</guid>
            <pubDate>Fri, 08 May 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="状态模式">状态模式<a aria-hidden="true" href="#状态模式">#</a></h1>
<p>现有的IM软件都有状态设置功能，常见的默认状态有：在线，忙碌，离开，隐身，离线，
但是这些状态对应的选项是不可设置的，例如TM/QQ，选择在线或者忙碌，对应的通知铃声，
接收消息方式都是指定、不可改变的，虽然这些默认设置在某些情景下可能很合理，但不总是这样。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SgQrIxd1QAI/AAAAAAAAIBg/Ky02D0%5CnlldY/s320/TM%5Cnstatus.JPG" alt="图"></img></p>
<p>TM/QQ 状态：可以使用默认状态作为模板附加消息来添加状态。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SgQuUjBzaiI/AAAAAAAAIBo/1huCGCCenME/s320/Gtalk%5Cnstatus.JPG" alt="图"></img></p>
<p>Gtalk 状态：可以直接在状态写状态信息，但是只有在线，离开和离线三种状态。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SgQuYt6H6OI/AAAAAAAAIBw/d9PHFq32QOc/s320/Wangwang%5Cnstatus.JPG" alt="图"></img></p>
<p>WangWang 状态：可以添加状态信息。</p>
<p>可以看出，基本上IM软件的状态信息只能向好友展示文本消息，告诉好友你当前的状态，
有时候并不能真正帮助我们在某些需要的时候过滤某些信息，例如老板告诉秘书，帮我回绝所有约会和电话。</p>
<p>最近工作的时候发现，我希望工作的时候设置状态为在线，或者忙碌也可以，
而且不想接收所有或某些群消息。</p>
<p>例如上班工作的时候不想接受技术探讨群或娱 乐群的叽歪消息，</p>
<p>但是要聆听部门或项目组的群消息，尤其要注意老板发来的消息，
当然手工修改每个群的消息设置也可以做到，但是每次改都非常不方便，如果可 以保存为模式
（如命名为“工作模式”，寂寞的时候想找人聊天可以设置一个“寂寞模式”），在模式之间切换就更实用了。</p>
<p>智能手机（如我的Smartphone）在这方面就做的不错，值得学习。
Smartphone上有各种“情景模式”，如普通，静音，会议，室外，自 动，耳机，车载和免提，
每一种模式的铃声类型，音量，包括模式名称等多项设置都可以根据用户自身情况改变
（当然默认的情景模式设置也已经很合理了，但我也有在一些特殊的时候，做一些适当的修改）。</p>
<p><img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SgQzKZVKoKI/AAAAAAAAIB4/dc%5CndJtAA3dU/s320/dopod%5Cn577w.jpg" alt="图"></img></p>
<p>下面使用Windows Mobile 2003的相关屏幕截屏</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SgQz0nQ2nVI/AAAAAAAAICA/VVtYVy6DAfQ/s320/smartphone%5Cn1.jpg" alt="图"></img></p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SgQz3xB2zUI/AAAAAAAAICI/1Vz4I9VzXAE/s320/smartphone%5Cn2.jpg" alt="图"></img></p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SgQz6xCW68I/AAAAAAAAICQ/a7T%5CnSw4jD3I/s320/smartphone%5Cn3.jpg" alt="图"></img></p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SgQz98t%5CntgI/AAAAAAAAICY/JT08w%5Cn36uRU/s320/smartphone%5Cn4.jpg" alt="图"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[标签模式]]></title>
            <link>https://hotoo.github.io/blog/post/tags-pattern</link>
            <guid>185</guid>
            <pubDate>Sat, 02 May 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="标签模式">标签模式<a aria-hidden="true" href="#标签模式">#</a></h1>
<p>目前的标签有以下几种模式(形式)：</p>
<h2 id="手动外联标签模式">手动外联标签模式。<a aria-hidden="true" href="#手动外联标签模式">#</a></h2>
<p>这种模式将标签和内容分离，用户需要为指定文档/内容贴上不同的标签。
例如Gmail和新版Wordpress的标签。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SfvBJ3%5CnKZQI/AAAAAAAAIAY/qS9Y53%5CnxN4g/s320/Gmail%5Cnlabels.JPG" alt="图"></img></p>
<p>\n 优点：简单易用，可控性强。
\n 缺点：需要为每个内容设置标签。</p>
<h2 id="手动内联标签模式">手动内联标签模式。<a aria-hidden="true" href="#手动内联标签模式">#</a></h2>
<p>这种模式将标签和内容融合，用户同样需要为文档/内容贴上不同的标签，
并且这种模式因为没有明确的标签输入区（标签输入区和内容输入区在一起），
容易导致忘记贴标签，对于及时性和不可修改性的应用不太理想。</p>
<p>如Twitter就有这方面的第三方应用，参考 <a href="https://www.hashtags.org/" target="_blank" rel="noopener noreferrer">hashtags</a>。</p>
<p><img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SfvCwh4OmRI/AAAAAAAAIAg/WM8rUQkDBl8/s400/twitter%5Cntags.JPG" alt="图"></img></p>
<p>\n 优点：内容被语义化；标签本身简单易用，可控性也很强。
\n 缺点：需要辅助标记，内容被干扰；容易忘记使用标签。</p>
<h2 id="自动内联标签模式">自动内联标签模式。<a aria-hidden="true" href="#自动内联标签模式">#</a></h2>
<p>这种模式需要用户手动设置标签集合，系统根据内容自动匹配标签。
目前还没有发现这种模式的实际应用，比较接近的有 \n关键字替换\n 和
\n对局部文本进行评论\n （忘记怎么称呼了，请指教）。
关键字替换只是展示层的，用户可以根据内容发现（暂且称之为）标签，
但无法通过标签找到匹配的内容
（由此想到了搜索引擎）。</p>
<p><img src="https://1.bp.blogspot.com/%5CnPOl6bUDELqY/SfvGbLpTtAI/AAAAAAAAIAo/7osZzg3lZPU/s400/qq%5Cnnews%5Cnreplace%5Cntext.jpg" alt="图"></img></p>
<p>\n 优点：标签自动化，用户无需操心内容和标签之间的关系。
\n 缺点：要匹配到正确的标签并不容易，大概到真正的语义时代可以解决。</p>
<p>由此扩展另一种：</p>
<h2 id="内联标签兼容模式">内联标签兼容模式。<a aria-hidden="true" href="#内联标签兼容模式">#</a></h2>
<p>系统根据用户设置的标签集合管理标签与内容之间的关系，另外用户也可以手动管理标签。</p>
<p>\n 优点：标签自动化；可控性强。
\n 缺点：简单问题变复杂，包括系统实现复杂度和用户使用复杂度。</p>
<p>不过回头想想，标签本身很简单，有必要把它变复杂吗？自动化就是不想手动控制，
如果需要手动控制还要自动化干嘛？</p>
<p>\n\n\n\n</p>
<p>UPDATE: 未尝不可一试. (2010/10/24)</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[关于面包屑导航]]></title>
            <link>https://hotoo.github.io/blog/post/crumb-navigation</link>
            <guid>186</guid>
            <pubDate>Sun, 19 Apr 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="关于面包屑导航">关于面包屑导航<a aria-hidden="true" href="#关于面包屑导航">#</a></h1>
<p>一直都很喜欢 <a href="https://blog.rexsong.com/" target="_blank" rel="noopener noreferrer">千鸟志</a> 的标题面包屑导航方式，
我准备在自己的博客主题中使用这种导航。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SeqhIZSlAVI/AAAAAAAAIAA/%5CnbaINqNNStg/s320/nav0.jpg" alt="图"></img></p>
<p>不过，千鸟志的导航部分和标题有重复（另外我比较倾向于使用标签而不是分类）。
下面将导航和标题融合，去除标题部分。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SeqiNLKKJTI/AAAAAAAAIAI/mjHbOS%5Cn0Q%5Cng/s400/nav1.jpg" alt="图"></img></p>
<p>这里使用了语义化的标签，并且在字体和颜色上突出当前的状态，与标题融合的也算恰当。
不过当标签较多时会将标题挤到很靠后。</p>
<p>另外想到有一些Unix论坛使用的树形导航也不错，稍加改进如下：</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SeqjWus5%5CnMI/AAAAAAAAIAQ/DyOoETHewq8/s320/nav2.jpg" alt="图"></img></p>
<p>标签应用比上面稍合理，而且css裸奔情况下表现也略如人意（话说“差强人意”这个词的“差”
是“甚，殊”的意思）。对于导航层级不太深的应用，还是不错的。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[改进的菜单按钮]]></title>
            <link>https://hotoo.github.io/blog/post/menu-button-improved</link>
            <guid>187</guid>
            <pubDate>Fri, 17 Apr 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="改进的菜单按钮">改进的菜单按钮<a aria-hidden="true" href="#改进的菜单按钮">#</a></h1>
<p>一直想写关于菜单按钮的设计，但是太懒惰的原因，老是拖着不做。当然今天也没勤快到哪里去，
下面第二个改进图是用 <a href="https://www.evolus.vn/Pencil/" target="_blank" rel="noopener noreferrer">Pencil</a> 画的，并没有用脚本实现，哎，懒啊。</p>
<p>先看QQ/TM的设计，无论选项是什么，按钮上都没有体现出来。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SedGvF26A7I/AAAAAAAAH%5CnY/%5CnUB9My9RlP8/s320/qq%5Cnsend%5Cnbutton%5Cnorig.jpg" alt="pic"></img></p>
<p>我觉得其实不论是文本，还是图标，都可以把当前选中状态体现在按钮上的，便于用户确认按钮当前的状态。
下面是改进后的菜单按钮（以QQ/TM为例）。</p>
<p><img src="https://1.bp.blogspot.com/%5CnPOl6bUDELqY/SedFixewtuI/AAAAAAAAH%5CnQ/fFRR8KiM4OE/s320/qq%5Cnsend%5Cnbutton.jpg" alt="pic"></img></p>
<p>一般来说，菜单按钮都应该做用户“最后一次”使用选择的动作。
例如早期QQ的视频、语音菜单按钮，MSN的菜单按钮，还有旺旺的菜单按钮，都应该如此。</p>
<p><img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SedKDnXmfOI/AAAAAAAAH%5Cng/rGTWQwL8MSE/s320/wangwang%5Cntrans%5Cnfile.JPG" alt="pic"></img></p>
<h2 id="延伸阅读">延伸阅读<a aria-hidden="true" href="#延伸阅读">#</a></h2>
<p>\n <a href="https://vimcn.blogspot.com/2009/04/menu%5Cnbutton%5Cnimproved.html" target="_blank" rel="noopener noreferrer">@blogspot</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[如何削铅笔]]></title>
            <link>https://hotoo.github.io/blog/post/how-to-peel-pencil</link>
            <guid>188</guid>
            <pubDate>Tue, 14 Apr 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="如何削铅笔">如何削铅笔<a aria-hidden="true" href="#如何削铅笔">#</a></h1>
<p>看了 <a href="https://www.junchenwu.com/" target="_blank" rel="noopener noreferrer">JunChen</a> 翻译的
<a href="https://www.junchenwu.com/2009/04/our%5Cnfavorite%5Cntools%5Cnfor%5Cnsketching.html" target="_blank" rel="noopener noreferrer">Adaptive Path：我们最爱的草图工具</a>，
我很受启发。之前也有让公司买彩色铅笔用，但现在已经离开用不着了。
而且一直都很想买个 GTD 记事本以及其他文具，今天抽空就把装备给差不多备齐了。</p>
<p>回来削铅笔的时候，想起自己以前的经历：小时候用过转笔刀和小刀，都会把笔尖削的很尖锐，
跟书本上的引导、同学的同化、以及思维定势都有关，而且也 基本适合那时候的使用场景。
后来高考使用2B铅笔，也受一些美术专业朋友的影响，学会了把笔尖削得平板愚钝一点
（有点返璞归真，大智若愚的感觉），这种削 法也一直 使用到现在。</p>
<p>这里要讲的就是这种削法。</p>
<p>\n 削表面木头时，先不要削炭芯，倾斜度建议平滑一点，大概15°，也就是圆锥体切面角度大概为30°。
大概完成的时候，被削的表皮为2cm长，露出的笔芯部分0.5cm。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SeQYzaIDvHI/AAAAAAAAH%5Cnw/BMxhZ7QLgz4/s320/pencil%5Cn0.GIF" alt="图"></img>
\n 然后是削笔芯，先在圆柱体的两边削出平行（渐进微斜）的两个平面，尖端厚度大概为0.15cm (1.5mm)。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SeQZa%5Cno1x9I/AAAAAAAAH%5Cn4/JWnbaXCX2QE/s320/pencil%5Cn1.GIF" alt="图"></img>
\n 再把笔尖顶端的一侧削（刮）出一点弧度，以便于书写和素描。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SeQZ23fOCMI/AAAAAAAAH%5CnA/L5qqNshtEEs/s320/pencil%5Cn2.GIF" alt="图"></img>
\n 最后在稿纸上试笔，顺便打磨一下笔尖两侧，使之更便于使用就可以了。
笔尖平时一般不用削，用的时候就可以把笔尖磨成舒适的形状，直到笔尖变短。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SeQ6eRCn8aI/AAAAAAAAH%5CnI/P1GGYKmZR4Y/s400/90414%5Cn151043.jpg" alt="图"></img></p>
<p>p.s. 1. 不知道白色笔芯的铅笔用来华什么，一般都用白纸，而且她也不能遮盖掉其他颜色，
不然用做橡皮功能也不错。
p.s. 2. 文具店的阿姨也在讲求用户体验呢，正准备装修外面的广告招牌，
对店里放笔的盒子的设计细节也有研究。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[电梯按钮设计]]></title>
            <link>https://hotoo.github.io/blog/post/lift-button-design</link>
            <guid>189</guid>
            <pubDate>Wed, 08 Apr 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="电梯按钮设计">电梯按钮设计<a aria-hidden="true" href="#电梯按钮设计">#</a></h1>
<p>\n 外面选择“上”或“下”的按钮换成“开门”，这样外面也可以中断自动关闭的电梯门，
并增加选择楼层按钮。这样电梯系统可以预知各个起始楼层和目标情况，
可以结合历史数据合理调整运转过程，对用户来说，也不必都挤在电梯里忙着（或忘记）选择目标层；
\n 选择“上”、“下”以及楼层的按钮可以取消选中。建议如下：当前被选中，则按一下取消选中，否则选中。
目前有一些稍人性化的电梯可以取消操作，但是要按N下，而一般用户又不知道N等于几？
其实按一下就够了，不过避免误操作，连续按两、三下取消也可以，并在旁边给出提示；
\n 里面保留选择上、下和楼层按钮（用户可以中途改变目标），但是选择楼层的按钮应该放到开、
关门按钮的下面，方便儿童和残障人士使用（开、关门是自动的，影响不大）。</p>
<p>这个改造成本不知道算不算大，每一层都需要增加选择楼层的按钮，不过这对用户和系统都是有利的，
为电梯系统设计的合理也做了准备。我觉得这是未来电梯的最低配置。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[笔试后双方最好能当面讨论题解]]></title>
            <link>https://hotoo.github.io/blog/post/after-written-examination</link>
            <guid>191</guid>
            <pubDate>Thu, 26 Mar 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="笔试后双方最好能当面讨论题解">笔试后双方最好能当面讨论题解<a aria-hidden="true" href="#笔试后双方最好能当面讨论题解">#</a></h1>
<p>最近有好几次进阿里集团的笔试经验，有一个小体会：笔试后招聘方和应聘方最好能一起交流讨论题解
（记得学校考试的时候，对题目有疑问时可以举手提问，老师也有出错题的时候，但是考场上发现后会立即处理。
不过由于笔试时间短，出现意外再改的话时间会很仓促，所以建议在笔试后讨论，题可以先按照“常理”解答）。</p>
<p>前两次分别在 <a href="https://ued.taobao.com/" target="_blank" rel="noopener noreferrer">淘宝UED</a> 和 <a href="https://www.alimama.com/" target="_blank" rel="noopener noreferrer">阿里妈妈</a>
的笔试题里，有一道很相似的题：给数值对象（Number）扩展一个原型方法，
将数值格式化为指定长度的字符串（另外还有一个条件，淘宝UED给的是“能指定格式最好”，
阿里妈妈则是“能指定进制最好”）。</p>
<p>淘宝UED：
想到数值可能是小数，但题目没有知道小数保留长度等条件，这里只考虑整数位。</p>
<pre><code>Number.prototype.format = function(len, format){
  var a=this.toString().split(&quot;.&quot;), l=a[0].length;
  if(l&gt;=len) return a.join(&quot;.&quot;);
  return new Array(len\nl+1).join(&quot;0&quot;)+a[0] + (a[1]?&quot;.&quot;+a[1]:&quot;&quot;);
};
</code></pre>
<p>阿里妈妈：
同样有小数问题，而且小数转进制的话也有特殊的地方，这里忽略小数。</p>
<pre><code>Number.prototype.format = function(len, dem){
  var s = this.toString(dem), l=s.length;
  if(l&gt;=len) return s;
  return new Array(l\nlen+1).join(&quot;0&quot;) + s;
};
</code></pre>
<p>好在两个部门笔试后都有相关讨论，对这一问题做了及时的初步探讨。</p>
<p>今天又去参加了 <a href="https://china.alibaba.com/" target="_blank" rel="noopener noreferrer">阿里巴巴</a> 的笔试，这次的题没有重复的，
但是也有一个问题压轴题。</p>
<p>大意是用CSS控制3个DIV，布局如下图（图是随手画的，不计较大小比例）：</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/ScpP%5CnIbKQOI/AAAAAAAAH94/2CpARReFJww/s320/Alibaba%5CnCSS.jpg" alt="图"></img></p>
<p>当时解答的时候，在我看来，似乎是只给3个兄弟关系的div，没有辅助标记，让写css控制布局。</p>
<p>css虽不是我所最擅长，但是这个布局还是可以做出来的，但是难点只在于不使用辅助标记，哪怕是div。
当时我的解法如下（这里是调试后正确的代码，当时思想相同，但代码没有写完整，也没有经过调试验证）：</p>
<pre><code>#box0{border:1px solid #f00;width:200px;height:400px;margin\nbottom:10px;}
#box1{border:1px solid #0f0;width:200px;height:250px;}
#box2{border:1px solid #00f;width:600px;height:650px;position:relative;top:\n664px;left:210px;}
</code></pre>
<pre><code>&lt;div id=&quot;box0&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;box1&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;box2&quot;&gt;&lt;/div&gt;
</code></pre>
<p>虽然效果基本相同，而且没有使用辅助标签，但总觉得有点ugly，因为这里的区域尺寸都是固定像素的，
所以较好控制，当遇到未知高度时，#box2的top就不知道要设置为多少了，还是加一个辅助标签简单灵活。</p>
<p>如果可以使用辅助标记，我的题解如下：</p>
<pre><code>#box{float:left;width:200px;border:0px solid #000;}
#space0{width:200px;height:400px;border:1px solid #f00;margin\nbottom:10px;}
#space1{width:200px;height:250px;border:1px solid #0f0;}
#space2{width:600px;height:650px;float:left;border:1px solid #00f;margin\nleft:10px;}
</code></pre>
<pre><code>&lt;div id=&quot;box&quot;&gt;
  &lt;div id=&quot;space0&quot;&gt;&lt;/div&gt;
  &lt;div id=&quot;space1&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&quot;space2&quot;&gt;&lt;/div&gt;
</code></pre>
<p>还有一个问题是，因为有边框和间隔的关系，左右两个区域是无法上下对齐的。
另外实际应用中还要考虑到清除浮动，父级元素等情况。</p>
<p>当时有想过打破（可能是自己臆想的）规则，用辅助div实现，但是由于尝试在规则之中实现，
结果用了过多的时间，还答的一塌糊涂。</p>
<p>由于这次有多人一同笔试，而且时间很晚（预约18:30分），无法安排讨论，我对这道题也耿耿于怀，
回来请教我那 <a href="https://www.hxblog.net/" target="_blank" rel="noopener noreferrer">牛逼的朋友</a>，第一选择也是使用辅助div。
不知道阿里巴巴这道题的作者是怎么想的，难道是故意的？</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[由邮件排序想到的]]></title>
            <link>https://hotoo.github.io/blog/post/idea-from-email-srot</link>
            <guid>190</guid>
            <pubDate>Sun, 15 Mar 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="由邮件排序想到的">由邮件排序想到的<a aria-hidden="true" href="#由邮件排序想到的">#</a></h1>
<p>目前的电子邮件系统，均是使用倒序列出邮件列表，最新的邮件总是在第一封。
这样做也并没有什么不好，不过这是最好的排列方式吗？</p>
<p>新邮件很容易将较早的邮件挤到下面甚至是后面的页面中，导致最先收到的邮件反而最后被看到，
这就出现了公平性问题，当然并不是先到的邮件就一定要先看，甚至邮件被直接无视也有可能。
而另一个问题是，同一个人连续发了多封相关邮件，这就出现了错误阅读顺序的问题，
如果是最后一封修正前面错误的，而最后一封又有全文引用的话，看这最后一封就可以了，
但如果没有引用呢，不看前面的邮件确实会摸不着头脑（Gmail的会话功能对这一问题处理较好）。</p>
<p>一般来说，有效率的人不会在收件箱保留过多未读邮件，所以收件箱邮件被分页的情况会比较少见
（受欢迎的收件人例外），所以按顺序排序是个不错的选择。</p>
<p>另外如果收件箱或者存档箱中确实需要分页该如何排序？我的想法是“总倒序，分顺序”，
即总体数据是按倒序排列的，而被分页的页面则使用顺序排列显示。
效果：第一页就是最后一页，而显示页每一封邮件则按顺序排列。</p>
<p>后来在 <a href="https://www.verycd.com/" target="_blank" rel="noopener noreferrer">VeryCD</a> 看到一个更好的方案：所有数据按顺序排列，
但是默认（首次）显示的是最后一页。细节上可以有一个更好的改进：默认页将尽可能多的显示内容。
例如默认每页显示 50条评论，当总共有 60条评论时，默认显示第 2页，而第 2页按顺序排列显示 50条，
第一页显示 10条。</p>
<p>当然最好的情况是综合类似Gmail会话功能的方式，将相同主题归为同一个会话中，
这类似于Wordpress的一个评论插件（效果参看 <a href="https://www.awflasher.com/blog/archives/1716#awcomment" target="_blank" rel="noopener noreferrer">aw's blog</a>，
新版 Wordpress 已经内置该功能）。</p>
<p>个人意见综述：</p>
<p>\n 收件箱邮件列表完全使用顺序排列。
先到先被看，这样我就不会因为希望得到重视，
在周日写好的邮件，却等到周一才发出去了；
处理较早有邮件也合乎常理。
\n 评论、留言、邮件存档箱使用顺序排序，默认显示最后一页。
这样的话，像 Wordpress 这样使用英文语言，放在底部左侧的 Older Posts
也不会觉得别扭了。</p>
<p>p.s. 另外发现 draft.blogger.com 的自动保存还是很人性化的，不是使用定时自动保存，
在用户输入过程中不会瞎保存影响用户，而是在输入停顿时才自动保存。
这有点类似我的节奏感知器上运用的思想。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[让对方介绍一下工作的情况，对方对现在的工作有什么看法。]]></title>
            <link>https://hotoo.github.io/blog/post/after-nterview</link>
            <guid>193</guid>
            <pubDate>Tue, 10 Mar 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="淘宝应聘后记">淘宝应聘后记<a aria-hidden="true" href="#淘宝应聘后记">#</a></h1>
<p>前段时间在北京做项目，期间看到一篇关于
"<a href="https://dancewithnet.com/2009/02/17/how%5Cnto%5Cnmake%5Cna%5Cnresume%5Cnof%5Cnf2e/" target="_blank" rel="noopener noreferrer">如何做好一份前端工程师的简历？</a>"，
又在 blueidea 看到一些感兴趣的招聘帖，就参照着简要写了一份简历，并随手投了一些。</p>
<p>口碑 UED 因为已经招好了人，就帮我转投给了淘宝 UED（其实好像我本身也有投）。</p>
<p>后来就接到淘宝 UED 部门的面试电话，由于身在外地，以及一些特殊原因，我不能立即赶回杭州面试，
结果一直拖着，好在最后有hr玄渡给我留了联系电话，让我可以回杭州后直接联系。</p>
<p>昨日(3/9)打电话给玄渡，约好今天(3/10)10点左右去面试，他还特地发来邮件邀请函。
结果我却十分遗憾的迟到了10多分钟（按10点整计算）。</p>
<p>前台给了一份简历表让填，这是我没想到的，因为之前包括网上的网页简历和电子档附件给
小马的电子简历都有事先发过来，我想淘宝应该有打印件，不过这也在情理之中，是我太山寨了。</p>
<p>我虽然也算是久经沙场，但是现在竟拿不稳笔杆。。</p>
<p>忐忑不安的填好简历，过了有一段时间，圆心才送来一份笔试题，3页总共7题30分钟时间。</p>
<p>这次的笔杆跳得更厉害，我甚至怀疑过几天我自己是否能看懂。</p>
<p>好在题不是很难，用了不到一半的时间就做完了。为了缓解压力，就走到大厅的电子屏前
看中国地图上闪烁的圆点。</p>
<p>面试我的有三个人，小马，圆心和正淳，算是技术调查，主要是探讨简历和笔试内容。
不过我的准备真的很不足（其实也没有专门做准备，都是平时的积累），结果有不少问题
我答不上来，比如说标签语义化，em是做什么用的，这些特殊的标签我还真是用的少，
而且我回来查了一下 XHTML 和标签语义化的资料，发现我掌握的实在太少，还有js和框架的内容，
我也答的支支吾吾，虽然我并不是不知道，但老是思维中断，连数组的 push, pop 都没想起来。</p>
<p>还有让我给自己的js,css,x/html程度打分，我很恬不知耻的给自己掌握的js和x/html打95分，
在我看来，越往上，要加分越难，所以这相差的5分也是一个难以逾越的高度。
但是事后想起来，自己真实的分数差不多应该是js 80分，x/html 70分。
css则打75分也有点偏高，应该大概是65分，。其实在回答这样的问题前，要先问清楚标准，
给出几个“标杆”，如60分和100分各是什么程度？对方能给出其自身的打分最好。
如果按自己的单方面标准或者根本不经过大脑，则很容易高估自己。</p>
<p>说到我的性格，应该是内外各半，或者稍向内偏一点（在我看来这是缺点，我也有努力）。
缺点的话，有朋友说我心思太细密，有敏感的嫌疑，也有说我太实在，直性子，冲动。
优点则说我总体上是好的，待人诚恳，热情，有上进心，勤劳，是个好人。我自己则觉得偏内向了点。</p>
<p>最后我也象征性的回问了几个问题，因为还不是淘宝员工，也不好问太内部的问题。
现在想想，是应该事先想好几个有质量一点的问题。例如：</p>
<h1 id="对我的简历有什么看法">对我的简历有什么看法；<a aria-hidden="true" href="#对我的简历有什么看法">#</a></h1>
<h1 id="对我的笔试有什么见解给打个分">对我的笔试有什么见解，给打个分；<a aria-hidden="true" href="#对我的笔试有什么见解给打个分">#</a></h1>
<h1 id="自己给对方的印象如何">自己给对方的印象如何；<a aria-hidden="true" href="#自己给对方的印象如何">#</a></h1>
<h1 id="让对方介绍一下工作的情况对方对现在的工作有什么看法">让对方介绍一下工作的情况，对方对现在的工作有什么看法。<a aria-hidden="true" href="#让对方介绍一下工作的情况对方对现在的工作有什么看法">#</a></h1>
<p>已经12点半，hr已经去吃饭，便约我下午1点半复试（主要是和hr谈）。</p>
<p>随便扒了几口饭，提前来到淘宝大厅。</p>
<p>玄渡人不错，从电话里都能感觉出来，很热情，说话也字正腔圆。</p>
<p>大概因为经过上午的历练，也和玄渡个人有关，一对一的谈话中我再也没有感到紧张，
但是却把实话一句不漏的说了出来，被玄渡的笔记了个正着。</p>
<p>说是一周内给答复，不知道是不是委婉的拒绝，听天由命吧，自己准备的也不算太好。
但是如果错过这次，我就再也没有这样的机会了吧。</p>
<p>\n\n
闲耘 (xianyun.org)
如果自以为了不起，那一定是高估了自己，或者是给自己定的标准过低。
Sent from: Hangzhou 33 China.</p>
<p>blog:datetime=2009/3/10 19:33:33:tags=</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[JavaScript 无块级作用域]]></title>
            <link>https://hotoo.github.io/blog/post/javascript-vars-scope</link>
            <guid>192</guid>
            <pubDate>Tue, 06 Jan 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-无块级作用域">JavaScript 无块级作用域<a aria-hidden="true" href="#javascript-无块级作用域">#</a></h1>
<p>最近在做一系列JavaScript压缩工具，语法压缩，语义压缩，字符串压缩均有涉及（p.s.有趣的是，
压缩变量名之类的“有损压缩”不影响代码执行，但是字符串压缩这样的“无损压缩”却总是需要解压消耗）。</p>
<p>在实现压缩局部变量名时，最初的实现是将 if/else, for/in, do/while, switch/case/default,
try/catch/finally, with和Object实例对象（后面统称为“块级作用域”）与function一样，
都作为独立的作用域，但是测试发现在JavaScript中并不是这么回事。</p>
<p>尝试着在块级作用域里声明定义变量：</p>
<pre><code>if(true){
var bool=true;
}
document.write(bool); // output:true
</code></pre>
<p>会发现输出true，而且不论嵌套多深，也不论使用任何块级作用域进行嵌套，最后变量
依然如同在调用处之前，而且同级的作用域中定义的一样；值为在此之前，在块级作用域中所做改变的结果。
注意：如果块级作用域未被执行，则其中声明定义的变量会被声明（var name），但不被定义
（即未被初始化，此时name为undefined，引用name时不抛异常）。</p>
<pre><code>if(false){var bool=true;}
document.write(bool); // output:undefined
</code></pre>
<p>之前虽知道，IE里for(var i=0;...)里定义的i，在for之外也是可以使用的，但是现在才知道这种情况更为猖獗，
大出我的意料之外，而更意外的是，IE 7(IE6?), Firefox 3(FF1,FF2?), Opera 9, Chrome 1, Safari 3表现均丝毫不差。</p>
<p>虽然与某些编程规范不同，但是js就是这样了，唉。早知道这样，压缩变量名这部分也就不用那么费劲了，只得重写了。</p>
<p>另外还有一些JavaScript作用域方面的文章：
[<a href="https://www.blueidea.com/tech/web/2007/4855.asp" target="_blank" rel="noopener noreferrer">https://www.blueidea.com/tech/web/2007/4855.asp</a> JavaScript中的作用域]，好像是realazy翻译的，
文章很好，虽然有点文不对题（主要阐述this的作用域链问题）。
[<a href="https://www.cnblogs.com/3zfp/archive/2008/10/24/528644.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/3zfp/archive/2008/10/24/528644.html</a> js变量作用域及可访问性的探讨]，
详细介绍了各种变量的作用域及其可访问性问题。</p>
<p>附A 测试代码：</p>
<pre><code>// Global Scope
if (true){
  var v10 = true;
}else {
  var v00 = false;
}
document.write(&quot;v10 : &quot;+v10+&quot;&lt;br /&gt;&quot;);
document.write(&quot;v00 : &quot;+v00+&quot;&lt;br /&gt;&quot;);
document.write(&quot;&lt;hr /&gt;&quot;);

// Function Scope
function functionScopes(){
  if (true){
      // 以下均执行
      var v11 = true;

      do{
          var v12 = true;
      }while (false);

      while (true){
          var v13 = true;
          break;
      }

      switch (1){
      case 1:
          var v14 = true;
      default:
          var v15 = true;
      }

      try{
          var v16 = true;
          throw new Error(&quot;&quot;);
      }catch(e){
          var v17 = true;
      }finally{
          var v18 = true;
      }

      for (var v19=0; v19&lt;1; v19++){
          var v1a=true;
      }

      with(v11){
          var v1b = true;
      }

      function inn1(){
          var inn11 = false;
      }
  }else {
      // 以下均未执行
      var v01 = false;

      do{
          var v02 = false;
      }while (false);

      while (false){
          var v03 = false;
      }

      try{
          var v06 = true;
          throw new Error(&quot;&quot;);
      }catch(e){
          var v07 = true;
      }finally{
          var v08 = true;
      }

      switch (1){
      case 1:
          var v04 = true;
      default:
          var v05 = false;
      }

      for (var v09=0; v09&lt;1; v09++){
          var v0a=true;
      }

      with(v01){
          var v0b = true;
      }

      function inn0(){
          var inn01 = false;
      }
  }
  document.write(&quot;v11 : &quot;+v11+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v12 : &quot;+v12+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v13 : &quot;+v13+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v14 : &quot;+v14+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v15 : &quot;+v15+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v16 : &quot;+v16+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v17 : &quot;+v17+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v18 : &quot;+v18+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v19 : &quot;+v19+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v1a : &quot;+v1a+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v1b : &quot;+v1b+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;&lt;hr /&gt;&quot;);
  document.write(&quot;v01 : &quot;+v01+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v02 : &quot;+v02+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v03 : &quot;+v03+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v04 : &quot;+v04+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v05 : &quot;+v05+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v06 : &quot;+v06+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v07 : &quot;+v07+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v08 : &quot;+v08+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v09 : &quot;+v09+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v0a : &quot;+v0a+&quot;&lt;br /&gt;&quot;);
  document.write(&quot;v0b : &quot;+v0b+&quot;&lt;br /&gt;&quot;);

  document.write(&quot;&lt;hr /&gt;&quot;);
  try{alert(inn11);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
  try{alert(inn01);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
}
functionScopes();

document.write(&quot;&lt;hr /&gt;&quot;);
try{alert(v11);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v12);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v13);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v14);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v15);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v16);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v17);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v18);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v19);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v1a);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v1b);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}

try{alert(v01);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v02);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v03);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v04);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v05);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v06);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v07);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v08);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v09);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v0a);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
try{alert(v0b);}catch(e){document.write((e.message||e)+&quot;&lt;br /&gt;&quot;);}
</code></pre>
<p>附B 测试结果（IE 7, FF 3, Opera 9, Safari 3, Chorme 1均同）：</p>
<pre><code>    v10 : true
    v00 : undefined
    v11 : true
    v12 : true
    v13 : true
    v14 : true
    v15 : true
    v16 : true
    v17 : true
    v18 : true
    v19 : 1
    v1a : true
    v1b : true
    v01 : undefined
    v02 : undefined
    v03 : undefined
    v04 : undefined
    v05 : undefined
    v06 : undefined
    v07 : undefined
    v08 : undefined
    v09 : undefined
    v0a : undefined
    v0b : undefined
    &#39;inn11&#39; 未定义
    &#39;inn01&#39; 未定义
    &#39;v11&#39; 未定义
    &#39;v12&#39; 未定义
    &#39;v13&#39; 未定义
    &#39;v14&#39; 未定义
    &#39;v15&#39; 未定义
    &#39;v16&#39; 未定义
    &#39;v17&#39; 未定义
    &#39;v18&#39; 未定义
    &#39;v19&#39; 未定义
    &#39;v1a&#39; 未定义
    &#39;v1b&#39; 未定义
    &#39;v01&#39; 未定义
    &#39;v02&#39; 未定义
    &#39;v03&#39; 未定义
    &#39;v04&#39; 未定义
    &#39;v05&#39; 未定义
    &#39;v06&#39; 未定义
    &#39;v07&#39; 未定义
    &#39;v08&#39; 未定义
    &#39;v09&#39; 未定义
    &#39;v0a&#39; 未定义
    &#39;v0b&#39; 未定义
</code></pre>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[尊严]]></title>
            <link>https://hotoo.github.io/blog/post/dignity</link>
            <guid>194</guid>
            <pubDate>Fri, 02 Jan 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="尊严">尊严<a aria-hidden="true" href="#尊严">#</a></h1>
<p>\n</p>
<p>看了Twitter上有推李普曼的《<a href="https://www.my1510.cn/article.php?557d98abd63d8e1a" target="_blank" rel="noopener noreferrer">没有感到的尊严</a>》
一文，想起自己也有类似的经历。</p>
<p>高中时在外面读书，和一个在我看来很赖皮很讨厌的同学关系不合，一天他挑衅被我回击，
晚上他叫了一个人过来跟我“讲道理”，寝室恰巧没电，没看清对方的面容，但是身体不比我弱。
当他们把我逼到墙角时，我借助墙壁的力量将对方踢了出去，不知道对方是不是本身就没什么底气，
叫了一声“不要这么嚣张”之后就再也没有回来。如果对方狠一点，我可能就要吃亏，
但是如果当时我软一点，我在这个讨厌鬼面前就永远都抬不起头。</p>
<p>当然我并不总是那么“英勇”，学校当地有一个死胖子同学老挑衅我，我就回敬了一句，
并且不礼貌的骂了对方。死胖子好像抓到把柄了一样，老要我道歉，在寝室里我们还打了一架，
当时我被打的很惨，不过没有道歉，上课的时候他总坐到我旁边捣乱影响我学习。
终于有一节课上我再也容受不了，向他低了头。到现在我还对这事耿耿于怀，想当时如果不低头会怎么样？</p>
<p>为什么老是想到打架呢？当对方无理取闹时，暴力确实是直接有效的解决办法呢，如果能比对方更暴力的话。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[开放篮球场地.地标工程]]></title>
            <link>https://hotoo.github.io/blog/post/open-basketball-field</link>
            <guid>195</guid>
            <pubDate>Fri, 02 Jan 2009 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="开放篮球场地地标工程">开放篮球场地.地标工程<a aria-hidden="true" href="#开放篮球场地地标工程">#</a></h1>
<p>作为业余篮球爱好者，作为他乡游子，每到一个陌生的地方，都想尽快找到一个能施展球技、
或者仅是活动一下筋骨的场地。就地解决当然也可以，但是如果有自由开放的美好世界，为什么不加入进去呢？</p>
<p>一般来说，大多数开放的篮球场地都在学校里（大学最多，中小学一般不对外开放），
有一些公益场所也有简易的设施，所以希望能有一些学生朋友能给予帮助，我将尽力争取得到帮助。</p>
<p>基于这样的想法，我展开了一个“开放篮球场地.地标工程”的想法，为广大篮球爱好者服务。
首先做好了几个我所知道的地标：<a href="https://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketballField.All.in.One.kmz" target="_blank" rel="noopener noreferrer">https://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketballField.All.in.One.kmz</a></p>
<p>将地址复制粘贴到Google Maps（谷歌地图）搜索栏，回车即可；或是下载到本地，使用Google Earth打开。</p>
<p>全国现有完整地标(All in One)：
<a href="https://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketballField.All.in.One.kmz" target="_blank" rel="noopener noreferrer">https://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketballField.All.in.One.kmz</a></p>
<p>杭州：
<a href="https://labs.xianyun.org/OpenBasketballField/landmark/HangZhou.kmz" target="_blank" rel="noopener noreferrer">https://labs.xianyun.org/OpenBasketballField/landmark/HangZhou.kmz</a></p>
<p>北京：
<a href="https://labs.xianyun.org/OpenBasketballField/landmark/BeiJing.kmz" target="_blank" rel="noopener noreferrer">https://labs.xianyun.org/OpenBasketballField/landmark/BeiJing.kmz</a></p>
<p>另有在线地标，直接Google Maps上编辑即可（所有登录了Google账户的网友都可以编辑）</p>
<p>主要定位开放的篮球运动场地，默认为室外，尤其是免费的场地，室内或收费场地另附说明。</p>
<p>标题格式：地名[.开放封闭未知][.室外室内][.免费收费]</p>
<p>使用默认图标（期待志同之士提供更形象的图标）
红色不带圆点：
蓝色不带圆点：
紫色不带圆点：开放程度未知
红色带圆点：开放，人气旺
蓝色带圆点：开放，人气一般
紫色带圆点：
黄色不带圆点：封闭</p>
<p>以卫星地图为准。所有地标和文字描述仅作参考，欢迎修正（所有登录了Google帐号的朋友都可以进行修订）。</p>
<p>在线地标列表：
<a href="https://maps.google.com/maps/user?uid=108314985261981078822&amp;hl=en" target="_blank" rel="noopener noreferrer">https://maps.google.com/maps/user?uid=108314985261981078822&hl=en</a></p>
<p>北京：
<a href="https://maps.google.com/maps/ms?hl=en&amp;ie=UTF8&amp;lr=lang%5Cnzh%5CnCNlang%5Cnzh%5CnTW&amp;oe=UTF8&amp;msa=0&amp;msid=108623690175354072173.00045480d1fa17e9056ac" target="_blank" rel="noopener noreferrer">https://maps.google.com/maps/ms?hl=en&ie=UTF8&lr=lang\nzh\nCNlang\nzh\nTW&oe=UTF8&msa=0&msid=108623690175354072173.00045480d1fa17e9056ac</a></p>
<p>杭州：
<a href="https://maps.google.com/maps/ms?hl=en&amp;ie=UTF8&amp;lr=lang%5Cnzh%5CnCNlang%5Cnzh%5CnTW&amp;oe=UTF8&amp;msa=0&amp;msid=108623690175354072173.00045f6778d694e0d3cc3" target="_blank" rel="noopener noreferrer">https://maps.google.com/maps/ms?hl=en&ie=UTF8&lr=lang\nzh\nCNlang\nzh\nTW&oe=UTF8&msa=0&msid=108623690175354072173.00045f6778d694e0d3cc3</a></p>
<p>blog:datetime=2010/10/25 13:57:33:tags=Maps,Sports</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Javascript String 方法效率大比拼]]></title>
            <link>https://hotoo.github.io/blog/post/javascript-string</link>
            <guid>197</guid>
            <pubDate>Mon, 29 Dec 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="javascript-string-方法效率大比拼">Javascript String 方法效率大比拼<a aria-hidden="true" href="#javascript-string-方法效率大比拼">#</a></h1>
<p>最初是通过 <a href="https://blog.csdn.net/meizz" target="_blank" rel="noopener noreferrer">梅子</a>（<a href="https://www.meizz.com/" target="_blank" rel="noopener noreferrer">梅花雪</a>）
关于大型字符串拼接效率（<a href="https://blog.csdn.net/meizz/archive/2005/12/14/552260.aspx" target="_blank" rel="noopener noreferrer">1</a>，
<a href="https://blog.csdn.net/meizz/archive/2006/01/04/569805.aspx" target="_blank" rel="noopener noreferrer">2</a>）的研究得到启发，
最近又看到 never\nonline 的 <a href="https://www.never%5Cnonline.net/blog/article.asp?id=259" target="_blank" rel="noopener noreferrer">从 trim 原型函数看js正则表达式的性能</a>，
里面有介绍正则表达式效率陷阱等问题，并提出解决方法。
我向来对这些鸡毛蒜皮感兴趣，也开始对大型字符串各种方法实现的效率进行比较，
并尝试提高这些方法的效率。</p>
<h2 id="大型字符串拼接">大型字符串拼接<a aria-hidden="true" href="#大型字符串拼接">#</a></h2>
<p><a href="https://blog.csdn.net/meizz/archive/2005/12/14/552260.aspx" target="_blank" rel="noopener noreferrer">如梅子所言</a>，
使用数组的join方法确实是最好的实现，可以根据这个思路设计StringBuilder, StringBuffer类。</p>
<h2 id="大型字符串trim">大型字符串trim<a aria-hidden="true" href="#大型字符串trim">#</a></h2>
<p>其实never\nonline在他的文章里有一些说的不准确的地方，代码也不算很精炼。
既然这是鸡毛蒜皮的小事，这些零碎东西当然要斤斤计较了。
我很久以前有收集到这样一些实现，I：</p>
<pre><code>String.prototype.trim = function(){
return this.replace(/(^\s+)(\s+\n)/g, &#39;&#39;);
};
</code></pre>
<p>为了避免正则表达式使用括号带来的消耗，可以写成这样，II：</p>
<pre><code>String.prototype.trim = function(){
    return this.replace(/(?:^\s+)(?:\s+\n)/g, &#39;&#39;);
};
</code></pre>
<p>另外有一套实现是这样的，III：</p>
<pre><code>String.prototype.lTrim = function(){
    return this.replace(/^\s+/, &#39;&#39;);
};
String.prototype.rTrim = function(){
    return this.replace(/\s+\n/, &#39;&#39;);
};
String.prototype.trim = function(){
    return this.lTrim().rTrim();
};
</code></pre>
<p>其实调用函数也会多少有一点消耗，写成这样或许会快一点点（开个玩笑，这样写会带来
一些冗余代码，这时候就需要基于效率（时间）、代码量（空间）和可维护性方面的考量了），IV：</p>
<pre><code>String.prototype.trim = function(){
return this.replace(/^\s+/, &#39;&#39;).replace(/\s+\n/, &#39;&#39;);
};
</code></pre>
<p>后来我对正则表达式有了更多的了解，知道了贪婪与非贪婪匹配，于是自作聪明写了这一段：</p>
<pre><code>String.prototype.trim = function(){
return this.replace(/^\s\n(.\n?)\s\n\n/, &quot;\n1&quot;); // 两端空白字符贪婪匹配，中间字符非贪婪匹配。
};
</code></pre>
<p>我曾经为这段代码自鸣得意了好长一段时间，不过后来想到点号不包括换行符，字符串中间有换行符时，返回值就不正确了，于是不情愿的改成这样（多行模式效率也很低），V：</p>
<pre><code>String.prototype.trim = function(){
return this.replace(/^\s\n((?:.\n)\n?)\s\n\n/, &quot;\n1&quot;);
};
</code></pre>
<p>谁知，这样的代码遇到大家伙时效率会一落千丈，哎，失败。</p>
<p>原以为String.replace方法比String.substr、String.substring效率低，于是想，只使用正则表达式获得两头（或者一头）的索引位置，然后使用substring方法取出子串，VI：</p>
<pre><code>String.prototype.trim = function(){
    var l=this.length;
    /^[\s]\n/.test(this);
    // /(?=[^\s])/.test(this);// \n\n never\nonline
    var s = RegExp.lastIndex;
    if(1==s &amp;&amp; !Char.isBlank(this.charAt(0)))s=0;
    if(s==l){return &#39;&#39;;}
    // /\s\n\n/.test(this);
    // var e=RegExp.index;
    var e=\nlastIndexOf(function(c){return !Char.isBlank(c);});
    e=\n1==e?l:e+1;
    return this.substring(s,e);
};
</code></pre>
<p>而最土的方法，莫过于两头都使用循环获得索引了，VII：</p>
<pre><code>String.prototype.trim = function(){
    var f=function(c){return !Char.isBlank(c);};
    var l=this.length, s=this.\nindexOf(f), e=this.\nlastIndexOf(f);
    if(\n1==s)s=0;
    e= \n1==e?l:e+1;
    return this.substring(s, e);
};
</code></pre>
<p>代码里老是for啊for的一大串，为了节省字节，而且有可能的话，也准备再优化一下循环，
就实现了\nindexOf和\nlastIndexOf两个方法，可以传递一个返回boolean值的函数作为参数
（本来还想也支持正则表达式参数的，想想以前扩展indexOf和lastIndexOf方法后的效率，
就算了），这样就可以求得第一个非空白和最后一个非空白字符的位置了。</p>
<pre><code>String.prototype.\nindexOf = function(f){
    for(var i=0,c,l=this.length; i=0; i\n\n){
        c=this.charAt(i);
        if(f(c)){return i;}
    }
    return \n1;
};
String.prototype.\nlastIndexOf = function(f){
    for(var i=this.length\n1,c; i&gt;=0; i\n\n){
        c=this.charAt(i);
        if(f(c)){return i;}
    }
    return \n1;
};
</code></pre>
<p>至于说要扩展到支持更长子串和起始索引，以后有需要再说了（顺便说一下，子串越长，
有优化算法可以得到更高效率）。</p>
<p>另一个辅助方法：</p>
<pre><code>var Char = {
    isBlank:function(c){
        //return /\s/.test(c);
        return &#39; &#39;==c &#39;\t&#39;==c &#39;\r\n&#39;==c &#39;\n&#39;==c &#39;\r&#39;==c;
    }
};
</code></pre>
<p>到了永不在线(<a href="https://translate.google.com/translate%5Cnt#en%7Czh%5CnCN%7Cnever%5Cnonline" target="_blank" rel="noopener noreferrer">Google Translate翻译为</a>“永远在线”)的算法，VIII：</p>
<pre><code>String.prototype.trim = function(){
    var s = this.replace(/^\s+/, &#39;&#39;);
    var l=s.length, e=l;
    if(0==l){return &#39;&#39;;}
    for(var i=l\n1; i&gt;=0; i\n\n){
        if(!Char.isBlank(s.charAt(i))){
            e=i+1;
            break;
        }
    }
    return this.substring(0,e);
};
</code></pre>
<p>最初这个算法让我很兴奋，直觉上，感觉这样效率肯定要高，不过事实并不是这么简单。</p>
<p>说到这些实现的效率，无法一概而论，因为不同的字符串，它们的效率比也大不同，甚至异乎寻常。</p>
<p>影响trim方法效率的，主要与字符串的总长度，前面空白字符串长度，后面空白字符串长度，
以及前中后的比例有关。详细的效率对比表有时间再上，这里只简要提一下：</p>
<p>对于较小的字符串，各种实现都有不错的表现，而对于大型字符串，则实现III,
IV表现较为稳定，甚至可以处理超大型字符串（修正：之前有误写成I，II两个较为稳定）。</p>
<h2 id="大型字符串字节长度">大型字符串字节长度<a aria-hidden="true" href="#大型字符串字节长度">#</a></h2>
<p>即双字节长度为2。注意：这个提法其实也不正确，Javascript是使用Unicode字符集的，
所有的字符都（有可能）是双字节字符。将汉字等转换为双字节长度主要是为了某些应用。
最土的方法还是循环遍历所有字符，I：</p>
<pre><code>String.prototype.bytes = function(){
    var l=this.length, r=l, n=0xff;
    for(var i=l; i&gt;=0; i\n\n){
        if(this.charCodeAt(i)&gt;n){
            r++;
        }
    }
    return r;
};
</code></pre>
<p>这里判断字符是否双字节有很多方法，效率较高的之间相差（大概）不大。</p>
<p>另一种实现则看起来很轻灵，寥寥几行，II：</p>
<pre><code>String.prototype.bytes = function(){
return this.replace(/[^\x00\n\xff]/g,&quot;xx&quot;).length;
};
</code></pre>
<p>多动脑子，则想法愈多（也常把简单的事情复杂化），我想如果可以快速取得表达式
(双字节/单字节)匹配次数，两值相加应该比较高效，III：</p>
<pre><code>String.prototype.bytes = function(){
    return this.length+this.replace(/[\x00\n\xff]/g,&quot;&quot;).length;
};
</code></pre>
<p>IV：</p>
<pre><code>String.prototype.bytes = function(){
    return this.length+(this.match(/[^\x00\n\xff]/g)&quot;&quot;).length;
};
</code></pre>
<p>另外看到梅花雪用数组能提供字符串拼接速度，也想：把字符串split为数组，
不想对大型字符串而言，这split一步就慢得不行。</p>
<p>bytes方法的效率：使用Javascript脚本循环大型字符串（I），确实远不如内置的
replace方法（II）快，而使用正则表达式match方法（IV）又比replace方法（III）稍快，
排名第二。</p>
<h2 id="总结">总结：<a aria-hidden="true" href="#总结">#</a></h2>
<p>\n replace方法因匹配而被替换的子串愈长，效率愈低。
\n 根据目标字符串，选择合适的实现。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[汉化Family Tree Builder]]></title>
            <link>https://hotoo.github.io/blog/post/chinese-localization-family-tree</link>
            <guid>196</guid>
            <pubDate>Fri, 21 Nov 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="汉化family-tree-builder">汉化Family Tree Builder<a aria-hidden="true" href="#汉化family-tree-builder">#</a></h1>
<p>前文有言 <a href="family%5Cntree%5Cnbuilder%5Cnprofessional%5Cngenealgy%5Cnsoftware.md">理想的族谱软件Family Tree Builder</a> 说虽有中文站，
但是软件本身没有中文化，因为很喜欢并且很需要这款软件，就自己动手汉化了过来。</p>
<p><img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SSbaNcRhqkI/AAAAAAAAGp0/Y6WjfhFSPqg/s400/family+tree+builder.jpg" alt="pic"></img></p>
<p>汉化原理很简单：</p>
<p>\n 备份软件安装目录下，Lang子目录中的English.lang（也可以是其他国家的语言文件）。
\n English.lang其实属于一种属性文件（properties），将每一行的第二部分翻译成中文
（或合适的文本）即可。
\n 备份安装目录下，Res子目录中的English.bmp图片。
\n 制作一张32x28像素，bmp格式的中国国旗图片，命名为English.bmp，放到Res目录。
\n 启动程序，菜单“工具(Tools)”\n“选项(Options)”，
“名字(Names)”\n“Display people's names”设置为 <code>Last First (Armstong John)</code>，
即让姓氏(Last Name)放在名字(First Name)之前，符合中文习惯。
“日期(Dates)”，Day/Month/Year format 设置为 <code>%y%\n%m%\n%d%</code>，
“Month/Year format”设置为 <code>%y%\n%m%</code>。可以根据自己的习惯设置，
其中 <code>%m%</code> 是使用英文短格式，如Mon，在English.lang改为数字即可。</p>
<p>注意：部分文本不可以翻译为中文，如日期选择按钮类的，提示文本为中文时，显示乱码。
另外程序本身左侧的列表(List)的姓名列，中文也显示列表（好像所有List View都不支持中文）。</p>
<p>下载文件 <a href="https://code.google.com/p/familytreebuildercn/" target="_blank" rel="noopener noreferrer">托管在Google Code</a> 上，
同时支持SNV提交，有兴趣的朋友联系我，希望大家来共同完成。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Family Tree Builder:理想的族谱/家谱软件]]></title>
            <link>https://hotoo.github.io/blog/post/family-tree-builder-professional-genealgy-software</link>
            <guid>198</guid>
            <pubDate>Sat, 15 Nov 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="family-tree-builder理想的族谱家谱软件">Family Tree Builder:理想的族谱/家谱软件<a aria-hidden="true" href="#family-tree-builder理想的族谱家谱软件">#</a></h1>
<p>去年春节回家，老爸让我把家谱（族谱）放到电脑上，但当时家里不能上网，
手头又没有理想的家谱软件，只能把一些文本输入到电脑上。</p>
<p>后来又尝试使用树型结构（当时使用梅花雪树）临时模拟，但是族谱是一种双亲（甚至多亲：
[古代可同时]结婚多次）树型结构，使用普通的单亲树型结构就显得很别扭，
最后使用纯文本拼成一个简易版本。</p>
<pre><code>爷爷 + 奶奶        外公 + 外婆
     |                  |
  \n\n\n+\n\n\n\n+       +\n\n\n\n\n+\n\n\n
          |       |
         老爸 + 老妈
              |
        +\n\n\n\n\n+\n\n\n\n\n+
        |           |
     大儿子       二儿子
</code></pre>
<p>这个版本也算理想，但是涉及到详细资料，尤其是当这棵树变得更大而复杂，盘根错节时，
这个纯文本拼凑起来的双亲树就显得力不从心。</p>
<p>后来回杭州工作时，找了一些软件试用，大都不怎么理想（大概是我崇洋媚外的缘故，
国内确实还没看到什么让我觉得有脸拿出来使用的族谱作品），只是找到一个仅支持
联机使用的Flash版本：<a href="https://www.treemily.com/" target="_blank" rel="noopener noreferrer">中国传家宝</a>，
只能联机使用让我觉得很不方便，而更不方便的是
设计上有一些（大概）不合理，操作不便，并且速度也不行，让我满意的大概只有显示效果不错。</p>
<p>过了很长时间，零星的找找也没得到什么结果。</p>
<p>后来无意在VeryCD上看到一下族谱软件，是外国专业公司制作的产品，不过给人的感觉有点
太强而大的样子，而且收费挺贵。顺手又上Google搜寻一番，收获不小，这个市场貌似现在很活跃的样子。</p>
<p>于是就发现了这个相当理想的免费软件：<a href="https://www.myheritage.cn/" target="_blank" rel="noopener noreferrer">Family Tree Builder</a>
（这是它的 <a href="https://www.myheritage.com/" target="_blank" rel="noopener noreferrer">英文网站</a>），号称支持29中本地化语言（事实上也是如此）。
不过遗憾的是，虽然它有中文网站，但是软件本身却没有中文本地化版本，刚安装在Windows Server 2008
上时崩溃了好几次（大概是我没有摸清它的脾性），而且更糟糕的是程序左侧的List成员列表视图显示中文乱码。
不过它的优点也相当可观，免费，启动速度快，自动备份（崩溃后可以恢复），支持多国语言，视觉效果好，
操作方便，功能齐全，而且可以导入导出标准系谱数据格式gedcom，这里是它的
<a href="https://www.myheritage.cn/family%5Cntree%5Cnbuilder" target="_blank" rel="noopener noreferrer">中文官方介绍</a>，
传说是族谱学家级别的人士和专业软件设计专家创造出来的（事实上看起来应该也是如此），
适用于管理大型及小型的族谱。</p>
<p><img src="https://www.myheritage.cn/FP/Images/Screenshots/Screenshot7Small%5Cn320%5Cn258.JPG" alt="pic"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Firefox本地化及其切换]]></title>
            <link>https://hotoo.github.io/blog/post/firefox-localization</link>
            <guid>200</guid>
            <pubDate>Fri, 14 Nov 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="firefox本地化及其切换">Firefox本地化及其切换<a aria-hidden="true" href="#firefox本地化及其切换">#</a></h1>
<p>昨天用Firefox内置的下载管理器下载一个较大的文件，而且新搬来这边的网速慢到让我想起
令人怀念的大学时期（那时候的校园网，不是一般人能够忍受的），无意中我看到下载管理器里
当前下载的文件下显示着“第x小时，剩余x分钟”的提示（不超过一小时时，只显示“剩余x分钟”）。
看到这个提示，我当时有两种想法：</p>
<p>\n Firefox下载管理器的剩余时间计算方法比较有趣，将每小时的下载分段，
所以就有了第1小时，剩余20分钟的说法；
\n 翻译问题，实际应该是剩余1小时又20分钟的意思。</p>
<p>这两种理解方式都有其道理，而且在我最初看来，是各占 50% 的。</p>
<p>为了打消疑问，我Google，Baidu试了个遍，但是没有找到一条符合的记录，
于是又尝试问一些对Firefox有/无兴趣的朋友，以及mozine的Gtalk群友，
但是大伙都没有注意到这个，只能给个猜测的结果。</p>
<p>为了找到答案，就需要知道Firefox英文版是怎么说的，但是我还不想为此再装一个英文版Firefox，
那么怎么切换本地化语言呢，又是大肆搜罗一番，找到一些近似的，这里整理如下：</p>
<h2 id="切换方法-i">切换方法 I:<a aria-hidden="true" href="#切换方法-i">#</a></h2>
<p>\n about:config
\n general.useragent.locale由zh\nCN改为en\nUS。
（前提：Firefox/chrome/目录下有en\nUS.jar和en\nUS.manifest）</p>
<h2 id="切换方法-ii">切换方法 II:<a aria-hidden="true" href="#切换方法-ii">#</a></h2>
<p>\n <a href="https://releases.mozilla.org/pub/mozilla.org/firefox/releases/%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%AD%E8%A8%80%E5%8C%85(.xpi)%E3%80%82" target="_blank" rel="noopener noreferrer">https://releases.mozilla.org/pub/mozilla.org/firefox/releases/下载安装对应的语言包(.xpi)。</a>
\n 启用该语言包（安装后默认启用）并重启Firefox。</p>
<p>例如我的Firefox版本3.0.3，Windows，则语言包文件地址为：
<a href="https://releases.mozilla.org/pub/mozilla.org/firefox/releases/3.0.3/win32/xpi/en%5CnGB.xpi" target="_blank" rel="noopener noreferrer">https://releases.mozilla.org/pub/mozilla.org/firefox/releases/3.0.3/win32/xpi/en\nGB.xpi</a>
（粗体为Firefox对应的版本号）。</p>
<p>注意：<a href="https://releases.mozilla.org/pub/mozilla.org/firefox/releases/" target="_blank" rel="noopener noreferrer">https://releases.mozilla.org/pub/mozilla.org/firefox/releases/</a>
下的目录并不会列出xpi文件，将正确的版本号替换粗体部分，直接拷贝到地址栏回车即可。</p>
<p>安装并重启之后，可以看到Add\nons \n 语言页签下会列出刚安装的English(GB) Language Pack语言包，想撤回中文时，禁用此语言包，重启Firefox即可。</p>
<h2 id="iii">III:<a aria-hidden="true" href="#iii">#</a></h2>
<p>另外还有几个用来切换本地化语言的扩展，<a href="https://addons.mozilla.org/en%5CnUS/firefox/addon/356" target="_blank" rel="noopener noreferrer">Locale Switcher</a> 和
<a href="https://addons.mozilla.org/zh%5CnCN/firefox/addon/1333" target="_blank" rel="noopener noreferrer">Quick Locale Switcher</a>，
它们可以让Firefox直接在菜单栏切换语言。</p>
<p>言归正传，话说回来，切换为英文语言后，尝试大文件下载发现原文是类似于
<code>2 hours, 8 minutes remaining</code> 这样的提示，意思是剩余2小时8分钟。</p>
<p>Firefox 中文版的这个翻译确实不怎么样。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[PANDA-glGo，完美的围棋软件]]></title>
            <link>https://hotoo.github.io/blog/post/panda-glgo-the-perfect-igo</link>
            <guid>199</guid>
            <pubDate>Fri, 24 Oct 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="panda-glgo完美的围棋软件">PANDA-glGo，完美的围棋软件<a aria-hidden="true" href="#panda-glgo完美的围棋软件">#</a></h1>
<p>我的围棋水平虽然很差，但是这一点也不影响我对围棋的喜爱程度。
而今天意外的发现一款让我满意度达到100%的围棋软件，它就是
<a href="https://www.pandanet.co.jp/English/glgo/index.html" target="_blank" rel="noopener noreferrer">PANDA\nglGo</a>，
（这是它在 <a href="https://www.gnu.org/software/gnugo/gnugo.html" target="_blank" rel="noopener noreferrer">GNU</a> 和
<a href="https://ggo.sourceforge.net/" target="_blank" rel="noopener noreferrer">SourceForge</a> 上的地址，不过 sf 上已经过期）。</p>
<p><a href="https://www.pandanet.co.jp/English/glgo/images/glgoshot15%5Cnthumb.jpg" target="_blank" rel="noopener noreferrer">https://www.pandanet.co.jp/English/glgo/images/glgoshot15\nthumb.jpg</a></p>
<p>PANDA\nglGo是一个GUN自由软件，支持Windows，Linux和Macintosh平台，不论外观，还是内涵，
无一不是完美绝伦。PANDA\nglGo支持2D和3D的风格，界面简洁大方，操作方便。
可以设置棋盘背景图和更换棋子，支持多语种，包括中文。</p>
<p>PANDA\nglGo默认没有机器人，如果想要人机对战，需要另外下载GNU Go（解压至PANDA\nglGo安装目录即可，
也可以放在其他位置）。机器人跑起来一点都感觉不到慢，即使设置棋力为最高级别（机机对战除外），
至于算法是否高明，机器人棋力能达到什么程度，我不（需要）知道，目前我还没赢过。
可以设置机器人的棋力级别，棋盘大小（纵横数目）和对战让子目数。另外 PANDA\nglGo还支持网络对战，
或者观看他人对战。联机时，可以查看棋手级别等资料，正在进行的棋局。
可以这么说，PANDA\nglGo 不仅仅是一款围棋软件，更是一个围棋平台。</p>
<p><a href="https://www.pandanet.co.jp/English/glgo/manual/index.html" target="_blank" rel="noopener noreferrer">帮助文档</a> 很完整，只是缺少中文文档。</p>
<p>如果你也是围棋爱好者，这是不容错过的一款软件。好想找一份和这类似的中国象棋软件，
因为我的象棋水平比围棋稍好，可以坚持久一点。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[电子图书管理软件幻想]]></title>
            <link>https://hotoo.github.io/blog/post/dream-for-ebooks-manager</link>
            <guid>202</guid>
            <pubDate>Wed, 15 Oct 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="电子图书管理软件幻想">电子图书管理软件幻想<a aria-hidden="true" href="#电子图书管理软件幻想">#</a></h1>
<p>一直以来，稍微好点的电子图书管理软件是特别的少，而做很不错的更是少之又少，
要说真正让用户喜欢，或者至少还满意的，到目前为止，没有。</p>
<p>而与之功能相似，状态却截然相反的是，图片和音乐文件的管理软件却如此兴旺发达。</p>
<p>下面先介绍一下图片管理软件，它们大致有以下几个特点（这里以个人最偏爱的
<a href="https://picasa.google.com/" target="_blank" rel="noopener noreferrer">Picasa 3 Beta</a> 作参照）：</p>
<p>\n 看图。图片管理软件最好能（方便快捷的）阅读各种格式的图片。（Picasa 3的看图模块很炫很优秀，
半透明状态悬浮在窗口上，附有一些播放，翻转，标星，打开在Picasa中编辑等快捷功能。
不过Picasa对GIF动画支持很烂，甚至会毁掉动画的动态特性）
\n 管图。每一张图片都不是独立存在的，它们存在于一些相关/无关的相册中。
对于一个图片管理软件来说，对相册的管理能力尤为重要。
（Picasa可以动态扫描整个磁盘/指定目录的所以支持的图片，
还可以建立独立于存放目录物理路径之外的虚拟相簿功能，感觉就像管理你的家庭相册一样）
\n 搜图。搜索功能对于任何一个信息系统来说都必不可少，而对于图片搜索，还有一些有待探索的领域。
（以搜索著称的Google生产的Picasa自然有这个功能，虽然还有待提高）
\n 写图。这是对单张/多张图片进行微量/智能调整的高级特性。
这个可以交给专业的图片处理软件，对图片管理软件来说非必要，但是一定要提供快速定位到系统资源、
直接由这些专业的处理软件打开的特性。（Picasa有一些像改变色相，去除“红眼”这样的简单功能，
另外，和Google搜索的“手气不错”一样，Picasa也有这样自作主张的功能）</p>
<p>而我所期待的图书管理软件，就像上面列出来的这些特性一致：</p>
<p>\n 看书。软件最好能支持多种图书格式，因为现在的图书格式繁多，一一支持不太现实，
也没有必要，让管理者做好管理的事情就够了，当然还需要能够方便的定位资源，
并能与其他专业的看书软件配合。另外最重要的，是有一些读书计划方面的规划系统
（可以结合一些读书技巧/理论）。
\n 管书。每个人都会有自己的个人图书库，当这个库越来越多时，管理则是势必施行，
在管理方面，图书有它和图片的不同之处，比如分类（可以参考但不拘泥于图书馆的管理方式），
加一些现流行使用的小标签，图书的名称，ISBN，缩略图，作者等，软件最好，或者说最起码能像
Picasa 一样支持动态扫描指定位置的所有支持/指定格式的图书。
\n 搜书。并不是每个人都能够/需要看并记住所有收集的电子图书的，
在需要时快速定位的指定位置，或者至少找到匹配的书。
\n 写书。编辑书名，作者，缩略图，分类，标签，ISBN，给喜欢的书标星等，
另外像编辑PDF的书签或添加评语/附注，非必须，有专业的编辑软件支持就可以了。</p>
<p>目前发现最好的有 Foxit Library，它支持静态扫描和书架归类，并能够使用自己的
<a href="https://foxitsoftware.com/" target="_blank" rel="noopener noreferrer">Fixit Reader</a> 打开PDF文件，但是在使用它管理图书时，
操作不便到简直不可用的地步，而且速度很慢（可能是因为我的书太多，
但是Picasa管理我更多的 图片时，一点都不显胖），并且不支持搜索（有一个索引功能）。</p>
<p>另外 <a href="https://www.ssreader.com/" target="_blank" rel="noopener noreferrer">SSReader</a> 也有一个“本地图书馆”，可以导入本地目录。
它会按照目录结构生成默认归类（跟系统资源管理器差不多，建议还是用资源管理器比较好）。</p>
<p>不知道为什么现行的图书格式都不支持（像音乐文件一样）将书名，作者，缩略图，
ISBN等信息存储在图书属性中，这方面难道没有对应的规范，还是牛仔太多了？</p>
<p>这样的软件是一个梦吗。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[同步Web客户端的时间]]></title>
            <link>https://hotoo.github.io/blog/post/correct-web-client-datetime</link>
            <guid>201</guid>
            <pubDate>Mon, 01 Sep 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="同步web客户端的时间">同步Web客户端的时间<a aria-hidden="true" href="#同步web客户端的时间">#</a></h1>
<p>富客户端应用的普遍流行，许多操作直接在客户端完成，而一些跟时间相关的操作，
客户端时间的正确性就显得尤为重要，一个和标准时间相差得离谱的时间，
可能会带来滑稽甚至严重的错误。</p>
<p>在C/S构架下，对时间有要求的应用程序一般解决方法是同步客户端和服务器端的时间，
一些要求较高的应用甚至需要专门的时间戳技术。</p>
<p>普通的B/S应用程序一般没有权限同步客户端的时间（也不一定有这个必要），
这个问题也有一些解决办法。</p>
<ol>
<li>响应用户请求时返回服务器时间，并使用计时器（如：window.setInterval）做一个虚拟时钟。
但是考虑到浏览器消耗和脚本计时器本身并不精准，长时间运行后时钟会出现较大的误差，予以忽略。</li>
<li>响应用户请求时返回服务器时间，并计算服务器与客户端之间的时间差，
每次时间操作均以该差值进行修正（可以专门做一个接口）。或者考虑只有在
差值较大的情况下才进行修正（并提醒用户修正客户机时间）。</li>
</ol>
<p>另外还要考虑用户所在不同时区的情况（Date.getTimezoneOffset）。</p>
<p>但是对于较精准的时间需求，这样仍然有一个问题，即从服务器端响应到客户端返回过程中
的网络传输时间。这是一个随机数，根据网络情况和其他偶然因素有关，从几十毫秒到几十秒不等，
有时达数分钟之久，最惨的是整个页面超时，当然同步也就没有必要了：）</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SLvPzIEGEmI/AAAAAAAAD7k/OGNAGnITYaE/s320%5CnR/syncWebDateTime.jpg" alt="pic"></img></p>
<p>如上图，客户端从客户机的t0时刻发送请求到服务端，然后服务端在T0时刻得到请求，
经过连接数据、计算等操作，最终在T1时刻响应完成，客户端最后在t1时刻加载完成。</p>
<p>此时我们最关心的是服务器返回到客户端加载完成这段时间的网络传输耗时，
但是暂时无法精确求得，只有一个相当不凑和方法：客户端发生请求时，
带上当时的客户机时间（t0，浏览器请求头信息里一般带有，也可以通过客户端脚本
<code>new Date()</code>，此时则需要通过异步请求），服务器计算所耗时间也可以得到，
响应时返回服务器计算耗时（T1\nT0）以及浏览器请求的时刻（t0）以及服务器时间，
客户端加载完成时刻（t1）计算网络传输总共耗时为：(t1\nt1)\n(T1\nT0)，
之后以一定比例（如1:1）计算响应的网络传输耗时。</p>
<p>结果相当不凑和，而过程又相当麻烦，所以只作为抛砖引玉之篇。</p>
<p><img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SLu9R80pfRI/AAAAAAAAD7c/ybEW9mu15Ac/s320%5CnR/datetime.jpg" alt="pic"></img></p>
<p>图片来自 <a href="https://image.baidu.com/i?ct=201326592&amp;cl=2&amp;lm=%5Cn1&amp;tn=baiduimage&amp;pv=&amp;word=%CA%B1%BC%E4&amp;z=0" target="_blank" rel="noopener noreferrer">Baidu图片</a> 搜索。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Rating for Foobar2000 columns UI]]></title>
            <link>https://hotoo.github.io/blog/post/rating-for-foobar2000-columns-ui</link>
            <guid>203</guid>
            <pubDate>Thu, 14 Aug 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="rating-for-foobar2000-columns-ui">Rating for Foobar2000 columns UI<a aria-hidden="true" href="#rating-for-foobar2000-columns-ui">#</a></h1>
<p>给 Foobar2000 的 Columns UI 设置标星功能：</p>
<h2 id="i-显示歌曲标星级别">I. 显示歌曲标星级别。<a aria-hidden="true" href="#i-显示歌曲标星级别">#</a></h2>
<p>\n 文件 \n> 参数设置。
\n 显示 \n> Columns UI \n> Playlist view。
\n 切换到Columns页签，新建（New）一个列。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SJ6%5CnG0igVlI/AAAAAAAAD20/IMyH4NToL1c/s1600%5Cnh/viewRating.jpg" alt="pic"></img></p>
<p>如图，Display里的代码是：</p>
<pre><code>\nif(%rating%,
\nselect(%rating%,
\n,
\n\n,
\n\n\n,
\n\n\n\n,
\n\n\n\n\n),
)
)
</code></pre>
<p>其实也可以简单是输入：<code>%rating%</code>。</p>
<h2 id="ii-设置标星级别功能">II. 设置标星级别功能。<a aria-hidden="true" href="#ii-设置标星级别功能">#</a></h2>
<p>\n 右键播放列表某首歌曲 \n> 标签 \n> 管理脚本。
<img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SKKI6GFCmTI/AAAAAAAAD3g/8mBCeRyB4k8/s320/0.right+menu.GIF" alt=""></img>
\n 打开“批量标签”窗口。
<img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SKKPQ%5CnkgaBI/AAAAAAAAD3o/9a8J60zWdRM/s320/1.tags.GIF" alt=""></img>
\n 点击“准备的任务”中的“添加”按钮，选择动作类型为“从另一个字段格式化值...”，确定。
<img src="https://1.bp.blogspot.com/%5CnPOl6bUDELqY/SKKPbKbESKI/AAAAAAAAD3w/5FbcHoTmX68/s320/2.select+action.GIF" alt=""></img>
\n 目标字段名：RATING 
格式化原型：<code>\nif(\ngreater(6,\nadd(%RATING%,1)),\nadd(%RATING%,1),5)</code> 
<img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SKKPrZHkhrI/AAAAAAAAD34/yPDpKB5d3gA/s320/3.0.format+add+value.GIF" alt=""></img>
\n 保存为rating++，名称可以自定，点击“运行”按钮。
<img src="https://3.bp.blogspot.com/%5CnPOl6bUDELqY/SKKPrqTAO5I/AAAAAAAAD4I/h9QuR4fIlow/s320/3.2.run.jpg" alt=""></img>
\n 重复第3步。
\n 重复第4步，目标字段名：RATING 
格式化原型： <code>\nif(\ngreater(%RATING%,0),\nsub(%RATING%,1),0)</code> 
保存为：rating\n\n 
点击“运行”按钮。</p>
<h2 id="iii-设置标星界面操作按钮">III. 设置标星界面（操作按钮）：<a aria-hidden="true" href="#iii-设置标星界面操作按钮">#</a></h2>
<p>\n 右键工具栏，点击 Customise...
<img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SKKgVMPR42I/AAAAAAAAD4Q/x3tqs58BTf4/s320/customise.JPG" alt=""></img>
\n 添加(Add)一个按钮(button)，并点击Change...按钮。
<img src="https://2.bp.blogspot.com/%5CnPOl6bUDELqY/SKKgVKCZ3zI/AAAAAAAAD4Y/8rHQn7SXnq4/s320/custonise+buttons.jpg" alt=""></img>
\n Command group中选择“Context menu items”，Item group中选择“Now Playing item”，
Command中选择“标签/脚本/rating++”。OK保存后回到Command picker窗口，设置按钮图片什么。
注：支持bmp和png格式的图片，但是png图片如果有透明的部分，则可能不会显示。
<img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SKKgVeJuaXI/AAAAAAAAD4g/ToVomGPvQSA/s320/command+picker.jpg" alt=""></img>
\n 重复第2步。Command中选择“标签/脚本/rating\n\n”其他雷同。
\n 最后OK保存就可以了，下面是配置完成的界面，两个带星星的按钮功能分别是标星自减和自增。</p>
<p><img src="https://4.bp.blogspot.com/%5CnPOl6bUDELqY/SKRIW4GiHEI/AAAAAAAAD4o/fN%5CnUJ17Kp1Q/s320/foobar200.jpg" alt="pic"></img></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[IM 软件互联畅想]]></title>
            <link>https://hotoo.github.io/blog/post/dream-for-im</link>
            <guid>205</guid>
            <pubDate>Sun, 03 Aug 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="im-软件互联畅想">IM 软件互联畅想<a aria-hidden="true" href="#im-软件互联畅想">#</a></h1>
<p>现在的IM软件（如QQ, MSN, Gtalk...）都有各种支持的新邮件，日志/博客更新及
好友联系资料更新的检查功能，它们各自为政，互不相干，每个IM服务商都只支持自己提供的服务。</p>
<p>而现在的IM领域愈来愈趋向于互联互通，相互开放。这也是众心所向，大势所趋。</p>
<p>在这个时候，IM软件的检查用户更新的功能也应该相互开放，相互支持。</p>
<p>就拿新邮件检查来说，其实 <a href="https://www.google.com/search?hl=en&amp;q=mail+notify&amp;btnG=Google+Search" target="_blank" rel="noopener noreferrer">mail notify</a>
的相关软件相当多，它们有的具有针对性，只对某些邮件服务商服务
（如 <a href="https://mail.google.com/mail/help/notifier/" target="_blank" rel="noopener noreferrer">gnotify</a> (仅支持单个帐号)，
<a href="https://addons.mozilla.org/zh%5CnCN/firefox/addon/1320" target="_blank" rel="noopener noreferrer">Gmail Manager</a> (Firefox插件，支持多个Gmail帐号)），
有的具有开放性，同时支持若干个不同服务商和多个不同帐号。当然最好是能同时支持多个服务商和多个帐号了。
由于不同邮件服务商（为不同用户）提供的服务不同，获取新邮件的方式不一而足，一般服务商只提供pop服务
（如126，163邮箱。另外某些服务商该功能需要收费），而Google同时提供Atom格式（gnotify支持该格式）。
以pop方式实现的检查新邮件功能总觉着不那么舒服（但至少能实现），Atom 格式比较合适（但其他服务商不支持）。
如果IM软件能提供多邮件帐号、多服务商的新邮件检查支持，这将是相当棒的了。
（注：Pidgin，原Gaim，支持检查登录帐号各自新邮件的功能。）</p>
<p>再就是日志/博客（以下简称博客）更新，现在的博客都支持RSS/Atom输出，检查更新应该没有技术难度。</p>
<p>用户资料更新的话，可能还需要出新标准才行，最好能支持第三方应用
（比如我在某个专业提供个人联系资料服务的服务商那里公开某部分资料给某些好友，
这些有权限的用户就可以得到相关更新）。</p>
<p>最后关于IM本身的互联互通，希望有一天能做的真正的互联，就像我有Gmail可以发邮件到163一样，
之间只有通信标准，没有其他阻碍。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[参考]]></title>
            <link>https://hotoo.github.io/blog/post/factorial-recursion</link>
            <guid>204</guid>
            <pubDate>Tue, 08 Apr 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="阶乘factorial--尾递归tail-recursion">阶乘(factorial) & 尾递归(Tail Recursion)<a aria-hidden="true" href="#阶乘factorial--尾递归tail-recursion">#</a></h1>
<p>\n</p>
<p>今天看了dennis的《<a href="https://www.blogjava.net/killme2008/archive/2008/03/18/187071.html" target="_blank" rel="noopener noreferrer">用递归计算阶乘咋不行呢？</a>》
受益良多，这里做下小结。</p>
<p>传统的递归算法写起来很漂亮，代码很简洁，但是每递归一次就需要更深一层的堆栈支持，
可能会造成内存溢出而失败，所以递归和goto语句一样声名狼藉。</p>
<blockquote>
<p>甚至《代码大全》的作者有这样一句话：如果为我工作的程序员用递归去计算阶乘，那么我宁愿换人。
作者对递归的态度相当谨慎，这在静态命令式语言中显然是正确的，但是在函数式语言中，
由于有尾递归优化的存在，递归反而是最自然的形式，况且我打心里认为递归更符合人类思维。
(by dennis)</p>
</blockquote>
<p>尾递归就是从最后开始计算，每递归一次就算出相应的结果，
也就是说，函数调用出现在调用者函数的尾部，因为是尾部，
所以根本没有必要去保存任何局部变量，直接让被调用的函数返回时越过调用者，
返回到调用者的调用者去。举例说明。</p>
<p>线性递归（传统递归方式）：</p>
<pre><code>function recursion(n){
    return n==1?1:n\nrecursion(n\n1);
}
</code></pre>
<p>尾递归：</p>
<pre><code>function tailRecursion(n, a){
    a = a||1; // 尾递归之尾，即上次递归结果。
    return n==1?a:tailRecursion(n\n1, a\nn);
}
</code></pre>
<p>这里将基于尾递归的求数值阶乘算法贴下：</p>
<pre><code>Math.factorial\nIII = function(n){
    var a = arguments[1]||1;
    return n&lt;=1?a:Math.factorial\nIII(n\n1, a\nn);
};
</code></pre>
<p>效率上和循环迭代、<a href="https://blog.xianyun.org/2007/12/26/improved%5Cnfactorial/" target="_blank" rel="noopener noreferrer">阶乘改进算法</a>
相当甚至稍胜出（ie6,firefox2,safari3），普通递归的效率最为底下，且需要深入堆栈。</p>
<h1 id="参考">参考<a aria-hidden="true" href="#参考">#</a></h1>
<p>\n 《<a href="https://baike.baidu.com/view/1439396.htm" target="_blank" rel="noopener noreferrer">尾递归</a>》\n百度百科
\n 《<a href="https://www.blogjava.net/killme2008/archive/2008/03/18/187071.html" target="_blank" rel="noopener noreferrer">用递归计算阶乘咋不行呢？</a>》\ndennis</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[正则表达式拼接和构建零长度对象]]></title>
            <link>https://hotoo.github.io/blog/post/regexp-and-zero-width-object</link>
            <guid>206</guid>
            <pubDate>Mon, 31 Mar 2008 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="正则表达式拼接和构建零长度对象">正则表达式拼接和构建零长度对象<a aria-hidden="true" href="#正则表达式拼接和构建零长度对象">#</a></h1>
<p>之前在网上收集到一个正则表达式拼接的方法/函数，一直没有注意，直到昨天用 jsdoc
生成 api 文档时才看到。
心里想这样的方法实际应用中大概没什么意义，但是出于好奇就拿出来玩了一下，
这一玩不要紧啊，这么精炼的东西差点成垃圾。</p>
<p>可能是网络编辑器的原因，原始代码有bug，经过修正和测试，现在的代码如下：代码I</p>
<pre><code>/\n\n
 \n 连接两个正则表达式。
 \n 题外话：获得字符串常量&quot;&quot;的长度，比构建空数组再求其长度效率高（忽略构建过程，求长度消耗时间相同）。
 \n @param {RegExp} r 指定被连接的正则表达式对象。
 \n @param {String} p 连接后的表达式使用的选项，由&quot;i&quot;,&quot;g&quot;,&quot;m&quot;组合而成。
 \n @return {RegExp} 返回连接后的正则表达式。
 \n/
RegExp.prototype.concat = function(r, p){
  var i=(this.source.match(/\((?!\?:)/g) || &quot;&quot;).length; // 正向预搜索。
  return new RegExp(this.source+r.source.replace(/\\(\d)/g, function(\n0, \n1){
    return &quot;\\&quot; + (i+(\n1 | 0)); // 修正第二个表达式中的反向引用。注意这里的位运算。
  }), p);
};
</code></pre>
<p>原方法名是contact，现在为了和字符串类的一致，换为concat，至于bug/不足这里不做解读。
这个实际应用意义不大的小程式却有值得称道的几点：</p>
<p>\n 正向预搜索匹配第一个表达式里左括号（不包括非捕获组(?:)）的个数。
\n 当第一个表达式没有匹配时返回 0 长度对象（再求其长度），
可以构建空数组（[]）和空字符串（""），这里使用空字符串，理由下面再解释。
\n 修正反向引用时用的位运算（），这里将匹配到的数值字符串与0位或没有其他意义，
只是将数值字符串转型为数值，相当于 <code>parseInt()</code> 函数。</p>
<p>下面介绍为什么使用空字符串而不是空数组构建0长度对象。代码II</p>
<pre><code>var I = 10000;

var d = new Date();
for (var i=0; i&lt;I; i++){
&quot;&quot;.length;
}
d = new Date()\nd;

var d2 = new Date();
for (var i=0; i&lt;I; i++){
[].length;
}
d2 = new Date()\nd2;

document.write(d+&quot;:&quot;+d2);
</code></pre>
<p>一万次循环叠加可以发现构建空字符串比构建空数组求长度快1到3倍。</p>
<p>再将代码改为：代码III</p>
<pre><code>var I = 10000;
var s=&quot;&quot;;
var d = new Date();
for (var i=0; i&lt;I; i++){
s.length;
}
d = new Date()\nd;

var a=[];
var d2 = new Date();
for (var i=0; i&lt;I; i++){
a.length;
}
d2 = new Date()\nd2;

document.write(d+&quot;:&quot;+d2);
</code></pre>
<p>可以发现，求空字符串长度与空数组长度的过程效率相当。可见，代码 II 处空数组效率
多余的消耗主要在构建空数组对象上。</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[手机卡的自白]]></title>
            <link>https://hotoo.github.io/blog/post/the-card-in-mobile-phone</link>
            <guid>207</guid>
            <pubDate>Tue, 29 May 2007 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="手机卡的自白">手机卡的自白<a aria-hidden="true" href="#手机卡的自白">#</a></h1>
<p>唉！老天何其不公！身为一张移动手机卡生在这个时代何错之有？！
我宁愿变成一辆普普通通的单车，也能驮着人无拘无束的快乐游玩。
可残酷的现实是：我只能被固定在铁箱子里收发信息，不见天日，
唯一作伴的只有同样被固定在我身旁的 SD 卡。</p>
<p>现在好了，停机了，整个世界清净了。我终于可以泡杯热茶、吃块饼干，
悠闲的等着机主注意到我了。</p>
<p>别担心，一旦这事引发混乱，机主会手脚麻利的尽快充值。所以等一会儿你再来看，
就会发现我又开始自得其乐的工作了。</p>
]]></content:encoded>
            <category>小说</category>
        </item>
        <item>
            <title><![CDATA[陀螺]]></title>
            <link>https://hotoo.github.io/blog/post/top</link>
            <guid>208</guid>
            <pubDate>Sun, 01 Feb 2004 00:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="陀螺">陀螺<a aria-hidden="true" href="#陀螺">#</a></h1>
<p>在被抽打中不羁执着，<br></br>
在痛苦里继续发现快乐。<br></br>
信仰唯有围绕我心，<br></br>
才能实现不倒的自我。</p>
<p>\n\n 闲耘</p>
]]></content:encoded>
        </item>
    </channel>
</rss>