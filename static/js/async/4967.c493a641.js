"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["4967"],{49687:function(e,s,n){n.r(s),n.d(s,{default:()=>i});var r=n(74132),c=n(40453);function l(e){let s=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",hr:"hr",strong:"strong",cite:"cite",em:"em",footer:"footer",div:"div"},(0,c.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"sql-like-查询的一个问题",children:["SQL LIKE 查询的一个问题",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#sql-like-查询的一个问题",children:"#"})]}),"\n",(0,r.jsx)(s.p,{children:"在做用户管理的时候，用户表(users) 有一个字段(dept)用来存储用户所在部门的信息，\n字段的值一般是这样的，各级部门间使用横杠分隔："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"XX宝-技术部\nXX宝-技术部-数据仓库\n"})}),"\n",(0,r.jsx)(s.p,{children:"我们的系统有一个根据用户所在部门进行过滤的功能，所以我们用了类似下面的查询语句："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:'SELECT * FROM users WHERE dept LIKE "XX宝-技术部%";\n'})}),"\n",(0,r.jsx)(s.p,{children:"这样的性能还好，但是今天发现一个问题是，当有两个部门名称很相似，比如："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"XX宝-CEO\nXX宝-CEO办公室\n"})}),"\n",(0,r.jsxs)(s.p,{children:["这时在查询 ",(0,r.jsx)(s.code,{children:"XX宝CEO"})," 的时候就会把 ",(0,r.jsx)(s.code,{children:"XX宝-CEO办公室"})," 的用户也查询出来。"]}),"\n",(0,r.jsx)(s.p,{children:"于是想到正则表达式："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE REGEXP_LIKE(dept, "^XX宝-CEO$")\nOR REGEXP_LIKE(dept, "^XX宝-CEO-[\\w\\-]+");\n'})}),"\n",(0,r.jsx)(s.p,{children:"合并正则表达式的另一解："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE REGEXP_LIKE(dept, "^XX宝-CEO($|-[\\w\\-]+)");\n'})}),"\n",(0,r.jsx)(s.p,{children:"杯具的性能问题。"}),"\n",(0,r.jsx)(s.p,{children:"突然想到"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE dept="XX宝-CEO"\nOR dept LIKE "XX宝-CEO-%";\n'})}),"\n",(0,r.jsx)(s.p,{children:"于是简单有效的解决了这个问题。"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Tags:"})," ",(0,r.jsx)("a",{href:"/blog/tags/SQL",children:(0,r.jsx)("cite",{class:"tags",children:"SQL"})})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"Published on 2010-08-13"})}),"\n",(0,r.jsxs)("footer",{children:[(0,r.jsx)("div",{class:"meta-left",children:(0,r.jsxs)(s.p,{children:["Tags: ",(0,r.jsx)("a",{href:"/blog/tags/SQL",children:(0,r.jsx)("cite",{class:"tags",children:"SQL"})})]})}),(0,r.jsx)("div",{class:"meta-right",children:(0,r.jsxs)(s.p,{children:["Date: ",(0,r.jsx)("cite",{class:"date",children:"2010-08-13"})]})})]})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.ah)(),e.components);return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}let i=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["..%2Fnode_modules%2F.rspress%2Fruntime%2Ftemp-114.mdx"]={toc:[],title:"SQL LIKE 查询的一个问题",headingTitle:"SQL LIKE 查询的一个问题",frontmatter:{}}}}]);