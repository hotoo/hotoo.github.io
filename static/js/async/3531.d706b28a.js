"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["3531"],{9614:function(n,e,r){r.r(e),r.d(e,{default:()=>i});var t=r(4132),o=r(453);function s(n){let e=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",h2:"h2",ol:"ol",li:"li",footer:"footer",div:"div",strong:"strong",cite:"cite"},(0,o.ah)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.h1,{id:"丢弃图片的-http-请求",children:["丢弃图片的 HTTP 请求",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#丢弃图片的-http-请求",children:"#"})]}),"\n",(0,t.jsx)(e.p,{children:"\\n"}),"\n",(0,t.jsx)(e.p,{children:"| OS       | Browser        | \"\"    | null  | remove | delete | stop | StopImage | Stop | Button | Timeout    |\n|\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n\\n|\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n|\n| Windows  | IE6,7,8        | √(e) | √(e) | II     | \xd7     | \xd7   | \xd7        | \xd7   | \xd7     | 21s (e)    |\n| /       | FF4,5          | II    | II    | II     | \xd7     | II   | \xd7        | \xd7   | II     | 21s (e)    |\n| /       | Chrome12       | \xd7    | \xd7    | \xd7     | \xd7     | II   | \xd7        | \xd7   | II     | 21s (e)    |\n| /       | Safari4,5      | \xd7    | \xd7    | \xd7     | \xd7     | II   | \xd7        | \xd7   | II     | 21s (e)    |\n| /       | Opera9         | \xd7    | √(e) | \xd7     | \xd7     | II   | \xd7        | \xd7   | II     | 47s (e)    |\n| /       | Opera11        | II    | √(e) | II     | II     | II   | \xd7        | \xd7   | II     | 47s (e)    |\n| Mac OS X | Safari5        | \xd7    | \xd7    | \xd7     | \xd7     | II   | \xd7        | \xd7   | II     | 1.2m (e)   |\n| /       | Chrome12       | \xd7    | \xd7    | \xd7     | \xd7     | II   | \xd7        | \xd7   | II     | 1.2m (e)   |\n| /       | FF4,5          | II    | II    | II     | \xd7     | II   | \xd7        | \xd7   | II     | 1m'15s (e) |\n| Ubuntu   | FF4,5          | II    | II    | II     | \xd7     | II   | \xd7        | \xd7   |        | 3m'9s (e)  |\n| /       | Chrom(e/ium)12 | \xd7    | \xd7    | \xd7     | \xd7     | II   | \xd7        | \xd7   |        | 3.2m (e)   |"}),"\n",(0,t.jsx)(e.p,{children:"\\n Windows XP, Server 2003, 7.\n\\n Mac OS X 10.6.7\n\\n Ubuntu 11.04"}),"\n",(0,t.jsx)(e.p,{children:"\\n标题注解：\\n"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'"":: `img.src = ""`\nnull:: `img.src = null`\nrevmove:: `img.removeAttribute("src")`\ndelete:: `delete img["src"]`\nstop:: `window.stop()`\nStopImage:: `document.execCommand("StopImage")`\nStop:: `document.execCommand("Stop")`\nButton:: Browser Stop Button.\n'})}),"\n",(0,t.jsx)(e.p,{children:"\\n图标注解：\\n"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"√:: 能够 Abort 图片请求，并回调 (e)onerror/(a)onabort/(l)onload 函数。\nII:: 能够 Abort 图片请求，但不触发任何事件进行回调。\n≈:: 部分版本支持。如 Stop/StopImage 在 .NET Framework 3.0 中取消了支持。\n\xd7:: 不能 Abort 图片请求，或不支持该方法。\n"})}),"\n",(0,t.jsxs)(e.h2,{id:"事件回调",children:["事件回调",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#事件回调",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'var img = new Image();\nimg.onload = function(){out.innerHTML += "loaded.";};\nimg.onabort = function(){out.innerHTML += "aborted.";};\nimg.onerror = function(){out.innerHTML += "errored.";};\nwindow.setTimeout(function(){\n    out.innerHTML += "before.";\n    // abort.\n    img.src = null;\n    out.innerHTML += "after." + img.complete;\n}, 2000);\n'})}),"\n",(0,t.jsx)(e.p,{children:"测试结果："}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"IE:: before.errored.after.\nOpera:: before.after.errored.\nFF:: before.after.\nChrome:: before.after.\nSafari:: before.after.\n"})}),"\n",(0,t.jsxs)(e.h2,{id:"todo丢弃-jsonp-请求",children:["TODO:丢弃 jsonp 请求？",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#todo丢弃-jsonp-请求",children:"#"})]}),"\n",(0,t.jsx)(e.p,{children:"为什么不是 script/link?"}),"\n",(0,t.jsx)(e.p,{children:'使用 document.createElement("script") 创建元素并设置 src 属性，\nappendChild 到 DOM 中会去请求指定资源，可以到底向日志服务器发送数据的要求。'}),"\n",(0,t.jsx)(e.p,{children:"但是使用这种方式有一下几点弊端："}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"创建脚本带来的危险性。"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"会向 DOM 中附加元素，影响 DOMLint 校验。"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["无法 abort，无论设置 ",(0,t.jsx)(e.code,{children:"script = null;"}),", ",(0,t.jsx)(e.code,{children:'script.src="";'}),", ",(0,t.jsx)(e.code,{children:"script.src=null;"}),",\n",(0,t.jsx)(e.code,{children:'script.removeAttribute("src");'}),", ",(0,t.jsx)(e.code,{children:"document.body.removeChild(script);"}),"\n都无法实现 abort."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"引入资源不触发 onload/onerror/onabort 事件，除非使用 jsonp 的方式，\n对元素本身无法得到回调。"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"see-also",children:["See Also",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#see-also",children:"#"})]}),"\n",(0,t.jsxs)(e.p,{children:["\\n ",(0,t.jsx)(e.a,{href:"https://stackoverflow.com/questions/930237/javascript%5Cncancel%5Cnstop%5Cnimage%5Cnrequests",target:"_blank",rel:"noopener noreferrer",children:"https://stackoverflow.com/questions/930237/javascript\\ncancel\\nstop\\nimage\\nrequests"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://www.sysopt.com/forum/archive/index.php/t%5Cn177147.html",target:"_blank",rel:"noopener noreferrer",children:"https://www.sysopt.com/forum/archive/index.php/t\\n177147.html"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://stackoverflow.com/questions/1671717/javascript%5Cnimage%5Cnonabort%5Cnevent%5Cnnot%5Cnfiring%5Cnin%5Cnfirefox%5Cnchrome",target:"_blank",rel:"noopener noreferrer",children:"https://stackoverflow.com/questions/1671717/javascript\\nimage\\nonabort\\nevent\\nnot\\nfiring\\nin\\nfirefox\\nchrome"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://stackoverflow.com/questions/4506160/abort%5Cnactive%5Cnimage%5Cnrequests",target:"_blank",rel:"noopener noreferrer",children:"https://stackoverflow.com/questions/4506160/abort\\nactive\\nimage\\nrequests"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://www.devguru.com/technologies/ecmascript/quickref/image.html",target:"_blank",rel:"noopener noreferrer",children:"https://www.devguru.com/technologies/ecmascript/quickref/image.html"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://stackoverflow.com/questions/930237/javascript%5Cncancel%5Cnstop%5Cnimage%5Cnrequests",target:"_blank",rel:"noopener noreferrer",children:"Javascript: Cancel/Stop Image Requests"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://www.google.com/support/forum/p/Chrome/thread?tid=4bf113154d53d101&hl=en",target:"_blank",rel:"noopener noreferrer",children:"Can't you stop images from loading?"}),"\n\\n ",(0,t.jsx)(e.code,{children:"window.stop()"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://stackoverflow.com/questions/930237/javascript%5Cncancel%5Cnstop%5Cnimage%5Cnrequests",target:"_blank",rel:"noopener noreferrer",children:"https://stackoverflow.com/questions/930237/javascript\\ncancel\\nstop\\nimage\\nrequests"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://stackoverflow.com/questions/3146200/stop%5Cnloading%5Cnof%5Cnimages%5Cnon%5Cna%5Cnhashchange%5Cnevent%5Cnvia%5Cnjavascript%5Cnor%5Cnjquery",target:"_blank",rel:"noopener noreferrer",children:"https://stackoverflow.com/questions/3146200/stop\\nloading\\nof\\nimages\\non\\na\\nhashchange\\nevent\\nvia\\njavascript\\nor\\njquery"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://developer.mozilla.org/en/DOM/window.stop",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/en/DOM/window.stop"}),"\n\\n ",(0,t.jsx)(e.code,{children:"execCommand"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://msdn.microsoft.com/en%5Cnus/library/ms536419%28v=vs.85%29.aspx",target:"_blank",rel:"noopener noreferrer",children:"execCommand Method"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://msdn.microsoft.com/en%5Cnus/library/ms536419%28v=vs.85%29.aspx",target:"_blank",rel:"noopener noreferrer",children:"https://msdn.microsoft.com/en\\nus/library/ms536419%28v=vs.85%29.aspx"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://msdn.microsoft.com/en%5Cnus/library/ms533049%28v=vs.85%29.aspx",target:"_blank",rel:"noopener noreferrer",children:"https://msdn.microsoft.com/en\\nus/library/ms533049%28v=vs.85%29.aspx"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://developer.mozilla.org/En/Document.execCommand",target:"_blank",rel:"noopener noreferrer",children:"https://developer.mozilla.org/En/Document.execCommand"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://www.xiahaixia.com/2010/11/19/ie6%E4%B8%8B%E9%93%BE%E6%8E%A5onclick%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E8%AF%B7%E6%B1%82%E8%A2%ABaborted/",target:"_blank",rel:"noopener noreferrer",children:"IE6下链接ONCLICK事件处理中的请求被ABORTED"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://www.cnblogs.com/zhyt1985/archive/2009/05/27/1490755.html",target:"_blank",rel:"noopener noreferrer",children:"What does (Aborted) mean in HttpWatch?"}),"\n",(0,t.jsx)(e.a,{href:"https://www.sanotes.net/html/y2008/165.html",target:"_blank",rel:"noopener noreferrer",children:"来源"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://blog.httpwatch.com/2007/11/20/error%5Cninternet%5Cninvalid%5Cnurl%5Cnhttpwatch/",target:"_blank",rel:"noopener noreferrer",children:"https://blog.httpwatch.com/2007/11/20/error\\ninternet\\ninvalid\\nurl\\nhttpwatch/"}),"\n\\n ",(0,t.jsx)(e.a,{href:"https://www.cnblogs.com/mayingbao/archive/2007/11/30/978530.html",target:"_blank",rel:"noopener noreferrer",children:"HttpWatch工具简介及使用技巧"})]}),"\n",(0,t.jsxs)("footer",{class:"blog-post-footer",children:[(0,t.jsx)("div",{class:"blog-post-footer-meta meta-left",children:(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Tags:"})," ",(0,t.jsx)("a",{href:"/blog/tags/JavaScript",children:(0,t.jsx)("cite",{class:"tags",children:"JavaScript"})}),", ",(0,t.jsx)("a",{href:"/blog/tags/HTTP",children:(0,t.jsx)("cite",{class:"tags",children:"HTTP"})})]})}),(0,t.jsx)("div",{class:"blog-post-footer-meta meta-right",children:(0,t.jsxs)(e.p,{children:["Published on ",(0,t.jsx)("cite",{class:"date",children:"2011-06-23"})]})})]})]})}function a(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,o.ah)(),n.components);return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(s,{...n})}):s(n)}let i=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["..%2Fnode_modules%2F.rspress%2Fruntime%2Ftemp-88.mdx"]={toc:[{text:"事件回调",id:"事件回调",depth:2},{text:"TODO:丢弃 jsonp 请求？",id:"todo丢弃-jsonp-请求",depth:2},{text:"See Also",id:"see-also",depth:2}],title:"丢弃图片的 HTTP 请求",headingTitle:"丢弃图片的 HTTP 请求",frontmatter:{category:null,tags:"JavaScript, HTTP",date:"2011-06-23T00:00:00.000Z"}}}}]);