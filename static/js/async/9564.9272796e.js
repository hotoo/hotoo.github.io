"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["9564"],{86338:function(e,s,n){n.r(s),n.d(s,{default:()=>h});var i=n(74132),r=n(40453);function c(e){let s=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",img:"img",hr:"hr",strong:"strong",cite:"cite",em:"em",footer:"footer",div:"div"},(0,r.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.h1,{id:"每周异常第-3期宏观异常分析方法",children:["每周异常：第 3期，宏观异常分析方法",(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#每周异常第-3期宏观异常分析方法",children:"#"})]}),"\n",(0,i.jsx)(s.p,{children:"为了有效的分析 JavaScript 异常，我们从宏观的统计数据中做了大量的分析，初步结果如下："}),"\n",(0,i.jsxs)(s.h2,{id:"全站每日异常统计",children:["全站每日异常统计",(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#全站每日异常统计",children:"#"})]}),"\n",(0,i.jsx)(s.p,{children:"首先我们从每天的全站总体数据进行分析，得到下面这些报表。其中："}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"all_pv: 全站所有有效异常次数 (PV)"}),"\n",(0,i.jsx)(s.li,{children:"all_uv: 全站所有有效异常人数 (UV)"}),"\n",(0,i.jsx)(s.li,{children:"all_pv_rate: 全站所有异常率 (按 PV 统计)"}),"\n",(0,i.jsx)(s.li,{children:"all_uv_rate: 全站所有异常率 (按 UV 统计)"}),"\n",(0,i.jsx)(s.li,{children:"valid_rate_pv: 有效异常率（按 PV 统计）"}),"\n",(0,i.jsx)(s.li,{children:"valid_rate_uv: 有效异常率（按 UV 统计）"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://f.cloud.github.com/assets/143572/900597/98aa3094-fb68-11e2-9f9e-c3809ea15b48.png",alt:"2013-08-02 7 42 02"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://f.cloud.github.com/assets/143572/900599/ac59ccb2-fb68-11e2-89c3-4e0d6db7261f.png",alt:"2013-08-02 7 42 37"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://f.cloud.github.com/assets/143572/900625/c145cbac-fb69-11e2-80c7-d1f9152ddeb4.png",alt:"2013-08-02 7 50 11"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://f.cloud.github.com/assets/143572/900601/bbc1e3a6-fb68-11e2-85e7-b6443f502860.png",alt:"2013-08-02 7 43 04"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://f.cloud.github.com/assets/143572/900602/cd4f7f0c-fb68-11e2-96b8-2de40b5d2882.png",alt:"2013-08-02 7 43 31"})}),"\n",(0,i.jsx)(s.p,{children:"从趋势图中我们可以明显的看到第 2天和最后一天，异常 PV 有较大波动，这是由于用户\n攻击爆发大量异常造成的。"}),"\n",(0,i.jsxs)(s.p,{children:["我们在 ",(0,i.jsx)(s.a,{href:"https://github.com/totorojs/javascript-exception-archives/issues/12",target:"_blank",rel:"noopener noreferrer",children:"异常评分算法"}),"\n的讨论中有提到，即使是少量用户进行攻击，异常 UV 也不应该有波动的（除非页面 UV\n本身有较大波动），但是实际上我们看到最后一天的异常 UV 也有明显波动，因此粗略\n分析这个异常 PV 的上升是由于页面访问人数增多造成的。"]}),"\n",(0,i.jsx)(s.p,{children:"事后我们查了当天的页面访问 PV 和 UV，可惜并没有明显波动。"}),"\n",(0,i.jsx)(s.p,{children:"实际经过细致的异常日志分析，我们看到攻击用户同时没过一段时间就更换 IP 地址或清理\nCookie，因此全天的综合数据中异常 PV  和异常 UV 有了一些明显波动。"}),"\n",(0,i.jsx)(s.p,{children:"而且实际上，每天都有攻击造成的异常波动。"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"每天都有攻击造成的异常，累加在一起好像每天都没什么问题。"}),"\n",(0,i.jsx)(s.li,{children:"由于攻击造成异常总数相对一天的异常总数太小，从全天异常总数的层面来看，\n无法发现，甚至排除攻击造成的异常。"}),"\n",(0,i.jsx)(s.li,{children:"T+1 的统计数据，对于异常监控来说，太迟钝了。"}),"\n"]}),"\n",(0,i.jsxs)(s.h2,{id:"全站每分钟异常统计",children:["全站每分钟异常统计",(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#全站每分钟异常统计",children:"#"})]}),"\n",(0,i.jsx)(s.p,{children:"从上面每日异常总和的分析我们可以看出，一天的总和数据能发现的问题还是比较有限的。\n于是我从分钟的粒度来统计异常。"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://f.cloud.github.com/assets/143572/900781/7496f1e6-fb6e-11e2-854f-1a0f685bea15.png",alt:"2013-08-02 7 24 54"})}),"\n",(0,i.jsx)(s.p,{children:"图有点大，点击可以看大图。"}),"\n",(0,i.jsx)(s.p,{children:"从图中我们可以看到，凌晨 2点多到 3点多期间，有少量用户发起了猛烈的攻击；\n凌晨 4点多到凌晨7点多期间也有少量温和的攻击。攻击时全站异常 PV （绿色）\n和全站有效异常（深红色）明显飙升，但是异常 UV 和有效异常 UV 都没有太大波动，\n而且与前后的时间切片有较好的连贯性，没有大起大落。"}),"\n",(0,i.jsx)(s.p,{children:"而如果异常 UV 出现较大波动，在很可能是由于我们正在发布的新代码影响大面积用户。"}),"\n",(0,i.jsx)(s.p,{children:"合适的时间粒度对于及时发现真正有效的异常有非常重要的意义。"}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Tags:"})," ",(0,i.jsx)("a",{href:"/blog/tags/每周异常",children:(0,i.jsx)("cite",{class:"tags",children:"每周异常"})})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.em,{children:"Published on 2013-08-02"})}),"\n",(0,i.jsxs)("footer",{children:[(0,i.jsx)("div",{class:"meta-left",children:(0,i.jsxs)(s.p,{children:["Tags: ",(0,i.jsx)("a",{href:"/blog/tags/每周异常",children:(0,i.jsx)("cite",{class:"tags",children:"每周异常"})})]})}),(0,i.jsx)("div",{class:"meta-right",children:(0,i.jsxs)(s.p,{children:["Date: ",(0,i.jsx)("cite",{class:"date",children:"2013-08-02"})]})})]})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}let h=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["..%2Fnode_modules%2F.rspress%2Fruntime%2Ftemp-52.mdx"]={toc:[{text:"全站每日异常统计",id:"全站每日异常统计",depth:2},{text:"全站每分钟异常统计",id:"全站每分钟异常统计",depth:2}],title:"每周异常：第 3期，宏观异常分析方法",headingTitle:"每周异常：第 3期，宏观异常分析方法",frontmatter:{}}}}]);