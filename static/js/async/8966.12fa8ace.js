"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["8966"],{35407:function(e,n,r){r.r(n),r.d(n,{default:()=>c});var s=r(74132),t=r(40453);function i(e){let n=Object.assign({h1:"h1",a:"a",p:"p",hr:"hr",strong:"strong",cite:"cite",em:"em",footer:"footer",div:"div"},(0,t.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"同步客户端时间续",children:["同步客户端时间(续)",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#同步客户端时间续",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["08 年我就有了这样的 ",(0,s.jsx)(n.a,{href:"correct-web-client-datetime.html",children:"想法"}),"，却到今天才开始实践。"]}),"\n",(0,s.jsx)(n.p,{children:"公司电脑时间错了好多，但我的账户没有 Internet 同步的权限，遂手动校准。"}),"\n",(0,s.jsxs)(n.p,{children:["到 ",(0,s.jsx)(n.a,{href:"http://www.time.ac.cn/stime.asp",target:"_blank",rel:"noopener noreferrer",children:"国家授时中心"})," 校准时，发现其服务器时间的\n跳跃是受客户端时间影响的，当客户端时间发生修改时，页面上显示的服务器时间也跟着\n偏差。"]}),"\n",(0,s.jsxs)(n.p,{children:["后来到台湾的 ",(0,s.jsx)(n.a,{href:"http://www.stdtime.gov.tw/chinese/home.aspx",target:"_blank",rel:"noopener noreferrer",children:"國家時間與頻率標準實驗室"}),"\n发现没有这个问题。"]}),"\n",(0,s.jsx)(n.p,{children:"研究了两者的代码，发现跟第一观感不同的是，这两者我更赞赏大陆的做法了，虽然有明显的可见缺陷。\n下面简单分析下两者的实现思想及各自的优缺点。"}),"\n",(0,s.jsx)(n.p,{children:"台湾的是使用 setInterval 实现了一个定时器，这个定时器考虑到了调用函数的时间消耗，\n但是 setInterval 或 setTimeout 本身的不确定性，随着跳跃时间变长，页面显示的服务器\n时间便有非常大的偏差，尤其在 IE 浏览器中（几十分钟内，Firefox偏差数秒，IE7偏差数分钟）。"}),"\n",(0,s.jsx)(n.p,{children:"而大陆的实现则使用服务器的初始时间，但使用客户端的频率进行跳跃（并在 1 秒中检查 10 次，\n避免跳秒问题）。这样即使经过长时间的跳跃，同样能保持较高的准确度。但问题是，当客户端\n时间发生修改时，所谓的服务器时间也会收到影响。"}),"\n",(0,s.jsxs)(n.p,{children:["于是我结合两者各自的优点，避开他们的缺点，实现了一个 ",(0,s.jsx)(n.a,{href:"https://github.com/hotoo/Chronos",target:"_blank",rel:"noopener noreferrer",children:"校时器"}),"。\n他使用客户端的跳秒，但是当客户端发生时间不正常的跳跃时，自动修正客户端和服务器端之间的\n时间差。"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Tags:"})," ",(0,s.jsx)("a",{href:"/blog/tags/Web-Design",children:(0,s.jsx)("cite",{class:"tags",children:"Web-Design"})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Published on 2010-11-15"})}),"\n",(0,s.jsxs)("footer",{children:[(0,s.jsx)("div",{class:"meta-left",children:(0,s.jsxs)(n.p,{children:["Tags: ",(0,s.jsx)("a",{href:"/blog/tags/Web-Design",children:(0,s.jsx)("cite",{class:"tags",children:"Web-Design"})})]})}),(0,s.jsx)("div",{class:"meta-right",children:(0,s.jsxs)(n.p,{children:["Date: ",(0,s.jsx)("cite",{class:"date",children:"2010-11-15"})]})})]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(i,{...e})}):i(e)}let c=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["..%2Fnode_modules%2F.rspress%2Fruntime%2Ftemp-104.mdx"]={toc:[],title:"同步客户端时间(续)",headingTitle:"同步客户端时间(续)",frontmatter:{}}}}]);