"use strict";(self.webpackChunkhotoo_co=self.webpackChunkhotoo_co||[]).push([["4967"],{9687:function(e,s,n){n.r(s),n.d(s,{default:()=>o});var l=n(4132),r=n(453),t=n(3030);function c(e){let s=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",footer:"footer",div:"div",strong:"strong",cite:"cite"},(0,r.ah)(),e.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(s.h1,{id:"sql-like-查询的一个问题",children:["SQL LIKE 查询的一个问题",(0,l.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#sql-like-查询的一个问题",children:"#"})]}),"\n",(0,l.jsx)(s.p,{children:"在做用户管理的时候，用户表(users) 有一个字段(dept)用来存储用户所在部门的信息，\n字段的值一般是这样的，各级部门间使用横杠分隔："}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{children:"XX宝-技术部\nXX宝-技术部-数据仓库\n"})}),"\n",(0,l.jsx)(s.p,{children:"我们的系统有一个根据用户所在部门进行过滤的功能，所以我们用了类似下面的查询语句："}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:'SELECT * FROM users WHERE dept LIKE "XX宝-技术部%";\n'})}),"\n",(0,l.jsx)(s.p,{children:"这样的性能还好，但是今天发现一个问题是，当有两个部门名称很相似，比如："}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{children:"XX宝-CEO\nXX宝-CEO办公室\n"})}),"\n",(0,l.jsxs)(s.p,{children:["这时在查询 ",(0,l.jsx)(s.code,{children:"XX宝CEO"})," 的时候就会把 ",(0,l.jsx)(s.code,{children:"XX宝-CEO办公室"})," 的用户也查询出来。"]}),"\n",(0,l.jsx)(s.p,{children:"于是想到正则表达式："}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE REGEXP_LIKE(dept, "^XX宝-CEO$")\nOR REGEXP_LIKE(dept, "^XX宝-CEO-[\\w\\-]+");\n'})}),"\n",(0,l.jsx)(s.p,{children:"合并正则表达式的另一解："}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE REGEXP_LIKE(dept, "^XX宝-CEO($|-[\\w\\-]+)");\n'})}),"\n",(0,l.jsx)(s.p,{children:"杯具的性能问题。"}),"\n",(0,l.jsx)(s.p,{children:"突然想到"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE dept="XX宝-CEO"\nOR dept LIKE "XX宝-CEO-%";\n'})}),"\n",(0,l.jsx)(s.p,{children:"于是简单有效的解决了这个问题。"}),"\n",(0,l.jsxs)("footer",{class:"blog-post-footer",children:[(0,l.jsx)("div",{class:"blog-post-footer-meta meta-left",children:(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Tags:"})," ",(0,l.jsx)("a",{href:"/blog/tags/SQL",children:(0,l.jsx)("cite",{class:"tags",children:"SQL"})})]})}),(0,l.jsx)("div",{class:"blog-post-footer-meta meta-right",children:(0,l.jsxs)(s.p,{children:["Published on ",(0,l.jsx)("cite",{class:"date",children:"2010-08-13"})]})})]}),"\n",(0,l.jsx)(t.DiscussionEmbed,{shortname:"hotoo",config:{url:"https://hotoo.co/blog/post/about-sql-like.html",identifier:"/blog/post/about-sql-like.html",title:"SQL LIKE 查询的一个问题",language:"zh_CN"}})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}let o=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["..%2Fnode_modules%2F.rspress%2Fruntime%2Ftemp-114.mdx"]={toc:[],title:"SQL LIKE 查询的一个问题",headingTitle:"SQL LIKE 查询的一个问题",frontmatter:{category:null,tags:"SQL",date:"2010-08-13T00:00:00.000Z",sidebar:!1,footer:!1}}}}]);