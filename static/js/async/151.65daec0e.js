"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["151"],{57026:function(n,d,e){e.r(d),e.d(d,{default:()=>c});var t=e(74132),r=e(40453);function s(n){let d=Object.assign({h1:"h1",a:"a",p:"p",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",hr:"hr",code:"code",pre:"pre",img:"img",h2:"h2"},(0,r.ah)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.h1,{id:"每周异常第-2-期",children:["每周异常：第 2 期",(0,t.jsx)(d.a,{className:"header-anchor","aria-hidden":"true",href:"#每周异常第-2-期",children:"#"})]}),"\n",(0,t.jsx)(d.p,{children:"这是全站排名第 4 的一个异常，详情如下："}),"\n",(0,t.jsxs)(d.table,{children:["\n",(0,t.jsxs)(d.thead,{children:["\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.th,{children:"KEY"}),"\n",(0,t.jsx)(d.th,{children:"VALUE"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(d.tbody,{children:["\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"URL"}),"\n",(0,t.jsx)(d.td,{children:(0,t.jsx)(d.a,{href:"https://www.example.com/console/selectStrategy.htm",target:"_blank",rel:"noopener noreferrer",children:"https://www.example.com/console/selectStrategy.htm"})}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"File"}),"\n",(0,t.jsx)(d.td,{children:(0,t.jsx)(d.a,{href:"https://a.example.com/??seajs/1.3.1/sea.js,seajs/1.3.1/plugin-combo.js,jquery/jquery/1.7.2/jquery.js",target:"_blank",rel:"noopener noreferrer",children:"https://a.example.com/??seajs/1.3.1/sea.js,seajs/1.3.1/plugin-combo.js,jquery/jquery/1.7.2/jquery.js"})}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"Line"}),"\n",(0,t.jsx)(d.td,{children:"35"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"Message"}),"\n",(0,t.jsx)(d.td,{children:"找不到成员。"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(d.table,{children:["\n",(0,t.jsxs)(d.thead,{children:["\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.th,{children:"Stack Trace"}),"\n",(0,t.jsx)(d.th,{children:"Device"}),"\n",(0,t.jsx)(d.th,{children:"OS"}),"\n",(0,t.jsx)(d.th,{children:"Browser"}),"\n",(0,t.jsx)(d.th,{children:"Engine"}),"\n",(0,t.jsx)(d.th,{children:"Count"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(d.tbody,{children:["\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"ie/10.0"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"826"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"sg/2.x"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"423"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.2"}),"\n",(0,t.jsx)(d.td,{children:"ie/10.0"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"151"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"baidu/2.x"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"27"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/3.4.5.2000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"10"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"tw/3.6.1.1"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"10"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.2"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.6.2000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"3"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"lb/undefined"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/3.5.2.1000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.5.3000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.5.4000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.6.2000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"qq/7.3.11251.400"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.2"}),"\n",(0,t.jsx)(d.td,{children:"tw/-1"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"2"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"360/3.7.1.6"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"360/4.0.3.6"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"360/4.0.5.2"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/2.5.15.1000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/2.5.16.100"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.3.6000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.5.2000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.1.0.2000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"qq/6.13.13719.201"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"qq/6.14.15493.201"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"tw/3.4.0.5"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.1"}),"\n",(0,t.jsx)(d.td,{children:"tw/3.6.1.0"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.2"}),"\n",(0,t.jsx)(d.td,{children:"mx/3.5.2.1000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{children:"at function(a,b,d)"}),"\n",(0,t.jsx)(d.td,{children:"pc/-1"}),"\n",(0,t.jsx)(d.td,{children:"windows/6.2"}),"\n",(0,t.jsx)(d.td,{children:"mx/4.0.5.3000"}),"\n",(0,t.jsx)(d.td,{children:"trident/6.0"}),"\n",(0,t.jsx)(d.td,{children:"1"}),"\n"]}),"\n",(0,t.jsxs)(d.tr,{children:["\n",(0,t.jsx)(d.td,{}),"\n",(0,t.jsx)(d.td,{}),"\n",(0,t.jsx)(d.td,{}),"\n",(0,t.jsx)(d.td,{}),"\n",(0,t.jsx)(d.td,{}),"\n",(0,t.jsx)(d.td,{children:"1478"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(d.hr,{}),"\n",(0,t.jsxs)(d.p,{children:["首先我们找到异常所在文件的第 35行，在上面的异常栈信息中我们可以知道异常从\n压缩后的匿名函数 ",(0,t.jsx)(d.code,{children:"function(a,b,d)"})," 中抛出，这个函数是："]}),"\n",(0,t.jsx)(d.pre,{children:(0,t.jsx)(d.code,{className:"language-js",children:'set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}\n'})}),"\n",(0,t.jsx)(d.p,{children:"对应压缩前的源码是："}),"\n",(0,t.jsx)(d.pre,{children:(0,t.jsx)(d.code,{className:"language-js",children:'	// Use this for any attribute in IE6/7\n	// This fixes almost every IE6/7 issue\n	nodeHook = jQuery.valHooks.button = {\n		get: function( elem, name ) {\n			var ret;\n			ret = elem.getAttributeNode( name );\n			return ret && ( fixSpecified[ name ] ? ret.nodeValue !== "" : ret.specified ) ?\n				ret.nodeValue :\n				undefined;\n		},\n		set: function( elem, value, name ) {\n			// Set the existing or create a new attribute node\n			var ret = elem.getAttributeNode( name );\n			if ( !ret ) {\n				ret = document.createAttribute( name );\n				elem.setAttributeNode( ret );\n			}\n			return ( ret.nodeValue = value + "" );\n		}\n	};\n'})}),"\n",(0,t.jsx)(d.p,{children:"这个代码是用来兼容 IE6/7 的属性操作（代码注释中号称几乎修复了 IE6/7 所有的问题），\n页面中的业务源码中我们找到不少 DOM 属性的操作，其中有一些看起来几乎不会有问题，\n另外一些则出现问题的可能性更高。"}),"\n",(0,t.jsxs)(d.p,{children:["我们从这些可能性更高的部分着手，最终发现 IE10 兼容模式下会抛出『",(0,t.jsx)(d.a,{href:"https://github.com/totorojs/javascript-exception-archives/blob/master/content/wiki/member-not-found.md",target:"_blank",rel:"noopener noreferrer",children:"找不到成员。"}),"』\n的异常，这时我们注意到，异常详情中全部都是 Trident 6.0 内核的浏览器抛出的异常。\n看来我们这个增加兼容模式信息的 ",(0,t.jsx)(d.a,{href:"https://github.com/totorojs/monitor.js/issues/13",target:"_blank",rel:"noopener noreferrer",children:"Issues#13"}),"\n是正确的。"]}),"\n",(0,t.jsx)(d.p,{children:"我们看到兼容模式下表单中的 Select 模拟组件显示不正常，最初以为是 Select 组件设置属性造成的异常。"}),"\n",(0,t.jsx)(d.p,{children:(0,t.jsx)(d.img,{src:"https://f.cloud.github.com/assets/143572/834321/3db467be-f2bb-11e2-93c0-007ec07ba729.png",alt:"1c00b54eaad3a6f45ffec0d7526abc6e"})}),"\n",(0,t.jsx)(d.p,{children:"（正常情况下的 Select 模拟组件）"}),"\n",(0,t.jsx)(d.p,{children:(0,t.jsx)(d.img,{src:"https://f.cloud.github.com/assets/143572/834325/57343714-f2bb-11e2-84aa-fb8834763fce.png",alt:"0aafc43da07d07423e1f67199cf5c5b9"})}),"\n",(0,t.jsx)(d.p,{children:"（兼容模式下的 Select 模拟组件）"}),"\n",(0,t.jsxs)(d.p,{children:['IE10 的调试工具还是不错的，最终我们发现在设置 "novalidate" 属性时抛出这个异常，\n想到 Validator 的相关 ',(0,t.jsx)(d.a,{href:"https://github.com/aralejs/validator/issues/30",target:"_blank",rel:"noopener noreferrer",children:"Issues#30"})]}),"\n",(0,t.jsx)(d.p,{children:(0,t.jsx)(d.img,{src:"https://f.cloud.github.com/assets/143572/834340/6db729a6-f2bb-11e2-8558-a8f9681f99bf.png",alt:"edde87186b5919bd49a4d74874c7ce36"})}),"\n",(0,t.jsx)(d.p,{children:"于是这个异常就破解完成。"}),"\n",(0,t.jsxs)(d.h2,{id:"如何修复这个异常",children:["如何修复这个异常？",(0,t.jsx)(d.a,{className:"header-anchor","aria-hidden":"true",href:"#如何修复这个异常",children:"#"})]}),"\n",(0,t.jsx)(d.p,{children:"找回密码的这个页面使用的 Validator@0.8.9，而 novalidate 属性造成的异常在\nValidator@0.9.3 及其后续版本中得到修复。建议升级到最新版本。"})]})}function i(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:d}=Object.assign({},(0,r.ah)(),n.components);return d?(0,t.jsx)(d,{...n,children:(0,t.jsx)(s,{...n})}):s(n)}let c=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["blog%2Fpost%2F2013%2Fweekly-topic-about-exceptions-2.md"]={toc:[{text:"如何修复这个异常？",id:"如何修复这个异常",depth:2}],title:"每周异常：第 2 期",headingTitle:"每周异常：第 2 期",frontmatter:[{template:"post.html"},{date:"2013-07-22T00:00:00.000Z"},{tags:"每周异常"}]}}}]);