"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["2518"],{88795:function(e,n,r){r.r(n),r.d(n,{default:()=>i});var t=r(74132),a=r(40453);function c(e){let n=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",br:"br",hr:"hr",strong:"strong",cite:"cite",em:"em",footer:"footer",div:"div"},(0,a.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{id:"javascript-无块级作用域",children:["JavaScript 无块级作用域",(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#javascript-无块级作用域",children:"#"})]}),"\n",(0,t.jsx)(n.p,{children:"最近在做一系列JavaScript压缩工具，语法压缩，语义压缩，字符串压缩均有涉及（p.s.有趣的是，\n压缩变量名之类的“有损压缩”不影响代码执行，但是字符串压缩这样的“无损压缩”却总是需要解压消耗）。"}),"\n",(0,t.jsx)(n.p,{children:"在实现压缩局部变量名时，最初的实现是将 if/else, for/in, do/while, switch/case/default,\ntry/catch/finally, with和Object实例对象（后面统称为“块级作用域”）与function一样，\n都作为独立的作用域，但是测试发现在JavaScript中并不是这么回事。"}),"\n",(0,t.jsx)(n.p,{children:"尝试着在块级作用域里声明定义变量："}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"if(true){\nvar bool=true;\n}\ndocument.write(bool); // output:true\n"})}),"\n",(0,t.jsx)(n.p,{children:"会发现输出true，而且不论嵌套多深，也不论使用任何块级作用域进行嵌套，最后变量\n依然如同在调用处之前，而且同级的作用域中定义的一样；值为在此之前，在块级作用域中所做改变的结果。\n注意：如果块级作用域未被执行，则其中声明定义的变量会被声明（var name），但不被定义\n（即未被初始化，此时name为undefined，引用name时不抛异常）。"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"if(false){var bool=true;}\ndocument.write(bool); // output:undefined\n"})}),"\n",(0,t.jsx)(n.p,{children:"之前虽知道，IE里for(var i=0;...)里定义的i，在for之外也是可以使用的，但是现在才知道这种情况更为猖獗，\n大出我的意料之外，而更意外的是，IE 7(IE6?), Firefox 3(FF1,FF2?), Opera 9, Chrome 1, Safari 3表现均丝毫不差。"}),"\n",(0,t.jsx)(n.p,{children:"虽然与某些编程规范不同，但是js就是这样了，唉。早知道这样，压缩变量名这部分也就不用那么费劲了，只得重写了。"}),"\n",(0,t.jsxs)(n.p,{children:["另外还有一些JavaScript作用域方面的文章：",(0,t.jsx)("br",{}),"\n[",(0,t.jsx)(n.a,{href:"http://www.blueidea.com/tech/web/2007/4855.asp",target:"_blank",rel:"noopener noreferrer",children:"http://www.blueidea.com/tech/web/2007/4855.asp"})," JavaScript中的作用域]，好像是realazy翻译的，\n文章很好，虽然有点文不对题（主要阐述this的作用域链问题）。",(0,t.jsx)("br",{}),"\n[",(0,t.jsx)(n.a,{href:"http://www.cnblogs.com/3zfp/archive/2008/10/24/528644.html",target:"_blank",rel:"noopener noreferrer",children:"http://www.cnblogs.com/3zfp/archive/2008/10/24/528644.html"})," js变量作用域及可访问性的探讨]，\n详细介绍了各种变量的作用域及其可访问性问题。"]}),"\n",(0,t.jsx)(n.p,{children:"附A 测试代码："}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'// Global Scope\nif (true){\n  var v10 = true;\n}else {\n  var v00 = false;\n}\ndocument.write("v10 : "+v10+"<br />");\ndocument.write("v00 : "+v00+"<br />");\ndocument.write("<hr />");\n\n// Function Scope\nfunction functionScopes(){\n  if (true){\n      // 以下均执行\n      var v11 = true;\n\n      do{\n          var v12 = true;\n      }while (false);\n\n      while (true){\n          var v13 = true;\n          break;\n      }\n\n      switch (1){\n      case 1:\n          var v14 = true;\n      default:\n          var v15 = true;\n      }\n\n      try{\n          var v16 = true;\n          throw new Error("");\n      }catch(e){\n          var v17 = true;\n      }finally{\n          var v18 = true;\n      }\n\n      for (var v19=0; v19<1; v19++){\n          var v1a=true;\n      }\n\n      with(v11){\n          var v1b = true;\n      }\n\n      function inn1(){\n          var inn11 = false;\n      }\n  }else {\n      // 以下均未执行\n      var v01 = false;\n\n      do{\n          var v02 = false;\n      }while (false);\n\n      while (false){\n          var v03 = false;\n      }\n\n      try{\n          var v06 = true;\n          throw new Error("");\n      }catch(e){\n          var v07 = true;\n      }finally{\n          var v08 = true;\n      }\n\n      switch (1){\n      case 1:\n          var v04 = true;\n      default:\n          var v05 = false;\n      }\n\n      for (var v09=0; v09<1; v09++){\n          var v0a=true;\n      }\n\n      with(v01){\n          var v0b = true;\n      }\n\n      function inn0(){\n          var inn01 = false;\n      }\n  }\n  document.write("v11 : "+v11+"<br />");\n  document.write("v12 : "+v12+"<br />");\n  document.write("v13 : "+v13+"<br />");\n  document.write("v14 : "+v14+"<br />");\n  document.write("v15 : "+v15+"<br />");\n  document.write("v16 : "+v16+"<br />");\n  document.write("v17 : "+v17+"<br />");\n  document.write("v18 : "+v18+"<br />");\n  document.write("v19 : "+v19+"<br />");\n  document.write("v1a : "+v1a+"<br />");\n  document.write("v1b : "+v1b+"<br />");\n  document.write("<hr />");\n  document.write("v01 : "+v01+"<br />");\n  document.write("v02 : "+v02+"<br />");\n  document.write("v03 : "+v03+"<br />");\n  document.write("v04 : "+v04+"<br />");\n  document.write("v05 : "+v05+"<br />");\n  document.write("v06 : "+v06+"<br />");\n  document.write("v07 : "+v07+"<br />");\n  document.write("v08 : "+v08+"<br />");\n  document.write("v09 : "+v09+"<br />");\n  document.write("v0a : "+v0a+"<br />");\n  document.write("v0b : "+v0b+"<br />");\n\n  document.write("<hr />");\n  try{alert(inn11);}catch(e){document.write((e.message||e)+"<br />");}\n  try{alert(inn01);}catch(e){document.write((e.message||e)+"<br />");}\n}\nfunctionScopes();\n\ndocument.write("<hr />");\ntry{alert(v11);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v12);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v13);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v14);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v15);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v16);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v17);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v18);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v19);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v1a);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v1b);}catch(e){document.write((e.message||e)+"<br />");}\n\ntry{alert(v01);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v02);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v03);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v04);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v05);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v06);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v07);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v08);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v09);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v0a);}catch(e){document.write((e.message||e)+"<br />");}\ntry{alert(v0b);}catch(e){document.write((e.message||e)+"<br />");}\n'})}),"\n",(0,t.jsx)(n.p,{children:"附B 测试结果（IE 7, FF 3, Opera 9, Safari 3, Chorme 1均同）："}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"    v10 : true\n    v00 : undefined\n    v11 : true\n    v12 : true\n    v13 : true\n    v14 : true\n    v15 : true\n    v16 : true\n    v17 : true\n    v18 : true\n    v19 : 1\n    v1a : true\n    v1b : true\n    v01 : undefined\n    v02 : undefined\n    v03 : undefined\n    v04 : undefined\n    v05 : undefined\n    v06 : undefined\n    v07 : undefined\n    v08 : undefined\n    v09 : undefined\n    v0a : undefined\n    v0b : undefined\n    'inn11' 未定义\n    'inn01' 未定义\n    'v11' 未定义\n    'v12' 未定义\n    'v13' 未定义\n    'v14' 未定义\n    'v15' 未定义\n    'v16' 未定义\n    'v17' 未定义\n    'v18' 未定义\n    'v19' 未定义\n    'v1a' 未定义\n    'v1b' 未定义\n    'v01' 未定义\n    'v02' 未定义\n    'v03' 未定义\n    'v04' 未定义\n    'v05' 未定义\n    'v06' 未定义\n    'v07' 未定义\n    'v08' 未定义\n    'v09' 未定义\n    'v0a' 未定义\n    'v0b' 未定义\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tags:"})," ",(0,t.jsx)("a",{href:"/blog/tags/JavaScript",children:(0,t.jsx)("cite",{class:"tags",children:"JavaScript"})})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Published on 2009-01-06"})}),"\n",(0,t.jsxs)("footer",{children:[(0,t.jsx)("div",{class:"meta-left",children:(0,t.jsxs)(n.p,{children:["Tags: ",(0,t.jsx)("a",{href:"/blog/tags/JavaScript",children:(0,t.jsx)("cite",{class:"tags",children:"JavaScript"})})]})}),(0,t.jsx)("div",{class:"meta-right",children:(0,t.jsxs)(n.p,{children:["Date: ",(0,t.jsx)("cite",{class:"date",children:"2009-01-06"})]})})]})]})}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}let i=v;v.__RSPRESS_PAGE_META={},v.__RSPRESS_PAGE_META["..%2Fnode_modules%2F.rspress%2Fruntime%2Ftemp-179.mdx"]={toc:[],title:"JavaScript 无块级作用域",headingTitle:"JavaScript 无块级作用域",frontmatter:{}}}}]);