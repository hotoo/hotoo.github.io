"use strict";(self.webpackChunkhotoo_github_io=self.webpackChunkhotoo_github_io||[]).push([["6825"],{70913:function(e,n,s){s.r(n),s.d(n,{default:()=>i});var r=s(74132),l=s(40453);function c(e){let n=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code"},(0,l.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"sql-like-查询的一个问题",children:["SQL LIKE 查询的一个问题",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#sql-like-查询的一个问题",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"在做用户管理的时候，用户表(users) 有一个字段(dept)用来存储用户所在部门的信息，\n字段的值一般是这样的，各级部门间使用横杠分隔："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"XX宝-技术部\nXX宝-技术部-数据仓库\n"})}),"\n",(0,r.jsx)(n.p,{children:"我们的系统有一个根据用户所在部门进行过滤的功能，所以我们用了类似下面的查询语句："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'SELECT * FROM users WHERE dept LIKE "XX宝-技术部%";\n'})}),"\n",(0,r.jsx)(n.p,{children:"这样的性能还好，但是今天发现一个问题是，当有两个部门名称很相似，比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"XX宝-CEO\nXX宝-CEO办公室\n"})}),"\n",(0,r.jsxs)(n.p,{children:["这时在查询 ",(0,r.jsx)(n.code,{children:"XX宝CEO"})," 的时候就会把 ",(0,r.jsx)(n.code,{children:"XX宝-CEO办公室"})," 的用户也查询出来。"]}),"\n",(0,r.jsx)(n.p,{children:"于是想到正则表达式："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE REGEXP_LIKE(dept, "^XX宝-CEO$")\nOR REGEXP_LIKE(dept, "^XX宝-CEO-[\\w\\-]+");\n'})}),"\n",(0,r.jsx)(n.p,{children:"合并正则表达式的另一解："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE REGEXP_LIKE(dept, "^XX宝-CEO($|-[\\w\\-]+)");\n'})}),"\n",(0,r.jsx)(n.p,{children:"杯具的性能问题。"}),"\n",(0,r.jsx)(n.p,{children:"突然想到"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'SELECT *\nFROM users\nWHERE dept="XX宝-CEO"\nOR dept LIKE "XX宝-CEO-%";\n'})}),"\n",(0,r.jsx)(n.p,{children:"于是简单有效的解决了这个问题。"})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,l.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}let i=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["blog%2Fpost%2F2010%2Fabout-sql-like.md"]={toc:[],title:"SQL LIKE 查询的一个问题",headingTitle:"SQL LIKE 查询的一个问题",frontmatter:{date:"2010-08-13T00:00:00.000Z",tags:"SQL"}}}}]);