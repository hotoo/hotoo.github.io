[{"id":0,"title":"关于","content":"#\n\n本站是闲耘的个人网站，主要用于博客和项目展示。\n\n网名：闲耘，寓意闲庭信步，植杖耘耔。\n\n网络 ID @hotoo，源于早期使用 QQ 时的网名“糊涂”，是个糊里糊涂过完半生，一事无成的 Loser。\n\n\n\n熟悉 Web2，关注 Web3，Vim 重度用户，自行车、球类、棋类运动爱好者；崇尚自由，信仰民主与法治。\n\n民主启蒙推荐看哈佛大学公共课《公正：该如何做是好？》，科学启蒙推荐《世界观》。\n\n\n联系我#\n\n * Email: hotoo.cn@gmail.com","routePath":"/about/","lang":"zh-CN","toc":[{"text":"联系我","id":"联系我","depth":2,"charIndex":203}],"domain":"","frontmatter":{},"version":""},{"id":1,"title":"陀螺","content":"#\n\n在被抽打中不羁执着， 在痛苦里继续发现快乐。 信仰唯有围绕我心， 才能实现不倒的自我。\n\n-- 闲耘","routePath":"/blog/post/2004/top","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2004-02-01T00:00:00.000Z"},"2":{"tags":"Life"}},"version":""},{"id":2,"title":"汉化Family Tree Builder","content":"#\n\n前文有言 理想的族谱软件Family Tree Builder 说虽有中文站， 但是软件本身没有中文化，因为很喜欢并且很需要这款软件，就自己动手汉化了过来。\n\n\n\n汉化原理很简单：\n\n * 备份软件安装目录下，Lang子目录中的English.lang（也可以是其他国家的语言文件）。\n * English.lang其实属于一种属性文件（properties），将每一行的第二部分翻译成中文 （或合适的文本）即可。\n * 备份安装目录下，Res子目录中的English.bmp图片。\n * 制作一张32x28像素，bmp格式的中国国旗图片，命名为English.bmp，放到Res目录。\n * 启动程序，菜单“工具(Tools)”-“选项(Options)”， “名字(Names)”-“Display people's names”设置为\n   Last First (Armstong John)， 即让姓氏(Last Name)放在名字(First Name)之前，符合中文习惯。\n   “日期(Dates)”，Day/Month/Year format 设置为 %y%-%m%-%d%， “Month/Year format”设置为\n   %y%-%m%。可以根据自己的习惯设置， 其中 %m% 是使用英文短格式，如Mon，在English.lang改为数字即可。\n\n注意：部分文本不可以翻译为中文，如日期选择按钮类的，提示文本为中文时，显示乱码。 另外程序本身左侧的列表(List)的姓名列，中文也显示列表（好像所有List\nView都不支持中文）。\n\n下载文件 托管在Google Code 上， 同时支持SNV提交，有兴趣的朋友联系我，希望大家来共同完成。","routePath":"/blog/post/2008/chinese-localization-family-tree","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-11-21T00:00:00.000Z"},"2":{"tags":"Tools, Family-Tree"}},"version":""},{"id":3,"title":"同步Web客户端的时间","content":"#\n\n富客户端应用的普遍流行，许多操作直接在客户端完成，而一些跟时间相关的操作， 客户端时间的正确性就显得尤为重要，一个和标准时间相差得离谱的时间，\n可能会带来滑稽甚至严重的错误。\n\n在C/S构架下，对时间有要求的应用程序一般解决方法是同步客户端和服务器端的时间， 一些要求较高的应用甚至需要专门的时间戳技术。\n\n普通的B/S应用程序一般没有权限同步客户端的时间（也不一定有这个必要）， 这个问题也有一些解决办法。\n\n 1. 响应用户请求时返回服务器时间，并使用计时器（如：window.setInterval）做一个虚拟时钟。\n    但是考虑到浏览器消耗和脚本计时器本身并不精准，长时间运行后时钟会出现较大的误差，予以忽略。\n 2. 响应用户请求时返回服务器时间，并计算服务器与客户端之间的时间差， 每次时间操作均以该差值进行修正（可以专门做一个接口）。或者考虑只有在\n    差值较大的情况下才进行修正（并提醒用户修正客户机时间）。\n\n另外还要考虑用户所在不同时区的情况（Date.getTimezoneOffset）。\n\n但是对于较精准的时间需求，这样仍然有一个问题，即从服务器端响应到客户端返回过程中\n的网络传输时间。这是一个随机数，根据网络情况和其他偶然因素有关，从几十毫秒到几十秒不等， 有时达数分钟之久，最惨的是整个页面超时，当然同步也就没有必要了：）\n\n\n\n如上图，客户端从客户机的t0时刻发送请求到服务端，然后服务端在T0时刻得到请求，\n经过连接数据、计算等操作，最终在T1时刻响应完成，客户端最后在t1时刻加载完成。\n\n此时我们最关心的是服务器返回到客户端加载完成这段时间的网络传输耗时， 但是暂时无法精确求得，只有一个相当不凑和方法：客户端发生请求时，\n带上当时的客户机时间（t0，浏览器请求头信息里一般带有，也可以通过客户端脚本 new Date()，此时则需要通过异步请求），服务器计算所耗时间也可以得到，\n响应时返回服务器计算耗时（T1-T0）以及浏览器请求的时刻（t0）以及服务器时间，\n客户端加载完成时刻（t1）计算网络传输总共耗时为：(t1-t1)-(T1-T0)， 之后以一定比例（如1:1）计算响应的网络传输耗时。\n\n结果相当不凑和，而过程又相当麻烦，所以只作为抛砖引玉之篇。\n\n\n\n图片来自 Baidu图片 搜索。","routePath":"/blog/post/2008/correct-web-client-datetime","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-09-01T00:00:00.000Z"},"2":{"tags":"Web-Design, DateTime"}},"version":""},{"id":4,"title":"电子图书管理软件幻想","content":"#\n\n一直以来，稍微好点的电子图书管理软件是特别的少，而做很不错的更是少之又少， 要说真正让用户喜欢，或者至少还满意的，到目前为止，没有。\n\n而与之功能相似，状态却截然相反的是，图片和音乐文件的管理软件却如此兴旺发达。\n\n下面先介绍一下图片管理软件，它们大致有以下几个特点（这里以个人最偏爱的 Picasa 3 Beta 作参照）：\n\n * 看图。图片管理软件最好能（方便快捷的）阅读各种格式的图片。（Picasa 3的看图模块很炫很优秀，\n   半透明状态悬浮在窗口上，附有一些播放，翻转，标星，打开在Picasa中编辑等快捷功能。 不过Picasa对GIF动画支持很烂，甚至会毁掉动画的动态特性）\n\n * 管图。每一张图片都不是独立存在的，它们存在于一些相关/无关的相册中。 对于一个图片管理软件来说，对相册的管理能力尤为重要。\n   （Picasa可以动态扫描整个磁盘/指定目录的所以支持的图片， 还可以建立独立于存放目录物理路径之外的虚拟相簿功能，感觉就像管理你的家庭相册一样）\n\n * 搜图。搜索功能对于任何一个信息系统来说都必不可少，而对于图片搜索，还有一些有待探索的领域。\n   （以搜索著称的Google生产的Picasa自然有这个功能，虽然还有待提高）\n\n * 写图。这是对单张/多张图片进行微量/智能调整的高级特性。 这个可以交给专业的图片处理软件，对图片管理软件来说非必要，但是一定要提供快速定位到系统资源、\n   直接由这些专业的处理软件打开的特性。（Picasa有一些像改变色相，去除“红眼”这样的简单功能，\n   另外，和Google搜索的“手气不错”一样，Picasa也有这样自作主张的功能）\n\n而我所期待的图书管理软件，就像上面列出来的这些特性一致：\n\n * 看书。软件最好能支持多种图书格式，因为现在的图书格式繁多，一一支持不太现实， 也没有必要，让管理者做好管理的事情就够了，当然还需要能够方便的定位资源，\n   并能与其他专业的看书软件配合。另外最重要的，是有一些读书计划方面的规划系统 （可以结合一些读书技巧/理论）。\n * 管书。每个人都会有自己的个人图书库，当这个库越来越多时，管理则是势必施行，\n   在管理方面，图书有它和图片的不同之处，比如分类（可以参考但不拘泥于图书馆的管理方式），\n   加一些现流行使用的小标签，图书的名称，ISBN，缩略图，作者等，软件最好，或者说最起码能像 Picasa\n   一样支持动态扫描指定位置的所有支持/指定格式的图书。\n * 搜书。并不是每个人都能够/需要看并记住所有收集的电子图书的， 在需要时快速定位的指定位置，或者至少找到匹配的书。\n * 写书。编辑书名，作者，缩略图，分类，标签，ISBN，给喜欢的书标星等， 另外像编辑PDF的书签或添加评语/附注，非必须，有专业的编辑软件支持就可以了。\n\n目前发现最好的有 Foxit Library，它支持静态扫描和书架归类，并能够使用自己的 Fixit Reader 打开PDF文件，但是在使用它管理图书时，\n操作不便到简直不可用的地步，而且速度很慢（可能是因为我的书太多， 但是Picasa管理我更多的 图片时，一点都不显胖），并且不支持搜索（有一个索引功能）。\n\n另外 SSReader 也有一个“本地图书馆”，可以导入本地目录。 它会按照目录结构生成默认归类（跟系统资源管理器差不多，建议还是用资源管理器比较好）。\n\n不知道为什么现行的图书格式都不支持（像音乐文件一样）将书名，作者，缩略图， ISBN等信息存储在图书属性中，这方面难道没有对应的规范，还是牛仔太多了？\n\n这样的软件是一个梦吗。","routePath":"/blog/post/2008/dream-for-ebooks-manager","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-10-15T00:00:00.000Z"},"2":{"tags":"Books, Tools"}},"version":""},{"id":5,"title":"IM 软件互联畅想","content":"#\n\n现在的IM软件（如QQ, MSN, Gtalk...）都有各种支持的新邮件，日志/博客更新及\n好友联系资料更新的检查功能，它们各自为政，互不相干，每个IM服务商都只支持自己提供的服务。\n\n而现在的IM领域愈来愈趋向于互联互通，相互开放。这也是众心所向，大势所趋。\n\n在这个时候，IM软件的检查用户更新的功能也应该相互开放，相互支持。\n\n就拿新邮件检查来说，其实 mail notify 的相关软件相当多，它们有的具有针对性，只对某些邮件服务商服务 （如 gnotify (仅支持单个帐号)，\nGmail Manager (Firefox插件，支持多个Gmail帐号)），\n有的具有开放性，同时支持若干个不同服务商和多个不同帐号。当然最好是能同时支持多个服务商和多个帐号了。\n由于不同邮件服务商（为不同用户）提供的服务不同，获取新邮件的方式不一而足，一般服务商只提供pop服务\n（如126，163邮箱。另外某些服务商该功能需要收费），而Google同时提供Atom格式（gnotify支持该格式）。\n以pop方式实现的检查新邮件功能总觉着不那么舒服（但至少能实现），Atom 格式比较合适（但其他服务商不支持）。\n如果IM软件能提供多邮件帐号、多服务商的新邮件检查支持，这将是相当棒的了。 （注：Pidgin，原Gaim，支持检查登录帐号各自新邮件的功能。）\n\n再就是日志/博客（以下简称博客）更新，现在的博客都支持RSS/Atom输出，检查更新应该没有技术难度。\n\n用户资料更新的话，可能还需要出新标准才行，最好能支持第三方应用 （比如我在某个专业提供个人联系资料服务的服务商那里公开某部分资料给某些好友，\n这些有权限的用户就可以得到相关更新）。\n\n最后关于IM本身的互联互通，希望有一天能做的真正的互联，就像我有Gmail可以发邮件到163一样， 之间只有通信标准，没有其他阻碍。","routePath":"/blog/post/2008/dream-for-im","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-08-03T00:00:00.000Z"},"2":{"tags":"IM, Email"}},"version":""},{"id":6,"title":"参考","content":" * \n\n\n阶乘(factorial) & 尾递归(Tail Recursion)#\n\n今天看了dennis的《用递归计算阶乘咋不行呢？》 受益良多，这里做下小结。\n\n传统的递归算法写起来很漂亮，代码很简洁，但是每递归一次就需要更深一层的堆栈支持， 可能会造成内存溢出而失败，所以递归和goto语句一样声名狼藉。\n\n> 甚至《代码大全》的作者有这样一句话：如果为我工作的程序员用递归去计算阶乘，那么我宁愿换人。\n> 作者对递归的态度相当谨慎，这在静态命令式语言中显然是正确的，但是在函数式语言中，\n> 由于有尾递归优化的存在，递归反而是最自然的形式，况且我打心里认为递归更符合人类思维。 (by dennis)\n\n尾递归就是从最后开始计算，每递归一次就算出相应的结果， 也就是说，函数调用出现在调用者函数的尾部，因为是尾部，\n所以根本没有必要去保存任何局部变量，直接让被调用的函数返回时越过调用者， 返回到调用者的调用者去。举例说明。\n\n线性递归（传统递归方式）：\n\n\n\n尾递归：\n\n\n\n这里将基于尾递归的求数值阶乘算法贴下：\n\n\n\n效率上和循环迭代、阶乘改进算法 相当甚至稍胜出（ie6,firefox2,safari3），普通递归的效率最为底下，且需要深入堆栈。\n\n\n参考#\n\n * 《尾递归》-百度百科\n * 《用递归计算阶乘咋不行呢？》-dennis","routePath":"/blog/post/2008/factorial-recursion","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-04-08T00:00:00.000Z"},"2":{"tags":"算法"}},"version":""},{"id":7,"title":"Family Tree Builder:理想的族谱/家谱软件","content":"#\n\n去年春节回家，老爸让我把家谱（族谱）放到电脑上，但当时家里不能上网， 手头又没有理想的家谱软件，只能把一些文本输入到电脑上。\n\n后来又尝试使用树型结构（当时使用梅花雪树）临时模拟，但是族谱是一种双亲（甚至多亲： [古代可同时]结婚多次）树型结构，使用普通的单亲树型结构就显得很别扭，\n最后使用纯文本拼成一个简易版本。\n\n\n\n这个版本也算理想，但是涉及到详细资料，尤其是当这棵树变得更大而复杂，盘根错节时， 这个纯文本拼凑起来的双亲树就显得力不从心。\n\n后来回杭州工作时，找了一些软件试用，大都不怎么理想（大概是我崇洋媚外的缘故， 国内确实还没看到什么让我觉得有脸拿出来使用的族谱作品），只是找到一个仅支持\n联机使用的Flash版本：中国传家宝， 只能联机使用让我觉得很不方便，而更不方便的是\n设计上有一些（大概）不合理，操作不便，并且速度也不行，让我满意的大概只有显示效果不错。\n\n过了很长时间，零星的找找也没得到什么结果。\n\n后来无意在VeryCD上看到一下族谱软件，是外国专业公司制作的产品，不过给人的感觉有点\n太强而大的样子，而且收费挺贵。顺手又上Google搜寻一番，收获不小，这个市场貌似现在很活跃的样子。\n\n于是就发现了这个相当理想的免费软件：Family Tree Builder （这是它的 英文网站），号称支持29中本地化语言（事实上也是如此）。\n不过遗憾的是，虽然它有中文网站，但是软件本身却没有中文本地化版本，刚安装在Windows Server 2008\n上时崩溃了好几次（大概是我没有摸清它的脾性），而且更糟糕的是程序左侧的List成员列表视图显示中文乱码。\n不过它的优点也相当可观，免费，启动速度快，自动备份（崩溃后可以恢复），支持多国语言，视觉效果好，\n操作方便，功能齐全，而且可以导入导出标准系谱数据格式gedcom，这里是它的 中文官方介绍，\n传说是族谱学家级别的人士和专业软件设计专家创造出来的（事实上看起来应该也是如此）， 适用于管理大型及小型的族谱。\n\n","routePath":"/blog/post/2008/family-tree-builder-professional-genealgy-software","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-11-15T00:00:00.000Z"},"2":{"tags":"Family-Tree, Tools"}},"version":""},{"id":8,"title":"Firefox本地化及其切换","content":"#\n\n昨天用Firefox内置的下载管理器下载一个较大的文件，而且新搬来这边的网速慢到让我想起\n令人怀念的大学时期（那时候的校园网，不是一般人能够忍受的），无意中我看到下载管理器里\n当前下载的文件下显示着“第x小时，剩余x分钟”的提示（不超过一小时时，只显示“剩余x分钟”）。 看到这个提示，我当时有两种想法：\n\n * Firefox下载管理器的剩余时间计算方法比较有趣，将每小时的下载分段， 所以就有了第1小时，剩余20分钟的说法；\n\n * 翻译问题，实际应该是剩余1小时又20分钟的意思。\n\n这两种理解方式都有其道理，而且在我最初看来，是各占 50% 的。\n\n为了打消疑问，我Google，Baidu试了个遍，但是没有找到一条符合的记录，\n于是又尝试问一些对Firefox有/无兴趣的朋友，以及mozine的Gtalk群友， 但是大伙都没有注意到这个，只能给个猜测的结果。\n\n为了找到答案，就需要知道Firefox英文版是怎么说的，但是我还不想为此再装一个英文版Firefox，\n那么怎么切换本地化语言呢，又是大肆搜罗一番，找到一些近似的，这里整理如下：\n\n\n切换方法 I:#\n\n * about:config\n * general.useragent.locale由zh-CN改为en-US。\n   （前提：Firefox/chrome/目录下有en-US.jar和en-US.manifest）\n\n\n切换方法 II:#\n\n * http://releases.mozilla.org/pub/mozilla.org/firefox/releases/下载安装对应的语言包(.xpi)\n   。\n * 启用该语言包（安装后默认启用）并重启Firefox。\n\n例如我的Firefox版本3.0.3，Windows，则语言包文件地址为：\nhttp://releases.mozilla.org/pub/mozilla.org/firefox/releases/3.0.3/win32/xpi/en-\nGB.xpi （粗体为Firefox对应的版本号）。\n\n注意：http://releases.mozilla.org/pub/mozilla.org/firefox/releases/\n下的目录并不会列出xpi文件，将正确的版本号替换粗体部分，直接拷贝到地址栏回车即可。\n\n安装并重启之后，可以看到Add-ons - 语言页签下会列出刚安装的English(GB) Language\nPack语言包，想撤回中文时，禁用此语言包，重启Firefox即可。\n\n\nIII:#\n\n另外还有几个用来切换本地化语言的扩展，Locale Switcher 和 Quick Locale Switcher，\n它们可以让Firefox直接在菜单栏切换语言。\n\n言归正传，话说回来，切换为英文语言后，尝试大文件下载发现原文是类似于 2 hours, 8 minutes remaining\n这样的提示，意思是剩余2小时8分钟。\n\nFirefox 中文版的这个翻译确实不怎么样。","routePath":"/blog/post/2008/firefox-localization","lang":"zh-CN","toc":[{"text":"切换方法 I:","id":"切换方法-i","depth":2,"charIndex":481},{"text":"切换方法 II:","id":"切换方法-ii","depth":2,"charIndex":603},{"text":"III:","id":"iii","depth":2,"charIndex":1079}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-11-14T00:00:00.000Z"},"2":{"tags":"Firefox"}},"version":""},{"id":9,"title":"Javascript String 方法效率大比拼","content":"#\n\n最初是通过 梅子（梅花雪） 关于大型字符串拼接效率（1， 2）的研究得到启发， 最近又看到 never-online 的 从 trim\n原型函数看js正则表达式的性能， 里面有介绍正则表达式效率陷阱等问题，并提出解决方法。\n我向来对这些鸡毛蒜皮感兴趣，也开始对大型字符串各种方法实现的效率进行比较， 并尝试提高这些方法的效率。\n\n\n大型字符串拼接#\n\n如梅子所言， 使用数组的join方法确实是最好的实现，可以根据这个思路设计StringBuilder, StringBuffer类。\n\n\n大型字符串trim#\n\n其实never-online在他的文章里有一些说的不准确的地方，代码也不算很精炼。 既然这是鸡毛蒜皮的小事，这些零碎东西当然要斤斤计较了。\n我很久以前有收集到这样一些实现，I：\n\n\n\n为了避免正则表达式使用括号带来的消耗，可以写成这样，II：\n\n\n\n另外有一套实现是这样的，III：\n\n\n\n其实调用函数也会多少有一点消耗，写成这样或许会快一点点（开个玩笑，这样写会带来\n一些冗余代码，这时候就需要基于效率（时间）、代码量（空间）和可维护性方面的考量了），IV：\n\n\n\n后来我对正则表达式有了更多的了解，知道了贪婪与非贪婪匹配，于是自作聪明写了这一段：\n\n\n\n我曾经为这段代码自鸣得意了好长一段时间，不过后来想到点号不包括换行符，字符串中间有换行符时，返回值就不正确了，于是不情愿的改成这样（多行模式效率也很低），V：\n\n\n\n谁知，这样的代码遇到大家伙时效率会一落千丈，哎，失败。\n\n原以为String.replace方法比String.substr、String.substring效率低，于是想，只使用正则表达式获得两头（或者一头）的索引位\n置，然后使用substring方法取出子串，VI：\n\n\n\n而最土的方法，莫过于两头都使用循环获得索引了，VII：\n\n\n\n代码里老是for啊for的一大串，为了节省字节，而且有可能的话，也准备再优化一下循环，\n就实现了$indexOf和$lastIndexOf两个方法，可以传递一个返回boolean值的函数作为参数\n（本来还想也支持正则表达式参数的，想想以前扩展indexOf和lastIndexOf方法后的效率，\n就算了），这样就可以求得第一个非空白和最后一个非空白字符的位置了。\n\n\n\n至于说要扩展到支持更长子串和起始索引，以后有需要再说了（顺便说一下，子串越长， 有优化算法可以得到更高效率）。\n\n另一个辅助方法：\n\n\n\n到了永不在线(Google Translate翻译为“永远在线”)的算法，VIII：\n\n\n\n最初这个算法让我很兴奋，直觉上，感觉这样效率肯定要高，不过事实并不是这么简单。\n\n说到这些实现的效率，无法一概而论，因为不同的字符串，它们的效率比也大不同，甚至异乎寻常。\n\n影响trim方法效率的，主要与字符串的总长度，前面空白字符串长度，后面空白字符串长度， 以及前中后的比例有关。详细的效率对比表有时间再上，这里只简要提一下：\n\n对于较小的字符串，各种实现都有不错的表现，而对于大型字符串，则实现III,\nIV表现较为稳定，甚至可以处理超大型字符串（修正：之前有误写成I，II两个较为稳定）。\n\n\n大型字符串字节长度#\n\n即双字节长度为2。注意：这个提法其实也不正确，Javascript是使用Unicode字符集的，\n所有的字符都（有可能）是双字节字符。将汉字等转换为双字节长度主要是为了某些应用。 最土的方法还是循环遍历所有字符，I：\n\n\n\n这里判断字符是否双字节有很多方法，效率较高的之间相差（大概）不大。\n\n另一种实现则看起来很轻灵，寥寥几行，II：\n\n\n\n多动脑子，则想法愈多（也常把简单的事情复杂化），我想如果可以快速取得表达式 (双字节/单字节)匹配次数，两值相加应该比较高效，III：\n\n\n\nIV：\n\n\n\n另外看到梅花雪用数组能提供字符串拼接速度，也想：把字符串split为数组， 不想对大型字符串而言，这split一步就慢得不行。\n\nbytes方法的效率：使用Javascript脚本循环大型字符串（I），确实远不如内置的\nreplace方法（II）快，而使用正则表达式match方法（IV）又比replace方法（III）稍快， 排名第二。\n\n\n总结：#\n\n * replace方法因匹配而被替换的子串愈长，效率愈低。\n * 根据目标字符串，选择合适的实现。","routePath":"/blog/post/2008/javascript-string","lang":"zh-CN","toc":[{"text":"大型字符串拼接","id":"大型字符串拼接","depth":2,"charIndex":168},{"text":"大型字符串trim","id":"大型字符串trim","depth":2,"charIndex":247},{"text":"大型字符串字节长度","id":"大型字符串字节长度","depth":2,"charIndex":1342},{"text":"总结：","id":"总结","depth":2,"charIndex":1776}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-12-29T00:00:00.000Z"},"2":{"tags":"JavaScript, 性能, 算法"}},"version":""},{"id":10,"title":"PANDA-glGo，完美的围棋软件","content":"#\n\n我的围棋水平虽然很差，但是这一点也不影响我对围棋的喜爱程度。 而今天意外的发现一款让我满意度达到100%的围棋软件，它就是 PANDA-glGo， （这是它在\nGNU 和 SourceForge 上的地址，不过 sf 上已经过期）。\n\nhttp://www.pandanet.co.jp/English/glgo/images/glgoshot15_thumb.jpg\n\nPANDA-glGo是一个GUN自由软件，支持Windows，Linux和Macintosh平台，不论外观，还是内涵，\n无一不是完美绝伦。PANDA-glGo支持2D和3D的风格，界面简洁大方，操作方便。 可以设置棋盘背景图和更换棋子，支持多语种，包括中文。\n\nPANDA-glGo默认没有机器人，如果想要人机对战，需要另外下载GNU Go（解压至PANDA-glGo安装目录即可，\n也可以放在其他位置）。机器人跑起来一点都感觉不到慢，即使设置棋力为最高级别（机机对战除外），\n至于算法是否高明，机器人棋力能达到什么程度，我不（需要）知道，目前我还没赢过。 可以设置机器人的棋力级别，棋盘大小（纵横数目）和对战让子目数。另外\nPANDA-glGo还支持网络对战， 或者观看他人对战。联机时，可以查看棋手级别等资料，正在进行的棋局。 可以这么说，PANDA-glGo\n不仅仅是一款围棋软件，更是一个围棋平台。\n\n帮助文档 很完整，只是缺少中文文档。\n\n如果你也是围棋爱好者，这是不容错过的一款软件。好想找一份和这类似的中国象棋软件， 因为我的象棋水平比围棋稍好，可以坚持久一点。","routePath":"/blog/post/2008/panda-glgo-the-perfect-igo","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-10-24T00:00:00.000Z"},"2":{"tags":"Tools, iGo"}},"version":""},{"id":11,"title":"Rating for Foobar2000 columns UI","content":"#\n\n给 Foobar2000 的 Columns UI 设置标星功能：\n\n\nI. 显示歌曲标星级别。#\n\n * 文件 -> 参数设置。\n * 显示 -> Columns UI -> Playlist view。\n * 切换到Columns页签，新建（New）一个列。\n\n\n\n如图，Display里的代码是：\n\n\n\n其实也可以简单是输入：%rating%。\n\n\nII. 设置标星级别功能。#\n\n * 右键播放列表某首歌曲 -> 标签 -> 管理脚本。\n\n * 打开“批量标签”窗口。\n\n * 点击“准备的任务”中的“添加”按钮，选择动作类型为“从另一个字段格式化值...”，确定。\n\n * 目标字段名：RATING 格式化原型：$if($greater(6,$add(%RATING%,1)),$add(%RATING%,1),5)\n\n * 保存为rating++，名称可以自定，点击“运行”按钮。\n\n * 重复第3步。\n\n * 重复第4步，目标字段名：RATING 格式化原型： $if($greater(%RATING%,0),$sub(%RATING%,1),0)\n   保存为：rating-- 点击“运行”按钮。\n\n\nIII. 设置标星界面（操作按钮）：#\n\n * 右键工具栏，点击 Customise...\n * 添加(Add)一个按钮(button)，并点击Change...按钮。\n * Command group中选择“Context menu items”，Item group中选择“Now Playing item”，\n   Command中选择“标签/脚本/rating++”。OK保存后回到Command picker窗口，设置按钮图片什么。\n   注：支持bmp和png格式的图片，但是png图片如果有透明的部分，则可能不会显示。\n * 重复第2步。Command中选择“标签/脚本/rating--”其他雷同。\n * 最后OK保存就可以了，下面是配置完成的界面，两个带星星的按钮功能分别是标星自减和自增。\n\n","routePath":"/blog/post/2008/rating-for-foobar2000-columns-ui","lang":"zh-CN","toc":[{"text":"I. 显示歌曲标星级别。","id":"i-显示歌曲标星级别","depth":2,"charIndex":38},{"text":"II. 设置标星级别功能。","id":"ii-设置标星级别功能","depth":2,"charIndex":180},{"text":"III. 设置标星界面（操作按钮）：","id":"iii-设置标星界面操作按钮","depth":2,"charIndex":513}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-08-14T00:00:00.000Z"},"2":{"tags":"Music, Tools, Foobar2000"}},"version":""},{"id":12,"title":"正则表达式拼接和构建零长度对象","content":"#\n\n之前在网上收集到一个正则表达式拼接的方法/函数，一直没有注意，直到昨天用 jsdoc 生成 api 文档时才看到。\n心里想这样的方法实际应用中大概没什么意义，但是出于好奇就拿出来玩了一下， 这一玩不要紧啊，这么精炼的东西差点成垃圾。\n\n可能是网络编辑器的原因，原始代码有bug，经过修正和测试，现在的代码如下：代码I\n\n\n\n原方法名是contact，现在为了和字符串类的一致，换为concat，至于bug/不足这里不做解读。 这个实际应用意义不大的小程式却有值得称道的几点：\n\n * 正向预搜索匹配第一个表达式里左括号（不包括非捕获组(?:)）的个数。\n * 当第一个表达式没有匹配时返回 0 长度对象（再求其长度）， 可以构建空数组（[]）和空字符串（\"\"），这里使用空字符串，理由下面再解释。\n * 修正反向引用时用的位运算（），这里将匹配到的数值字符串与0位或没有其他意义， 只是将数值字符串转型为数值，相当于 parseInt() 函数。\n\n下面介绍为什么使用空字符串而不是空数组构建0长度对象。代码II\n\n\n\n一万次循环叠加可以发现构建空字符串比构建空数组求长度快1到3倍。\n\n再将代码改为：代码III\n\n\n\n可以发现，求空字符串长度与空数组长度的过程效率相当。可见，代码 II 处空数组效率 多余的消耗主要在构建空数组对象上。","routePath":"/blog/post/2008/regexp-and-zero-width-object","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2008-03-31T00:00:00.000Z"},"2":{"tags":"RegExp, Javascript"}},"version":""},{"id":13,"title":"让对方介绍一下工作的情况，对方对现在的工作有什么看法。","content":"淘宝应聘后记#\n\n前段时间在北京做项目，期间看到一篇关于 \"如何做好一份前端工程师的简历？\"， 又在 blueidea\n看到一些感兴趣的招聘帖，就参照着简要写了一份简历，并随手投了一些。\n\n口碑 UED 因为已经招好了人，就帮我转投给了淘宝 UED（其实好像我本身也有投）。\n\n后来就接到淘宝 UED 部门的面试电话，由于身在外地，以及一些特殊原因，我不能立即赶回杭州面试，\n结果一直拖着，好在最后有hr玄渡给我留了联系电话，让我可以回杭州后直接联系。\n\n昨日(3/9)打电话给玄渡，约好今天(3/10)10点左右去面试，他还特地发来邮件邀请函。 结果我却十分遗憾的迟到了10多分钟（按10点整计算）。\n\n前台给了一份简历表让填，这是我没想到的，因为之前包括网上的网页简历和电子档附件给\n小马的电子简历都有事先发过来，我想淘宝应该有打印件，不过这也在情理之中，是我太山寨了。\n\n我虽然也算是久经沙场，但是现在竟拿不稳笔杆。。\n\n忐忑不安的填好简历，过了有一段时间，圆心才送来一份笔试题，3页总共7题30分钟时间。\n\n这次的笔杆跳得更厉害，我甚至怀疑过几天我自己是否能看懂。\n\n好在题不是很难，用了不到一半的时间就做完了。为了缓解压力，就走到大厅的电子屏前 看中国地图上闪烁的圆点。\n\n面试我的有三个人，小马，圆心和正淳，算是技术调查，主要是探讨简历和笔试内容。 不过我的准备真的很不足（其实也没有专门做准备，都是平时的积累），结果有不少问题\n我答不上来，比如说标签语义化，em是做什么用的，这些特殊的标签我还真是用的少， 而且我回来查了一下 XHTML\n和标签语义化的资料，发现我掌握的实在太少，还有js和框架的内容， 我也答的支支吾吾，虽然我并不是不知道，但老是思维中断，连数组的 push, pop\n都没想起来。\n\n还有让我给自己的js,css,x/html程度打分，我很恬不知耻的给自己掌握的js和x/html打95分，\n在我看来，越往上，要加分越难，所以这相差的5分也是一个难以逾越的高度。 但是事后想起来，自己真实的分数差不多应该是js 80分，x/html 70分。\ncss则打75分也有点偏高，应该大概是65分，。其实在回答这样的问题前，要先问清楚标准，\n给出几个“标杆”，如60分和100分各是什么程度？对方能给出其自身的打分最好。 如果按自己的单方面标准或者根本不经过大脑，则很容易高估自己。\n\n说到我的性格，应该是内外各半，或者稍向内偏一点（在我看来这是缺点，我也有努力）。 缺点的话，有朋友说我心思太细密，有敏感的嫌疑，也有说我太实在，直性子，冲动。\n优点则说我总体上是好的，待人诚恳，热情，有上进心，勤劳，是个好人。我自己则觉得偏内向了点。\n\n最后我也象征性的回问了几个问题，因为还不是淘宝员工，也不好问太内部的问题。 现在想想，是应该事先想好几个有质量一点的问题。例如：\n\n\n对我的简历有什么看法；#\n\n\n对我的笔试有什么见解，给打个分；#\n\n\n自己给对方的印象如何；#\n\n\n让对方介绍一下工作的情况，对方对现在的工作有什么看法。#\n\n已经12点半，hr已经去吃饭，便约我下午1点半复试（主要是和hr谈）。\n\n随便扒了几口饭，提前来到淘宝大厅。\n\n玄渡人不错，从电话里都能感觉出来，很热情，说话也字正腔圆。\n\n大概因为经过上午的历练，也和玄渡个人有关，一对一的谈话中我再也没有感到紧张， 但是却把实话一句不漏的说了出来，被玄渡的笔记了个正着。\n\n说是一周内给答复，不知道是不是委婉的拒绝，听天由命吧，自己准备的也不算太好。 但是如果错过这次，我就再也没有这样的机会了吧。\n\n-- 闲耘 (xianyun.org) 如果自以为了不起，那一定是高估了自己，或者是给自己定的标准过低。 Sent from: Hangzhou 33\nChina.\n\nblog:datetime=2009/3/10 19:33:33:tags=","routePath":"/blog/post/2009/after-nterview","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-03-10T00:00:00.000Z"},"2":{"tags":"Jobs"}},"version":""},{"id":14,"title":"笔试后双方最好能当面讨论题解","content":"#\n\n最近有好几次进阿里集团的笔试经验，有一个小体会：笔试后招聘方和应聘方最好能一起交流讨论题解\n（记得学校考试的时候，对题目有疑问时可以举手提问，老师也有出错题的时候，但是考场上发现后会立即处理。\n不过由于笔试时间短，出现意外再改的话时间会很仓促，所以建议在笔试后讨论，题可以先按照“常理”解答）。\n\n前两次分别在 淘宝UED 和 阿里妈妈 的笔试题里，有一道很相似的题：给数值对象（Number）扩展一个原型方法，\n将数值格式化为指定长度的字符串（另外还有一个条件，淘宝UED给的是“能指定格式最好”， 阿里妈妈则是“能指定进制最好”）。\n\n淘宝UED： 想到数值可能是小数，但题目没有知道小数保留长度等条件，这里只考虑整数位。\n\n\n\n阿里妈妈： 同样有小数问题，而且小数转进制的话也有特殊的地方，这里忽略小数。\n\n\n\n好在两个部门笔试后都有相关讨论，对这一问题做了及时的初步探讨。\n\n今天又去参加了 阿里巴巴 的笔试，这次的题没有重复的， 但是也有一个问题压轴题。\n\n大意是用CSS控制3个DIV，布局如下图（图是随手画的，不计较大小比例）：\n\n\n\n当时解答的时候，在我看来，似乎是只给3个兄弟关系的div，没有辅助标记，让写css控制布局。\n\ncss虽不是我所最擅长，但是这个布局还是可以做出来的，但是难点只在于不使用辅助标记，哪怕是div。\n当时我的解法如下（这里是调试后正确的代码，当时思想相同，但代码没有写完整，也没有经过调试验证）：\n\n\n\n\n\n虽然效果基本相同，而且没有使用辅助标签，但总觉得有点ugly，因为这里的区域尺寸都是固定像素的，\n所以较好控制，当遇到未知高度时，#box2的top就不知道要设置为多少了，还是加一个辅助标签简单灵活。\n\n如果可以使用辅助标记，我的题解如下：\n\n\n\n\n\n还有一个问题是，因为有边框和间隔的关系，左右两个区域是无法上下对齐的。 另外实际应用中还要考虑到清除浮动，父级元素等情况。\n\n当时有想过打破（可能是自己臆想的）规则，用辅助div实现，但是由于尝试在规则之中实现， 结果用了过多的时间，还答的一塌糊涂。\n\n由于这次有多人一同笔试，而且时间很晚（预约18:30分），无法安排讨论，我对这道题也耿耿于怀， 回来请教我那 牛逼的朋友，第一选择也是使用辅助div。\n不知道阿里巴巴这道题的作者是怎么想的，难道是故意的？","routePath":"/blog/post/2009/after-written-examination","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-03-26T00:00:00.000Z"},"2":{"tags":"Web-Design"}},"version":""},{"id":15,"title":"asx snippets for vim","content":"#\n\n前段时间写了个 asx (Windows Media Player 的播放列表格式) 的 snipMate 的模板语法文件。\n\n本身很简单，分享在此。\n\n安装snipMate之后，将上面的 asx.snippets 文件丢进 $VIM/vimfiles/snippets/ 文件夹即可。\n\n\n什么是asx?#\n\n * asx – 百度百科\n * ASX 文件格式全功略","routePath":"/blog/post/2009/asx-snippets-for-vim","lang":"zh-CN","toc":[{"text":"什么是asx?","id":"什么是asx","depth":2,"charIndex":148}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-10-20T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":16,"title":"博客日(blogday)2009","content":"#\n\n今天(每年8月31日)是 博客日， 照例是要分享/推荐5个博客的。\n\n * 互联网，请记住我 我也俨然快要成为vim重度爱好者了，今天搜索vim的相关知识时发现了 这个博主分享的vimrc，这个博客好像主要涉及php, c,\n   vim等方面， 我也不算太熟悉，对我来说是新的，基本符合博客日推荐精神，特此推荐。\n * GMATZ – The “official” blog of Gustava Tandeciorz\n   这个是Twitter上推友分享的jQuery壁纸时看到的,博客好像涉及Window 7, jQuery, Apple, Game,涉猎广泛.\n * Matrix67 我是这个博客的订阅者,博主读文科,但是精通数学,发布了很多的数学经典证明, 算法和数学趣题.\n * 情书 我是通过和菜头的[情书]书评才知道此博的, 博客主要涉及政治, 民主, 自由方面.\n * 阿阳的个人博客 博主貌似是应届毕业生,但是前端开发阅历不浅, 大概属于很有前途的那种. 通过淘宝小马 Twitter 分享知道此博.","routePath":"/blog/post/2009/blogday-2009","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-31T00:00:00.000Z"},"2":{"tags":"Blog"}},"version":""},{"id":17,"title":"C++如何判断声明为基类的对象，是否某子类型的实例?","content":"#\n\n我有如下类结构\n\n\n\n并定义有：\n\n\n\n有一个地方需要判断 lastToken 是否是 KeywordToken\n\n\n\n但是编译时报错如下：\n\n> LexicalAnalyzer.cpp|444| error: cannot dynamic_cast\n> ((LexicalAnalyzer*)this)->LexicalAnalyzer::lastToken’ (of type class\n> BaseToken’) to type `class KeywordToken*’ (source is not a pointer)\n\n貌似不能将父类型转为子类型，那么请问如何判断 lastToken 是 KeywordToken ?\n\n经过“帅的不敢出门 ” 提点 ：\n\n> dynamic_cast < type-id > ( expression ) The type-id must be a pointer or a\n> reference to a previously defined class type or a “pointer to void”. The type\n> of expression must be a pointer if type-id is a pointer, or an l-value if\n> type-id is a reference.\n\ndynamic_cast 需要的是一个指针，将代码改为如下即可：\n\n\n\n\n参考#\n\n 1. 如何在运行时确定对象类型（RTTI）\n 2. dynamic_cast","routePath":"/blog/post/2009/cpp-check-type","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":636}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-12-31T00:00:00.000Z"},"2":{"tags":"Cpp"}},"version":""},{"id":18,"title":"疯狂的性能","content":"#\n\n> Performance is Everything. 工作中最重要的是提高效率。– 约·艾迪生\n\n单元测试是开发人员必做的功课之一，而精益求精的开发人员又会为性能而癫狂。\n\n目前很少有发现 JavaScript 的性能测试工具，程序员在比较几段为同一目标， 但实现方式不同的代码效率时，总需要一行行的写new\nDate()和document.write()。 应该说，这不是什么大不了的事，因为 JavaScript 的性能测试本身就很简单，代码量也不算多。\n\n不过，如果我们可以做的更好，更简单，更直观的话，那就动手吧。\n\n这里我初步写了一个 性能测试的框架， 实话实说，是抛砖引玉，因为这个本身没有什么值得骄傲的， 请大家多提意见和建议，来共建一个更好的性能测试框架。\n\n\n延伸阅读：#\n\n * Performance is Everything\n * Javascript performance test\n * Chrome称王 五款浏览器性能大比拼－软件评测\n * 浏览器 JavaScript 大比拼，Opera 9.5胜出！\n * 主流浏览器JS性能大比拼","routePath":"/blog/post/2009/crazy-performance","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":343}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-23T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":19,"title":"关于面包屑导航","content":"#\n\n一直都很喜欢 千鸟志 的标题面包屑导航方式， 我准备在自己的博客主题中使用这种导航。\n\n\n\n不过，千鸟志的导航部分和标题有重复（另外我比较倾向于使用标签而不是分类）。 下面将导航和标题融合，去除标题部分。\n\n\n\n这里使用了语义化的标签，并且在字体和颜色上突出当前的状态，与标题融合的也算恰当。 不过当标签较多时会将标题挤到很靠后。\n\n另外想到有一些Unix论坛使用的树形导航也不错，稍加改进如下：\n\n\n\n标签应用比上面稍合理，而且css裸奔情况下表现也略如人意（话说“差强人意”这个词的“差” 是“甚，殊”的意思）。对于导航层级不太深的应用，还是不错的。","routePath":"/blog/post/2009/crumb-navigation","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-04-19T00:00:00.000Z"},"2":{"tags":"Web-Design"}},"version":""},{"id":20,"title":"样式表的书写风格","content":"#\n\n按照样式定义的用途归类，采用横排+竖排结合的书写方式。\n\n * 如果定义较少，则直接放在同一行即可。\n * 否则，每一行书写同一类型的样式定义（如字体控制）， 不同类型的样式定义则放在不同的行。\n\n另外，个人偏好：\n\n * 第一个定义总是顶住左花括号，显得紧凑点，最后一个定义也紧靠着右花括号；\n * 每个定义间用 1 个空格分隔；\n * 每组定义从第 2 行开始都相对第 1 行缩进 2 个空格，每组定义间有层级关系的则缩进4个空格。\n * 与“淘宝的css属性顺序书写规范^1^”不同的，我倾向于将color定义和\n   background-color和border放在一起，因为他们都（可能）有颜色值的控制， 也较常改变，而字体本身一般来说是不变的。\n\n\n\n横排+竖排书写风格演示，参考“淘宝的css属性顺序书写规范”。\n\nhttp://farm4.static.flickr.com/3547/3814038548_230aa17c50_o.png\n\n\n参考阅读#\n\n * CSS样式表书写风格\n * 再谈CSS样式表书写风格\n * 淘宝的css属性顺序书写规范 （出处未知，似乎是淘宝 段正淳 的作品， 但是其博客及淘宝UED博客都无找到原版）^1^","routePath":"/blog/post/2009/css-code-style","lang":"zh-CN","toc":[{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":434}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-12T00:00:00.000Z"},"2":{"tags":"CSS"},"3":{"status":"draft"}},"version":""},{"id":21,"title":"CSS字体中文、英文、Unicode名对照表","content":" * \n\n\nCSS字体中文、英文、Unicode名对照表#\n\ncss字体名可以使用2种Unicode格式来书写，以“微软雅黑”为例: 微软雅黑 和 \\5FAE\\8F6F\\96C5\\9ED1都可以。\n如果未找到需要的字体名称，可以到 这里 把简体中文转换为Unicode编码。\n\n另外注意：繁体中文字体名，在简体中文系统中是不能被识别的。\n\n查看 详细的字体名称对照表。\n\n\n参考阅读：#\n\n * CSS中 常见中文字体的英文名称\n * 中文字体在 CSS 中的写法\n * 谈谈网页设计中的字体应用（系列）\n * 中文转Unicode","routePath":"/blog/post/2009/css-names-with-cn-en-unicode","lang":"zh-CN","toc":[{"text":"参考阅读：","id":"参考阅读","depth":2,"charIndex":186}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-14T00:00:00.000Z"},"2":{"tags":"CSS"}},"version":""},{"id":22,"title":"尊严","content":" * \n\n\n尊严#\n\n看了Twitter上有推李普曼的《没有感到的尊严》 一文，想起自己也有类似的经历。\n\n高中时在外面读书，和一个在我看来很赖皮很讨厌的同学关系不合，一天他挑衅被我回击，\n晚上他叫了一个人过来跟我“讲道理”，寝室恰巧没电，没看清对方的面容，但是身体不比我弱。\n当他们把我逼到墙角时，我借助墙壁的力量将对方踢了出去，不知道对方是不是本身就没什么底气，\n叫了一声“不要这么嚣张”之后就再也没有回来。如果对方狠一点，我可能就要吃亏， 但是如果当时我软一点，我在这个讨厌鬼面前就永远都抬不起头。\n\n当然我并不总是那么“英勇”，学校当地有一个死胖子同学老挑衅我，我就回敬了一句，\n并且不礼貌的骂了对方。死胖子好像抓到把柄了一样，老要我道歉，在寝室里我们还打了一架， 当时我被打的很惨，不过没有道歉，上课的时候他总坐到我旁边捣乱影响我学习。\n终于有一节课上我再也容受不了，向他低了头。到现在我还对这事耿耿于怀，想当时如果不低头会怎么样？\n\n为什么老是想到打架呢？当对方无理取闹时，暴力确实是直接有效的解决办法呢，如果能比对方更暴力的话。","routePath":"/blog/post/2009/dignity","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-01-02T00:00:00.000Z"},"2":{"tags":"Life, Think"}},"version":""},{"id":23,"title":"重复的书签","content":"#\n\n项目需求要做一个收藏夹，供用户收藏项目中的功能点。开发人员先给了个初步的设计文稿，\n基本上是参考IE的设计方案（当然其他浏览器的方案也差不离），后来在讨论如何对待\n用户收藏重复的功能点这个细节问题时，也没有经过太多的争论，照例抄袭了IE的处理方式：\n\n * 同一文件夹下不允许收藏重复的功能点，只将新的信息（如名称）覆盖到旧有的信息上；\n * 不同文件夹下可以收藏同一个已收藏的功能点。\n\n但是经过讨论，后来摒弃了这个方案，因为我们看到了Firefox的优秀设计：\n\n * 同一账户不允许重复收藏同一书签；\n * 当用户收藏一个已收藏的书签时，覆盖已有信息（如名称）；\n * 如果被收藏到另一个不同的文件夹时，则将旧的收藏移动到新文件夹。\n\n\n\nChrome包括智能地址栏和收藏夹都吸收了Firefox的优秀设计。\n\n\n\nSafari则表现的不同凡响：\n\n * 用户可以收藏重复的书签；\n * 甚至在同一个文件夹中，以相同的名称存放。\n\n\n\nOpera和Safari表现完全一致，或许他们认为，这是用户的自由。\n\n\n\nIE7和我们所熟悉的一样：\n\n * 用户可以重复收藏已有的书签；\n * 仅当这两个书签放在不同的文件夹；\n * 或者以不同名称，放在同一个文件夹中。\n\n\n\nMaxthon最初是从IE学习并扩展而来，可想而知，并且实际上也是， 它们在对待重复的书签上，也是一致的。\n\n面对这些主流浏览器对待重复书签的态度，像Safari和Opera这样给用户充分的自由，\n或Firefox和Chrome这样“所谓”的智能，以及IE及Mathon取两者（自由或相对不自由） 之中庸，作为经常使用书签的普通用户，你觉得哪种设计更合理？\n\n这里我表达一点自己的想法：\n\n * 不受约束的自由，不是什么好自由；过分的灵活，只会给用户带来迷茫。\n * 书签本身的作用，就是给用户一个记录、并能够快速打开常用或优秀的网址的地方。 如果收藏夹，甚至同一个文件夹中存在（看起来）相同的书签，\n   用户就需要停下来思考自己要的是哪一个。\n * 书签一般都需要记录用户使用的次数，并根据算法排序提供给智能地址栏， 收藏夹存在多个副本也会存在歧义。\n\n从这个角度来讲，Opera和Safari是做的最烂的，IE和Maxthon则做的一般。\n很幸运，这个想法也博得了我们项目组开发人员和PM的赞同，并应用与项目设计中。\n\n\n关键字：#\n\n * 收藏夹(Favorite)：指浏览器用来管理书签集合的工具。\n * 书签(Bookmark)：指单个被收藏的网址信息。","routePath":"/blog/post/2009/duplicate-bookmarks","lang":"zh-CN","toc":[{"text":"关键字：","id":"关键字","depth":2,"charIndex":1003}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-14T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":24,"title":"Firefox Profile 及多实例运行","content":" * \n\n\nFirefox Profile 及多实例运行#\n\n之前就知道Firefox 支持多账户，并允许各账户安装不同的插件，会话信息也完全独立。\n\n方法是制作快捷方式，目标指向Firefox的安装路径，并加上 -P 参数：\n\n\n\n加引号是为了防止空格问题。这样会启动选择账户的对话框，如果想直接指定账户启动， 而不出现对话框，可以在 -P 参数后直接带账户的名称，如默认的 default：\n\n\n\n如果想同时启动多个Firefox独立的账户实例，可以加上 -no-remote 参数。\n\n\n\n受 Editplus 的影响，其<C-b> 快捷键可以使用内置的IE核心浏览器预览和 html 源码间快速切换（也可以使用外部浏览器）。\n\n最近在定义 vimrc 时映射了 Cpp 的快速编译和运行快捷键，顺手一并映射了批处理和 X/HTML 文件类型的运行/预览快捷键，如下：\n\n\n\n由于 default 和 debug 账户都加上了 -no-remote 参数，Firefox 被设置为默认浏览器， 并使用外部程序打开链接是，会弹出如下警告：\n\n> “Firefox 已经在运行，但是没有响应。如要打开新窗口，您必须先关闭该 Firefox 进程，或者重新启动您的系统。”\n\n确定后会被直接退出，打开链接失败。\n\n解决办法是的主账户启动时不带 -no-remote 参数，其他账户带此参数启动，此时从 外部程序打开的链接，会在此不带 -no-remote\n参数的主账户中启动，另外还可以 带上 -new-window 或 -new-tag 参数。\n\n另外还有一个问题是，每次按 <F5> 都会从新的页签或窗口中打开，而不是刷新已有的同路径页。\n\n\n参考#\n\n * 同时运行两个 Firefox实例\n * Geek to Live: Manage multiple Firefox profiles\n * Command line arguments\n * Profiles\n * firefox 啟動參數\n\n另：\n\n * “Firefox 已经在运行，但是没有响应。”\n * Firefox 已经在运行，但是没有响应 2","routePath":"/blog/post/2009/firefox-profile-and-multi-instance","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":723}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-10-22T00:00:00.000Z"},"2":{"tags":"Firefox"}},"version":""},{"id":25,"title":"未知选项的表单设计","content":"#\n\n发现许多的注册表单设计中，性别部分的设计大都这样：使用单选按钮（radio） 并默认选中一个（大都为男性，某些女性频道为主的可能为女性）。例如：\n\n\n\n网页申请QQ （qq.com）帐号\n\n\n\n注册网易（163.com）通行证\n\n雅虎（yahoo.com）的设计比较特立独行，使用选择框（select）， 并默认不选中任何一个。\n\n\n\n而雅虎中国（yahoo.cn）的设计也是使用单选框（radio）， 但是不选中任何一个。\n\n\n\n按常理来说，注册系统并不知道用户的性别是什么，默认选中任何一个都不合理。 yummy有一篇文章《中文按1，For English, press 2》\n提到“如果用户必须做出选择，那就先给他做好一个选择。”，这个道理在某些情况很不错， 但是用在这里不合适。\n\n如果不足够了解用户，就不要替用户做选择。","routePath":"/blog/post/2009/form-design-for-unknow-options","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-05-09T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":26,"title":"带套翻墙","content":"#\n\n因为众所周知的原因(?)，最近GFW变本加厉，穷凶极恶，处处昭示着它即将灭亡的预兆。\n不过在它消亡的前夕，我们还是需要翻墙来争取自己的自由，戴套就是一种不错的方法。 不过最近的套套出了点问题，下面讲修复的办法：\n\n 1. 到这里下载 Tor Cache\n\n 2. 然后将里面的文件释放到（%USER% 替换成你的计算机用户）：\n    \n    * Windows XP(?): C:\\Documents and Settings\\%USER%\\Application Data\\Tor\n    * Vista: C:\\Users\\%USER%\\AppData\\Roaming\\Application Data\\Tor\\torrc\n    * Windows 7: C:\\Users\\%USER%\\AppData\\Roaming\\Vidalia\n\n 3. 启动 Vidalia ，在设置里面，设置”高级”，配置目录为（不同操作系统参考上面及实际地址， 下面以XP为例）：\n    \n    Tor Configuration File: C:\\Documents and Settings\\%USER%\\Application\n    Data\\Tor\\torrc Data Directory: C:\\Documents and Settings\\%USER%\\Application\n    Data\\Tor\n\n\n参考：#\n\n * 连不上 tor 的解决方法\n * 关于近期 Tor 无法连接的问题，请统一在此帖中问、答，谢谢。\n * Tor Cache 和使用方法\n * 近期用不了 tor 的同学请进（zt）\n * 连不上TOR了 (参考第30条回复)\n * Tor.zip\n * 连不上 tor 的解决方法（综合）","routePath":"/blog/post/2009/fuck-gfw-with-tor","lang":"zh-CN","toc":[{"text":"参考：","id":"参考","depth":2,"charIndex":611}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-10-24T00:00:00.000Z"},"2":{"tags":"GFW"}},"version":""},{"id":27,"title":"如何削铅笔","content":"#\n\n看了 JunChen 翻译的 Adaptive Path：我们最爱的草图工具， 我很受启发。之前也有让公司买彩色铅笔用，但现在已经离开用不着了。\n而且一直都很想买个 GTD 记事本以及其他文具，今天抽空就把装备给差不多备齐了。\n\n回来削铅笔的时候，想起自己以前的经历：小时候用过转笔刀和小刀，都会把笔尖削的很尖锐， 跟书本上的引导、同学的同化、以及思维定势都有关，而且也\n基本适合那时候的使用场景。 后来高考使用2B铅笔，也受一些美术专业朋友的影响，学会了把笔尖削得平板愚钝一点 （有点返璞归真，大智若愚的感觉），这种削 法也一直\n使用到现在。\n\n这里要讲的就是这种削法。\n\n * 削表面木头时，先不要削炭芯，倾斜度建议平滑一点，大概15°，也就是圆锥体切面角度大概为30°。\n   大概完成的时候，被削的表皮为2cm长，露出的笔芯部分0.5cm。\n   \n   \n\n * 然后是削笔芯，先在圆柱体的两边削出平行（渐进微斜）的两个平面，尖端厚度大概为0.15cm (1.5mm)。\n   \n   \n\n * 再把笔尖顶端的一侧削（刮）出一点弧度，以便于书写和素描。\n   \n   \n\n * 最后在稿纸上试笔，顺便打磨一下笔尖两侧，使之更便于使用就可以了。 笔尖平时一般不用削，用的时候就可以把笔尖磨成舒适的形状，直到笔尖变短。\n   \n   \n\np.s. 1. 不知道白色笔芯的铅笔用来华什么，一般都用白纸，而且她也不能遮盖掉其他颜色， 不然用做橡皮功能也不错。 p.s. 2.\n文具店的阿姨也在讲求用户体验呢，正准备装修外面的广告招牌， 对店里放笔的盒子的设计细节也有研究。","routePath":"/blog/post/2009/how-to-peel-pencil","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-04-14T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":28,"title":"谦逊","content":"#\n\n谦逊，刚回家路上想起这个词。\n\n前段时间，公司包车组织出游，大客车在及其陡峭的山路上行驶，在每个转弯处都会事先鸣笛示意，\n一般来往的车辆都会这样做，但在一处锐角转弯处，一辆小卡车居然冒冒失失的闯过来，而没有鸣笛。\n在这样险峻的山路上，刺耳的刹车声让整车人都吓呆了，要是按照我的脾气，那辆小破卡车司机\n就要被我骂死（尽管对方无理，但却不保证被骂不生气，骂人，不知道有什么用！）。\n\n大概游山玩水累了，下山的路上，我们许多人都在车上睡着了，不知不觉，已经下得山来，\n行驶在平坦的大路上。然后就听到导游就向我们介绍司机师父，称赞他的驾车技术和为人。 我们一车人，都对他报以热烈的掌声，和发自内心的敬意。\n\n另一次出游，也需要上下山，虽然没有第一次的路崎岖，但是单行山道， 两辆大客车插身过路（老家土话：即两辆汽车对开）需要非常有\n\n * 技术：两辆车最近的距离近10厘米，最难开的时候还需要三番五次的下车目测，这是细活；\n * 远见：前方有车来时，事先停靠在合适的位置；\n * 忍让：甚至经常需要倒车让对方；\n * 合作：一方做的不到位，就有可能将双方堵死在路上。\n\n有空出游的机会毕竟较少，而日常生活中却经常见到横冲直撞的小车，为了一点点的时间， 或者车位，造出极大的危险。不敢肯定说这些小车司机的技术不如大客车司机\n（虽然事实上的确如此，大客车司机需要经过严格的训练和考核，拿的是A照， 只这一点拿C照的小车司机就比不了），但是对比那种谦让的态度，\n确是让人记忆深刻（让我想起小时候经常看见汽车上写的“礼让三先”）。\n\n不止是汽车，摩托车、电动车、自行车也有太多和小汽车司机态度一样的， 我一直就是这样一个态度恶劣的自行车爱好者，自认为车技很棒，什么飚车，慢速行驶，\n双手离开车把，车头跃起，漂移，都会来。\n\n以前看到街上一骑电动车的，洋到不行，甚至频繁的左右摇摆车把，让车身像水蛇一般扭动前行。\n这是及其危险的动作，无论对人对己。每天我上下班路上，也经常能看到一些在车流中频繁左右穿梭的人， 看似车技不错，其实很多连基本功——车把都扶不稳。\n我个人觉得，判断一个人的非机动车（包括自行车，电动车，摩托车在内）的技术能力， 只看他在慢速行驶时，能否扶稳车把即可（其实这也就是在考验控制平衡的能力）。\n\n谦逊的车手，大概应该是这样：尽量靠右行；从左侧超车；超车前鸣铃声； 尽量双手扶车把；控制好刹车系统和刹车时机，让车速保持在可控的范围之内；\n面对逆车道行驶，或占道的行人和车辆，也不必过于气愤（这一点我做的非常不好）。\n\n我最看不惯的是行人或车辆（主要是非机动车辆）闯红灯，这些人甚至在比较繁忙的十字路口见缝插针，\n他们可能抢得了一点自己的时间，却耗费了此时效率更高的汽车时间，把汽车堵在十字路口，\n另外其他驴友也做同样的事，被浪费的就是他的时间了。这种人被撞了我是不屑一顾的， 这是找死，只憎恶他造成交通堵塞，又浪费国家钱财（我又不谦逊了）。\n\n另外，我的房间有一堵墙与楼梯相连，平时总能听见蛮响的脚步声。其实这跟墙的质量 和隔音效果有很大关系，不过想起自己平时也大大咧咧，不顾及他人的感受时，\n够汗颜的，是应该放稳自己的脚步，走谦逊的路了。\n\n非机动车驾驶注意事项：\n\n> 行驶： 右行，并注意靠右，方便赶时间者超车； 行驶过程中千万不要过多S型游动前行。 高速行驶时，注意扫视远方，把握大局； 保持车速在可控的范围内，注意安全；\n> 控制刹车系统和刹车时机。 拐弯： 控制刹车系统，减速。 拐弯前，向转向的一方旁边观察。 超车： 从左侧超车，超车前鸣铃声示意； 被超车：\n> 听到后面鸣铃想超车时，注意扶稳车把，保持前行； 向合适的边靠拢，但不要太急； 注意两边，但不要向后看 其他：\n> 面对逆车道/占道的行人车辆，鸣铃示警，但不必介怀。","routePath":"/blog/post/2009/humility","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-09-08T00:00:00.000Z"},"2":{"toc":true},"3":{"tags":"Life"}},"version":""},{"id":29,"title":"由邮件排序想到的","content":"#\n\n目前的电子邮件系统，均是使用倒序列出邮件列表，最新的邮件总是在第一封。 这样做也并没有什么不好，不过这是最好的排列方式吗？\n\n新邮件很容易将较早的邮件挤到下面甚至是后面的页面中，导致最先收到的邮件反而最后被看到，\n这就出现了公平性问题，当然并不是先到的邮件就一定要先看，甚至邮件被直接无视也有可能。\n而另一个问题是，同一个人连续发了多封相关邮件，这就出现了错误阅读顺序的问题， 如果是最后一封修正前面错误的，而最后一封又有全文引用的话，看这最后一封就可以了，\n但如果没有引用呢，不看前面的邮件确实会摸不着头脑（Gmail的会话功能对这一问题处理较好）。\n\n一般来说，有效率的人不会在收件箱保留过多未读邮件，所以收件箱邮件被分页的情况会比较少见 （受欢迎的收件人例外），所以按顺序排序是个不错的选择。\n\n另外如果收件箱或者存档箱中确实需要分页该如何排序？我的想法是“总倒序，分顺序”， 即总体数据是按倒序排列的，而被分页的页面则使用顺序排列显示。\n效果：第一页就是最后一页，而显示页每一封邮件则按顺序排列。\n\n后来在 VeryCD 看到一个更好的方案：所有数据按顺序排列， 但是默认（首次）显示的是最后一页。细节上可以有一个更好的改进：默认页将尽可能多的显示内容。\n例如默认每页显示 50条评论，当总共有 60条评论时，默认显示第 2页，而第 2页按顺序排列显示 50条， 第一页显示 10条。\n\n当然最好的情况是综合类似Gmail会话功能的方式，将相同主题归为同一个会话中， 这类似于Wordpress的一个评论插件（效果参看 aw's blog， 新版\nWordpress 已经内置该功能）。\n\n个人意见综述：\n\n * 收件箱邮件列表完全使用顺序排列。 先到先被看，这样我就不会因为希望得到重视， 在周日写好的邮件，却等到周一才发出去了； 处理较早有邮件也合乎常理。\n\n * 评论、留言、邮件存档箱使用顺序排序，默认显示最后一页。 这样的话，像 Wordpress 这样使用英文语言，放在底部左侧的 Older Posts\n   也不会觉得别扭了。\n\np.s. 另外发现 draft.blogger.com 的自动保存还是很人性化的，不是使用定时自动保存，\n在用户输入过程中不会瞎保存影响用户，而是在输入停顿时才自动保存。 这有点类似我的节奏感知器上运用的思想。","routePath":"/blog/post/2009/idea-from-email-srot","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-03-15T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":30,"title":"增强 Vim 的语法折叠","content":"#\n\n 1. 折叠多行注释\n\n\n\n折叠为：\n\n\n\n 2. 折叠单行注释\n\n\n\n折叠为：\n\n\n\n 3. 折叠导入外部定义\n\n\n\n折叠为：\n\n\n\n\n\n折叠为：\n\n\n\n 4. 折叠作用域\n\n\n\n折叠为：\n\n\n\n这属于语法折叠部分。\n\n 5. 折叠标记语言\n\n\n\n折叠为：\n\n\n\n\n\n折叠为：\n\n\n\n\n\n折叠为：\n\n\n\n折叠为：\n\n\n\n以上是我目前想到的折叠方式，欢迎补充。\n\n这里推荐一个 增强的 Javascript 语法文件 ， 有非常多值得借鉴的地方。\n\n遗憾：折叠文本(foldtext)没有状态栏(statusline)的居左、居右概念(以等号[=]分隔)，\n比如想将在左侧放置折叠上下文文本，右侧放置被折叠的行数：\n\n\n\n目前只能通过计算 Vim 窗口宽度和折叠文本的长度来模拟。\n\n这个折叠方法我已经在C,C++,Java,Javascript,CSS上实现，主要跟语法(syntax) 文件和折叠文本(foldtext) 有关。\n\n另外我觉得被折叠的行应该和注释一样低调一点（desert主题使用金色的文本前景色）。\n\n@source\n\n@source","routePath":"/blog/post/2009/impoved-fold-for-vim","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-12-04T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":31,"title":"JavaScript 无块级作用域","content":"#\n\n最近在做一系列JavaScript压缩工具，语法压缩，语义压缩，字符串压缩均有涉及（p.s.有趣的是，\n压缩变量名之类的“有损压缩”不影响代码执行，但是字符串压缩这样的“无损压缩”却总是需要解压消耗）。\n\n在实现压缩局部变量名时，最初的实现是将 if/else, for/in, do/while, switch/case/default,\ntry/catch/finally, with和Object实例对象（后面统称为“块级作用域”）与function一样，\n都作为独立的作用域，但是测试发现在JavaScript中并不是这么回事。\n\n尝试着在块级作用域里声明定义变量：\n\n\n\n会发现输出true，而且不论嵌套多深，也不论使用任何块级作用域进行嵌套，最后变量\n依然如同在调用处之前，而且同级的作用域中定义的一样；值为在此之前，在块级作用域中所做改变的结果。\n注意：如果块级作用域未被执行，则其中声明定义的变量会被声明（var name），但不被定义\n（即未被初始化，此时name为undefined，引用name时不抛异常）。\n\n\n\n之前虽知道，IE里for(var i=0;...)里定义的i，在for之外也是可以使用的，但是现在才知道这种情况更为猖獗， 大出我的意料之外，而更意外的是，IE\n7(IE6?), Firefox 3(FF1,FF2?), Opera 9, Chrome 1, Safari 3表现均丝毫不差。\n\n虽然与某些编程规范不同，但是js就是这样了，唉。早知道这样，压缩变量名这部分也就不用那么费劲了，只得重写了。\n\n另外还有一些JavaScript作用域方面的文章： [http://www.blueidea.com/tech/web/2007/4855.asp\nJavaScript中的作用域]，好像是realazy翻译的， 文章很好，虽然有点文不对题（主要阐述this的作用域链问题）。\n[http://www.cnblogs.com/3zfp/archive/2008/10/24/528644.html js变量作用域及可访问性的探讨]，\n详细介绍了各种变量的作用域及其可访问性问题。\n\n附A 测试代码：\n\n\n\n附B 测试结果（IE 7, FF 3, Opera 9, Safari 3, Chorme 1均同）：\n\n","routePath":"/blog/post/2009/javascript-vars-scope","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-01-06T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":32,"title":"老家的粳米茶","content":" * \n\n\n老家的粳米茶#\n\n我的老家在江西九江瑞昌市南义镇， 有非常多独特的乡村美食，大多只能用老家土话叫名字，普通话都不知道该怎么说， 汉字也不知道该怎么写才正确。\n\n比如说粳(Jing)米茶，老家土话的发音应该是“箭米茶”，箭米其实就是粳米， 粳米茶是老家的习惯叫法，因为大都是在炎热的夏日中午，咕嘟咕嘟炖几个钟头，\n然后让它自然凉掉，到下午的时候当晚餐，或下午茶喝。实际上我想应该属于粳米粥。\n\n我搜了一下粳米茶，大都是九江的做法，用粳米和绿茶煮成，这完全不同于我老家的材料和做法。\n\n西祠胡同有一篇《辉婶学艺–粳米茶》的做法和老家的非常相似：\n\n * 先要有炒熟的粳米。这是整个过程中最为关键的一步， 我没有专门学， 当然不会，熟粳米是从老家带过来的，老妈很辛苦。\n   \n   \n\n * 还要有晒熟的红薯，或白薯粒。这个也很关键，过程有点漫长，大概几天吧， 一般是夏天把挖回来的红、白薯洗净切成正方体颗粒，放在外面让太阳暴晒，\n   晒干之后可以存储很久。老家还有纯粹煮红、白薯，或薯粒的做法， 叫薯茶或薯粒茶，当早茶或下午茶都可以。\n\n * 白砂糖，红糖也可以。\n\n如果上面的原材料都具备了的话，煮法就没什么好说的了，直接放到锅里煮就行了， 先用猛火煮开，然后用文火慢慢炖，到薯粒变软和，粳米煮开花就可以了。\n\n\n\n干薯粒本身就很甜，不过如果喜欢，加糖后味道会更佳。\n\n","routePath":"/blog/post/2009/jingmi-tea","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-09-05T00:00:00.000Z"},"2":{"tags":"Life"},"3":{"toc":true}},"version":""},{"id":33,"title":"让 gvim 访问网络资源","content":"#\n\n当我还是 Vim 超级菜鸟的时候，我就知道 Vim 可以和 Editplus、UltraEdit 一样， 访问网络资源，操作方式也很类似：\n\n * 使用菜单栏的“文件”->“打开”命令；\n * 或者使用工具栏的“打开”按钮；\n * 会打开“编辑文件”对话框，此时在默认光标获焦的“文件名”文本框中输入网络资源定位符；\n * 回车，或点击“打开”按钮；\n * Vim 就会加载网站资源文件的内容。\n\n没有错，作为超级菜鸟，我们就是这样被当作什么都不懂，什么都不会的小孩一样来教导的。\n\n本来这样已经可以了，我们还有强求什么呢？真是得寸进尺啊，我发现 gvim 使用命令 是无法正常访问网络资源的。\n\n\n\n虽说 Vim 从 7.0 就已经默认集成安装了 netrw. Vim 了，支持网络资源访问， 但是如果使用上面的命令，gvim 会告诉你说：\n\n> error (netrw) neither the wget nor the fetch command is available\n> ——————————————————————————————– “NetrwMessage” –缓冲区无内容–\n\n向人请教得到解答： 这是因为缺少访问网络资源的程序（wget） Windows下需要下载 WGET for Windows (win32)， 将\nwget.exe 放到某个系统环境变量 Path 包含的位置（如 c:\\windows）即可。 如果是Linux，直接安装wget即可。\n\n现在还有一点问题，gvim使用上面的某个命令访问网络资源时，会打开命令行窗口：\n\n\n\n需要再敲一个键，才能关闭这个命令行窗口（Windows 7因为安全的原因，还有更多一步麻烦）， 并将网络资源的内容读到\nVim，目前不知有什么完美的方法，不需要打开，或者能够自动关闭这个窗口？ 而使用菜单或功能按钮等 gui 操作方式，是没有这些东西的，只是在同步加载远程资源时，\n不能进行其他操作。\n\n\n参考讨论#\n\n * Vim 网络读写功能的问题","routePath":"/blog/post/2009/let-vim-to-access-remove-resources","lang":"zh-CN","toc":[{"text":"参考讨论","id":"参考讨论","depth":2,"charIndex":841}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-09-12T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":34,"title":"电梯按钮设计","content":"#\n\n * 外面选择“上”或“下”的按钮换成“开门”，这样外面也可以中断自动关闭的电梯门， 并增加选择楼层按钮。这样电梯系统可以预知各个起始楼层和目标情况，\n   可以结合历史数据合理调整运转过程，对用户来说，也不必都挤在电梯里忙着（或忘记）选择目标层；\n\n * 选择“上”、“下”以及楼层的按钮可以取消选中。建议如下：当前被选中，则按一下取消选中，否则选中。\n   目前有一些稍人性化的电梯可以取消操作，但是要按N下，而一般用户又不知道N等于几？\n   其实按一下就够了，不过避免误操作，连续按两、三下取消也可以，并在旁边给出提示；\n\n * 里面保留选择上、下和楼层按钮（用户可以中途改变目标），但是选择楼层的按钮应该放到开、\n   关门按钮的下面，方便儿童和残障人士使用（开、关门是自动的，影响不大）。\n\n这个改造成本不知道算不算大，每一层都需要增加选择楼层的按钮，不过这对用户和系统都是有利的， 为电梯系统设计的合理也做了准备。我觉得这是未来电梯的最低配置。","routePath":"/blog/post/2009/lift-button-design","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-04-08T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":35,"title":"Vim映射Home键到首个非空字符","content":"#\n\n许多编辑器有相关选项，可以直接设置让 <Home> 键在首个非空字符和行首之间跳转。\n\nVim 也有快捷键，normal 模式下：\n\n * 0 跳转到行首；\n * ^ 跳转到首个非空字符；\n * $ 跳转到行尾。\n\n目前未知跳转到最后一个非空字符的快捷键，有个网友提供了一个很好玩的技巧：\n\n\n\n为了将 <Home>和 End> 键映射到其他编辑器常用的设置，我写了个可以用的代码，请高手不吝赐教。\n\n\n\n\n参考#\n\n这里还有几个实现很优雅，但稍有问题的脚本：\n\n * SmartHome and SmartEnd over wrapped lines\n * Crazy Home Key blog\n * c9s: smart_home_end.vim","routePath":"/blog/post/2009/map-home-key-for-vim","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":206}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-10-22T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":36,"title":"改进的菜单按钮","content":"#\n\n一直想写关于菜单按钮的设计，但是太懒惰的原因，老是拖着不做。当然今天也没勤快到哪里去， 下面第二个改进图是用 Pencil 画的，并没有用脚本实现，哎，懒啊。\n\n先看QQ/TM的设计，无论选项是什么，按钮上都没有体现出来。\n\n\n\n我觉得其实不论是文本，还是图标，都可以把当前选中状态体现在按钮上的，便于用户确认按钮当前的状态。 下面是改进后的菜单按钮（以QQ/TM为例）。\n\n\n\n一般来说，菜单按钮都应该做用户“最后一次”使用选择的动作。 例如早期QQ的视频、语音菜单按钮，MSN的菜单按钮，还有旺旺的菜单按钮，都应该如此。\n\n\n\n\n延伸阅读#\n\n * @blogspot","routePath":"/blog/post/2009/menu-button-improved","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":269}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-04-17T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":37,"title":"菜单项图标","content":"#\n\n新装的Windows 7总有一些因为暂时不习惯或无知而遇到的问题，例如网络链接就经常出问题， 右键一个网络适配器，我们大概可以看到这样的菜单。\n\n\n\n看到这一连串代表着安全的图标你作何感想？\n\n图标可以增强视觉效果，加深记忆印象；合理的图标可以到底一目了然的功效， 而不用看后面的介绍性文本；但是糟糕或者不合理的图标，只会适得其反。\n\n所以说，这几个图标，用的确实让人雷到，（几乎？）没有一个能确切表达对应菜单项功能的。\n\n如果没有合适的图标用来表达菜单项的功能，就不要使用图标。\n\n当然Windows 7的右键菜单图标并不是都用的这么烂。\n\n\n\n之前的Windows系统也做的很好，选用的图标都很恰当，留白也留的很性感。\n\n","routePath":"/blog/post/2009/menu-item-icons","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-16T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":38,"title":"开放篮球场地.地标工程","content":"#\n\n作为业余篮球爱好者，作为他乡游子，每到一个陌生的地方，都想尽快找到一个能施展球技、\n或者仅是活动一下筋骨的场地。就地解决当然也可以，但是如果有自由开放的美好世界，为什么不加入进去呢？\n\n一般来说，大多数开放的篮球场地都在学校里（大学最多，中小学一般不对外开放），\n有一些公益场所也有简易的设施，所以希望能有一些学生朋友能给予帮助，我将尽力争取得到帮助。\n\n基于这样的想法，我展开了一个“开放篮球场地.地标工程”的想法，为广大篮球爱好者服务。\n首先做好了几个我所知道的地标：http://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketba\nllField.All.in.One.kmz\n\n将地址复制粘贴到Google Maps（谷歌地图）搜索栏，回车即可；或是下载到本地，使用Google Earth打开。\n\n全国现有完整地标(All in One)：\nhttp://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketballField.All.in.\nOne.kmz\n\n杭州： http://labs.xianyun.org/OpenBasketballField/landmark/HangZhou.kmz\n\n北京： http://labs.xianyun.org/OpenBasketballField/landmark/BeiJing.kmz\n\n另有在线地标，直接Google Maps上编辑即可（所有登录了Google账户的网友都可以编辑）\n\n主要定位开放的篮球运动场地，默认为室外，尤其是免费的场地，室内或收费场地另附说明。\n\n标题格式：地名[.开放封闭未知][.室外室内][.免费收费]\n\n使用默认图标（期待志同之士提供更形象的图标） 红色不带圆点： 蓝色不带圆点： 紫色不带圆点：开放程度未知 红色带圆点：开放，人气旺 蓝色带圆点：开放，人气一般\n紫色带圆点： 黄色不带圆点：封闭\n\n以卫星地图为准。所有地标和文字描述仅作参考，欢迎修正（所有登录了Google帐号的朋友都可以进行修订）。\n\n在线地标列表： http://maps.google.com/maps/user?uid=108314985261981078822&hl=en\n\n北京：\nhttp://maps.google.com/maps/ms?hl=en&ie=UTF8&lr=lang_zh-CNlang_zh-TW&oe=UTF8&msa\n=0&msid=108623690175354072173.00045480d1fa17e9056ac\n\n杭州：\nhttp://maps.google.com/maps/ms?hl=en&ie=UTF8&lr=lang_zh-CNlang_zh-TW&oe=UTF8&msa\n=0&msid=108623690175354072173.00045f6778d694e0d3cc3\n\nblog:datetime=2010/10/25 13:57:33:tags=Maps,Sports","routePath":"/blog/post/2009/open-basketball-field","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-01-02T00:00:00.000Z"},"2":{"tags":"Life"}},"version":""},{"id":39,"title":"右键菜单的细节","content":"#\n\n在 Web 客户端编程中，绑定 JavaScript 的 contextmenu 事件来驱动触发自定义右键菜单，\n并通过停止事件冒泡来阻止Windows默认菜单，是一种比较常见的自定义菜单实现方式， 自定义菜单的基准位置是基于事件的触发位置得来的。\n\nhttp://farm3.static.flickr.com/2475/3761004107_8f9f25efc1_o.png\n\n就右键菜单的本意来说，这基本没什么问题，不过Windows PC键盘上有一个右键功能键。\n\nhttp://farm3.static.flickr.com/2583/3760929801_31e0e4b6c8_o.png\n\n通过按这个功能键来触发右键菜单，除了Firefox （v3.5，其他版本未测试）外，均表现不正常。\n\nhttp://farm4.static.flickr.com/3529/3761023363_50cd93a685_o.png\n\nIE 事件触发对象的坐标仍是鼠标所在的坐标位置。\n\nhttp://farm4.static.flickr.com/3529/3761015003_552bdedc82_o.png\n\nSafari和Chrome均不能触发自定义右键菜单，呈现浏览器默认菜单\n（Safari在使用鼠标邮件激活自定义右键菜单后，自定义右键菜单消失前，不呈现浏览器默认菜单）。\n\nOpera不支持contextmenu事件，默认情况下也禁止脚本控制右键菜单。\n\n而标准的桌面应用程序中使用这个键，和右击鼠标是基本一致的，基准位置参照焦点对象的位置。\n\nhttp://farm3.static.flickr.com/2591/3760955767_8fb08f8007_o.png\n\n右键功能键是为无鼠标或鼠标不可用情况设计的，所以使用右键功能键激活的右键菜单， 应该呈现在焦点对象附近，并且自定义菜单应该（至少在视觉上）获得焦点，\n以便于通过方向键控制选中的菜单项。\n\n这在很大程度上应该属于浏览器的问题，不过在现实的情况下，如果前端开发者可以解决掉这个问题， 就不要寄希望于浏览器将来的新版本。\n\n> 不过更好的方式也许是：严谨区分鼠标和键盘事件。\n\n\n参考阅读：#\n\n * Opera下自定义右键菜单的研究","routePath":"/blog/post/2009/particulars-of-right-click-menu","lang":"zh-CN","toc":[{"text":"参考阅读：","id":"参考阅读","depth":2,"charIndex":935}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-07-27T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":40,"title":"反向搜索的设计","content":"#\n\n文本搜索是一项非常常用的功能，在文本编辑器中更是一个不可或缺的功能。\n\n而反向搜索（搜索光标之前的文本）的设计，最初也非常原始：\n\n\n\nWindows Notepad\n\nEditplus 2.3\n\nUltraEdit 11\n\nEclipse 3.4\n\n这基本算是可用了，不过还是有一些非常用心的改进的：\n\nEditplus 3\n\nWindows Internet Explorer 7\n\nGoogle Chrome 4\n\nApple Safari 4\n\nMozilla Firefox\n\n这些细小的改进都有一个共性，就是可以快捷的反向搜索，快速定位到上次匹配到的地方。 作为 Vim\n爱好者，她的反向搜索功能（包括搜索功能）更是华丽的惊人，normal 模式下 正向搜索(/keyword)， n 键下一个匹配， N\n键前一个匹配；如果是反向搜索(?keyword)， 则相反。","routePath":"/blog/post/2009/reverse-search","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-12-31T00:00:00.000Z"},"2":{"tags":"Search, UED"}},"version":""},{"id":41,"title":"搜索的体验","content":"#\n\n准备升级博客模板，用js提供高级特性，比如和vim类似的键盘命令模式，和内联搜索模式。 主要提高搜索的体验，包括一下几点。\n\n * 检查来自Google,Baidu等搜索引擎和本地搜索的搜索关键字，并高亮之。\n * 内联搜索模式，在底部fixed搜索框，并支持快捷键，最好能支持正则匹配模式，参考vim。\n * 使用搜索框附近fixed工具按钮，提供下一个、上一个搜索关键字的跳转，参考Eclipse。\n * 在滚动条附近使用(fixed)条纹，标识每个搜索结果在整屏中对应的大概位置， 点击条纹可以跳转到对应结果项，拖放滚动条到对应的条纹处，\n   页面也正好滚动到对应的结果项，参考Eclipse, Chrome。\n\n这里只是初步想法，受我“[[the-god-of-editor|编辑器之神]]”的想法发散而来，\n目前已经初步模拟了滚动条附近的搜索大纲，和命令模式的命令列表(完全模仿vim)。\n\nhttp://farm4.static.flickr.com/3475/3768956114_2562cf5b10_o.png\n\nhttp://farm4.static.flickr.com/3470/3768173303_ffbf2028cb_o.png","routePath":"/blog/post/2009/search-expreience","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-07-29T00:00:00.000Z"},"2":{"tags":"UED, Seach"}},"version":""},{"id":42,"title":"状态模式","content":"#\n\n现有的IM软件都有状态设置功能，常见的默认状态有：在线，忙碌，离开，隐身，离线，\n但是这些状态对应的选项是不可设置的，例如TM/QQ，选择在线或者忙碌，对应的通知铃声，\n接收消息方式都是指定、不可改变的，虽然这些默认设置在某些情景下可能很合理，但不总是这样。\n\n\n\nTM/QQ 状态：可以使用默认状态作为模板附加消息来添加状态。\n\n\n\nGtalk 状态：可以直接在状态写状态信息，但是只有在线，离开和离线三种状态。\n\n\n\nWangWang 状态：可以添加状态信息。\n\n可以看出，基本上IM软件的状态信息只能向好友展示文本消息，告诉好友你当前的状态，\n有时候并不能真正帮助我们在某些需要的时候过滤某些信息，例如老板告诉秘书，帮我回绝所有约会和电话。\n\n最近工作的时候发现，我希望工作的时候设置状态为在线，或者忙碌也可以， 而且不想接收所有或某些群消息。\n\n例如上班工作的时候不想接受技术探讨群或娱 乐群的叽歪消息，\n\n但是要聆听部门或项目组的群消息，尤其要注意老板发来的消息， 当然手工修改每个群的消息设置也可以做到，但是每次改都非常不方便，如果可 以保存为模式\n（如命名为“工作模式”，寂寞的时候想找人聊天可以设置一个“寂寞模式”），在模式之间切换就更实用了。\n\n智能手机（如我的Smartphone）在这方面就做的不错，值得学习。 Smartphone上有各种“情景模式”，如普通，静音，会议，室外，自\n动，耳机，车载和免提， 每一种模式的铃声类型，音量，包括模式名称等多项设置都可以根据用户自身情况改变\n（当然默认的情景模式设置也已经很合理了，但我也有在一些特殊的时候，做一些适当的修改）。\n\n\n\n下面使用Windows Mobile 2003的相关屏幕截屏\n\n\n\n\n\n\n\n","routePath":"/blog/post/2009/status-pattern","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-05-08T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":43,"title":"标签模式","content":"#\n\n目前的标签有以下几种模式(形式)：\n\n\n手动外联标签模式。#\n\n这种模式将标签和内容分离，用户需要为指定文档/内容贴上不同的标签。 例如Gmail和新版Wordpress的标签。\n\n\n\n * 优点：简单易用，可控性强。\n\n * 缺点：需要为每个内容设置标签。\n\n\n手动内联标签模式。#\n\n这种模式将标签和内容融合，用户同样需要为文档/内容贴上不同的标签， 并且这种模式因为没有明确的标签输入区（标签输入区和内容输入区在一起），\n容易导致忘记贴标签，对于及时性和不可修改性的应用不太理想。\n\n如Twitter就有这方面的第三方应用，参考 hashtags。\n\n\n\n * 优点：内容被语义化；标签本身简单易用，可控性也很强。\n * 缺点：需要辅助标记，内容被干扰；容易忘记使用标签。\n\n\n自动内联标签模式。#\n\n这种模式需要用户手动设置标签集合，系统根据内容自动匹配标签。 目前还没有发现这种模式的实际应用，比较接近的有 关键字替换 和 对局部文本进行评论\n（忘记怎么称呼了，请指教）。 关键字替换只是展示层的，用户可以根据内容发现（暂且称之为）标签， 但无法通过标签找到匹配的内容 （由此想到了搜索引擎）。\n\n\n\n * 优点：标签自动化，用户无需操心内容和标签之间的关系。\n * 缺点：要匹配到正确的标签并不容易，大概到真正的语义时代可以解决。\n\n由此扩展另一种：\n\n\n内联标签兼容模式。#\n\n系统根据用户设置的标签集合管理标签与内容之间的关系，另外用户也可以手动管理标签。\n\n * 优点：标签自动化；可控性强。\n * 缺点：简单问题变复杂，包括系统实现复杂度和用户使用复杂度。\n\n不过回头想想，标签本身很简单，有必要把它变复杂吗？自动化就是不想手动控制， 如果需要手动控制还要自动化干嘛？\n\n--------------------------------------------------------------------------------\n\nUPDATE: 未尝不可一试. (2010/10/24)","routePath":"/blog/post/2009/tags-pattern","lang":"zh-CN","toc":[{"text":"手动外联标签模式。","id":"手动外联标签模式","depth":2,"charIndex":22},{"text":"手动内联标签模式。","id":"手动内联标签模式","depth":2,"charIndex":134},{"text":"自动内联标签模式。","id":"自动内联标签模式","depth":2,"charIndex":344},{"text":"内联标签兼容模式。","id":"内联标签兼容模式","depth":2,"charIndex":586}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-05-02T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":44,"title":"论广告窗口的弹出","content":"#\n\n弹窗广告，这（和页面漂浮广告）是上个世纪用的最频繁的广告方式，这种广告之所以“流行”，\n是因为它引人注目的特性，广告商也正是看中这一点。而这也是最讨人厌的一种广告方式，\n因为它未经用户同意，擅自弹出新窗口，一来每次都要手动关闭窗口很烦，二来它不尊重用户的意愿。\n\n既然服务商不尊重用户，用户当然说服务商很讨厌。\n\n后来通过服务商，广告商，开发人员和用户等大众的共同努力，这种弹窗方式逐渐受到质疑：\n\n 1. 这种广告方式真的很有效吗？\n 2. 有更好更受欢迎的广告模式吗，为什么(Google) 内联的 ， 精确匹配的广告模式会受广告商和普通用户的一致好评？\n\n同时这（两）种广告模式逐渐退出广告历史的舞台，只有非常小众的网站才偶尔， 或非常恶劣的网站才频繁出现。\n\n并且，即使链接本身是否在新窗口弹出都成了讨论的热点话题。w3c 已经不建议使用 target 属性了，\n是否在新窗口、新页签中打开，这应该是用户可控的，属于用户的偏好问题，应该尊重用户的选择。\n\n不过，用过淘宝的人应该都知道，淘宝首页 是会弹出广告窗口的， 即使默认情况下被浏览器自动屏蔽掉，在用户点击页面时还是会被弹出，此时因为带有用户行为，\n浏览器较难判断是否应该屏蔽。\n\n真是令人发指，淘宝这样出色的公司，居然做出这么卑劣的事情，而且还费尽心机。\n\n前些时候我发现淘宝首页的拼音索引和商品详细信息等都不可用了，于是在 Twitter 上对 @TaobaoUED 发了句牢骚，然后 @Macji\n很主动的跟我联系了解情况。 后来发现问题出在 Adblock plus 2 的 ChinaList 直接将淘宝用的 tbra 框架屏蔽了， 然后我和 Macji\n进行了“深入的激辩”，大致情况如下：\n\n> Macji: 对于 china list 这种不负责的乱禁用 js 框架, 而不是只是禁用广告. 所以我们也无办法 闲耘:\n> 我觉得在弹窗这一点上，chinalist 是负责任的，是淘宝不负责任 Macji: chinalist 应该专业点的, 只是禁用弹出广告 闲耘:\n> 也许淘宝应该专业点，不要用弹窗广告 ... Macji: 弹出广告 严重邮箱用户体验, 其实我们一直再争取, 但我们不是高层 Macji: 我会写信给\n> chinalist 给出禁用弹窗的解决方案\n\n最后想说：淘宝是个很有责任感的公司，这个弹窗广告除外；淘宝是个很注重用户体验的公司，\n这个弹窗广告除外；淘宝是个很尊重用户的公司，这个弹窗广告除外。淘宝是个很注重细节的公司， 包括这个弹窗在内；淘宝是个很注重技术的团队，包括这个弹窗在内。\n\n--------------------------------------------------------------------------------\n\n更新：可喜的是，经过努力，新版淘宝已经戒掉了这个恶习。\n\n\n延伸阅读：#\n\n * 万恶的弹窗广告\n * 符合国情的链接新窗口打开\n * 在新窗口打开链接是流氓行为","routePath":"/blog/post/2009/talk-about-popup-window","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":1212}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-07T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":45,"title":"編輯器之神","content":"#\n\n最初的时候我一直使用 Editplus，这是一款轻量级， 效率极高，可配置性稍强的编辑器，而且有内嵌的(IE6)浏览器内核， 使用快捷键 <Ctrl-b>\n就可以在 html 代码和预览效果之间快速切换， 甚至可以无需保存html 文件到指定磁盘位置（默认保存在浏览器临时目录）。 我仍然很喜欢\nEditplus，但是不经常用了。\n\n后来使用的 Eclipse 在项目管理和强大的插件支持下， 如神器一般。这是一个足够伟大的IDE，不过如果单纯的作为编辑器来用，就有点大材小用了。\n\n最后，就是 Vim 了，Vim 和 Emacs 两款编辑器我都试用过， 最开始不理解多模式，没有适应这种使用习惯，心想：这是什么破编辑器！？\n\n来来回回丢弃过几次，后来有一次不小心心智大开，迅速的习惯了多模式编辑， 并从此爱上了 Vim，经过一段时间的学习和练习，更是无法自拔。\n\n上面三款编辑器如此优秀，Vim更有神器的美称，但即使是神器也有美中不足之处。 下面是我期待中的编辑神器的主要功能点。\n\n * 代码着色\n * 现代化的代码折叠方式\n * 大纲视图\n * 代码压缩与格式化\n * 文本比较\n * 文本书签\n * 文本拖放\n * 多模式编辑\n * 内联搜索模式\n * 在滚动条或附近使用彩色条纹标识状态\n * 自动识别文件编码\n * 可扩展\n * 项目管理支持\n * 二进制编辑支持\n * 代码着色 基本上现在的编辑器都支持代码着色，虽然使用方式各不相同， 但是使用效果基本可以达到一致，没什么要挑剔的。不过 Vim 的配色模式不错，\n   另外应该提供导入到处配色模式。\n * 现代化的代码折叠方式 代码折叠是一项如此受人喜爱的创造发明，不支持代码折叠你都不好意思更人打招呼。 不过 Editplus 和 Vim\n   的代码折叠方式比较原始，默认情况下只识别缩进后的文本/代码， 而且Vim左边的折叠按钮更是土到掉渣。\n * 大纲视图 Eclipse精于此道，自带的大纲视图对 Java，C++，PHP 等支持都很好， 而 Aptana 对 Javascript\n   的大纲视图更是令人称道。\n * 代码压缩与格式化 Vim的代码格式化做的很不足，有很多时候格式化不到位。Eclipse及其插件做的比较完美。\n * 文本比较。 Vim 和 Eclipse 都做的很好。\n * 文本书签 要在大段、篇幅很长的文本/代码中跳跃阅读，并能轻松回到原来的位置上， 书签就显得尤为重要。Vim 的 mark 插件对文本书签支持的很好。\n * 文本拖放 在不想使用复制/剪贴影响剪贴板内容的情况下很有用。 不过 Vim 默认不支持，Editplus 和 Eclipse 做的很好。\n * 多模式编辑 Vim 和 Emacs 的多模式编辑，舒适到不行。\n * 内联搜索模式 Vim 的内联搜索模式是如此的浑然天成，并且支持强劲的正则表达式匹配模式。\n * 在滚动条或附近使用彩色条纹标识状态 Eclipse的全局搜索，Chrome浏览器的搜索，Beyond Compare 2的文本比较，\n   都有在恰当的位置标识出所有结果集在编辑器的全局大体位置， 使用滚动条拖放到某位置，即可看到对应的搜索结果。\n * 自动识别文件编码 Ediplus 做的最为精湛，Vim 也有一个不错的插件支持。\n * 可扩展 Eclipse 和 Vim 的扩展性较强。\n * 项目管理支持 作为 IDE，Eclipse 当然表现强劲。Editplus 也有一个原始的项目管理功能。\n   编辑器本身可以没有项目管理功能集成，这个可以交给更专业的项目管理软件来做， 编辑器可以实现某些接口来集成或挂载项目管理功能。\n * 二进制编辑支持 一般人并不常用，如果在不影响前面的功能和编辑器效率的情况下， 加上这个功能也未尝不可。\n\n如果我们有一个编辑器，他启动像 Editplus和Vim一样迅捷， 使用Eclipse或类似的现代代码折叠方式，有Eclipse那样成熟的大纲视图、\n代码压缩工具和文本比较功能，像 Vim一样的多模式编辑和内联搜索模式， 支持如Perl一般的正则表达式匹配模式，并将搜索结果集在文档全局中对应的位置\n在恰当的位置（如滚动条底带）呈 现，支持文本书签，另外有像Eclipse一样， 或更好的更专业的项目管理工具支持，这将是怎么一款伟大的现代编辑器。","routePath":"/blog/post/2009/the-god-of-editor","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-07-24T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":46,"title":"引导用户升级/切换浏览器","content":" * \n\n\n引导用户升级/切换浏览器#\n\n虽然我不“赞同”强行拒绝IE6，但是“认同”推进Web及浏览器的发展进程。 一直想做引导用户升级/切换浏览器的工作，现在是做些实事的时候了。\n我们承受的苦难太多了，朋友们，这是抉择的时刻，是你作出改变是时候了，为了我们，干杯！\n\n\n升级/切换您的浏览器#\n\n鉴于您使用的浏览器过于陈旧，影响您的上网体验，我们向您推荐以下浏览器：\n\n * Firefox 来自开源Mozilla公司，安全可靠，拥有众多强大的插件和开源社区支持。 适合喜爱DIY的人士。\n * Chrome 来自誉满全球的互联网公司Google，安全快速，界面简洁、灵活、新颖， 使用开源的Webkit渲染引擎和强劲的V8\n   Javascript解析引擎， 给你飞一般的感觉，适合普通用户。\n * Safari cn 来自设计界著名的苹果(Apple)公司，使用自主开发、开源的Webkit渲染引擎， 适合普通用户。\n * Opera 一直以来默默无闻的引领着浏览器的设计潮流，其移动设备上的Mini版亦深受大众欢迎， 是一款值得尊重的、实用的浏览器，适合各类人群。\n * Internet Explorer 8 来自大名鼎鼎的微软(Microsoft)公司，是迄今为止IE家族最优秀的浏览器，\n   但目前有少量第三方插件支持不够友好，相信很快会有所改善。\n * Internet Explorer 7 隶属IE家族，相对IE8来说，第三方插件支持稍成熟。\n\nIE 、 浏览器 和 因特网 ：因特网是连接世界资讯的数字化网络。 我们使用浏览器是来浏览网页、上网冲浪，尽情使用互联网。 而Internet\nExplorer(IE)则只是浏览器的一种。\n\n完整 演示。\n\n\n参考阅读：#\n\n * Web技术要发展，IE6必须先消失！\n * 能支持IE6的前端更牛，还是敢对IE6说不的更牛？\n * 我该选用什么浏览器？\n * 升级您的Internet Explorer 6","routePath":"/blog/post/2009/upgrad-your-browser","lang":"zh-CN","toc":[{"text":"升级/切换您的浏览器","id":"升级切换您的浏览器","depth":2,"charIndex":136},{"text":"参考阅读：","id":"参考阅读","depth":2,"charIndex":740}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-07-26T00:00:00.000Z"},"2":{"tags":"Browser, Tools"}},"version":""},{"id":47,"title":"使用 Vim 查看 HTML 源码","content":"#\n\n收集到一些修改浏览器 html编辑器，用vim从浏览器查看源代码的方法，其中有一些是较佳的解决方法， 这里将相关技巧一并整理于此。\n\n\n针对Internet Explorer：#\n\n\n快捷方式+注册表^1^#\n\n * 创建 gvim 快捷方式，例如重命名为 ieVim，并置于 Vim 安装目录($VIMRUNTIME，如 D:\\Vim\\vim72)。\n * 右键该快捷方式，属性，目标文本框中加入参数：\n   \n   \n\n * 修改注册表： [Explorer\\View Source Editor\\Editor\n   Name](HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet)=D:\\\\Vim\\\\vim72\\\\ieVim.l\n   nk 注意最后要加上 .lnk 后缀。\n   \n   \n   \n   另外也可以将如下代码保存为 .reg 文件，引号中路径改成 Vim 安装路径即可\n   \n   \n   \n   或者下载这个 注册表文件， 双击运行，或右键“合并”即可。\n * 现在在IE里使用右键，“查看源代码”就可以使用 Vim 打开 html 源码。\n\n\n批处理+注册表^2^#\n\n * 将如下代码保存为批处理文件，如 ievim.bat，例如放到 $VIMRUNTIME 下。\n   \n   \n\n * 参照第 1 个方法的第 3 步，修改注册表的值为这个批处理文件的地址，如 D:\\Vim\\vim72\\ievim.bat。\n * 现在就可以使用 Vim 或其他外部编辑器打开 IE 的页面源代码了。\n * 缺点：打开的批处理命令行窗口不会自动关闭，直到被打开的页面源代码编辑器被关闭。\n\n\n针对Firefox^3^#\n\n * 修改浏览器配置\n   * 在 Firefox 地址栏输入 about:config 并回车。\n   * 点击“我保证会小心”按钮，确认进入。\n   * 在“过滤器”输入 view_source，筛选出查看代码的部分选项。\n   * 双击 view_source.editor.external 项，将值变成 true。\n   * 双击 view_source.editor.path，输入 gvim.exe 安装（绝对）路径，如我的是 E:\\Vim\\vim72\\gvim.exe。\n   * 现在就可以使用 Vim 查看 Firefox 页面源代码了\n * 使用插件\n   * 安装 ViewSourceWith 插件后，重启 Firefox。\n   * 配置系统已有文本编辑器，如 D:\\Vim\\vim72\\gvim.exe\n   * 即可使用 Vim 或其他任意外部编辑器打开 Firefox 的页面源代码。\n   * 缺点：需要安装插件，且所在右键菜单的层级较深。\n\n\n针对Opera^4^#\n\n * 在 Opera 地址栏输入 opera:config 并回车。\n * 在 Quick find 输入source viewer，筛选出查看代码部分的选项。\n * 在 Source Viewer 中填入欲使用的外部编辑路径，如 D:\\Vim\\vim72\\gvim.exe。\n * 并将 Source Viewer Mode 改为 2 源码显示模式： 1 表示使用系统默认程序查看源码 2 表示使用自定义程序查看源码 3\n   表示使用Opera查看源码\n * 保存即可，现在可以使用 Vim 或其他外部编辑器打开 Opera 的网页源代码了。\n\n\n参考阅读#\n\n * 用 vim查看ie源代码的问题\n * View Source from Internet Explorer in gvim\n * Use gvim to view page source in Internet Explorer ^vbs^\n * 改变查看页面源代码的程序\n * Opera首选项编辑器（opera:config）详解","routePath":"/blog/post/2009/use-vim-view-html-src","lang":"zh-CN","toc":[{"text":"针对Internet Explorer：","id":"针对internet-explorer","depth":2,"charIndex":70},{"text":"快捷方式+注册表^1^","id":"快捷方式注册表1","depth":3,"charIndex":94},{"text":"批处理+注册表^2^","id":"批处理注册表2","depth":3,"charIndex":510},{"text":"针对Firefox^3^","id":"针对firefox3","depth":2,"charIndex":728},{"text":"针对Opera^4^","id":"针对opera4","depth":2,"charIndex":1184},{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":1473}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-09-05T00:00:00.000Z"},"2":{"tags":"Vim, Browser"},"3":{"toc":true}},"version":""},{"id":48,"title":"在 Vim 中验证 X/HTML, Javascript 和 CSS","content":"#\n\nUnix/Linux（以下统称Unix）下可参考这里 和 这里， 因为介绍和代码都是现成的，而且我没有实验过，所以不多作介绍。\n\n原理 ： 改变makeprg，make时使用curl向指定的检测服务地址发送数据，通过管道， 使用sed编辑整理返回的数据后在Quickfix窗口中显示。\n\n我在Windows 7 下做了部分改动，由于对Unix命令不了解，目前还有一下输出格式的问题待修正。\n\n大部分代码参考这个Project， 里面的.sh文件都是 Unix中的脚本，Windows下可以改为.bat，有部分格式不同出需要修改， 如Unix下的\n$1，Windows下是%1，注释符合也不同，另外Sed for Windows是不支持使用\n单引号(?)的，需要改成双引号，里面的双引号需要转义，cURL和Sed这部分我目前没搞清楚， 所以少讲少错些的好。\n\n下面讲详细步骤：\n\n\n校验X/HTML#\n\n 1. 安装cURL for Windows：\n    \n    1. 到 这个页面 找“Win32 – Generic”， 下载下面带或不带ssl的都可以；\n    2. 把解压的 curl.exe 放到 Path 环境变量所在的目录（如 C:\\Windows）\n    3. 另外还需要几个动态链接库，如 libeay32.dll, libssl32.dll 直接在网上搜索 下载并放到 Path 环境变量所在目录下即可。\n    4. 命令行下运行 curl 测试是否安装成功。\n\n 2. 安装Sed for Windows：\n    \n    1. 到 这里 下载Binaries 版本，将解压的 sed.exe 放至系统 Path 环境变量所在目录。\n    2. 另外需要的 libintl-2, libiconv-2, regex 这几个动态链接库，sed下载页的 底部都有链接，放至系统 Path\n       环境变量所在目录。\n    3. 命令行下运行 sed 测试是否安装成功。\n\n 3. 下载这个 validate-html.sh， 重命名为 validate-html.bat，放至系统 Path所在路径，并编辑修改为以下内容：\n    \n    \n    \n    上面指定以 html5 标准来校验，如果你使用其他标准，可以自行修改。\n\n 4. 下载这个 html.vim ，将里面的\n    \n    \n    \n    改成\n    \n    \n    \n    放至 $VIM/vimfiles/ftplugin/ 目录下。\n\n 5. 修改 _vimrc，加入如下代码：\n    \n    \n\n 6. 现在，打开.html类型的文件，按键既可校验当前的html文档合法性了。\n\n\n\nref\n\n\n校验CSS#\n\n方法和上面的类似，从第3大步开始：\n\n 1. 下载这个 validate-css.sh ，重命名为 validate-css.bat 放至 Path 环境变量所在目录， 并修改为如下代码：\n    \n    \n\n 2. 复制一份 $VIM/vimfile/ftplugin/ 下的 html.vim，重命名为 css.vim，并修改以下内容为：\n    \n    \n\n 3. 修改 _vimrc 加入如下代码：\n    \n    \n\n 4. 至此，打开CSS文件，按下就可以校验CSS代码了。\n\n\n\nref\n\n另外还有一个插件支持验证CSS：css.vim : CSS compiler file\n\n\n校验Javascript#\n\n这个已有单机应用程序版本，更多资料可以参考 jsLint for Vim 和 javaScriptLint.vim (script#2578) ，\n另外，还是很期待 X/HTML 和 CSS 也有类似的版本的。\n\n\n参考#\n\n * HTML5 conformance checking in Vim\n * VIM IDE for Web applications\n * Project html5 (download)\n * Validator.nu\n * cURL\n * Sed for Windows\n * jsLint for Vim\n * javaScriptLint.vim : Displays JavaScript Lint warnings in the quickfix error\n   window\n * W3C Validator\n * JSLint, The JavaScript Code Quality Tool","routePath":"/blog/post/2009/validator-for-vim","lang":"zh-CN","toc":[{"text":"校验X/HTML","id":"校验xhtml","depth":2,"charIndex":392},{"text":"校验CSS","id":"校验css","depth":2,"charIndex":1169},{"text":"校验Javascript","id":"校验javascript","depth":2,"charIndex":1478},{"text":"参考","id":"参考","depth":2,"charIndex":1601}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-10-25T00:00:00.000Z"},"2":{"tags":"Vim, HTML, CSS, JavaScript"},"3":{"toc":true}},"version":""},{"id":49,"title":"让 Vim 支持 CSS3","content":"#\n\n和 HTML5 一样，CSS3 也是目前热门的技术，为了在 Vim 中更舒适的编辑 CSS ，我整理补充了 CSS3 的语法高亮和自动补全部分。\n\n\n语法高亮#\n\n下载这个 css.vim ，放至 $VIM/vimfiles/syntax/ (Windows) 或 ~/.vim/syntax/ (*nix) 目录下即可。\n\n更新 ：\n\n将 css.vim 下载放置 $VIM/vim72/syntax/ 下，覆盖源文件，这个版本补充和修正了CSS3的伪类支持。\n\n\n自动补全#\n\n下载这个 csscomplete.vim 放至 $VIM/vim72/autoload/ 目录下，覆盖原文件即可。\n\n其中 vim72 中的 72 是 Vim 版本号。\n\n如果安装有 snipMate，可以参考这个 css.snippets\n\n\n语法验证#\n\n可以参考这篇 在 Vim 中验证 X/HTML, Javascript 和 CSS\n\n\n参考：#\n\n * CSS 3.0 参考手册 (中文版)","routePath":"/blog/post/2009/vim-css3","lang":"zh-CN","toc":[{"text":"语法高亮","id":"语法高亮","depth":2,"charIndex":77},{"text":"自动补全","id":"自动补全","depth":2,"charIndex":236},{"text":"语法验证","id":"语法验证","depth":2,"charIndex":366},{"text":"参考：","id":"参考","depth":2,"charIndex":417}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-11-06T00:00:00.000Z"},"2":{"tags":"Vim, CSS, CSS3"}},"version":""},{"id":50,"title":"让 Vim 支持 cue","content":"#\n\n\n自动识别文件类型#\n\n在 $VIM/vim72/filetype.vim 中加入以下代码：\n\n\n\n\n语法高亮#\n\n下载 cue.vim 放至 $VIM/vimfiles/syntax/ 目录下。\n\n\n自动补全#\n\n如果已安装 snipMate。 下载 cue.snippets 放至 $VIM/vimfiles/snippets/ 目录下即可。","routePath":"/blog/post/2009/vim-cue","lang":"zh-CN","toc":[{"text":"自动识别文件类型","id":"自动识别文件类型","depth":2,"charIndex":3},{"text":"语法高亮","id":"语法高亮","depth":2,"charIndex":53},{"text":"自动补全","id":"自动补全","depth":2,"charIndex":103}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-11-06T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":51,"title":"Vim 字体设置","content":"#\n\n明城有 “苹果的 Courier 字体不错” 和“Windows 下 gVim 的雅黑字体配置” 两篇介绍 Vim\n下设置推荐字体的文章，里面提供的设置代码及提高的下载资源都很赞。\n\n家里的 Windows 7 用了 Courier New 字体后，体验很好。\n\n但是搬到公司的 Windows XP 上却比原来 Windows 自身的 Courier New 没多大提高。\n\n今天看了蟠盛写的“几种不错的编程字体”， 顺便看了下 使用 ClearType 增强屏幕字体，按步骤 果然好了很多。\n\n这里记录完整的设置：\n\n 1. 下载 Apple Courier字体 2 3 ，并安装。安装方法：\n    * for Windows 7: 右键字体文件，安装即可。\n    * for Windows XP:\n      1. 资源管理器中打开系统盘下的 fonts 目录（如C:\\WINDOWS\\Fonts，或运行 fonts）\n      2. 文件 -> 安装新字体；\n      3. 驱动器和文件夹定位到字体所在位置，字体列表将自动列出找到的字体；\n      4. 选中要安装的字体，点击确定即可。\n      5. 或直接将字体文件拷贝到Fonts文件夹亦可，系统将自动启动安装过程。\n 2. ClearType\n    1. 控制面板 -> 显示（或右键桌面 -> 属性） -> 外观 -> 效果；\n    2. 选中“☑ 使用下列方式使屏幕字体的边缘平滑”；\n    3. 并切换下面的下拉框，选中“清晰(ClearType)”；\n    4. 确定即可。\n 3. Vim设置\n    1. 在 _vimrc 中加入如下代码：\n    \n    \n    \n    1. 中文的宋体已经非常好了，不过仍然可以单独设置中文字体：\n    \n    \n    \n    1. 此时，新启动vim即可使用新设置的字体了。\n\n\n\nref\n\n\n白露非提供的字体#\n\n下载\n\n设置：\n\n\n\n\nSee Also#\n\n * @twitter","routePath":"/blog/post/2009/vim-fonts","lang":"zh-CN","toc":[{"text":"白露非提供的字体","id":"白露非提供的字体","depth":2,"charIndex":828},{"text":"See Also","id":"see-also","depth":2,"charIndex":851}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-09-14T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":52,"title":"配置 Vim 作为 C++ 开发环境初步","content":"#\n\n一般来说，如果你使用 Vim 开发完整的项目，使用 Makefile 并直接 :make 就可以了。\n\n将下面的代码写入到 vimrc 中， Vim 会捕获编译过程中出现的消息并显示在 Quickfix 窗口。\n\n\n\n但是如果你是 C/C++ 新手，目前较多书写单个的 C/C++ 代码文件，或者只是想快速测试 某段代码的话，使用 gcc/g++\n直接编译或许是更简单的方式。你可以直接在 Vim 中执行 外部 gcc/g++ 命令，也可以想这样映射快捷键：\n\n\n\n不过这样使用外部命令， Vim 并不能捕获编译过程的输出消息，就无法在 Vim 中根据 错误消息有效的定位到错误行了。\n\n有更好的方法：\n\n\n\n再补充映射一些 Quickfix 模式中快速跳转的快捷键：\n\n\n\n完整的设置可以参考 我的 vimrc\n\n更多讨论 看这里。\n\n\n参考#\n\n * vim 使用进阶: 剑不离手 – quickfix 2","routePath":"/blog/post/2009/vim-for-cpp-dev","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":372}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-10-19T00:00:00.000Z"},"2":{"tags":"Vim, Cpp"}},"version":""},{"id":53,"title":"让Vim支持html5","content":"#\n\nhtml5 呼之已出，众多的现代浏览器也已支持其大半新特性。\n\n\nHTML5 语法高亮#\n\n网上已有让 Vim 支持新的标签和属性的语法文件，安装好语法文件即可正确的高亮显示 HTML5 标记和属性。\n\n详细方法参考 VIM syntax highlight para HTML 5， 下载其 html.vim 语法文件， 放至\n$VIM/vimfiles/syntax/ 目录下即可。\n\n注：因为 html5 本身在不断更新，所以上面的脚本并不完整，我将持续关注并更新这个 html.vim 脚本。\n\n\nhtml5 自动补全#\n\n不过貌似目前还未有让 Vim 完整支持 html5 自动完成（又称自动补全）之脚本。\n\n我初步研究并修改了 $VIM/vim72/autoload/htmlcomplete.vim ，使其支持 html5\n的自动完成。目前这个脚本逻辑基本可用，不过针对 html5 自动完成的数据 （ $VIM/vim72/autoload/xml/html5.vim\n）还在收集调整中， 我也趁此机会深入学习一些 html5 知识。\n\n\n安装详情#\n\n将 htmlcomplete.vim 下载放至 $VIM/vim72/autoload/ 目录下，覆盖原文件即可， 再将 html5.vim 下载放至\n$VIM/vim72/autoload/xml/ 目录下即可。\n\n注：这个 html5.vim近期会做一些更新补充，以支持更完整正确的 html5 语法。\n\n\nhtml5 合法性验证#\n\n参考我的前一篇 在 Vim 中验证 X/HTML, Javascript 和 CSS。","routePath":"/blog/post/2009/vim-html5","lang":"zh-CN","toc":[{"text":"HTML5 语法高亮","id":"html5-语法高亮","depth":2,"charIndex":35},{"text":"html5 自动补全","id":"html5-自动补全","depth":2,"charIndex":255},{"text":"安装详情","id":"安装详情","depth":2,"charIndex":480},{"text":"html5 合法性验证","id":"html5-合法性验证","depth":2,"charIndex":643}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-11-01T00:00:00.000Z"},"2":{"tags":"Vim, HTML5"}},"version":""},{"id":54,"title":"未来的前端设计","content":"#\n\n今天基本完成了用户首页，用户可以拖放管理自定义布局 （类似 igoogle）。\n\n在PM试体验的时候，发现他的拖放方式都（跟部门主管一样）是“丢放式”的， 鼠标抓起一个模块，带有速度的往某个位置一扔，有时在没有到达目标区域就放手了，\n导致实际上没有被扔到目标区域。不仅仅是拖放模块，甚至连拖放改变边侧栏宽度也是使用这种手法。\n可以想象他们使用桌面应用程序（比如改变窗口大小）也是这样操作的。^1^\n\n我当时指出这两种拖放手法的不同，然后我们就短暂的畅想了关于“丢放式”的前端设计。\n\n如果你看过微软未来操作系统的视频^2^，或者腾讯未来QQ的演示视频^3^，大概能了解这是怎样的一种情形。\n\n这种模拟现实，并超越现实的操作体验，比目前任何的3D游戏都要精致、逼真得多，\n它是如此的流畅（非性能），以至于让人感觉不到操作系统和软件的存在，仿佛在摆弄实物一般。\n\n目前的大多数web前端设计，还只是初步模拟操作系统或桌面应用程序2D时代的作品，\n受浏览器的约束，也有一些做出了还不错的3D及流畅的动态效果，然而即使是flash也做的很不够。\n就3D效果本身来说，这只不过是未来设计中很基本的一种特性，另外包括手势动作及趋势，\n操作的速度及方向，还有现实世界中力学，人体工程学，甚至心理学等等众多科学的渗入，\n辅助以多点触摸屏，声控等，展现层的设计会越来越逼真，操作方式跟现实世界会越来越无差异。\n\n更进一步的，我曾经似乎看过，也传播过这样一句话：最好的界面，就是没有界面。\n我虽然只是随便说说，但是心里还是蛮认真的。当然这里说的没有，只是说对操作用户来说几乎透明，\n几乎感觉不到，而当用户希望有感觉时，他可以自己拼出符合自己期望的界面来。\n\n\n参考与延伸欣赏：#\n\n * Twitter@hotoo:3241383666 发现部门两个老大的拖放手法都是“丢放式”， 未来操作系统在触摸屏的辅助下，已经有这样的抽象设计。\n   我想，web前端也可以尝试这样的抽象设计。^1^\n * 视频: 超酷的微软操作系统 ^2^\n * 超炫的未来QQ版本（视频集合） ^3^\n * 未来的操作系统将采用3D用户界面和触摸操作","routePath":"/blog/post/2009/web-design-for-feature","lang":"zh-CN","toc":[{"text":"参考与延伸欣赏：","id":"参考与延伸欣赏","depth":2,"charIndex":722}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2009-08-12T00:00:00.000Z"},"2":{"tags":"UED, Web-Design"}},"version":""},{"id":55,"title":"在 Google Maps 的街景视图里看实况足球","content":"#\n\n我承认我标题党了，这只是我的一个 idea 而已，并没有实际实现。\n\n前几天有新闻称日本要申办 2022 年的世界杯，承诺将以 3D 转播赛况， 还以全息技术将赛况投影到足球场上，任何一个足球场都可以模拟现场实况，\n并准备研发全息电视，把赛况以全息技术在家庭里播放。 而实际上，日本在某些音乐会已经使用全息技术的实际应用 （X-Japan的 Art of Life 的\n15:36 至 19:13 之间都是以全息技术 制作的演出，直接观看19:10，然后等几秒钟就会明白）。\n\n我的个神啊，这是一种怎样的未来。\n\n在看南非世界杯的几个球场街景视图时，我突然想到如果模拟实况足球游戏， 根据比赛实况，将比赛情形在类似的视图中展现出来，会爽到什么程度啊。\n\n伊丽莎白港\n\n内尔斯普雷特\n\np.s. 现在的 Google Maps 街景视图，比 Google Earth 的 3D 模型要爽要逼真， 不过街景视图无法以 3D 效果看鸟瞰图。\n\n\n延伸阅读：#\n\n * 日本申办2022世界杯 许诺提供3D比赛直播\n * 日本研发全息电视：用激光投射飘浮图像\n * Google Trike\n * 初音未来3D全息演唱会 | 宅映像\n * 初音未来全息演唱会 - 初音ミク","routePath":"/blog/post/2010/3d-game-in-google-maps","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":422}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-06-16T00:00:00.000Z"},"2":{"tags":"WorldCup, 3D"}},"version":""},{"id":56,"title":"隐私权","content":"#\n\n团购的时候我在邮件和 Google Docs 向所有参与团购的团友公布了各自的详细信息 （包括联系信息）。\n\n我的公布的理由有两个：\n\n 1. 方便自己统一管理，和团友随时审阅；\n 2. 方便同城团友可以合并快递单。\n\n有团友很不高兴。于是我特地看了关于隐私权的一些资料。\n\n根据 维基百科全书：隐私权 和一些其他相关资料上的描述，我似乎并没有侵犯任何隐私权。 我没有把大家的手机号写在电线杆子上，并附上“办证”之类的字样；\n没有入侵并偷窥大家的电子邮件；也没有找到大家的收货地址后非法闯进去。。。 以上纯属玩笑话 :D\n\n隐私权目前来说还是有一些模棱两可的地方，虽然我主观上是支持保护隐私权的。 我也有隐私，但只要不是把我和家人的资料公布在网上，或者提供给某些混蛋，\n以至于我和家人会受到严重的骚扰和恐吓之外，还是没有什么的。\n\n朋友和一些相对比较可靠的人知道我的联系方式，是件好事吧。虽然我小时候曾经很傻的 想住到深山老林里去隐居。\n\n个人认为：有限区域范围内的个人或家庭联系方式，算不上是隐私。 你的邻居知道你家的门牌号码；公司、学校拥有你的详细资料；\n商家索取买家发货地址；快递员直接打你的手机； 参加团购的成员知道你的联系资料。。。\n\n> 好吧，虽然我可能没有犯罪，但是我错了。我只是想偷懒才使用群发邮件的方式的。\n\n另外居然有蛋疼的律师控告电信说“来电显示”损害了其隐私权。\n\n 1. 你没有号码怎么打电话给他人；你拿到他人的号码，是否就侵犯了其隐私？\n 2. 你打电话给他人，这他人没有知情权，无权知道是哪个混蛋在骚扰他？\n\n另外也有人控告移动、联通公司所谓的“恢复”收取来电显示的费用是单方面修改合同、 强制消费行为。想都不用想，最终败诉。\n\n现在好了，你可以关闭来电显示，每月省了 6 块还是几块钱。也就是说现在开通来电显示需要 每月多付几块钱，而这在以前是免费的。\n\n我有一个很不希望相信的“阴谋论”：这起官司是电信或移动公司幕后主使的案件。\n\n我对隐私权的概念还是有点不清晰，希望有人能写出清晰简洁的资讯出来，比如翻译关于隐私权\n的论文和辩论过程之类，而不要像法律条文一样直接给我们模糊不清的强制性规定和结论。\n\np.s. 希望有生之年不要看见“非法持有他人隐私”的罪名或者大帽出现。","routePath":"/blog/post/2010/about-privacy","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-08-22T00:00:00.000Z"},"2":{"tags":"唧唧歪歪"}},"version":""},{"id":57,"title":"SQL LIKE 查询的一个问题","content":"#\n\n在做用户管理的时候，用户表(users) 有一个字段(dept)用来存储用户所在部门的信息， 字段的值一般是这样的，各级部门间使用横杠分隔：\n\n\n\n我们的系统有一个根据用户所在部门进行过滤的功能，所以我们用了类似下面的查询语句：\n\n\n\n这样的性能还好，但是今天发现一个问题是，当有两个部门名称很相似，比如：\n\n\n\n这时在查询 XX宝CEO 的时候就会把 XX宝-CEO办公室 的用户也查询出来。\n\n于是想到正则表达式：\n\n\n\n合并正则表达式的另一解：\n\n\n\n杯具的性能问题。\n\n突然想到\n\n\n\n于是简单有效的解决了这个问题。","routePath":"/blog/post/2010/about-sql-like","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-08-13T00:00:00.000Z"},"2":{"tags":"SQL"}},"version":""},{"id":58,"title":"取消 vs. 撤销","content":"#\n\n 1. 对于提交之前的操作，可以取消(Cancel)； 比如点击某区域可以即时编辑，但是可以取消这个操作。\n 2. 但是提交时（真正提交之前）不要弹出确认对话框（让用户可以取消）。 这时候应该使用撤销功能。\n    比如删除时不要弹出确认对话框，但是删除后（至少在某时间段之内）可以撤销(Undo) 这个删除操作。\n\n \n\n\n参考 & 延伸阅读#\n\n * 谈谈取消键与撤消键的使用","routePath":"/blog/post/2010/cancel-vs-undo","lang":"zh-CN","toc":[{"text":"参考 & 延伸阅读","id":"参考--延伸阅读","depth":2,"charIndex":165}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-09-01T00:00:00.000Z"},"2":{"tags":"UED"},"3":{"status":"draft"}},"version":""},{"id":59,"title":"有中国特色的社会主义笑话","content":"#\n\n笑料：\n\n * 广电总局禁止电视节目用“NBA”等外语和缩略词\n\n笑点：\n\n * 三个达不溜点后头没有点卡姆。 ref\n * 注：其实根据一项 最新指示， 我们的标题是违规的，正确的写法应该是 “最受推特微博客网站和脸谱社交网站网友欢迎的美国职业男子篮球联赛球队”。 最受\n   Twitter 和 Facebook 网友欢迎的 NBA 球队\n * 我是用窗牌操作系统第七版回复的\n * 我是用因特网探索者第八代浏览器回复的\n * 剧院浏览器第十代半用户飘过……","routePath":"/blog/post/2010/china-joke","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-08T00:00:00.000Z"},"2":{"tags":"Jokes"}},"version":""},{"id":60,"title":"轉換編碼筆記","content":"#\n\n今天發現一個顯示為亂碼的 html 頁面，發現是當前頁面和 reference 頁面編碼 不一致造成的，reference 編碼為 gbk，當前頁面編碼是\nutf8。\n\n雖然各自 head 里的 charset 和其文件存儲的編碼一致，但某些瀏覽器（如Firefox） 從 reference 轉過來時，默認當前頁面的\ncharset 和 reference 的一致，導致亂碼 顯示。\n\n由于 reference 所使用的編碼是整站的基準編碼，所以把當前頁面的 fileencoding 轉成和 reference\n一致即可，不過轉碼時遇到一個問題是，文件中存在特殊字符，無法 由 utf8 正常轉碼為 gbk。\n\n文檔中無法用肉眼看出那些特殊字符，于是備份后使用 notepad 或 editplus 強行轉碼\n（注：會丟失那些特殊的字符），然后將轉碼后的文檔和原始備份檔比較，來查找特殊 字符，編輯（刪除無意義的，轉義有用的）保存即可。\n\n注：Vim :set fenc=gbk，可以轉碼，但 :wq! 無法正常保存；UltraEdit 本身的編碼 支持不夠好，不建議用來轉碼。\n\n注2：Vim diff 可以比較出不同，找出特殊字符，但可能無法正常編輯（如刪除）它們， 特殊字符是非常怪異的；BeyondCompare 和 WinMarge\n基本可以勝任。","routePath":"/blog/post/2010/convert-encoding-note","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-07T00:00:00.000Z"},"2":{"tags":"Encoding"}},"version":""},{"id":61,"title":"IE6 的 CSS:hover 伪类","content":"#\n\n众所周知，IE6 不支持 a:hover 以外的 CSS 伪类，解决办法一般有 3 种方案：\n\n\n使用 JavaScript 事件#\n\n直接使用 JavaScript 的 onmouseover/onmouseenter 和 onmouseout/onmouseleave\n事件进行针对性开发，这大概没什么好详细介绍的。\n\n\n使用 CSS 表达式#\n\n辅以 CSS 表达式中 JScript 同样也有 onmouseover/onmouseenter 和 onmouseout/onmouseleave\n事件，用以实现 :hover 效果。 注意：其中冒号之前的事件名称可以随意，关键是 expression() 里面的事件。\n\n\n\n不过应该说使用 CSS class 是更好的实践。\n\n\n\nonmouseout 事件处理函数中加了 try/catch 是为了避免 IE5.5 因为不支持 replace()\n而报脚本错误。当然为了避免这个错误，还是其他的实现方式：\n\n\n\n\n使用 CSS behavior 行为#\n\n使用 Whatever:hover\n\ncsshover3.htc\n\n\n\n\n延伸阅读#\n\n 1. 强大的CSS表达式 -- expression\n 2. CSS Expression 的优化","routePath":"/blog/post/2010/css-hover-for-ie6","lang":"zh-CN","toc":[{"text":"使用 JavaScript 事件","id":"使用-javascript-事件","depth":2,"charIndex":51},{"text":"使用 CSS 表达式","id":"使用-css-表达式","depth":2,"charIndex":165},{"text":"使用 CSS behavior 行为","id":"使用-css-behavior-行为","depth":2,"charIndex":440},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":498}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-09-15T00:00:00.000Z"},"2":{"tags":"CSS, IE6"}},"version":""},{"id":62,"title":"CSS 实现有限不确定背景","content":"#\n\n2 个嵌套的 html 元素，分别用个两个背景图交替叠加， 形成固定高度，有限、不确定宽度的元件，\n或固定宽度，有限、不确定高度的元件（比如实现简单的圆角效果）， 要求将有限延伸的背景图放置在内层元素上（如图中 b 区）， 避免 b\n区的背景图多出的备延伸部分（b' 区）影响到固定的背景图（a 区）的透明部分会被影响。 可以使用外层的 padding-left 或内层的\nmargin-left 来处理。","routePath":"/blog/post/2010/css-limit-bg","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-02-20T00:00:00.000Z"},"2":{"tags":"CSS"}},"version":""},{"id":63,"title":"Dropbox 的墙掉","content":"#\n\n其他的都不想说，只希望 Dropbox 的开放性能更强大，比如 API 或者分布式 的云技术再上台阶，第三方服务风起云涌，像 Twitter 那样。我深信：\n\n> 开放到极致的世界，无视大独裁者。 让 XX 去万岁，我只要真理，真理使我们自由。 -- 闲耘™","routePath":"/blog/post/2010/dropbox-died-in-china","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-05-10T00:00:00.000Z"},"2":{"tags":"Dropbox, GFW"}},"version":""},{"id":64,"title":"让 Editplus 和 Everything 结合，快速搜索","content":"#\n\n今天朋友向我分享了他新学的一个小技巧：将 Everything 搜索集成到 Editplus。\n\n毫无疑问，Everything 是 NTFS磁盘下， 本地文件快速搜索的极品，而 Editplus 也是Windows下非常优秀的文本编辑器。\n\n虽然 Editplus 本身也有文件搜索功能，而且支持内容搜索，不过这个集成也非常有意思。\n\n * 首先需要安装（绿色的也可以）有Everything本身。\n * 下载面向命令行界面的 es.exe ^2^ 程序，放至 Everything 安装目录。\n * 打开 Editplus ， “工具” -> “配置用户工具” -> “添加工具”\n * “菜单文本”可以随便命名，\n * “命令”填入 es.exe 所在的完整路径，如 E:\\Everything\\es.exe\n * “参数”填 $(FileDir) $(CurSel)\n * 选中捕获输出\n * 确定，现在选中一串文本，就可以使用 快捷键或菜单执行搜索了，搜索结果集会输出在输出窗口中。\n\n谢谢晓东的分享。有时间的话可以为 Vim 也写一个插件，搜索结果在 QuickFix 窗口中输出。\n\n注意：一定要记得先选定文本一串，否则会搜索出所有的文件，如果参数没有加入当前文件所在的目录，还会更惨 ^_^! 。不过作为 Vim\n插件就可以更灵活了，不需要选定文本，直接执行类似命令就可以了。\n\n","routePath":"/blog/post/2010/editplus-and-everything","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-01-27T00:00:00.000Z"},"2":{"tags":"Editor, Search Engine, Tools"}},"version":""},{"id":65,"title":"水平表单的错误消息方式","content":"#\n\n垂直方向的表单，错误消息有很多种呈现方式，放在输入框后面，下面，或上面都挺好， 因为垂直表单本身可用空间较大，而且向下或向右挤也不是什么问题，布局也没什么影响。\n\n但是对于水平方向向右一字排开的表单（自动适应可用宽度，不够则自动折行），搜索表单 比较常用，这种表单会有数个搜索输入框或选项，如图：\n\n[http://farm6.static.flickr.com/5202/5209097632_a2bddacb9f_b.jpg]\n\n这种表单，错误消息无论放在上、下、左、右，都会影响到表单的布局，而悬浮消息 也可能会遮挡住其他的输入框。那这样的表单，错误消息应该如何更好的呈现呢？\n\n我想到一种，即“双重视觉强调”讲的：在表单上/下方给出整体的的错误信息，但输入框 本身，只给出警戒色的边框进行提醒。\n\n[http://farm5.static.flickr.com/4091/5208505527_1a8dd70502_b.jpg]\n\n当用户鼠标悬浮在出错输入框上，或者出错输入框获得焦点时，上/下面的错误信息框 自动高亮当前输入框对应的错误消息。\n\n这种表单本身不会很多选项导致需要翻页，所以放在上面是没有问题的。如果真的需要 很多选项，那就要考虑换成垂直表单了。\n\n高亮而不是更新消息内容，是为了防止消息框高度发生变化，导致表单本身上下跳跃移动； 当然也可以将消息框放在下面，不过直觉上，错误消息放在上面似乎更靠谱。\n\n上面是个人观点，大家可以各抒己见。","routePath":"/blog/post/2010/err-msg-for-horizontal-forms","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-11-26T00:00:00.000Z"},"2":{"tags":"Forms, Web-Design"}},"version":""},{"id":66,"title":"禁用CNNIC的所谓安全证书","content":"#\n\n我个人是不信任 CNNIC 的，这里只是记录一下自己的学习过程，对 CNNIC 仍抱有幻想的同学可以无视。\n\n我都是在他人的教学指导下学习实践的，有兴趣的可以参考下面的链接：\n\n * CNNIC CA：最最最严重安全警告！\n\n * CNNIC，我不信任你！——从“受信任的根证书”里赶走CNNIC\n\n * 如何阻止不信任的 CNNIC 证书\n\n * Mac 下禁用 CNNIC CA 证书\n\n * linux下的chromium删除CNNIC的CA\n\n * 投票\n\n * 结果\n\n\n延伸阅读#\n\n * CNNIC,流氓!\n * 360的可怕","routePath":"/blog/post/2010/forbid-cnnic","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":243}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-02-02T00:00:00.000Z"},"2":{"tags":"Freedom"}},"version":""},{"id":67,"title":"表单设计","content":" * \n\n\n表单设计#\n\n表单元素有新增、修改、删除的状态（新增和修改可以参考 svn 的图标，删除则直接从页面上删除 DOM）\n\n\nRef:#\n\n * 如何精简用户界面","routePath":"/blog/post/2010/form-design","lang":"zh-CN","toc":[{"text":"Ref:","id":"ref","depth":2,"charIndex":66}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-08T00:00:00.000Z"},"2":{"tags":"UED, Forms, Web-Design"}},"version":""},{"id":68,"title":"Form 表单最佳实践","content":"#\n\n\n前言#\n\n这份文档献给我身边某些可爱的 Java 工程师，感谢你们激怒了我 :)\n\n“Form 表单”其实是一种错误的叫法，Form 本身就是表单，不过这样叫似乎比较顺口。\n\n这里所谓的“最佳实践”只是标题党。\n\n\nPOST & GET#\n\n表单有一般使用 POST 或 GET 方式提交数据到服务器端，如果你理解这两个词，这里就\n不再赘述了；如果不理解，那也没什么好讲的，就以下面通俗的“所见即所得”理解吧。\n\n\nGET:#\n\n所谓 GET 方式，通俗的讲，就是地址栏可见所有提交的信息：\n\n\n\n这个表单提交之后，地址栏就包含了所有的提交信息：\nhttp://example.com/get.html?key=value&search=%CB%D1%CB%F7\n\n可以直接在地址栏修改： action: 即 http://example.com/get.html 部分。 data/param: 即\nkey=value&search=%CB%D1%CB%F7 这些参数部分。\n\n广义上，通俗的讲，包括地址栏上手写并回车，点击链接，或者 method=\"get\" 的表单， 以及通过 AJAX get 提交的都是 get 方式。get\n请求，刷新时还是 get 请求。\n\n\nPOST:#\n\n通俗的讲，POST 就是地址栏看不到提交请求所带的数据（又称为“参数”）。\n\n\n\n这个表单提交之后，地址栏除了 http://example.com/post.html 外不包含其他信息。\n\n广义上，通俗的讲，method=\"post\" 的表单，AJAX post 都是 post 方式。 post 提交后，刷新仍是 post 提交相同的数据。\n\n\n编码(Encoding)#\n\n在客户端页面和服务器端程序编码不同时，提交数据非常容易出现编码问题，即所谓的 “乱码”。\n\n解决这个问题，可以多种方式：\n\n 1. 最根本的，就是统一客户端和服务器端的编码。建议都使用 utf-8。 目前服务器上均是使用 utf-8 接受数据，所以可以考虑统一使用 utf-8 编码，\n    要做的有一下几点：\n    \n    * 修改页面的 charset 设置\n    \n    * .vm 文件本身保存为 utf-8 编码。\n    \n    * 修改编码设置： milan-web-base-2.0-SNAPSHOT.jar\\META-INF\\webx\\pipeline.xml\n      \n      \n    \n    milan-web-base-2.0-SNAPSHOT.jar\\META-INF\\webx\\webx-default.xml\n    \n    \n\n 2. 设置 form 元素的 accept-charset 属性为服务器接收数据使用的编码。 Hack in IE:\n    onsubmit=\"document.charset='utf-8';\"\n\n 3. 通过 JavaScript 的 encodeURIComponent(key) 函数转码，一般用于 AJAX 提交。\n    另有两个转码函数：escape(), encodeURI() 解码函数分别是：unescape(), decodeURI(),\n    decodeURIComponent()\n\n\nonsubmit#\n\nForm 表单的 onsubmit 事件在表单真正向服务器发送请求之前执行，一般用于验证表单 的数据完整性和合法性。如果处理函数返回\nfalse，则不向服务器发送请求。\n\n绑定 onsubmit 事件处理函数的方法有 3 种：\n\n * 一般简单的页面，直接在 form 标签中添加 onsubmit 属性: <form onsubmit=\"return\n   validater(this);\">...</form>\n\n * 按照“内容与行为分离”的思想，我们一般可以在 JavaScript 加载完成后对表单进行 事件绑定：\n   \n   \n\n * 更专业的事件绑定方法（考虑到兼容性问题，这里使用 jQuery 代码）：\n   \n   \n\n\n普通提交数据的表单#\n\n对于普通提交数据的表单，比如新增、修改数据，使用 POST 方式提交数据即可。 删除的方式一般有两种：\n\n 1. 删除链接的 href 指向执行删除操作的地址，链接元素绑定 onclick 事件： <a href=\"del.html?id=1\"\n    onclick=\"return window.confirm('确认删除？');\"> 这是 GET 提交方式。绑定事件处理函数的技巧同上面的\n    onsubmit。\n 2. 绑定 onclick 事件，并执行 AJAX 提交， return false；回调函数中可以使用动态 更新 DOM 的方式或其他。\n\n呃，其实最好体验也许是：删除操作时不要求确认（弹出确认对话框），但在事后可以 执行 撤销 删除操作。\n\n\n多个提交按钮的表单#\n\n某些时候，单个表单中可能存在 2 个及其以上的提交按钮。\n\n首先，考虑清楚这多个按钮是否真的都需要向服务器提交数据。像关闭，返回，后退， 或者失传已久的重置操作，就不要使用按钮了，至少不要使用绑定 onclick 并\n\n\n\n或 location.href=\"back.html\" 这样的按钮。\n\n这些按钮在实践上使用链接来实现更好更简单：<a href=\"back.html\">后退</a>\n\n对于确实需要多个提交操作的按钮，可以通过提交按钮的 name 来区分。\n\n\n\n\n多个相同操作的表单#\n\n类似于搜索引擎结果页，页面上、下均有功能相同的搜索框（为方便用户使用，虽然 实际受惠的用户可能并不多），这两个搜索框分别由两个表单组成，但是可以统一使用 同一个\nonsubmit 事件处理函数。\n\n\n\n\n搜索#\n\n搜索建议使用 GET 方式提交，过滤参数和当前页码这些信息全部带在地址中。 http://example.com/search.html?k=keywrod\n\n翻页链接（上一页，下一页...） http://example.com/search.html?k=keywrod&p=2\n\n翻页系统一般还允许用户手动输入页码并直接跳转到指定页，这个翻页表单建议和 搜索表单分离，分别是不同的 form 组成。\n\n下面是搜索关键字 key 并翻页到第 2 页之后的状态：\n\n\n\n\n可爱的陋习#\n\n不要在表单中为 button 类型的按钮绑定 onclick 事件，并在事件处理函数中执行 form.submit();\n，然后费尽心思实现“在输入框中也可以回车提交”这种蠢事。\n\n也不要为了解决避免编码问题而在 onsubmit 处理函数中做\ninput.value=encodeURIComponent(input.value);，然后为了避免这个带来的\n“乱码(被编码的字符)瞬间出现在表单中”而把搜索框做成隐藏域，再附加一个傀儡 输入框用于输入。\n\n\nDemo#\n\n搜索表单演示","routePath":"/blog/post/2010/form-in-action","lang":"zh-CN","toc":[{"text":"前言","id":"前言","depth":2,"charIndex":3},{"text":"POST & GET","id":"post--get","depth":2,"charIndex":111},{"text":"GET:","id":"get","depth":3,"charIndex":211},{"text":"POST:","id":"post","depth":3,"charIndex":540},{"text":"编码(Encoding)","id":"编码encoding","depth":2,"charIndex":723},{"text":"onsubmit","id":"onsubmit","depth":2,"charIndex":1391},{"text":"普通提交数据的表单","id":"普通提交数据的表单","depth":2,"charIndex":1725},{"text":"多个提交按钮的表单","id":"多个提交按钮的表单","depth":2,"charIndex":2074},{"text":"多个相同操作的表单","id":"多个相同操作的表单","depth":2,"charIndex":2323},{"text":"搜索","id":"搜索","depth":2,"charIndex":2437},{"text":"可爱的陋习","id":"可爱的陋习","depth":2,"charIndex":2679},{"text":"Demo","id":"demo","depth":2,"charIndex":2917}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-10-27T00:00:00.000Z"},"2":{"tags":"Forms, Web-Design"}},"version":""},{"id":69,"title":"用 Dropbox 做私有 Git 服务器","content":"#\n\n这几记录一下如何做一个本地版本库，关键命令是：git clone --bare test test.git\n\n\n\n\n延伸阅读#\n\n 1. 用dropbox做私有git服务器\n 2. 方便而又强大：本地 Git 操作完全指南\n 3. Hosting a Git Repo on Dropbox\n 4. GitBox - Git repository hosting inside Dropbox folders @github","routePath":"/blog/post/2010/git-on-dropbox","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":60}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-11-12T00:00:00.000Z"},"2":{"tags":"Dropbox, Git"}},"version":""},{"id":70,"title":"用 gvim 比较 git diff","content":"#\n\n\nfor Windows#\n\n参考 [http://gist.github.com/502217 gist:502217]\n\n 1. 在用户目录下的 .gitconfig 中加入：\n    \n    \n\n 2. 创建 git_diff_wrapper.bat 文件放到 $PATH 目录下，内容为：\n    \n    \n    \n    注意其中的 path\\to\\ 要改为 gvim.exe 所在目录。\n\n\nfor Linux#\n\n参考 Git Diff with Vimdiff","routePath":"/blog/post/2010/gitdiff-with-vim","lang":"zh-CN","toc":[{"text":"for Windows","id":"for-windows","depth":2,"charIndex":3},{"text":"for Linux","id":"for-linux","depth":2,"charIndex":207}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-08-01T00:00:00.000Z"},"2":{"tags":"Vim, Git"}},"version":""},{"id":71,"title":"欢迎加入 Vim 的 Gtalk 群","content":"#\n\n> 声明： 由于能力&精力有限，我已不再是 vim-cn@appspot.com 群管理员。 平时工作很忙，我已经退出这个群，无心参与这个群的讨论。\n> 大家有什么想和我交流、分享的话题，欢迎来邮件交流。 这篇日志的所谓群规，不再适用于 vim-cn@appspot.com\n> ，对其管理员&群成员没有任何约束力。 2011/10/22\n\n欢迎加入 Vim Talks™(vimcn@chatterous.com 已迁移到 vim-cn@appspot.com) 这个 Gtalk 群，\n任何人可以随意加入，没有任何限制。\n\n给对 Vim 感兴趣的朋友推荐一些 有用或有趣的资源。\n\n> 警告： 所有可用命令都已在 //help 中列出，入群后请不要自作聪明尝试未知的命令， 给群其他成员带来无谓的打扰，谢谢。\n\n\n加入方法：#\n\n在 Gtalk 里加 vim-cn@appspot.com 为好友，然后给大家打个招呼 :)\n\n\n使用帮助(针对Gtalk)：#\n\n下面的命令，机器人会单独针对你进行回复，包括你的命令和回复的消息，都不会被其他 群成员接受到（除非你的命令有错误，被当作消息发送）。\n\nhelp:: 查看所有可用的命令。\n\n最新的命令前缀以横线 - 开始（help 命令可以不带前缀），你也可以修改为适合 自己的设置。\n\n更多内容参考 [http://io43.com/io43.GtalkGroup/cmds/] 和\n[http://wiki.hotoo.me/Gtalk.html GTalk]。\n\n\n《群规》#\n\n>  0. 自由开放，自重互爱。\n>  1. 管理员不得将 vim-cn@appspot.com 设置为私有状态，保证入、退群都没有任何障碍。\n>  2. 管理员不得以任何理由审查聊天信息，禁言、踢人须得至少 2 位管理员同意。\n>  3. 允许偏见，不要求中立；但尽量不要有歧视，侮辱，诽谤或人身攻击行为。\n>  4. 允许闲聊，不禁止灌水，但抽水机除外，请至少言之有物。 【注意】有技术话题时请积极参与，并暂停闲聊（可以去私聊）。\n\n我之前也有试玩过将 vimcn@chattous.com 群设置为 Private，记得当时感觉非常不好， 作为新用户会遇到很多麻烦。另外 Private\n群也不出现在 chatterous.com 列表中， 新人很难找到，@join 的时候也会遇到问题。\n\n之前的因为不了了之，没有记录和反思，偶尔手贱便会有“复辟”的念头，甚至还写了 用来检验新用户的程序，完全违背了群组 创立之初所坚信的自由开放精神，和这个 投票。\n\n于是立此群规，约束管理员和群友的行为。以上为立群之根本，管理员不得私自修改， 必须经全部管理员同意，及群友投票数达到 50 票，并有 60%\n以上的投票同意方可修订。\n\n群规细则视需要再补充。\n\n延伸阅读\n\n“公民论坛”对话守则： 1989年的冬天，哈维尔等捷克知识分子在布拉格成立了“公民论坛”，制定了8条《对话守则》，\n在街头巷尾、居住区、大学校园到处张贴，希望广为人知，以便监督。（1993年 瓦茨拉夫·哈韦尔\n当选捷克第一任总统。瓦茨拉夫·哈韦尔出生于1936年，作为一名持不同政见者，长期从事反对前政府的活动，\n曾3次入狱。他是“七七宪章”和“公民论坛”的创始人。）内容是：\n\n 1. 对话的目的是寻求真理，不是为了斗争。\n 2. 不做人身攻击。\n 3. 保持主题。\n 4. 辩论时要用证据。\n 5. 不要坚持错误不改。\n 6. 要分清对话与只准自己讲话的区别。\n 7. 对话要有记录。\n 8. 尽量理解对方。\n\n(注：我没有找到原始出处，但我很认同。)\n\n《提问的智慧》 简体中文 2 繁体中文 En\n\n独门绝技： 直接提问，最好一次描述清楚问题。不要预热说：“谁熟悉 XX？”\n\n不要伤害新手。\n\n== 技巧 == 群 LOGO 将下面（或者任何你喜欢）的图片保存到本地，到 Gmail 的联系人(Contacts)、或者你的客户端里修改群机器人的头像即可。\n\n白色背景   透明背景\n       \n\n修改昵称 建议加入群组之后立即修改昵称，和 FID，一来可以标识和展现你的身份，二来可以避免长用户名好 FID 影响群聊效果。\n\n\n缺陷 & 不足#\n\n不能像 QQ 一样方便的发送图片并直接预览。GTalk 已经支持发送文件， 而且在新版的 Pidgin 中发送图片也支持直接预览，这跟平台相关。\n如果确实需要分享图片/截图，可以使用第三方的图片服务 （如 Flickr， Dropbox 的Public目录， Yupoo\n等），将图片所在的链接发送到群里即可。\n\n没有群空间，用来存储/分享文件。当然你同样可以使用第三方存储服务（Dropbox， Windows Live Sync ^SkyDrive^， Google\nDocs ^支持上传任意类型的文件^， RapidShare 等）来实现。\n\n\nGtalk 群的使用：#\n\n鉴于 Gtalk 的特殊性，大段代码最好不要作为聊天内容直接发送，推荐的方法是， 将代码贴到专业的第三方网站（如 Snipt, PasteBay,\nCopyTaste, Ubuntu Paste, Pastebin）， 然后将网址贴到聊天消息里。这有个好处是，\n避免大段内容影响阅读，专业的第三方服务能保持代码原文不被转义，支持代码着色， 甚至可以直接运行并得到结果，如果是第三方服务的会员，也可以方便管理自己的代码。\n\n有些 *nix 高手偶尔会频繁的尝试一些高级命令，例如 \"@online\", \"@ls\" 之类。\n我个人希望群聊是本着分享和讨论交流的宗旨进行，当然闲聊也可以，话唠也行， 但是垃圾信息不要太多以至影响大家正常的交流。\n\n\n为什么不是 QQ 群？#\n\n米兰达警告(Miranda Warning)：\n\n> “你有权使用 QQ，但是你在 QQ 上所说的一切将被作为呈堂证供。Do you understand?”\n\nGTalk 没有人数限制，不需要冲Q币来增加某些服务，而受到更多不可理喻的限制；可以轻易的加入或退出群，\n或随时暂停接收他人的讨论；具有完整的开放性，有非常多的官方或第三方客户端可以用，包括Windows,Linux,Mac平台； 更尊重 言论自由，\n没有无理取闹的审查制度， 不会因为胡萝卜、李子和温习功课而被敏感词。\n\n== Vim Talks™大事記 == 2010/4/9:: Vim Talks™Gtalk 群创立于深夜。之前我加入“Vim 草堂”QQ\n群，是比较活跃的成员， 因为不喜欢腾讯的所作所为，创立此群。不久后，重度删除腾讯的各种软件。\n\n2010/6/12:: 关于“群隐私”及 Vim Talks™要处于 Public 还是 Private 状态的讨论。 (link)\n\n2010/9/15:: 百合仙子(依云,lilydjwg) 成为管理员。不久 [http://davidx.me/ davidx] 也成为管理员。\n\n2010/11/3:: “我刚做了一个艰难的决定，如果群里明天还有聊QQ和360的，禁止发言24小时。” (#5132176862502009)\n\n2010/11/4:: 临时邀请“Vim 草堂”堂主 张九天 成为 Vim Talks™的管理员。#5145129995941272\n\n2010/11/10:: 创立群规。邀请 shrek 和 春棍 为管理员。\n\n2010/11/24:: 群出现严重的丢消息情况，迁移到 GAE，由开源项目搭建的群组服务\nvim-cn@appspot.com，机器人由百合仙子搭建&维护，任何人都可以参与提交代码。\n\n2011/1/1:: 删除 vimcn@chatterous.com 群，全面迁移到 vim-cn@appspot.com，对于未主动迁移的群友，请自行迁移。\n\n2011/10/22:: 自行删除管理员身份，退出群。","routePath":"/blog/post/2010/gtalk-group-for-vim","lang":"zh-CN","toc":[{"text":"加入方法：","id":"加入方法","depth":2,"charIndex":361},{"text":"使用帮助(针对Gtalk)：","id":"使用帮助针对gtalk","depth":2,"charIndex":418},{"text":"《群规》","id":"群规","depth":2,"charIndex":663},{"text":"缺陷 & 不足","id":"缺陷--不足","depth":2,"charIndex":1776},{"text":"Gtalk 群的使用：","id":"gtalk-群的使用","depth":2,"charIndex":2062},{"text":"为什么不是 QQ 群？","id":"为什么不是-qq-群","depth":2,"charIndex":2398}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-09T00:00:00.000Z"},"2":{"tags":"Vim, Talks"}},"version":""},{"id":72,"title":"检测浏览器地址栏 #hash 的变化","content":"#\n\n \n\n\n参考#\n\n 1. Emulating onhashchange without setInterval\n 2. jQuery hashchange event\n 3. window.onhashchange - MDC","routePath":"/blog/post/2010/hashchange","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":6}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-09-05T00:00:00.000Z"},"2":{"tags":"JavaScript"},"3":{"status":"draft"}},"version":""},{"id":73,"title":"整合状态按钮和导向按钮","content":"#\n\nDemo\n\n\n延伸阅读#\n\n * 状态按钮和导向按钮","routePath":"/blog/post/2010/integrate-guide-button-and-status-button","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":9}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-07-31T00:00:00.000Z"},"2":{"tags":"Web-Design"}},"version":""},{"id":74,"title":"JavaScript 千分位算法","content":"#\n\nhttps://gist.github.com/748249\n\nv1:\n\n\n\nv2:\n\n\n\nv3:\n\n\n\n\n参考阅读#\n\n * “千分位”格式化数据的正则\n * 以“千分位”格式化数字–JavaScript\n * javascript 按千分位划分数字-递归方式\n * js数字千分位及取小数点后几位方法测试","routePath":"/blog/post/2010/javascript-commfy","lang":"zh-CN","toc":[{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":56}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-12-20T00:00:00.000Z"},"2":{"tags":"JavaScript, 算法"}},"version":""},{"id":75,"title":"Diff 模式下，让光标直接跳转到被修改的文本处","content":"#\n\nVim 的 Diff 功能非常优秀。有一个我非常喜欢的特性是：完全相同的地方，\n会被折叠隐藏起来(上下文除外)。还可以很方便的在各个差异点之间做出修改合并和快速跳转。\n\n不过默认的 [c 和 ]c 两种跳转方式，目前只能跳转到差异点的行首。对于只修改了\n行内部分文本内容（一般底色是浅红色）时，我更希望直接跳转到有变化的文本（底色是 深红色的部分）上。\n\n感谢 tocer ，我初步实现了两个版本 gits:556810\n\n 1. v1: 仅支持跳转到 DiffChange 的第一个 DiffText\n 2. v2: 支持 DiffChange 行多个 DiffText\n\n\n参考#\n\n 1. :h synIDattr\n 2. :h diff_hlID\n 3. @twitter\n 4. vimdiff 的跳转\n 5. vimdiff: Jump to next difference inside line?","routePath":"/blog/post/2010/jump-to-difftext","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":291}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-08-30T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":76,"title":"联动的设计","content":"#\n\n联动控件一般用于下拉列表，例如省市县的联动。\n\n很早的时候有些初级的实现只做到了固定级别（比如二级、三级）的联动，它们传入固定 的 N 个 <select> DOM 元素，形成固定的 N\n级联动关系。后来有了一些较好的实现， 这些实现做到了动态级别的联动（即无限级联动）。\n\n早期的无限级联动控件，一般实现是通过主动下拉列表在 onchange 触发时主动调用 被动列表的更新 <option> 的方法，或者甚至在 onchange\n处理函数中直接操作从动列表 的 <option>。\n\n主动调用从动列表的更新函数，则需要事先函数名称及传参的约定。 直接操作从动列表的 <option> 就更不靠谱了，灵活性也更差。\n\n另外，这两种实现只能做到一维的线性联动，即一个主动列表对应一个从动列表，要实现 一个主动列表联动多个（不确定数量的）从动列表，则比较麻烦/困难。\n\n另一种更好的实现，则是让从动列表来确定自己的主动列表，并监听主动列表的 change 事件。这种实现可以轻易做到动态级别、动态维度的联动，各个 <select>\n的数据源及 及处理函数都由自身确定。\n\n总结：\n\n> 这里 事件监听 ，比 主动调用 的设计思想更优秀。","routePath":"/blog/post/2010/linkage","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-11-23T00:00:00.000Z"},"2":{"tags":"Web-Design, Forms, BUG"}},"version":""},{"id":77,"title":"让 Vim 支持 LOG 文件","content":"#\n\n日志(.LOG)文件的基本上无章可循，各成风格。所以一般都是在纯文本模式下查看。 以普通文本的方式显示日志，基本没有清晰度和阅读舒适感。\n\n不过一般来说，日志中是会有日期时间（格式非常多样），错误产生的地址，行号，\n列号，日志类型（错误(ERROR)，信息(INFO)，调试(DEBUG)，警告(WARN)等）\n\n据此，我为 .LOG 文件定义了一些语法着色的规则，将 log.vim 放至 $VIM\\vimfiles\\syntax(Windows) 目录，并在\n$VIM\\vim72\\filetype.vim 中加入：\n\n\n\n现在就可以在 Vim 中较清晰的查看 .LOG 日志了。\n\n\n\n你也可以针对自己的实际情况，来自定义语法。","routePath":"/blog/post/2010/log-syntax-4-vim","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-05-13T00:00:00.000Z"},"2":{"tags":"Vim, .LOG"}},"version":""},{"id":78,"title":"在 Vim 页签中打开文件","content":"#\n\n这两天折腾让文件在 Vim 的新页签中打开（类似 Firefox 等浏览器）的特性， 发现让文件在页签中打开有非常多的优点：\n\n 1. 打开文件的速度更快（免去了启动 Vim 的时间）\n 2. 占用内存等资源更少（单个 Vim 窗口比多个窗口节省资源）\n 3. 任务栏更节省可用空间（不过 Windows 7 中还未支持任务栏多页签内容预览）。\n 4. 编辑过程中文件间可以快速跳转，缓冲区也可以共享。\n\n我参考前辈的方案，做了更 自动化的处理脚本， 将其中的 edit.with.vim.tabs.reg 合并到注册表就可以了。如果想还原为用窗口打开的方式， 再将\nedit.with.vim.window.reg 合并到注册表中。\n\n这个设置会让双击默认编辑器为 Vim 的文件，或者右键 -> Edit with Vim 都将文件在页签中\n打开。开始用着确实挺爽，右键菜单中也没有了那些动态增加进来的已打开的文件的菜单项。 不过后来又发现不止如此，连“用 Vim 比较”(Diff with\nVim)的项也没了。\n\n重装了好几次，终于搞清楚了一些东西。注册表的\n\n\n\n是关键项，他根据 gvimext.dll 来附加右键菜单的动态项，包括 Diff with Vim。 如果你不想有默认的新窗口中打开文件的“用 Vim 编辑\n(&V)”(Edit with Vim)， 就需要把上面这项删除，不过这也会殃及 Diff with Vim。\n\n我实在没有特别好的办法，我在注册表中做了一个 \"Diff with Vim\" 的项，但是这个菜单命令\n会针对选中的多个文件各自执行一次；而不是执行一次，并将多个选中的文件作为参数 一次传入。这个肯定也能做到的，参看 Vim 默认的行为，和 WinMerge\n等就知道，只求高手来帮忙了。\n\n我目前不希望没有这个选中多个文件并 Diff 的功能（虽然它连快捷键都没有）， 所以只好保留了这个注册表项，为了避免快捷键冲突，只好修改了在页签中打开文件的\n注册表项的快捷键。\n\n或者用其他的文本比较工具，如 WinMerge，BeyondCompare。这样的话，直接删除上面的注册表项。\n\n如果你有好主意，快来快来告诉我 : )\n\n\n其他#\n\n另外给页签加上序号是非常有用的：\n\n\n\n尤其是在设置了这样的快捷键之后：\n\n\n\n更多，但是不推荐(因为跟默认快捷键冲突)的快捷键设置：\n\n\n\n\n更新 (2010/6/26)#\n\n今天想折腾一下 gvimext.dll ，因为这个是问题的本源，只要将它里面的“用 Vim 编辑”(Edit with Vim)加上参数，\n改成新页签中打开的方式就好了，而且选中多个文件进行比较，好像也必须使用动态连接库的方式实现， 于是找到了这个 gvimext.dll 它让 Vim 7\n支持新页签中打开。试用了一下，感觉有点啰嗦了，它让新窗口和新页签打开文件的方式共存，并且快捷键\n仍然设置在新窗口打开的菜单项上。不过里面带有源码，我们可以改成自己喜欢的方式。\n\n\n参考链接#\n\n * Vimfaq - Ubuntu 中文\n * vi/vim使用技巧: 在标签页中打开文件 (windows)\n * 如何通过使用注册项 (.reg) 文件添加、修改或删除注册表子项和值\n * Context menu issues with gVim in Windows 7 x64\n * Add open-in-tabs context menu for Windows\n * Show tab number in your tab line\n * 为gVim Portable添加右键菜单\n * Vim 的标签页功能","routePath":"/blog/post/2010/open-files-in-vim-tabs","lang":"zh-CN","toc":[{"text":"其他","id":"其他","depth":2,"charIndex":939},{"text":"更新 (2010/6/26)","id":"更新-2010626","depth":2,"charIndex":1016},{"text":"参考链接","id":"参考链接","depth":2,"charIndex":1269}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-06-25T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":79,"title":"天目山拓展活动","content":"#\n\n公司组织了一次天目山野外拓展活动，收益良多，这里稍事记录。\n\n“信任背摔”：如果信任队友，笔直倒下，这无论对自己，对队友都是最佳选择。 在队友的保护下倒下90度并不会造成什么伤害，8个队友的平均分摊也使受力最小。\n但如果不信任队友，撅着屁股坐下去，队友不堪其苦，手可能会受伤，因为承受 不住而将自己扔在地上，自己也会摔的很惨。\n\n感受：把适当的工作放手交给队友，信任他们，自己可以得到最大程度的释放， 队友也可以表现到最好。否则自己心力交瘁，队友也不堪其苦。\n\n“齐头并进”：我们小组获得了最大程度的失败，中途两次中断排头有一定的责任， 但各位队友心力不齐是更大的问题，而最大的毛病是不能保持平和的心态，很好的\n势头，但急于求成，越走越快，直至完全失控，乱掉方寸。\n\n“天桥”（真正的名称未知，具体是爬上10米高架，从断桥跳跃抓住单杠）：据教练 说最快速度是从爬上到跳下总共14秒，我第一次玩这个，作为压阵选手，我准备挑战\n一下，让同事用我的手机秒表记时，可惜他不是很熟练，没记上，说大概是25秒， 看来还是有差距。这个游戏最刺激的是下落那一刻，负责保险绳的教练，非常好玩，\n他说了，只负责队员的生命安全，其他不管，弄哭了好几个女生（不包括在上面还 没有开跳就开哭的）。我在自由下落那一刻，眼前一片模糊，四肢没有知觉，不知道\n有没有很挫的蜷缩。\n\n“电网”：我第一个出发，在队友的帮助下从下面的窟窿安全穿过，然后帮助几乎 所有队友通过，好累，也揩了好多油，美女都是我抱过来的，很多男的也是（挫）。\n\n经验：第一个需要身体适中（不是太壮大，但身体较强壮，比如我 ：D）；再辅助 几个能派上用场的男队员过来，中间把所有女队员抱过来，瘦的要留在最后，并且\n一定要记得要在下面给他留一个可以钻过的窟窿。衣服要很小心注意。\n\n“逃生墙”：没有绳子辅助，要翻过 4.2米的高墙是不可能的，团队合作尤为重要。 我被选为第一个逃生者，踩在队友的大腿和肩膀上是不够的，我没想到他们会将我\n托起来，太伟大了！我（被女生称为）“像猴子一样”迅速翻过，然后协助了超过一半 的队友完成逃生，先上来的又积极协助后面的队友，而下面作为基石的队友更是伟大，\n有些基石托起了超过一半人。逃生 过程非常火爆，最终我们81人全部在 13分8秒完成了翻墙逃生。\n\n技巧：两名基石队员半蹲准备，逃生队员通过其大腿踩到肩膀上，然后身体贴这墙 直起身体，向上伸手求助（第一名队员千万不要通过弹跳来抓上面，这样基石队员\n的肩膀非常容易受伤），翻墙时脚的协助非常重要，侧身攀延。最后一个队员的逃生 最为困难，本来准备让我倒挂救援的，结果据说是让其抓住倒数第二名队员的脚\n拉上来的，我没有看到，不过人多力量大，这个绝对可以做到。","routePath":"/blog/post/2010/outreach-activities-2010-04","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-17T00:00:00.000Z"},"2":{"tags":"Life"}},"version":""},{"id":80,"title":"遍历字符的性能","content":"#\n\n 1. s.charAt(i)\n 2. s.split(\"\")[i]\n\nTest\n\n在 IE7, Firefox3.6.8, Chrome5.0, Safari5.0, Opera10 上测试， 除了 Firefox 之外，所有的浏览器均是第\n2 种表达式更快速。\n\n ","routePath":"/blog/post/2010/performance-for-each-char","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-07-29T00:00:00.000Z"},"2":{"tags":"JavaScript, Performance, 性能"},"3":{"status":"draft"}},"version":""},{"id":81,"title":"正则表达式重复子模式前、后倾的性能比较","content":"#\n\n在准备内部的正则表达式 (Regular Expression)分享的过程中， 注意到一个细节问题：重复的子模式，是应该前倾还是后倾，这两者在性能上有什么差异？\n\n前倾和后倾是我胡诌的两个词，我的定义如下：\n\n> 前倾 就是前面的子表达式使用贪婪匹配或较大的量词，尽可能多的匹配内容，\n> 导致前面匹配的内容较多而使“天平”前倾。例如：/(?:\\d{1,3}\\.){3}\\d{1,3}/。 后倾\n> 则相反，后面的子表达式使用贪婪匹配或较大的量词。如：/\\d{1,3}(?:\\.\\d{1,3}){3}/。\n\n \n\n前倾和后倾在实际应用中很常见，如时间，主机名等，中间以某特殊字符（串?）分隔， 被分隔部分的规则又相同的情况下，一般都是使用这两种实现方式之一。\n\n上面定义中的两个例子只是简例，可以用来大致匹配 IPv4 地址，完整的 IPv4 地址正则式如下， 它要求每段都在 0-255 之间： 前倾：\n\n\n\n后倾：\n\n\n\n我写了一个测试比较这两个正则性能 的页面，在 IE7, FF3.6, Safari 4, Opera 10 下测试均为前倾的性能较高，Chrome 4\n下则不相伯仲。\n\np.s. 这种重复子模式，要有语法上的简写就好了，像 Perl 正则的递归引用（或类似运行时反向引用）， 维护起来就方便多了。","routePath":"/blog/post/2010/performance-for-regex-repeat-sub-pattern","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-01-26T00:00:00.000Z"},"2":{"tags":"RegExp"}},"version":""},{"id":82,"title":"arguments to Array 之效率","content":"#\n\n怿飞昨天发有一篇《如何将函数的实际参数转换成数组》 的日志，其实核心不是讲“如何如何”，而是比较了几种算法/语法的效率。 说到算法本身的性能，我和 army\n的看法 一样，对这篇日志的观点提出质疑。\n\n从语法原理上，Array.prototype.slice.call(arguments)是对数组的slice方法的原型直接引用，而[].slice.call(a\nrguments)则需要创建数组对象。没有理由后者比前者的性能还要高的。\n\n不过我还是写了 测试 来证实自己的观点，为了尽量少的避免其他干扰（包括函数调用带来的消耗）， 算法/语法都直接内联写在计时器一起。\n\n这几个例子分别比较了：\n\n * Array.apply(this,arguments)\n * Array.prototype.slice.call(arguments)\n * [].slice.call(arguments)\n * Prototype 的 $A(arguments)\n * jQuery 的 makeArray(arguments)\n * 和最土的循环算法。\n\n并在各个浏览器（Multi IE 6, IETester 5.5, IETester 6, IE 7, FF 3.5, Chrome 4, Safari 4,\nOpera 10）下一一测试。也欢迎各位参与测试并将结果提交给我， 如果你觉得测试有不公平合理的地方也可以提出。\n\n至于结论，也不是那么好确定，不过大致如下： Array.apply(this,arguments) 在大部分情况下都能取得优胜；\n而Prototype和jQuery其次，不过这两者不仅仅是针对arguments编写而且是直接调用其函数\n（稍有消耗），这里只拿来比较一下，这两个还是非常出色的； Array.prototype.slice.call(arguments) 和\n[].slice.call(arguments)则旗鼓相当， 并没有说谁比谁一定更强，更浏览器实现有关，在部分浏览器中前者有稳定的微量优势；\n至于老土的循环法，arguments.length 较小时表现不俗，较大时也更浏览器有关系。 而怿飞说的那点（不确定的）非关键或巨大性能优势，其实意义不大。\n\n\n延伸阅读：#\n\n * 正则表达式拼接和构建零长度对象\n * Javascript String 方法效率大比拼\n * Javascript 相等符(==)与完全相等符(===)之效率","routePath":"/blog/post/2010/performance-of-arguments-to-array","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":955}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-01-07T00:00:00.000Z"},"2":{"tags":"JavaScript, 性能"}},"version":""},{"id":83,"title":"电梯楼层选项板的位置","content":"#\n\n每天电梯使用的高峰期，相信许多人都体验，甚至主演过，许多人进门就堵在门口找自己要去的楼层。\n由于中国人勤劳自主的缘故，选楼层一般都倾向于自己来做，不过这不如尽快的让大家进电梯， 然后请站在选项板旁边的人帮按一下，再谢谢对方。\n\n作为选项板本身，也应该引导用户这样来乘电梯，所以将自己挪到电梯最内侧，也可以在两侧，但最忌在电梯门旁边。\n\n\n\n@flickr","routePath":"/blog/post/2010/place-of-lift-floor-control-panel","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-01-06T00:00:00.000Z"},"2":{"tags":"UED"}},"version":""},{"id":84,"title":"placeholder 最佳实践","content":"#\n\nplaceholder 2 是 HTML5 中的标准属性，它用于定义显示在输入框中的简短提示信息，并在适当的时机 （比如在输入框获得焦点时）隐匿起来。\n\n在早期的浏览器中，只能通过 JavaScript 自定义函数来实现。而在早期的实现中又五花八门。\n\n在 HTML 方面，一般是使用自定义的 hint 或者 title 属性放置提示消息。\n\n而在 JavaScript 上，最常见的是通过修改 input 本身的 value 及其 CSS 样式实现。 一般有直接修改 input 的样式，或者添加\nclass 两种，后者从某种程度上来说更好些。\n\n早期的实现中还有一个比较不好的问题是，代码里直接判断 input.value 是否为空，\n或者是否为占位符提示的值，如果用户输入的内容如果碰巧和占位符提示相同，则会出现误判。\n\n下面可以说是早期思想中一个较佳的实现：\n\n\n\n但是即使如此，直接修改 input.value 同样会有一个几乎无法避免的问题：假如用户在必填项中没有\n输入任何内容，但是占位符会填充其内容，在提交表单时，当然也可以通过判断 input 是否包含 placeholder\n样式类来针对性处理。但是特殊地，当页面出现脚本错误（这应该说不少见），导致\n表单验证函数未能正确处理而直接提交到服务器，这时服务器是较难准确确认输入框中的内容是占位符， 还是用户输入的内容的，它只知道这个满足非空条件。\n\n于是后来有了一种更有趣的实现，它不是直接修改 input.value，而是使用一个附加的元素，占位符消息\n放置在这个元素中，并通过恰当控制这个元素的显示/隐藏，来达到更真实和优秀的体验。\n\n这种实现甚至可以轻易的实现只有用户在输入框中输入内容之后，占位符提示消息才消失。\n\n这个实现要注意以下几点：\n\n * 字体大小等样式要尽量和 input 一致（颜色例外）。\n * 使用 label 作为占位符消息的容器标签，可以加上恰当的 for 属性，实现自动关联。\n * 占位符的位置，可以直接使用 CSS 的相对位置实现，也可以使用 JavaScript 计算获得。\n\n比如下面的实现：\n\n\n\n另外对于已经支持 placeholder 的浏览器可以忽略上面的代码，而使用浏览器的默认实现。\n\n\n\n\n延伸阅读#\n\n * diveintohtml5.org#placeholder\n * 让所有的浏览器都支持 HTML5 placeholder 属性，基于MooTools\n * 跨浏览器的HTML5 placeholder 实现\n * Inline Form Labels， Inline Form Labels（2）\n * JQuery HTML5 placeholder fix","routePath":"/blog/post/2010/placeholder-in-action","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":958}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-12-06T00:00:00.000Z"},"2":{"tags":"JavaScript, HTML5"}},"version":""},{"id":85,"title":"“正则表达式”分享资料","content":"#\n\n这周三做了一次内部“正则表达式”分享活动，本来是针对小组成员的分享， 结果部门很多高手也来捧场，非常荣幸。\n\n有兴趣的朋友可以下载 RegExp.zip 这个资料。 我使用 XMind 做的一个分享大纲，从简介，基础、高级语法，一些经典的案例和有趣的用法。\n另外还附有一些有用或有趣的资料。\n\n这是我生平第一次较正式的分享（上次是项目启动，没有什么实质的分享内容），\n由于没有什么经验，所以准备的相对比较充分，不过分享过程中的演说和演示的比提纲中的更丰满， 同事参与的探讨也非常热情。","routePath":"/blog/post/2010/regex-share","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-01-31T00:00:00.000Z"},"2":{"tags":"RegExp"}},"version":""},{"id":86,"title":"发现 Safari4 的 select 控件 bug","content":"#\n\n昨天看了新的淘宝首页，非常赞，有不少模仿/参考Yahoo 的成分。\n\n当时用的Safari 4 Public Beta (528.16)（后来用同事的Safari 4.0.2\n(530.19.1)也一样），偶然点到预订机票的页签，随便点了几下选择框(<select>)，2月，28天，正常；3月，28天？；4 月，28天！…\n\n\n\nSafari 4 select bug(Windows)\n\n另外在IE 7, FF3.5, Chrome 4, Opera 10上测试却都是正常的。\n\n源码很易读，逻辑上没有什么问题，几点建议：\n\n * 清空选项框建议使用遍历并 selDay.remove(0);； （一时忘记在什么情况下 selDay.options.length = 0; 会有问题了）\n * 在创建好 Option 对象之后再 selMonth.options[month].selected = true; 和\n   selDay.options[day-startDay].selected = true; 就可以了，无需在循环时一一判断；\n * 另外关于转换不存在的日期（如2月31日）时，在这里其实没有什么用处的， 转出来的日期基本也不会是用户期望的日期（用户期望是2月某日，却跑到了3月），\n   遇到这种情况，变成2月1日或2月28日就可以了，而无需给出任何（讨厌的alert）提示。\n\n这都不是造成这个bug的原因，打印各个关键的运行时变量值都是正常的，但在界面是就是没有显示出来。\n\n今天 5 号，把昨天没有确定（是当时机器，或者当时浏览器）的问题拿出来再看， 发现2,3,4…月都只有27天了，这个值与第一次产生的\noptions.length相等。 注释掉 519: //startDay = now.getDate(); ，让 最初长度为31，\n再转到2月，发现最后多了好几个不能点击的可见选项，此时浏览器也经常性崩溃。\n\n这应该是渲染引擎的问题，而针对 IE 激活重新渲染的代码也无效：\n\n\n\n但是淘宝紧邻预订机票左侧页签的“游戏快冲”却没有这个问题，于是怀疑是跟 Option 的个数有关。\n\n经过更多的实验分析， 结论 是超出24个 Option 之后的选项，渲染就会出问题， 而恰巧? Safari 4 默认最大下拉长度也是24个。","routePath":"/blog/post/2010/safari-4-select-bug","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-01-05T00:00:00.000Z"},"2":{"tags":"Browser, BUG"}},"version":""},{"id":87,"title":"针对 HTML 的 Snippets","content":"#\n\n","routePath":"/blog/post/2010/snippets-for-html","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-06T00:00:00.000Z"},"2":{"tags":"Vim, snipMate, HTML"},"3":{"status":"draft"}},"version":""},{"id":88,"title":"同步客户端时间(续)","content":"#\n\n08 年我就有了这样的 想法，却到今天才开始实践。\n\n公司电脑时间错了好多，但我的账户没有 Internet 同步的权限，遂手动校准。\n\n到 国家授时中心 校准时，发现其服务器时间的 跳跃是受客户端时间影响的，当客户端时间发生修改时，页面上显示的服务器时间也跟着 偏差。\n\n后来到台湾的 國家時間與頻率標準實驗室 发现没有这个问题。\n\n研究了两者的代码，发现跟第一观感不同的是，这两者我更赞赏大陆的做法了，虽然有明显的可见缺陷。 下面简单分析下两者的实现思想及各自的优缺点。\n\n台湾的是使用 setInterval 实现了一个定时器，这个定时器考虑到了调用函数的时间消耗， 但是 setInterval 或 setTimeout\n本身的不确定性，随着跳跃时间变长，页面显示的服务器 时间便有非常大的偏差，尤其在 IE 浏览器中（几十分钟内，Firefox偏差数秒，IE7偏差数分钟）。\n\n而大陆的实现则使用服务器的初始时间，但使用客户端的频率进行跳跃（并在 1 秒中检查 10 次，\n避免跳秒问题）。这样即使经过长时间的跳跃，同样能保持较高的准确度。但问题是，当客户端 时间发生修改时，所谓的服务器时间也会收到影响。\n\n于是我结合两者各自的优点，避开他们的缺点，实现了一个 校时器。 他使用客户端的跳秒，但是当客户端发生时间不正常的跳跃时，自动修正客户端和服务器端之间的 时间差。","routePath":"/blog/post/2010/sync-client-time","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-11-15T00:00:00.000Z"},"2":{"tags":"Web-Design"}},"version":""},{"id":89,"title":"“方便”的副本","content":"#\n\n在整理《Form 表单最佳实践》的时候，想起了功能相同， 分居在页面上、下两地的孪生元素。于是在 Twitter ，各个群里询问大家对于搜索引擎\n页面底部这个副本搜索框的实际使用情况。\n\n> 【调查/询问】：搜索引擎一般都在结果页上、下都提供搜索框，请问实际 较常使用 下面这个搜索框的用户有多少呢，你常用吗？下面的这个搜索框究竟多有用？\n> @twitter 实际上你有多常用这个搜索框？撇开其他的顾虑。 @twitter\n\n得到了蛮多的回馈，各方理由颇多，不一而足。总体来说，还是几乎不用的居多， 用的较少、或是还算常用的两者比起来都不相伯仲。\n\n我个人的情况是：多数情况下，都不自觉的滚轮/到页面顶部，然后在上面的 输入框输入关键字进行搜索。然后（有时候）想起下面其实也可以搜索，会有些懊恼。 而早先\nGoogle 和 Firefox 右上角的搜索框的配合很好的时候，则直接使用这个浏览器 搜索框的居多。\n\n听说 gnome 里右键点击滚动条上面的箭头，就直接滚上去了。\n\n有用 vimperator 插件，默认是上面的搜索框，所以下面的基本用不上。\n\n也有说用 AutoPager 插件，无视下面的搜索框（不过这是翻页，跟使用下面的搜索框 还是不一样的）。\n\n有些用户是直接使用 Google Chrome 的多功能地址栏。\n\n而支持使用下面的搜索框者，理由就都差不多了：浏览到底部，没有找到，想换关键字 就直接在下面输入了。\n\n调查\n\n\n思考#\n\n搜索引擎下面的搜索框用的较少的一个原因：结果列表并不长。\n\n多数情况下，或者多数人几乎都非常少用下面的搜索框，可以精简掉吗？呃，对于本来 就很简洁的搜索引擎来说，他至少没什么负面影响，另外支持这个输入框的用户同样会\n站出来捍卫他们的利益。如果还有其他更好的方式，他们还会反对吗？\n\nVim-like 的 / 快捷键用来快速定位到上面的输入框、或者激活悬浮搜索框到显耀的 位置，是一种更好的方式吗？（毕竟要更换搜索关键字，就要使用键盘的吧？）\n\n\n延伸#\n\n不仅仅是搜索框：\n\n 1. 翻页链接。 有人说翻页放到上面是一种变态，在下面没有翻页链接的情况下。 恩~~，是够变态的。 个人认为放在下面比较合适，上面的就不必了。\n 2. 类似在线音乐列表的全选/反选复选框。 支持 +Shift 多选也是一种方案。 这个比较特殊，我个人的习惯是：\n    功能(播放)按钮在上面时，使用上面的全选复选框；功能按钮在下面时，使用下面的 全选复选框。 对于 Gmail\n    这种上下都提供完全一致的全选复选框和功能按钮的情况， 主要还是用上面的，记忆中，几乎每天都用的 Gmail，5 年来下面的复选框和功能按钮 用过不超过\n    3 次。 一般来说，一屏差不多可显示完的短列表，上面提供全选及功能按钮就可以了； 对于非常长的列表，放置在底部可能比较合适。\n    另外：对于不需要思考就很可能会选择全选的内容（如唱片专辑），可以在上、下 都提供全选及功能按钮。\n 3. 一些打着方便的旗号，甚至跨页面的副本。 有时候也许是好事，但遍地开花就不仅仅是未必了。","routePath":"/blog/post/2010/the-duplicate-element","lang":"zh-CN","toc":[{"text":"思考","id":"思考","depth":2,"charIndex":626},{"text":"延伸","id":"延伸","depth":2,"charIndex":854}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-10-27T00:00:00.000Z"},"2":{"tags":"Web-Design, UED"}},"version":""},{"id":90,"title":"实现文本转语音","content":"#\n\n又是心血来潮，想把文本转为语音朗读，通过听书的方式来多重利用时间。分心听书有效 吗，未可知也。不过还是想折腾下，心血来潮嘛。\n\n刚开始以为一定需要下载个语音软件，用它将文本转成语音，通过调节字词之间的停顿， 来达到较好的视听效果。\n\n因为很久以前有折腾过使用 Word 实现语音朗读的事，朗读效果非常不好，所以不想下载 那些大型的朗读软件，总感觉他们读出来的声音会让人恶心死。\n\n群里请教了一下有没有推荐的，得到 eGuideDog，但是 似乎仍然不甚理想，后来又发现了 NeoSpeech，里面提供\n的试听效果非常好，尤其是日语朗读，跟真人朗读差不多。\n\n于是继续寻找相关资料，在 VeryCD 上得到这些：1 2 3\n\n后来看到一张语音属性的图片，才进控制面板明白了一些事情。\n\n看到有通过微软拼音输入法3.0的语音功能实现的介绍，不过我在微软拼音3.0和 2007 中 都没有找到对应菜单项。\n\n通过 Excel 2007中的文本到语音 知道 Excel 内置了语音朗读的功能，但是 Word 没有找到对应的。便找到了\noffice2007文本到语音命令的问题\n\n\n详细步骤#\n\n 1. 安装语音引擎，我下载的 这个，解压安装 会自动设置控制面板里的语音选择，可以进入“控制面板”->“语音”->“语音选择”， 系统默认是\n    \"Microsoft Sam\"，可以改为刚安装的语音，试听一下。\n 2. 打开 Excel (2007)，点击左上角（靠右侧的）三角下拉菜单（鼠标悬浮提示是 “自定义快速访问工具栏”->“其他命令”->“不在功能区的命令”，\n    添加“朗读单元格”和“朗读单元格 - 停止朗读单元格”， 在单元格中输入文本，点击“朗读单元格”就会听到发声。\n 3. 要想让 Word 朗读发声，可以使用自定义宏：\n    \n    1. 按 <Alt-F11> 启动 Visual Basic 编辑器。\n    \n    2. 创建名为 ReadRec 的宏：\n       \n       \n    \n    3. 单击VBE编辑器窗口中的“工具”菜单，选择“引用”命令，在弹出的 “引用-Normal”对话框中选择“Microsoft Excel 12.0\n       Object Library”复选框。\n    \n    4. 确定，关闭Visual Basic编辑器返回Word窗口。\n    \n    5. 右击工具栏，选择“自定义”命令，切换到“命令”选项卡，在“类别”中 选择“宏”，将命令中的“Normal\n       NewMacros.ReadSelection”拖放到工具栏中。\n    \n    6. 现在在 Word 里选中文本，点击工具栏刚加入的按钮，就可以朗读选中文本了。\n\n\n参考 & 延伸阅读#\n\n 1. NeoSpeech\n 2. NeoSpeech 语音下载(VeryCD) 2 3\n 3. Excel 2007中的文本到语音\n 4. office2007文本到语音命令的问题 2\n 5. Word 从文本到语音工具栏\n 6. Word音标助手COM加载项(更新2009.6.30版)\n 7. Word 2003如何实现文本朗读\n 8. Google's Text to Speech API : A PHP Wrapper Class","routePath":"/blog/post/2010/tts","lang":"zh-CN","toc":[{"text":"详细步骤","id":"详细步骤","depth":2,"charIndex":488},{"text":"参考 & 延伸阅读","id":"参考--延伸阅读","depth":2,"charIndex":1173}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-09-12T00:00:00.000Z"},"2":{"tags":"Text to Speech"}},"version":""},{"id":91,"title":"使用 calendar.vim","content":"#\n\n最初看到明城 推荐使用 Vim Calendar 插件， 于是很小白的尝试了一下，然后就没有了然后。\n\n最初尝试的过程已经基本忘记，恍惚记得在 Calendar 的日期上回车，窗户貌似在右侧窗口 打开的（后来发现我记错了，这是\nVimwiki-diary的支持）；至于明城推荐设置的 ca 快捷键，后来才知道是与 text-object 冲突的。\n\n再后来就用上了 Vimwiki，做个人 Wiki 之余，还用它的 diary 写日记。总体来说，Vimwiki 的 diary\n是比较强大的，我甚至还提了几个被接受的建议。\n\n但是随着使用的深入，发现通常 Wiki 项目下是不需要 diary 的，而 diary 也基本不需要\nWiki，把这两种整合在一起也许就是个错误。我们真正需要的是一个更强的 Calendar diary， 而不是 Wiki 附加的 diary 支持。\n\n如果真的希望 Vimwiki 有 diary 的支持，我也希望这个 diary 和 Wiki 是相互独立的， Wiki 项目中无需 diary，diary\n无需包含在每个 Wiki 项目里。\n\n另外基于 Wiki 的原因，所有的 diary-wiki 文件都放在同一个目录下，当 diary 日渐增多， 目录变得臃肿起来也不是什么好事。\n\n我需要的是一个更强的 Vim Calendar。基于这个想法，我便尝试着手增强 Calendar。 目前已经支持 :CalendarSearch 和更好的\ndiary 打开方式。更多的想法见 这里。","routePath":"/blog/post/2010/use-vim-calendar","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-07-23T00:00:00.000Z"},"2":{"tags":"Vim, Calendar"}},"version":""},{"id":92,"title":"用 Vimwiki 写博客","content":"#\n\n由于众所周知的缘故，我的博客 被消失了。 在国内买域名或主机都是十分不靠谱的事，所以目前没有重新开独立博客的打算。\n而使用第三方博客服务也同样不靠谱，目前只同步在 Google Blogger 上。\n\n把东西都放在自己的计算机里算是比较可靠的方式了， 我计划使用 Vim + Vimwiki + Dropbox 来搭建自己的特殊博客系统。\n\n\n原理#\n\n使用 Vim 这个极致的编辑器，加上 Vimwiki 这个优秀的插件， 可以用 Wiki 语法来写日志，1. 然后由 Dropbox 自动同步与发布， 2.\n已经改为 SVN 提交到 Google Code（生成的 HTML 文件需要设置 svn:mime-type 为 text/html）， 3. 现在是用 Git\n提交到 hotoo.github.com。 整体上来说这个系统基本完好，~~除了域名稍稍缺憾之外，~~Github 支持绑定第三方域名。\n\n\n搭建步骤#\n\n如果你看过 Vim Script 文档中文计划 的介绍，下面有写内容大概已经熟悉，这里作为完整的技巧一并介绍：\n\n 1. 确认正确安装了 Vim 和 Vimwiki。\n\n 2. 如果安装了 snipMate 在 $VIM/vimfiles/snippets/ 下新建一个 vimwiki.snippets 文件（已有则打开文件）。\n    在 vimwiki.snippets 中添加自己的博客格式模板，例如我的：\n    \n    \n\n 3. 因为 Vimwiki 和 snipMate 的 <Tab> 热键冲突， 可以将 $VIM/vimfiles/ftplugin/vimwiki.vim\n    中的\n    \n    \n    \n    换成其他的热键，例如：\n    \n    \n\n 4. 到此，在 .wiki 文件中输入 blog<Tab> 就展开博客模板了。\n\n 5. 在 vimrc 的 g:vimwiki_list 中加入一个 wiki，例如我的：\n    \n    \n\n\n技巧#\n\n这样我使用 4<leader>ww(一般是4\\ww) 就可以快速启动博客 Wiki 首页并进行编辑了。 Wiki 文件保存在 Dropbox 私有目录下，生成的\nhtml 文件保存在公开目录。\n\n草稿日志的 Wiki 文件中加入 %nohtml 不转成 HTML，索引页用 HTML 注释 < !-- --> （去掉 !\n前面的空格）就可以了。写好想发布时， 修改对应代码并 :Vimwiki2HTML 即可。\n\n\n模板#\n\n可以直接查看源码得到，或者这里 下载。\n\n\n评论系统#\n\n可以使用 disq.us。\n\n\n搜索#\n\n使用 Google AJAX Search API，详细可以参考老肥博客的 打造完美的 ajax 版 Google 自定义搜索","routePath":"/blog/post/2010/use-vimwiki-for-blog","lang":"zh-CN","toc":[{"text":"原理","id":"原理","depth":2,"charIndex":174},{"text":"搭建步骤","id":"搭建步骤","depth":2,"charIndex":410},{"text":"技巧","id":"技巧","depth":2,"charIndex":864},{"text":"模板","id":"模板","depth":2,"charIndex":1077},{"text":"评论系统","id":"评论系统","depth":2,"charIndex":1104},{"text":"搜索","id":"搜索","depth":2,"charIndex":1127}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-03-29T00:00:00.000Z"},"2":{"tags":"Vim, Vimwiki, Dropbox, Blog"}},"version":""},{"id":93,"title":"Vim 自动补全成对的括号和引号","content":"#\n\n炫日分享了一个 自动补全成对的括号 的脚本，【注】：原文代码中引号被转义成了中文引号，下面是修正后的脚本。\n\n\n\n经启发我增加了对括号和引号更为智能的补全支持， 不过中文全角的括号和引号目前无法通过映射来实现， 对于转义的符号对的支持不佳。\n\n支持 2000 行以内（可以根据系统性能自行配置）文档的全局括号对识别能力。 也就是 2000\n行以内的文档，支持跨行的括号对智能匹配能力；当文档行数超出预设值， 则使用行内括号对智能补全。\n\n * OpenPair:\n   1. 如果当前行的括号已经成对匹配，则自动补全右括号 (I)\n   2. 如果左括号比右括号多，则自动补全 I(() (I() ((I) (()I\n   3. 如果左括号比右括号少， I()) 原样输出，不自动补全 (I)) 同上 ()I) 同上 ())I\n      自动补全：左括号较少，且光标之后字符串进行一次递归上面的条件\n * ClosePair:\n   1. 如果光标之后是一个右括号，向右移动一列 (I) ((I) (I)) ()I)\n   2. 否则原样输出。\n\n代码见 gist: 449512\n\n\n更新 (2010/6/24)#\n\n\n最后更新 (2010/7/9)#\n\n\n相关脚本#\n\n * delimitMate.vim (src)\n * Making Parenthesis And Brackets Handling Easier","routePath":"/blog/post/2010/vim-autocomplete-pairs","lang":"zh-CN","toc":[{"text":"更新 (2010/6/24)","id":"更新-2010624","depth":2,"charIndex":496},{"text":"最后更新 (2010/7/9)","id":"最后更新-201079","depth":2,"charIndex":514},{"text":"相关脚本","id":"相关脚本","depth":2,"charIndex":533}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-06-20T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":94,"title":"Vim 中文帮助文档","content":"#\n\n前两天不知道为什么，帮助文档又跑会英文了（隐约是用 Vimball 安装了 Vimwiki 或者 重复安装了 TwitVim 的缘故）。\n\n\n\n无效。\n\n\n\n亦无效。\n\n很早以前不知道从哪里抄来的这个：\n\n\n\n从一开始就是报错的，一直被注释，从未被启用。\n\n在注册表中找到两个相关的项：\n\n\n\n将默认值修改为：\n\n\n\n或：\n\n\n\n重启系统，均无效。\n\n另一个注册表项的路径是正确的，无需改变：\n\n\n\n万般无奈，只好重装了中文文档。\n\n中文文档可以从 vimCdoc.sf.net 下载，也可以从 vimdoc.sf.net 找到链接，下载回来的是一个 .exe\n可执行安装文件，研究了下安装过程：\n\n 1. 前面都是在抽取中文文档文件(.cnx)，并放至合适的位置：(如 D:\\Vim\\vim72..\\vimfiles\\doc)\n 2. 抽取 tags-cn 并输出到文档同一目录 D:\\Vim\\vim72..\\vimfiles\\doc\n 3. 抽取 help_cn.vim 输出到 D:\\Vim\\vim72..\\vimfiles\\syntax\n 4. 抽取 vimcdoc.vim 输出到 D:\\Vim\\vim72..\\vimfiles\\plugin\n 5. 抽取 README,INSTALL,LICENSE,AUTHORS,guides.txt 到 C:\\Program Files\\vimcdoc\n\n其中设置 Vim 帮助的默认语言的步骤，即是在 vimcdoc.vim 中，因为 plugin 比 vimrc 加载要晚(参考)， 所以在 vimrc\n中的设置会被 vimcdoc.vim 覆盖掉。","routePath":"/blog/post/2010/vim-chinese-doc","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-03-15T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":95,"title":"Vim 学习路线","content":"#\n\n因为是完全自学，身边没有这方面的导师，所以在真正入门之前，我是完全不理解 Vim 是个什么玩意的，其中最大的障碍，遇到的第一个问题就是：“我怎么输入文字？”\n\n鼠标乱点，双击，右键，胡乱击键，应该是偶尔击到 \"a\" 键上而进入插入模式，但是 当时觉得又无章可循。新手在找一款趁手的工具时，一般很少太有耐心的，尤其面对\n这么怪异不可理解、还未接受的东西。这是个什么鸟玩意，我说，就离开了。\n\n所以第一个要点是，理解“多模式”编辑方式。\n\n能熟练进出插入模式并输入内容后，中文用户遇到的另一个重要问题就是编码问题了， 除非你直接拣了他人的 vimrc。Vim\n的编码支持是非常好的，重要的是理解并设置好 Vim 的编码选项。\n\n这两个门槛跨过之后，对新手来说 Vim 就和其他编辑器（如Editplus，Notepate++等） 大致没什么差别了。\n\n我于此踏上了 Vim 之旅，进入疯狂的学习期。\n\n这个学习期是无章可循的，不过大致是先学习凌波微步，各种快速移动的技巧；找别人 的 vimrc 参考设置，命令，快捷键，自定义的键盘映射，看别人推荐的插件介绍并\n亲身体验，搜索 Vim Wiki，看台湾大牛林佑安的 PPT，论坛和群组里交流学习， 搜索收集各种有趣、有用的小玩意。乱七八糟一堆东西，沉迷其中，不可收拾。\n\n逐渐的我也可以给新手一些指导帮助了，由于射手座，O型血的缘故，崇尚自由开放，在 力所能及的领域还算热心人，我便成了我。\n\nVim 是一个大宝藏，里面有太多太多的宝贝，Vim doc 就是一本 Vim 的百科全书，对 Vim\n的注解精悍而又无所不包，你几乎可以找到任何需要的帮助，如果实在找不到， Vim Script 和 Wiki 上也有其他人非常多的智慧。\n\n不过对于普通用户，只需要掌握快速移动，文本对象，少量的寄存器，搜索、替换技巧， 和微量的宏技术，基本就差不离了，这些是最常用的技巧，可以大幅度提高编辑、阅读\n效率。\n\n偶尔有一些特殊需求可以搜索或找人帮忙，如果喜欢，也可以学习脚本技术来扩展自己的 Vim。","routePath":"/blog/post/2010/vim-tutor","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-04-11T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":96,"title":"【已结束】 ~~关于团购庆祝 Vim 7.3 正式发布的 Tee~~","content":"【已结束】 关于团购庆祝 Vim 7.3 正式发布的 Tee#\n\n我在 Twitter 上随意说了句相关的 意向， 便有不少回应表示也愿意加入，我本想最好由某个懂行或者牛人来发起活动，我参加就好了，\n不过目前看来，我只能自己扛起这个重担。\n\n\n关于 Tee#\n\n> 初步设想： 正面 ：印 Vim 的 Logo。 投票 背面 ：印 :wq! 或者 :help! 命令，下面还印上版本信息 :version。 投票 右手袖子\n> ：印 :version 信息。 颜色 ：商家唯一指定白色。 P.S. 还有网友提议将自己的 vimrc 打上去，创意不错，但这是一此集体活动。\n> 不过大家还是可以提议一些非常具有 Vim 特色的代码。\n\n![](http://www.flickr.com/photos/hotoo/4893442809/\nhttp://farm5.static.flickr.com/4141/4893442809_aedb31676a_b.jpg)\n\n商家答应可以有 3 种不同的图案，但是考虑到实际操作太麻烦，包括下订单，印刷和发货都非常容易出错，\n所以我们最好是尽量少的使用不同图案。如果有喜欢但是没有选择的图案，各位可以各取所需自行单独印刷。\n\n参考：\n\n * 滇狐很久之前提供的版本 （简易版 ^[1]^ 普通版 ^[2]^ 高级版 ^[3]^）\n * Vim T-shirts, Shirts and Custom Vim Clothing\n   * Tee 图片\n   * 2\n * 另外感谢 阿阳 还提供了一份他找视觉设计师修改过，上次印 Tee 的 AI 文件。\n\n\nTee 的质量#\n\n商家是阿阳推荐的，他之前有在这家定制过，说是材料“比较厚，质量还不赖的”。 而商家说：“我们这只有一种220克的，是属于好的，差的么就是180\n200克的。那二种我们没有在做的。”\n\n\n关于费用#\n\n跟淘宝一个定制 Tee 的 商家 联系，50件以上的话 双面印刷最低能到 28.00 26.00 25.00 元/件（单面 25.00），目前有 50 多人，\n如果有更大的数量级，估计还可以更便宜，到时候我再商量，40 件估计需要一周才可以出货； Tee\n可以直接发到每个人手中，考虑到运费，我提议同城的统一由一个人负责签收并发放， 这样顺便还可以线下认识几个朋友，同城运费最终 AA\n制；自己愿意单独付运费的不在此列。\n\n如果看中这店家的其他 Tee，参加团购的朋友也同样可以以团购的价格购买，直接在 店家商品上拍即可，记得给商家说明情况，另外还要报上我的旺旺ID（请来邮件索取）。\n\n周六我会公布所有同城信息，到时候希望同城统一签收的可以联系我。 除非专门指定，默认情况下，均发或到个人签收。 学校老师或学生会稍晚发货，以确保各位能在学校签收。\n\n目前不支持快递到国外，如果有国内的地址，请使用国内地址。 到台湾的快递费是 35.00 元，3 天之内可以到。\n\n目前还没有确定最终购买人数和打折尺度，而且费用收取方式上也还没有确定，大家可以自由选择\n预付定金，或者我先垫资金的方式，都没有关系的。下周末等情况确定后我会公布收款方式， 请大家静候佳音。\n\n费用收取方式主要采取支付宝收款，或者银行卡汇款。\n\n店家提供的快递运费对照表：\n\n运输方式   1公斤内    加重/公斤   运送到\n快递     8.00    5.00    安徽\n快递     5.00    2.00    上海，江苏，浙江\n快递     10.00   8.00    北京,天津,河北,山西,辽宁,吉林,黑龙江,福建,江西,山东,河南,湖北,湖南,广东,广西,海南,重庆,四川,贵州,云南\n                       ,陕西,甘肃,青海,宁夏\n快递     15.00   ?       大陆其他地区\n速运     35.00   ?       台湾\n\n默认使用圆通快递，台湾地区使用顺风速运，3天内可以到达。\n\n\n【已结束】 关于报名#\n\n为避免报名时间过短，或等待时间过长，初步计划报名截止到下周末，如果中途有事没有时间也没有关系， 只要确认购买，我可以预付费用的。\n\n一旦确定购买名单，我们就开始下订单订货。\n\n由于我第一次搞这样的活动，有经验的老师请一定多多指导。\n\n> 注意 ：如果确定要购买，请务必将你 [http://www.flickr.com/photos/hotoo/4890597770/ 需要的尺码]， 邮件地址\n> ，实际的 收货地址 ， 邮编 和 收件人姓名 。 最好还有即时联系方式，比如手机，快递可能需要。 请确认这些信息能直接联系到你，收件人能收到货。\n\n如果在截止时间之前没有给出详细联系地址导致无法发货的，一律认为不参加这次活动，请谅解。\n\n如果有些没所谓的小失误的话请多多包含，大失误我会尽力承担的。\n\n\n活动结束语#\n\n这次活动过程几经波折，把我、团友，和商家都折腾的够呛。主要是由于我经验不足造成， 事先的准备工作也不够，导致有数次变更，甚至有些不尽如人意。\n\n不管怎么样，报名活动总算是结束了，我这里不再接收任何报名，仍希望购买的朋友可以尝试 这个链接， 运气好的话仍然可以得到团购的待遇。\n\n最后：这样的人生经历一次就够了，谢谢大家。","routePath":"/blog/post/2010/vim73-tee","lang":"zh-CN","toc":[{"text":"关于 Tee","id":"关于-tee","depth":2,"charIndex":121},{"text":"Tee 的质量","id":"tee-的质量","depth":2,"charIndex":699},{"text":"关于费用","id":"关于费用","depth":2,"charIndex":802},{"text":"【已结束】 ~~关于报名~~","id":"已结束-关于报名","depth":2,"charIndex":-1},{"text":"活动结束语","id":"活动结束语","depth":2,"charIndex":2037}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-08-14T00:00:00.000Z"},"2":{"tags":"Vim, Tee"}},"version":""},{"id":97,"title":"Vim 爱好者联系资料收集","content":"#\n\n希望通过一些形式让 Vim 爱好者联系更紧密，于是收集 Vim 爱好者的联系资料，并通过 较好的形式展现出来。\n\n目前是通过 面板形式 展现， 并有计划通过 Google 地图展现全国 Vim 爱好者的分布情况。\n\n资料收集方式：\n\n 1. Fork Vimmer 项目(最好是 gh-pages 分支)，并加入自己的资料到 vimmer.json 中。\n\n 2. 填写 Google Spread Sheets ^GFW出没注意^。\n\n 3. 邮件发送到 hotoo.cn+vim[AT]gmail.com ，请将 [AT] 替换成 @，保留 +vim\n    \n    ","routePath":"/blog/post/2010/vimmer-contact","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-10-11T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":98,"title":"用 Google Code 管理与发布 Wiki","content":"#\n\n由于 Dropbox 的墙掉，https 协议访问 dl 或 dl-web 子域 的方法也随之失效，虽然可以通过修改 hosts 来继续同步文件，但是\nPublic 目录再也 不能输出文化了。\n\n我之前 在 Dropbox Public 目录搭建的博客和 Wiki 系统 也无法在线浏览了，为了能够继续 辅助文化局输出文化，我便利用万恶的资本主义国家 的\nGoogle Code 来为我们服务了。\n\n由于可以继续使用 Dropbox 来自动同步私有文件，所以可以保持 .wiki 文件在 Dropbox 中，其他自动同步的软件也可以用来做类似的事情。\n\n将 Vimwiki 的 path_html 修改为 Google Code 的某个 svn 或 Hg 目录：\n\n\n\n虽然 Vimwiki 目前的 toHTML 方法还不支持重新生成仅更新过的 wiki 文件，但是 svn 可以判断文件是否有真正被修改过。\n\n另外 http://hotoo.googlecode.com/svn/wiki 目录存放的是 Google Code 的 Wiki 文件， 这里面的 wiki\n文件无需通过 Vimwiki 导出 HTML，Google Code 会自动完成这一工作， 并可以通过\nhttp://code.google.com/p/hotoo/w/list 浏览。而 Vimwiki 是 Google Code Wiki\n语法的一个子集，所以基本可以天衣无缝的配合使用。\n\n这也是不错的一个方案，除了需要 commit 之外，Google Code 比 Dropbox 的 Public 有过之而无不足，域名也是杠杠的。\n\n另外不小心发现还有其他的托管方案，让防火墙筑的更高些吧，当局者把自己当猪圈养起来 比较好，做个专职的脑子又笨，目光又短浅的墙脚之猪也可以提高幸福指数的。","routePath":"/blog/post/2010/vimwiki-google-code","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-05-20T00:00:00.000Z"},"2":{"tags":"Vim, Vimwiki, Google"}},"version":""},{"id":99,"title":"周数(Week Number, WeekNum)计算","content":"#\n\njQuery UI v1.8rc 版的日历控件已经非常完善，比之 v1.7.1 已经支持显示周数(WeekNum)， 而且计算 WeekNum\n的算法可以自定义；而 My97DatePicker 的算法又有Bug。对于两年交接的周，有两种常见的算法：\n\n每年 1月 1日所在的周均为该年的第 1周（如MS Excel的WeekNum()函数和 jQuery 实现）；\n\n\n\n每年最后 1天所在的周\n\n\n\n而从自然语言中来说，这交接的一周即可以是头一年的最后一周，也可以是后一年的第 1周。","routePath":"/blog/post/2010/weeknumber","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2010-03-16T00:00:00.000Z"},"2":{"tags":"JavaScript, 算法"}},"version":""},{"id":100,"title":"Date.now()","content":"#\n\n以前做过一个 JavaScript 性能测试“框架”，也看过其他人做性能比较的时候，基本上 也都是使用 new Date()\n来记时，会“耍点小花样”的同学会使用 +new Date()。\n\n现在又想做另一种性能监控的方法，便着重考量了下各种记时方案，尽量减少因为 性能监控代码对业务代码的影响。\n\n下面是循环 100000 次，过程中只有计数器操作，得到的时间(ms)对照表 (Demo)。\n\nBROWSER    NEW DATE()   NEW DATE().GETTIME()   NEW DATE().VALUEOF()   +NEW DATE()   DATE.NOW()\nIE8        469          391                    375                    406           -\nFirefox6   266          258                    257                    259           236\nChrome13   46           29                     29                     35            20\nOpera11    246          242                    246                    244           222\nSafari5    256          232                    239                    255           222\n\n由此可以对照出，Date.now() 确实有很明显的性能优势，另外 Date.now() 返回是 number 类型的数值，并不产生 Date 对象。\n\n不过目前只有 IE9, Firefox3+, Chrome5+, Opera10.50+, Safari4+ 支持，对于不支持 的浏览器，可以继续使用 new\nDate().valueOf() 方法（个人不推荐用 +new Date()）：\n\n\n\n\n日期相关#\n\n\n\n\n参考阅读#\n\n * Date.now Function (JavaScript) - MSDN\n * Data.now() - MDN","routePath":"/blog/post/2011/Date.now","lang":"zh-CN","toc":[{"text":"日期相关","id":"日期相关","depth":2,"charIndex":935},{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":945}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-09-18T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":101,"title":"Abort HTTP 请求","content":" * \n\n\nAbort HTTP 请求#\n\n英文不好，请教个问题：\n\nabort 这个单词，好像有丢弃，中断之类的意思。\n\nAJAX 发一个请求，然后 abort 掉，那么这个请求只是客户端一厢情愿的丢弃， 服务端仍然可以接收到并处理请求呢；还是直接中断这个请求，\n导致服务器端也会丢弃/忽略这个请求？\n\n如果翻译，应该翻成 丢弃 HTTP 请求 还是 中断 HTTP 请求 ？\n\n-- Update --\n\n搜索了一番，跟想象中的一致，只是客户端的一厢情愿，丢弃服务端的返回而已， 并不是服务端丢弃处理请求。\n\n所以应该翻作： 丢弃 。\n\n\n延伸阅读#\n\n * http://weblogs.asp.net/dwahlin/archive/2007/07/17/aborting-ajax-requests.aspx\n * http://stackoverflow.com/questions/446594/kill-ajax-requests-using-javascript\n   -using-jquery\n * http://topic.csdn.net/u/20090206/14/c43249df-29a9-4167-9dc3-e3a8f738248d.html\n * http://book.51cto.com/art/200810/91493.htm\n * @Google+","routePath":"/blog/post/2011/abort-http-request","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":271}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-22T00:00:00.000Z"},"2":{"tags":"Web-Design"}},"version":""},{"id":102,"title":"丢弃图片的 HTTP 请求","content":" * \n\n\n丢弃图片的 HTTP 请求#\n\nOS         BROWSER          \"\"     NULL   REMOVE   DELETE   STOP   STOPIMAGE   STOP   BUTTON   TIMEOUT\nWindows    IE6,7,8          √(e)   √(e)   II       ×        ×      ×           ×      ×        21s (e)\n/          FF4,5            II     II     II       ×        II     ×           ×      II       21s (e)\n/          Chrome12         ×      ×      ×        ×        II     ×           ×      II       21s (e)\n/          Safari4,5        ×      ×      ×        ×        II     ×           ×      II       21s (e)\n/          Opera9           ×      √(e)   ×        ×        II     ×           ×      II       47s (e)\n/          Opera11          II     √(e)   II       II       II     ×           ×      II       47s (e)\nMac OS X   Safari5          ×      ×      ×        ×        II     ×           ×      II       1.2m (e)\n/          Chrome12         ×      ×      ×        ×        II     ×           ×      II       1.2m (e)\n/          FF4,5            II     II     II       ×        II     ×           ×      II       1m'15s (e)\nUbuntu     FF4,5            II     II     II       ×        II     ×           ×               3m'9s (e)\n/          Chrom(e/ium)12   ×      ×      ×        ×        II     ×           ×               3.2m (e)\n\n * Windows XP, Server 2003, 7.\n * Mac OS X 10.6.7\n * Ubuntu 11.04\n\n标题注解：\n\n\n\n图标注解：\n\n\n\n\n事件回调#\n\n\n\n测试结果：\n\n\n\n\nTODO:丢弃 jsonp 请求？#\n\n为什么不是 script/link?\n\n使用 document.createElement(\"script\") 创建元素并设置 src 属性， appendChild 到 DOM\n中会去请求指定资源，可以到底向日志服务器发送数据的要求。\n\n但是使用这种方式有一下几点弊端：\n\n 1. 创建脚本带来的危险性。\n\n 2. 会向 DOM 中附加元素，影响 DOMLint 校验。\n\n 3. 无法 abort，无论设置 script = null;, script.src=\"\";, script.src=null;,\n    script.removeAttribute(\"src\");, document.body.removeChild(script); 都无法实现\n    abort.\n\n 4. 引入资源不触发 onload/onerror/onabort 事件，除非使用 jsonp 的方式， 对元素本身无法得到回调。\n\n\nSee Also#\n\n * http://stackoverflow.com/questions/930237/javascript-cancel-stop-image-reques\n   ts\n * http://www.sysopt.com/forum/archive/index.php/t-177147.html\n * http://stackoverflow.com/questions/1671717/javascript-image-onabort-event-not\n   -firing-in-firefox-chrome\n * http://stackoverflow.com/questions/4506160/abort-active-image-requests\n * http://www.devguru.com/technologies/ecmascript/quickref/image.html\n * Javascript: Cancel/Stop Image Requests\n * Can't you stop images from loading?\n * window.stop()\n   * http://stackoverflow.com/questions/930237/javascript-cancel-stop-image-requ\n     ests\n   * http://stackoverflow.com/questions/3146200/stop-loading-of-images-on-a-hash\n     change-event-via-javascript-or-jquery\n   * https://developer.mozilla.org/en/DOM/window.stop\n * execCommand\n   * execCommand Method\n   * http://msdn.microsoft.com/en-us/library/ms536419%28v=vs.85%29.aspx\n   * http://msdn.microsoft.com/en-us/library/ms533049%28v=vs.85%29.aspx\n   * https://developer.mozilla.org/En/Document.execCommand\n * IE6下链接ONCLICK事件处理中的请求被ABORTED\n * What does (Aborted) mean in HttpWatch? 来源\n * http://blog.httpwatch.com/2007/11/20/error_internet_invalid_url-httpwatch/\n * HttpWatch工具简介及使用技巧","routePath":"/blog/post/2011/abort-image-request","lang":"zh-CN","toc":[{"text":"事件回调","id":"事件回调","depth":2,"charIndex":1352},{"text":"TODO:丢弃 jsonp 请求？","id":"todo丢弃-jsonp-请求","depth":2,"charIndex":1371},{"text":"See Also","id":"see-also","depth":2,"charIndex":1805}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-06-23T00:00:00.000Z"},"2":{"tags":"JavaScript, HTTP"}},"version":""},{"id":103,"title":"说说渐进加载","content":"#\n\n 1. google+, quora, twitter... 这些网站都使用渐进加载数据的方式，\n    类似的还有淘宝图片的懒加载，都是等用户真正滚到最后之后才开始去加载， 提前一些预加载体验不是更好么。\n\n \n\n 2. 到最后一页了还是有“更多”，直到点击最后一个更多没加载到数据才告诉用户 没更多数据了，这不是蛋疼么？\n\n估计是基于算法上的考虑，比如每页 10 条：\n\n\n\n这样要查询 2 次。\n\n不过只查数据库一次也是可以的：\n\n\n\n好久不写后端程序，不知道他们这么做是否有基于其他的考虑？\n\np.s. Google+ 个笨蛋居然剔除行首的有效空白，而不剔除行尾的无效空白。。。\n\n\nSee Also#\n\n * @Google+","routePath":"/blog/post/2011/about-lazy-load","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":298}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-08T00:00:00.000Z"},"2":{"tags":"UED, 算法"}},"version":""},{"id":104,"title":"面积分割算法","content":"#\n\n做用户点击行为分析的展现时，用了一个透明的层覆盖在页面上，然后覆盖一层 canvas 画布，使用稀疏矩阵算法绘制热点分布图。\n\n预蒙上一层透明蒙版，然后只对需要的区域进行绘制热点图，本是非常不错的方案，我 本机上也一直无问题。但是测试提交了一个 bug，说 IE\n下看到点击热点图及轨迹图背后 一片漆黑，我就猜测滤镜问题，最先猜想的是浏览器安全设置导致的滤镜无效，但是又 发现有些类似的图形有没有问题。\n\n结果发现是某些显卡下，IE 中超大面积的区域滤镜会失效。\n\n首先想到的解决办法就是针对 IE 进行切割蒙版，由多个蒙版拼接而成，类似于铺地板。\n\n普通的算法有两种：\n\n 1. 将整块蒙版区域划分成多个 2000*2000 的蒙版，最后一列和最后一行不足指数，取余 设置宽高。\n 2. 将整块蒙版划分成多个不超过 2000*2000 的等份蒙版。这种算法比较简单，稍微的不足 之处在于，不能除断的情况，无法等分。\n\nTODO: 有更灵巧的算法么，当然有了，只是我还不知道而已。\n\n\n后来想到#\n\n用 canvas 绘制一个透明的区域也未尝不可。","routePath":"/blog/post/2011/area-split","lang":"zh-CN","toc":[{"text":"后来想到","id":"后来想到","depth":2,"charIndex":445}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-08-25T00:00:00.000Z"},"2":{"tags":"算法"}},"version":""},{"id":105,"title":"使用 Vimwiki 还是 Jekyll 作为博客系统？","content":"#\n\n一直使用 Vimwiki 作为个人博客系统，今天非常荣幸收到加入 Vim 中文星 的邀请，需要我的提供 RSS/Atom 输出。\n\n但是 Vimwiki 本质上是一个 wiki 系统，通常来说都是（个人推荐）作为平板结构\n来放置信息，较少（但也支持）基于目录，尤其是基于日期时间格式的目录结构来存储 词条（或者说日志），所以要支持基于时间的 RSS/Atom\n就有一定的困难，而且貌似 需求本身也不怎么合理，不过 github 的提交记录里是有 RSS 输出的，虽然作为博客 订阅的意义几近于无。\n\n于是想是否有必要在 Wordpress 上同步更新博客（Blogger 被墙的厉害），但是发现 很久以前（还是在拥有 xianyun.org，并使用\nmail@xianyun.org）注册的 Wordpress， 杯具的忘记密码了，注册的邮箱也不再使用，无法索取找回密码了。\n\n于是想：迁移到 Jekyll 怎么样？\n\n由于 github pages 的缘故，很早就大致了解了下 Jekyll，但是没有深入，一直主观的 认为 Jekyll 会根据模板动态转换\nmarkdown/textile 文件。但是更深入的了解之后 发现，Jekyll 只是一个静态文件转换程序，通过模板引擎将数据（博客日志）和模板 转换成静态\nHTML 文件。\n\n * 支持 markdown, textile 语法。\n * 支持生成 RSS, ATOM。\n * ruby 脚本生成静态文件。\n * 需要将安装 ruby 和 jekyll.\n\n而 Vimwiki 是一个基于 Vim 的 wiki 客户端程序，提供便于管理和使用的本地 wiki 支持。\n\n * 支持 wiki 语法。\n * 不支持生成 RSS, ATOM。\n * Vim script 生成静态文件。\n * 需要安装 Vim, Vimwiki.\n\n我个人目前最简单的需求，就是在 Vimwiki 的基础上实现 RSS 输出的支持。不过完整 、完美意义上来说，我还是希望有这样一个博客系统。\n\n * 支持 wiki, markdown, textile 或其他语法。(Vimwiki, Jekyll)\n * 支持生成 RSS/Atom 输出. (Jekyll)\n * 通过 Vim(script) 或其他易于安装使用的程序，将日志+模板自动生成 HTML 文件。(Vimwiki, Jekyll)\n * 日志原始文件通过 Dropbox 或其他云服务自动同步，无需 push 到 github。(Vimwiki)\n * 只将生成好的静态 HTML 文件 push 到 github。(Vimwiki)\n\n\n延伸阅读#\n\n * 像黑客一样写博客\n * 使用github作为博客引擎\n * 告别wordpress，拥抱jekyll\n * 在heroku上用jekyll做博客\n * 轻量级博客工具: Jekyll vs ToTo\n * 將Wordpress轉移到Jekyll及Disqus","routePath":"/blog/post/2011/blog-system-vimwiki-or-jekyll","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":1125}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-06-19T00:00:00.000Z"},"2":{"tags":"Vim, Blog"}},"version":""},{"id":106,"title":"保持 Chrome 插件的 popup.html 页面的状态","content":"#\n\n * Persistent iframe in background\n * Keep state of browser action\n * How to localStorage properly with one name?\n * Do popup.html and background.html share the same local storage?","routePath":"/blog/post/2011/chrome-extension-keep-popup","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-11-01T00:00:00.000Z"},"2":{"tags":"Chrome, Extension"},"3":{"status":"draft"}},"version":""},{"id":107,"title":"closure-compiler.vim","content":"#\n\nClosureCompiler.vim\n\n\nSee Also#\n\n * Auto compile Javascript with Closure\n * Vim 儲存完 JavaScript 檔案後自動用 yuicompressor\n * Vim function：使用 closure compiler 壓縮 js 文件\n * 在项目中使用Google Closure Compiler\n * Closure Compiler 高级模式及更多思考\n * Closure Compiler vs YUICompressor\n * function to use closure-compiler\n * Closure Compiler\n * closure-compiler online\n * Closure Compiler Documentation","routePath":"/blog/post/2011/closure-compile.vim","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":24}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-05-26T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":108,"title":"Confluence Wiki for Vi","content":"#\n\n.ctags / ctags.cnf\n\n\n\n.vimrc / _vimrc\n\n\n\n这玩意很好使，同样是 .wiki 后缀，可以同时支持 Vimwiki 和 Confluence Wiki。\n\n\nSee Also#\n\n * http://www.vim.org/scripts/script.php?script_id=1994","routePath":"/blog/post/2011/confluencewiki.vim","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":99}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-12-04T00:00:00.000Z"},"2":{"tags":"Vim, Wiki, Confluence"}},"version":""},{"id":109,"title":"日期时间型控件的体验","content":"#\n\n目前支持精确到时分秒输入/选择的日历控件，我总觉得用起来很不爽， 却又想不出更舒适的交互方式。\n\n大家有觉得哪种选择时间（非日期）的方式比较舒服一点的控件么， 或者描述一下自己期望的交互过程也好。\n\n----- Update ----\n\nNote: 我说的是 时间 (时分秒，非 日期 ，年月日 )选择/输入过程， 日期型一般点一下或少量几下就可以完成，基本上是比较自然流畅的一个过程；\n但是输入/选择时间的却是非常不流畅的一个过程。\n\n我只是想体验，或者尝试实现更流畅的时间输入过程， 不是想让推荐某个库的某个控件（这个控件的时间输入过程非常流畅的例外），谢谢。\n\n---- Comment 1 ----\n\nHao zi - 额，我没看错，是时分秒，YUI的链接干扰理解了， 最喜欢的就是能快捷键输入时间了，普通用户应该还是更青睐鼠标。 好多地方用的6:00 am\n6:30am……时间下拉单的形式我觉得不好用， 有的甚至还有6:15am……Google calender一方面可以拉动调整时间段，也不需要精确到秒，\n所以用着还好。时间不是10进制，实际生活中表盘上也还需要三根针才能显示， 设计特别了用户也不好理解，我的展望如图：\n\n\n\n时分使用一个滑动框，秒使用一个滑动框， 时分框移动到PM仍利用AM刻度但背景色改变。\n秒框稍有不同，可只显示部分刻录来避免太密集，滑块拉动到左右边缘时刻录跟着移动。\n\n---- Comment 2 ----\n\n萧星星 - 年月日和时分秒的处理 ： 支持键盘输入和方向增减， 支持鼠标滚轮和点击的增减 ； 滚轮的会是最流畅的， 不过用户需要一个适应过程～\n\n---- Comment 3 ----\n\n黄川 - 用安卓调时间的UI交互，然后鼠标放在上面，用滚轮，我觉得这种方式不错\n\n---- Comment 4 ----\n\n闲耘 - 鼠标滚轮，或者键盘方向键本身是不错的，我很认同。 我主要不满意的地方在于：如果 时间 随同日期的弹出层一起，\n同时需要选择日期和时间时，基本上只能增加一个确定按钮来辅助实现。 现在想想，年历，月历，日历还是和时间部分独立分开的比较合适。\n\n\nSee Also#\n\n * @Google+","routePath":"/blog/post/2011/datatime-picker","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":910}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-20T00:00:00.000Z"},"2":{"tags":"JavaScript, UED"}},"version":""},{"id":110,"title":"别用 try/catch","content":"#\n\n实践证明：#JavaScript 用 try/catch 来忽略未定义的函数调用异常是不明智的， 效能太差了，尤其在 FF 里，还是 typeof 快点。\n\n\nSee Also#\n\n * Demo","routePath":"/blog/post/2011/donot-use-try-catch","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":82}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-05T00:00:00.000Z"},"2":{"tags":"JavaScript"},"3":{"status":"draft"}},"version":""},{"id":111,"title":"豆瓣电台，我忍你很久了！","content":"#\n\n豆瓣电台做的太烂，估计算法是一个有怀旧情节的家伙设计的。\n\n听的越多， +1 的歌曲越多，重复播放的可能性越高， 同一个音乐人的歌曲被重放的可能性也越高，导致每天都在听一些听过 N 遍的歌曲。\n\n我 +1 不过是希望算法通过数据能再了解我一点，用来向我推荐其他类似风格的音乐人/乐曲。\n\n如果只是从我已经 +1 的歌曲中重复播放，我要一个电台干什么？！ 我的播放器就已经做的很好啊，稍笨一点，播放器或音乐文件属性中设置标星等级；\n再笨一点，做一个播放列表，把喜欢的音乐加进去；更笨一点，单曲循环播放好了。\n\n登录了在豆瓣电台标星/删除/下一曲，只因为手贱吗？豆瓣，我忍你很久了。\n\n\nComment#\n\n我情愿去听虽然有主持人在啰嗦或煽情，但重复少得多也不那么乏味的国内无线电台。\n\n另外推荐一个国外无主持人的网络电台，有很多风格的频道（非豆瓣分类方式）， 这个是我最喜欢的 NewAge 风格的，请欣赏\nhttp://www.sky.fm/play/newage\n\n前段时间有被墙或网络很不好才勉强听的豆瓣，今天发现又回来了，谢谢国家。\n\n\nSee Also#\n\n * @Google+","routePath":"/blog/post/2011/douban.fm","lang":"zh-CN","toc":[{"text":"Comment","id":"comment","depth":2,"charIndex":294},{"text":"See Also","id":"see-also","depth":2,"charIndex":474}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-13T00:00:00.000Z"},"2":{"tags":"Music"}},"version":""},{"id":112,"title":"“盗梦空间”","content":"#\n\n前段时间公司发生了好几次盗窃案，虽然很快破案了，但总还是感觉不太安全。 前几天有同事跟我说不要把自己本本放在公司，但是我却不以为然，公司座位那么多，\n而且柜子还锁着，偷到我的位置上的概率没那么高吧！\n\n昨晚做梦，说我心爱的小黑晚上盗了，我悲痛欲绝，无法相信这是真的。\n\n仿佛知道是在夜里做梦似的，或者是因为盗窃案发生在夜里的缘故，我梦里深夜赶到公司， 看到柜子被撬开了，翻乱一地。保安说摄像头有拍下整个过程，然后带我们去监视室。\n\n我们进的应该不是监视室，那种房间我去过，肯定不是。而且我也没有看到录像， 梦里乱七八糟的，盗贼的脸留下了悬念。另外虽然有录像，但是破案又是另外一回事了。\n\n第二天上班，没有电脑，然后师傅天蓬急了，给相关人员（ IT ?） 说好并让我去申请一天小台，但居然又是去的监视室的那个房间。 IT\n给我一台谁谁用过的小白，然后我就出来了。\n\n过了一会儿，我突然想起拿小白的时候仿佛瞟到我的小黑在那监视室的一张很乱的桌子上 放着，我赶紧过去看，果然，是放在那里，我心爱的小黑。\n\n梦里似乎有一个很合理的解释为什么我的小黑在这个房间里，仿佛是已经破案了， “赃物”都放在这里。呃，是这么回事么？可惜我已经记不清了。\n\n\nSee Also#\n\n * @Google+","routePath":"/blog/post/2011/dream-the-thief","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":521}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-06-30T00:00:00.000Z"},"2":{"tags":"Dream"}},"version":""},{"id":113,"title":"获取元素所绑定的事件列表","content":"#\n\n技术上有什么办法获得指定 HTMLElement 上有绑定那些 #JavaScript 函数事件，及其处理函数么？\n\n比如我有一个按钮，想知道他绑定了那些事件？ click 事件的处理函数是什么？\n\nelem.onclick 这种只能绑定唯一的一个事件处理函数，可以直接取到。\n\nDOM Level 3 有\n[http://www.w3.org/TR/2001/WD-DOM-Level-3-Events-20010823/events.html#Events-Eve\nntListenerList eventListenerList] 接口，但是现在还没有浏览器实现。\n\n不过可以通过框架包装的方式获取列表。 另外 Google Chrome 浏览器的开发者工具有提供查看元素绑定了哪些事件的特性， 猜测是通过解析页面及其引入的\nJavaScript 源码得到的 （据我所知，Firebug 的性能分析就是通过 inject 代码到各个函数中来实现的）。\n\n\n延伸阅读#\n\n * http://www.w3.org/TR/2001/WD-DOM-Level-3-Events-20010823/events.html#Events-E\n   ventListenerList\n * http://www.quirksmode.org/js/events_advanced.html","routePath":"/blog/post/2011/eventlistenerlist","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":433}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-08-19T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":114,"title":"深入 hasAttribute","content":"#\n\n众所周知，IE 的 HTMLElement 对象不支持 hasAttribute 方法，于是有了如下实现： 它针对不支持 hasAttribute\n方法的浏览器，检查 getAttribute 得到的是否等于 null， 如果是 null 则表明这个 HTMLElement 不存在指定的\nAttribute。很聪明的一个方法。\n\n\n\n最近写了个原理简单的基于 Select+Input 的可编辑 Combox 控件，用到了这个方法来检查目标 select 对象是否存在如 multiple,\neditable 这样的属性，来实现不同的 Combox 版本。其他 浏览器上跑的很好，但是在 IE6 上却总是被初始化为 multiple\n的实例，很明显，这个 hasAttribute 的实现出问题了。\n\n原来针对 IE6，还有稍多一点的特殊性：\n\n * input.getAttribute(\"checked\") 返回 Boolean 值，true/false；\n   * input[type=checkbox|radio].getAttribute(\"checked\") 根据他的 checked 状态相关；\n   * input[type=others...].getAttribute(\"checked\") 始终返回 false；\n * select.getAttribute(\"multiple\") 返回 Boolean 值；\n * select>option.getAttribute(\"selected\") 返回 Boolean 值。\n\n虽然可以通过 getAttribute(\"checked\") 判断 checkbox/radio 的属性状况，但对于 其他类型的 input\n元素，是无法准确获得 checked 属性的。\n\nTODO:\nchecked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,no\nwrap,readonly,selected\n\n下面是比较完整一点的实现：\n\n\n\n\nUpdate 2011/07/26#\n\n继续发现新坑：IE 中下面的代码\n\n\n\n输出：\n\n\n\n所以上面的 hasAttr 函数是无法正确返回这种在脚本中设置 onclick 值的。\n\n对策：\n\n\n\n\nUpdate 2011/10/26#\n\n继续新坑，IE5,6,7 的 script.getAttribute(\"src\") === \"\"，正常的 DOM 方法已经 阻止不了 IE 了，hack\n方案可以解析 wrapHTML(node){return outerHTML.startTag;}， 判断是否有 src 属性。\n\n如果在这里你真的可以忽略 IE，最佳方案还是屏蔽 IE 吧。","routePath":"/blog/post/2011/hasattribute","lang":"zh-CN","toc":[{"text":"Update 2011/07/26","id":"update-20110726","depth":2,"charIndex":903},{"text":"Update 2011/10/26","id":"update-20111026","depth":2,"charIndex":1003}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-05-19T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":115,"title":"如何取 URL 中第一个单独的问号(?) 位置","content":"#\n\n新版 Arale 通过 nginx 服务支持使用双问号的访问方式：\n\n\n\n访问 https://www.example.com/module.js\n\n通过正则的正向预搜索有办法获得第一个单问号的位置么？\n\n\n\n会匹配双问号的第 2 个问号：\n\n\n\n\n\n目前是通过循环方式计算的，无心比较遍历和正则之间无优劣， 纯粹对于正则的实现很有兴趣 :)\n\n\n答案一：#\n\n\n\n\n答案二：#\n\n上面用了两个相同规则的分组，这里可以减少到一个分组\n\n\n\n但是这种做法对于问号(?)在字符串首尾时没有办法匹配\n\n","routePath":"/blog/post/2011/how-to-get-the-first-single-question-mark","lang":"zh-CN","toc":[{"text":"答案一：","id":"答案一","depth":2,"charIndex":176},{"text":"答案二：","id":"答案二","depth":2,"charIndex":186}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-06-22T00:00:00.000Z"},"2":{"tags":"JavaScript, RegExp"}},"version":""},{"id":116,"title":"计算高度的时机","content":"深入 Iframe 自适应高度#\n\nDOCTYPE(CSS1Compat): HTML5, HTML4.01 Strict, HTML4.01 Transitional, XHTML1.0\nFrameset, XHTML1.0 Strict, XHTML1.0 Transitional, XHTML1.1.\n\nBROWSER   DOCUMENTELEMENT                  BODY           \n          scrollHeight      offsetHeight   scrollHeight   offsetHeight\nIE        √                 ×              √              √\nFF        √                 √              √              √\nChrome    √                 √              √              √\nSafari    √                 √              √              √\nOpera     √                 √              √              √\n\nnon-doctype(BackCompat): 无 DOCTYPE, IE: DOCTYPE 前有非空白字符（包括注释）。\n\nBROWSER      DOCUMENTELEMENT                  BODY           \n             scrollHeight      offsetHeight   scrollHeight   offsetHeight\nIE8          ×                 ×              √              ×\nFF5          √                 √              √              √\nChrome13     √                 √              √              √\nSafari5      √                 √              √              √\nOpera11.50   √                 √              √              ×\n\n测试环境：Windows Server 2003.\n\n综上所述：使用 document.body.scrollHeight 是最合适的。\n\n\n计算高度的时机#\n\n父窗口检测子窗口：\n\n\n\n本窗口自检测：\n\n\n\n\n子窗口获取自身在父窗口的 iframe 元素#\n\n如果父窗口有名字的话，可以直接通过 frames[name] 直接引用。\n\n\n\n\n其他相关#\n\n上面的 getParentFrame 通过窗口名字直接取得元素本身，这里要注意的一点， 以前写代码的时候有这样的代码定义：\n\n\n\n后来要增加一个变量，但是不小心写错标点符号。\n\n\n\n然后 name 就成了全局变量，无意中修改了 window.name 的值。 所以如果使用 name 作为局部变量的时候，千万要小心，否则执行这段代码之后，\na[target=oldName] 的链接会因为找不到 frames[oldName] 而弹出新窗口。\n\n\n延伸阅读#\n\n * 再谈iframe自适应高度\n * 三谈Iframe自适应高度","routePath":"/blog/post/2011/iframe-highly-adaptive","lang":"zh-CN","toc":[{"text":"子窗口获取自身在父窗口的 iframe 元素","id":"子窗口获取自身在父窗口的-iframe-元素","depth":2,"charIndex":1208},{"text":"其他相关","id":"其他相关","depth":2,"charIndex":1274},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":1505}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-08-24T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":117,"title":"JavaScript 异常初步","content":"#\n\n * Error, TypeError, ReferenceError\n * try/catch/finally\n * window.onerror / window.addEventListener(\"error\")\n * on(\"error\") events\n\n--------------------------------------------------------------------------------\n\n异常处理\n\nBROWSER     MESSAGE   DESCRIPTION   LINE   NUMBER   LINENUMBER   NAME   FILENAME   STACK\nIE8         √         √             ×      ×        ×            √      ×          ×\nFirefox 5   √         ×             ×      ×        √            √      √          √\nChrome 12   √         ×             ×      ×        ×            √      ×          √\nSafari 5    √         ×             √      ×        ×            √      ×          ×\nOpera 11    √         ×             ×      ×        ×            √      ×          √\n\n属性描述：\n\nmessage:: {String} 异常消息描述，全部浏览器都支持。 name:: 错误名称，一般等同于错误类型名，如 Error, TypeError,\nReferenceError...。不过实际抛出的同一个错误，不同浏览器的 name 值可能不一致(下面讲述)。 description:: 异常描述，IE\n中同 message，其他浏览器不支持。 line:: 错误行号，仅 Safari 支持。 number:: 错误编号，例如“缺少对象”是\n-2146823281。“xx未定义”是 -2146823279。仅 IE 支持。 lineNumber:: 错误发生所在行号，仅 Firefox 支持。\nfileName:: 发生错误的所在文件地址，仅 Firefox 支持。\n\n构造函数的参数&顺序：\n\n参数        1(个)                      2(个)                      3(个)\nFirefox   Error(message)            Error(message,fileName)   Error(message,fileName,lineNumber)\nIE        Error(<Number> number)    Error(number,message)     >\n/         Error(<String> message)   /                         >\nChrome    Error(message)            >                         >\nSafari    /                         >                         >\nOpera     /                         >                         >\n\nNote: IE, new Error(String message) - <Object,Array,RegExp,...>.toString()\n\nJavaScript 有多种原生异常类型，包括最常见的 Error 和 EvalError, RangeError, ReferenceError,\nSyntaxError, TypeError, URIError. 这些原生异常类型分别对应的 意义是：\n\nError:: 异常的基类。 EvalError:: 发生在 eval() 函数中的异常。 RangeError:: 数值超出 JavaScript\n可表示的范围。 ReferenceError:: 使用了非法的引用。 SyntaxError:: 在 eval()\n中发生了语法错误的异常。除此之外的语法错误异常，均无法通过 try/catch 和 onerror 捕获，这类异常会直接报告给浏览器。 TypeError::\n变量类型不是预期的。 URIError:: 在 encodeURI() 和 decodeURI() 函数中发生异常。\n\nTODO: 每种异常类型都带有以下成员/方法。 message:: line::\n\n值得注意的是，直接掷出 Error 之外的其他原生异常（如 throw new EvalError(\"msg\")） 时，IE\n浏览器是无法捕获异常消息的，统一的异常消息是“例外被抛出且未被接住”。\n\n而在 try{}catch(ex){} 中可以拿到更详细的异常信息。\n\nJavaScript 也可以掷出其他类型的异常，如 throw \"xx error.\"\n\n\n捕获异常#\n\n推荐的异常捕获方法是 try/catch，不过也可以简单使用全局异常捕获方式：\n\n\n\nwindow.onerror 事件可以捕获浏览器端掷出的所有异常，并可以拿到错误消息，所在文件， 及错误所在行。但是无法获得异常对象本身，及触发异常的事件对象。\n\n注意：onerror 事件不在早期的 HTML4 规范中，只有 IE, Firefox 和后续的 Chrome 才有 支持，Safari, Opera\n至今没有支持这个事件。\n\n一般来说，绑定事件(addEventListener/attachEvent)的方式比给 HTML DOM 元素直接连接事件处理函数的方式要好。\n\n但是为 window 绑定 error 事件却似乎不太理想。 IE 浏览器能得到 4 个参数（比 onerror 多一个），但有效的还是前面 3 个（跟\nonerror 一致）。 而其他浏览器却只能得到一个参数，即错误事件（FF 得到的是 Error，Chrome 得到的 ErrorEvent。\n\n题外话，对于 HTML 元素的 onerror 事件一般会触发在加载外部资源时。\n\n\n无法捕获的异常#\n\n如果 onerror 所在 <script> 块本身有语法错误，会导致 onerror 错误处理脚本本身无法 被执行，也就无法初始化全局异常处理函数。\n\n或者异常发生在初始化全局异常处理函数之前，这个异常也无法被全局处理函数捕获。\n\n\n延伸阅读#\n\n * Error - MDC Doc Center\n * window.onerror - MDC Doc Center\n * onerror Event\n * The onerror event of the window object 2 3 4\n * TypeError\n * js判断错误类型\n * 解析IE浏览器中的Javascript Error对象\n * DamnIT\n * ExceptionHub","routePath":"/blog/post/2011/javascript-exceptions","lang":"zh-CN","toc":[{"text":"捕获异常","id":"捕获异常","depth":2,"charIndex":2289},{"text":"无法捕获的异常","id":"无法捕获的异常","depth":2,"charIndex":2777},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":2905}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-04-03T00:00:00.000Z"},"2":{"tags":"JavaScript, Exceptions"}},"version":""},{"id":118,"title":"说说支付宝爱心捐助","content":"#\n\n以前我还持续捐助，但是我觉得支付宝爱心捐助 我是越来越没法持续捐助下去了，那该死的 KPI 要求项目达到 XX 数量， 狗日的又没有质量要求。\n\n每天救救这个，帮帮那个，都是一些实体的捐助对象，看这很痛心，但排成一排来展览， 看着就有点恶心了，让人看不下去，吃不下饭。\n\n我知道国内 NGO 很难，靠谱的也不多。但是我还是希望相对靠谱一点的机构 （下面都简称慈善机构，支付宝本身不是也有爱心小组么，虽然好像都是业余的）\n来做这些实体的捐助过程，安排捐助计划，定时公开捐助报表， 普通捐助人只需要持续对这个机构捐助就好了。\n\n像对一个人、或一个家庭这么小的单位，慈善机构自己可以自己列为项目，计划支出， 但捐助人真的无需去直接接触。你说我捐助了某个病人A，不去捐助另一个病人B吗？\n世界上困难的人这么多，每个捐助人都需要一个个去直接指定捐助么？ 这种事情慈善机构能有一点自己的计划么，该不该捐助，该如何捐助，\n你慈善机构没有计划，你还让捐助人信任你什么？！\n\n而对于重大集体性灾难，可以在爱心捐助平台上展示一个项目，让更多的人知晓， 传播给更多的人来支持捐助，而且一般这种项目，捐助人是很希望可以指定捐助的，\n比如上次日本地震+海啸+核污染，中国大陆居然没有可靠方便的捐助方式，简直是匪夷所思。\n\n最后给大家献给一曲《无地自容》\n\n> 策划：雅沫 导演：莞儿 曲：李丹 词：刘咚咚 唱：@土著Walker 美眉她姓郭，爱炫自我； 各种名包，各种好车； 微博经认证，名头热火；\n> 红十字会商业老总； 是否涉嫌炒作，你最清楚； 妹子到底想要揭露什么？ 何必东藏西躲，又何必删贴； 迟早有一天你会面对我； 天灾人祸中，常看到你；\n> 宣扬博爱，弘扬道义； 捐款全给你，进出无明细； 庞大帐目谁在审计； 总在自说自话，难自圆其说； 百姓问你到底做了什么？ 不要再装沉默，你实话实说；\n> 我们的爱心多少被挥霍； 商红会无车，清贫如洗； 没有电脑没有手续； 成立十几年，从不会登记； 中红博爱惹人注意； 总在自说自话，难自圆其说；\n> 百姓问你到底做了什么？ 不要再装沉默，你实话实说； 我们的爱心多少被挥霍； 不再相信，相信什么公益； 除非捐款公布明细； 这场危机，怎样才能过去；\n> 不必追究是谁的错； 我曾为你献血，也曾替你开脱； 如今献唱一曲，让你无地自容！\n\n\nSee Also#\n\n * @Google+","routePath":"/blog/post/2011/love.alipay.com","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":983}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-04T00:00:00.000Z"}},"version":""},{"id":119,"title":"鼠标事件研究(Mouse Event)","content":"#\n\n| Event | type | IE | > | FF | > | Chrome | > | Safari | > | Opera | > |\n\n/             /        BUTTON     WHICH       BUTTON   WHICH   BUTTON     WHICH   BUTTON     WHICH   BUTTON     WHICH\nonmousedown   left     1          undefined   0        1       0          1       0          1       0          1\n/             middle   4          undefined   1        2       1          2       1          2       1          2\n/             right    2          undefined   2        3       2          3       2          3       2          3\nonmouseup     left     1          undefined   0        1       0          1       0          1       0          1\n/             middle   4          undefined   1        2       1          2       1          2       no event   >\n/             right    2          undefined   2        3       2          3       2          3       2          3\nonclick       left     0          undefined   0        1       0          1       0          1       0          1\n/             middle   0          undefined   1        2       1          2       1          2       no event   >\n/             right    no event   >           2        3       no event   >       no event   >       no event   >\n\nWindows 2003 Server. IE8, FF5, Chrome12, Safari5, Opera11.\n\nNote:\n\n * document.onmousedown === document.addEventListener ===\n   document.attachEvent(\"onmousedown\")\n * document.onmouseup === document.addEventListener(\"mouseup\") ==\n   document.attachEvent(\"onmouseup\")\n * document.onclick === document.addEventListener(\"click\") ==\n   document.attachEvent(\"onclick\")\n\n\n\n\nSee Also#\n\n * Event properties - ppk\n * Demo","routePath":"/blog/post/2011/mouse-event","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":1589}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-16T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":120,"title":"非递归遍历 DOM 结构","content":"#\n\n上次在Google+ 上说 实现了非递归遍历 DOM 结构， 有朋友想让分享，我当然很高兴，但是很遗憾这本身没有什么值得分享的，大致如下， 给大家随便看一下：\n\n常见的递归方式遍历方式，下面是 Douglas Crockford 写的递归实现：\n\n\n\n然后有人自称写出了更快的遍历 DOM 方式。\n\n\n\n最初找到有详细对照的文章地址没有找到，这个是 类似的一篇， 而且也是非递归式的。\n\n确实是很快的，但只是快还是不够的，这个实现有很多弊端：\n\n 1. 注释等元素未必会被遍历。\n 2. 树形数据结构被整理成了平板结构，无法实现遍历过程的 in/out 处理。\n\n然后今天的主角隆重登场：\n\n\n\n上面只是一个精简版，实际过程中还需要考虑节点类型的问题，一般会过滤 1:HTMLElement, 8:Comment, 9:Document Type,\n10:DocType 之外的节点。\n\n其实也不过如此嘛，飘过~~\n\n\nSee Also#\n\n * W3C DOM -Introduction - ppk","routePath":"/blog/post/2011/non-recursion-walk-the-dom","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":412}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-10T00:00:00.000Z"},"2":{"tags":"JavaScript, 算法"}},"version":""},{"id":121,"title":"多种不同结果的返回模式","content":"#\n\n探讨个问题哈，我现在再做一个 HTML 校验工具，先将 HMTL 源码解析成 DOM 树，\n其间可能遇到语法错误，为了发现更多的错误，会跳到下一个分界点继续解析； 然后将解析得到的 DOM 树返回给 lint 工具继续进行进一步的语法、语义解析。\n其过程是：\n\n\n\n最终需要将 parse 和 lint 的错误收集到一起反馈给服务端。\n\n请问，parse 有什么好的方式来返回解析时错误信息？\n\n之前先是将 parse 设计成了函数式，但是我觉得下面这种返回方式很不好：\n\n\n\n\n另外一种思路#\n\nHTMLParser 设计成独立的类（而不是上面的函数方式）\n\n\n\n貌似这种方式比上面的稍好一点，不过我又不想为此将原本很简单的函数式改成 对象式。\n\n\n外部数据存储#\n\n\n\n对于只有一个实例（或运行一次）的情况，第三方独立的 console 是合适的。 但是一旦需要多个实例（或运行多次，每次Parse的结果都各自独立，\n每个html的parse和lint的错误结果各自拼接一起，但是不是所有的html的parse+lint错误结果拼接在一起）\n的情况，还是将解析异常信息和解析器本身绑定在一起（比如类）的方式比较合适。\n\n上面的文字有点绕，表达式：\n\n\n\nerr0 和 err1 是各自独立的，实例化多个第三方独立的有专用的Console，不如用类的方式好了。\n\n\n寻求指教#\n\n对于这种需要返回多种不同数据的函数式， 如果你有其他的方案，欢迎回帖、回邮，或回博交流指导 ：）\n\n\n更新 (2013)#\n\n事件机制可能是最好的选择：\n\n","routePath":"/blog/post/2011/parser-return-pattern","lang":"zh-CN","toc":[{"text":"另外一种思路","id":"另外一种思路","depth":2,"charIndex":242},{"text":"外部数据存储","id":"外部数据存储","depth":2,"charIndex":328},{"text":"寻求指教","id":"寻求指教","depth":2,"charIndex":586},{"text":"更新 (2013)","id":"更新-2013","depth":2,"charIndex":644}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-06-08T00:00:00.000Z"},"2":{"tags":"设计模式"}},"version":""},{"id":122,"title":"计算主域名","content":"#\n\n","routePath":"/blog/post/2011/primary-domain","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-12-13T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":123,"title":"智能同步滚动条","content":"#\n\nBROWSER   DOCUMENTELEMENT.SCROLLTOP   BODY.SCROLLTOP\nIE        √                           ×\nFirefox   √                           ×\nChrome    ×                           √\nSafari    ×                           √\nOpera     √                           ×\n\nTODO: 其他的 get 方式。尝试智能判断是否设置成功，非通过浏览器性别判断。","routePath":"/blog/post/2011/smart-sync-scroll","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-09-01T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":124,"title":"文本宽度 及 文本框滚动偏移量(scrollLeft)","content":"#\n\n\n背景#\n\n最近将多标签输入框进行修改，把原来随光标(caret)移动的自动建议浮动条改为根据当前标签相对左对齐。\n\nhttp://1.bp.blogspot.com/_POl6bUDELqY/SRQ_xx7LXCI/AAAAAAAAFSw/syXjnAQ-RLI/s320/t\nags.jpg\n\n解决方法很简单，计算当前标签前的文本宽度(将需要计算的文本转义后放入一个各字体样式与目标输入框相同的容器，\n如span中，span.offsetWidth即是文本的宽度。注意：文本框中，中文半角空格的宽度和英文半角空格的宽度显示为不同，\n虽然这两个空格本质上相同)，浮动条根据该值定位即可。\n\n\n问题#\n\n当标签文本过长，超出文本框宽度时，标签文本会向左滚动，但是此时当前标签前面的文本宽度不变， 定位浮动条时需要减去文本向左滚动的尺寸。\n\n网页文档对象中，元素都有一个可读写的scrollLeft属性，表示元素内容相当元素容器向左移动的偏移量。\n\n但是 Firefox 和 Opera 有一些例外，如文本框的 scrollLeft 始终为 0，\n[https://developer.mozilla.org/En/DOM/Element.scrollLeft Mozilla] 的描述是：\n\n> If the element can't be scrolled (e.g. it has no overflow), scrollLeft is set\n> to 0.\n\n对于一些不可滚动(scroll，即没有溢出)的元素，scrollLeft始终为0。而单行文本框 （在Gecko引擎看来）是不可滚动的，即使将样式指定为\noverflow:scroll （IE会出现水平和垂直滚动条这样的怪胎）。\n\n虽说单行文本框是不应该出现滚动条这样怪异的形态，但是这不表示它是不可滚动的，\n当文本宽度大于文本框宽度时，（为了将光标caret显示在文本框可见区域）文本势必向左滚动，如图：\n\n\n\n\n解决办法#\n\n对于文本框不支持scrollLeft的浏览器，一个临时的解决办法是，在文本宽度大于文本框宽度时，\n浮动条定位在相对文本框后端若干像素（便于输入）的位置，在增量输入时，体验不是太差， 但是在光标向前移动使文本向右滚动时，就会出现偏差。\n\n最终解决办法是期待浏览器能够得到正确的scrollLeft值，或者其他巧妙的计算方法。","routePath":"/blog/post/2011/text-width-and-input-scrollleft","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"问题","id":"问题","depth":2,"charIndex":299},{"text":"解决办法","id":"解决办法","depth":2,"charIndex":844}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-11-07T00:00:00.000Z"},"2":{"tags":"Web-Design"}},"version":""},{"id":125,"title":"JavaScript 分时加载","content":"#\n\n使用原始数据（非副本）和索引访问（非shift()），在IE中性能大幅度提高， 其他浏览器对 concat()，尤其是 shift()\n方法进行了优化，性能差别不大。\n\n分时算法对于需要及时更新 UI 的情况非常有效，但是实际上分时算法性能非常不好 （当然分时算法追求的不是这个），不适合作为巨量数据的实时处理。\n\n譬如说在树形控件中，原始数据提供了一个巨大的数组数据：\n\n\n\n我的处理方式是先将这份数据遍历一次，用 HashMap 进行缓存索引，便于后续的操作\n更加快捷。但是这个遍历本身是非常耗时的，虽然它不产生界面变化，但同样会将页面 卡死。为了提高界面响应速度，我们会想到使用分时计算方式，不过这种方式会延长\n缓存索引的过程变的更久，导致后续创建节点的操作无法及时执行，也就无法更新界面， 界面虽然可以操作，但是没什么可操作的（对于以树本身为主的页面来说）。\n\n后来的做法是，根据树的实时装载能力（目前是十万个节点。经过缓存索引的数据， 跟节点层级深度无关）和实际应用作出判断，对于在超出浏览器处理能力的，使用异步\n装载方式；处理能力以内的，不做要求。\n\n\n延伸阅读#\n\n 1. http://lifesinger.googlecode.com/svn/trunk/lab/2009/array-processing.html\n 2. 【优化】分时加载 - Cauma\n 3. http://www.nczonline.net/blog/2009/08/11/timed-array-processing-in-javascrip\n    t/","routePath":"/blog/post/2011/timed-array-processing","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":485}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-03-01T00:00:00.000Z"},"2":{"tags":"JavaScript, UED"}},"version":""},{"id":126,"title":"树形控件的分时装载","content":"#\n\n异步装载树形控件节点的时机：\n\n 1. 传统方式是展开节点时再装载子节点；\n 2. 预装载子节点（即展开节点时，预装载到孙级节点。 任何可见的节点，如果有子节点，则其子节点不是已经装载好，就是在装载的网路上）。","routePath":"/blog/post/2011/timed-tree-processing","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-03-01T00:00:00.000Z"},"2":{"tags":"JavaScript, UED"}},"version":""},{"id":127,"title":"吐槽","content":"#\n\n上次监控系统计算得分有些非常离谱的结果，然后我就质疑后端的算法， 结果师傅兼小组长突然莫名其妙的说我“怎么老是怀疑别人，我最看不惯这种人了，\n我们是一个开发团队，巴拉巴拉巴拉，，，”。\n\n当时我特无语~~ 只很愤怒的说了一句，“这个明显有问题，为什么还不能质疑！”\n\n 1. 第一，我只是对事不对人的质疑算法，并没有怀疑某个人。\n 2. 第二，其实组长本身貌似对我也很不放心，老怀疑我这个，质疑我那个， 有一些简洁清晰到不可能有问题的代码，还是要我去做各种检验。\n    我一直都没有什么二话去执行的，直到他连续 N 遍说到我烦为止。\n\n自己老怀疑他人，还说最讨厌其他人的怀疑态度的，其实也没什么了， 都这样，人性的双重性格而已。\n\n之前有几次组长来质疑我同一个问题，今天又来了，说我检测到的脚本错误， 前端开发很多都不承认，说他们不能重现，认为不准。说我虽然发现了他们的问题，\n但是他们不愿意、或者没有办法去改，问我怎么办？！这是什么逻辑。\n\n有不能解决的问题也不多搜索，也不群里问，说我的不准也没见来找我辩驳， 一口咬定我的不准，不承认我的工作，这算什么。\n\n然后说让我找一个报的次数最多的错误实例，说让我重现，那个错误是“错误的数量词”， 我去，这个我在常见脚本错误文档里写了那么多都白写的么！\n\n这是一个表单验证函数中使用 new RegExp(str) 导致的错误，str 是来自用户的输入，\n却没有经过转义处理，代码级可以肉眼看出来的错误，说让我那边表单实际试试嘛， 那个表单要邮箱验证，还要好几步才能进去呢。我蛋疼么。\n\n给了个最简单的 new RegExp(\"+\") 还是说让我去表单上试。说“不拿出实际例子出来， 没有资格说别人有问题！”\n\n究竟要多无语，才能说明我无语啊~~~\n\n怒道：有些问题看代码就有明显的问题，根本就无需睁着眼睛瞎测试。 昨天看到热点分布那里使用 evt.clientY 这样的代码，还需要去试一下么，\n难道还需要我去告诉开发你应该滚动下浏览器的滚动条来重现？\n\n终于迎来了艰难的沉默。\n\n\nSee Also#\n\n * @Google+","routePath":"/blog/post/2011/tucao","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":869}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-15T00:00:00.000Z"}},"version":""},{"id":128,"title":"Vim 神技","content":"#\n\n\n\n\nSee Also#\n\n 1. Vim 神技@slideshare","routePath":"/blog/post/2011/vim-share-2011","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":5}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-04-11T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":129,"title":"【结束】~~趣味 Vim Tee~~","content":"【结束】趣味 Vim Tee#\n\n去年 [[vim73-tee|【已结束】团购庆祝 Vim 7.3 正式发布的 Tee]] 真是热闹的说，今年刚入夏， 就有 Vim 爱好者提出团购 Tee\n的事了，我本来没准备印 Vim 的 Tee 的，倒是刚印了 2 件“连接被重置”和“连接超时”的 Tee。\n\n偶然又看到这副 Emacs 警追杀 Vim 匪 的漫画，可惜原图太小了。\n\n\n\nVim Talk 群里的“猫猫虫”同学非常给力的描了副大图，几经处理之后，我们终于 有了可以 印刷在 Tee 的创意 了。啊哈，这幅漫画我最爱了。\n\n跟商家初步聊了下，去年 60 多件每件 25 块，今年即使有这么多数量，最便宜也只能到 33 块了（哦，我的口袋，有 33\n块）。现在数量还没确定，而且这次不像去年那么热烈了， 估计人数会少很多。\n\n\n\n如果你也想印一件或者几件，请发邮件一下信息至 hotoo.cn+VimTee[AT]gmail.com ， 请将 [AT] 替换成 @，其他保持不变。\n\n\n\nGmail 最近很难连接上，尤其在公司，只能晚上回家整理订单了 抱歉。\n\n报名 ~还是像去年一样，截至这周末（2011/05/29） 吧~ 截至下周一(2011/05/30)，\n过期自己想印的可以单印，给商家打出我们的旗号，再好好商量，应该有折扣的 ：）\n\n我并非托，不收分毫中介费或者中间利润。如果你不信任的话可以自行拿图去印刷， 版权免费（如果猫猫虫同意的话）。\n\n\n流程#\n\n 1. 网友邮件详细信息给闲耘。\n 2. 闲耘收集统计信息，查漏补缺与确认。\n 3. 闲耘下订单。\n 4. 店家印制 Tee 并发货。\n 5. 闲耘得到快递单号，通知各位团友。\n 6. 团友收到 Tee 之后邮件通知闲耘，并（支付宝/银行）转账给闲耘。\n\n会有快递单号的，到时候我会一一发给各位的。33不是最终价格，看我们最终定的数量，我尽量争取更实惠的价格。邮费是另算的，如果同城其实可以考虑合寄，还可以顺便线下认\n识下。货款我是下单的时候统一给卖家的，到时候大家收到Tee之前/之后支付宝/银行转账都可以。\n\n * @NIX\n * fanke.im\n * @yyfrankyy\n\n\n延伸阅读#\n\n * 去年的贴","routePath":"/blog/post/2011/vim-tee-2","lang":"zh-CN","toc":[{"text":"流程","id":"流程","depth":2,"charIndex":631},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":929}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-05-26T00:00:00.000Z"},"2":{"tags":"VimTee"}},"version":""},{"id":130,"title":"宏伟的 Vimlike.js 计划","content":"#\n\n一直在想：网站本身提供的快捷键支持（如 Gmail, GReader, Gplus, Twitter），\n和浏览器插件提供的通用快捷键支持（Vimperator, Vimium, ...），两者如何共存， 相互之间能够相安无事，甚至能够相辅相成？\n\n目前想到两种方案：\n\n 1. 白名单机制。像 AutoProxy 一样，针对不同的网站/网址，屏蔽某些键映射， 使用官方自有映射支持。不过这个要维护这份列表也是一件蛋疼的事。\n 2. 网站根据统一约定的快捷键定义接口实现特有功能，非特有的则默认使用共有实现。\n    另外也提供扩展机制，让第三方插件也可以根据这个接口为特定的网站/页面实现特定功能。\n\n个人觉得第 2 中方案比较好，但这是一项宏大的项目，要各个网站遵循这个接口标准来实现， 不是一件易事。准备先把这个做到\n[https://github.com/hotoo/vimlike.js Vimlike.js] 项目里， 然后请一些 Vim 爱好者的个人博客一起来参与实践。","routePath":"/blog/post/2011/vimlike-project","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-08-16T00:00:00.000Z"},"2":{"tags":"JavaScript, Vim"}},"version":""},{"id":131,"title":"Vimlike.js","content":"#\n\n很久之前做了一个 Vimlike 的 HTML(5) Slide， 很小的一个玩意，但是很好玩。里面支持 normal, search, command,\nhelp 等模式， 最初是每个单独自己 Copy 的一份，然后精简成各个模式自己需要的键映射。\n\n一直想把这个 Vimlike 的键映射部分抽象提取处理，前段时间 Google+ 出来的时候， 看到 mattn 做的一个用来 支持 +, c, s ...\n等快捷键的 user-script， 我就立即提议实现 gg, G, gh, gp, gP 这些键盘映射，并把这个 Vimlike 键映射抽取好了。\n\n抽取的过程基本还顺利，只遇到一点点小问题，另外还做了些优化。\n\n之前为了避免无映射的键 push 到 history 中造成无法正确触发键映射的问题 （比如只映射了 <Esc> 键，其他的 abc 之类的键会 push 到\nhistroy 中， 尝试对应的映射是找不到的，后续的键就无法触发了），采用优先触发当前键事件的方式。\n\n仔细想了想，优先考虑当前 key 是不合理的，比如同时映射了 j 和 gj， 由于优先原则的干扰，造成 gj 永远都不会被触发。\n\n接着以为针对 <Esc>, <CR>, <Tab> 等键特殊处理，遇到这种键直接触发， 不放到 history 中就差不多可以了。\n\n继续深入思考，仍然不够，其实完整的 Vim-like 如果要支持 mark, g+, z+, +, 等一系列的扩展支持，都需要有内置支持，否则就是需要类似\nmap(\"m[a-zA-Z0-9]\", function(){}) 这样的模糊映射支持了。\n\n实现增强版的内置扩展键支持，还是实现模糊映射支持，这是个问题？\n\n\nSee Also#\n\n * Vimlike.js@github, Demo","routePath":"/blog/post/2011/vimlike.js","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":741}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-07-08T00:00:00.000Z"},"2":{"tags":"JavaScript, Vim"}},"version":""},{"id":132,"title":"window.close()","content":"#\n\n\n\nonclick return false;\n\nIE5.5以下\n\n\n\n\n延伸阅读#\n\n * window.close\n * Using the window.close method\n * window close\n * window.opener=null;window.close()，只支持IE6不支持IE7,IE8的问题\n * 怎么去掉使用window.close()时弹出的提示框？（不用按钮）\n * window.close关闭窗口，不弹出系统提示，直接关闭","routePath":"/blog/post/2011/window.close","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":39}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2011-04-26T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":133,"title":"千里走单骑","content":"#\n\n今天和 5 个同事一起从公司出发，骑车去径山寺。\n\n\n路线&定位#\n\n * Google Maps for iPhone. 可以自动搜索匹配路线，参考价值还是很高的。\n * Google Maps 手机 Web 版(iPhone) 这个不错，支持 My Places。就是每次动作都可能下载数据会比较费流量，体验也相对下降。\n * My Maps Editor 支持 Google Maps My Places，但是对于用 Google Maps 自动搜索到的路线，保存到 My\n   Places 的数据，这个支持还不行，会被拉成直线。\n * My Place for Google Maps 这个就垃圾了，纯粹骗钱偷窃的货，又不要脸又没种。\n\n\n参考#\n\n * 中国陆路边境口岸列表\n * 杭州及周边骑行路线集\n * 余杭径山寺","routePath":"/blog/post/2012/bicycle-travel","lang":"zh-CN","toc":[{"text":"路线&定位","id":"路线定位","depth":2,"charIndex":29},{"text":"参考","id":"参考","depth":2,"charIndex":327}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2012-04-02T00:00:00.000Z"},"2":{"tags":"自由的骑行"}},"version":""},{"id":134,"title":"『逻辑与』是个好东西","content":"#\n\n一直很想实现 WebForms2 的语义化表单验证，最近才开始动手，执行力真差啊。\n\n一个表单元素可以同时存在多种校验方案，比如：\n\n * required.\n * data type: number, date, url, email...\n * minlength, maxlength, min, max.\n * pattern\n * 用户自定义验证函数。\n * 异步访问服务器进行业务校验。\n\n通常可以通过逻辑判断进行处理：\n\n\n\n实际代码中，各个 verifyXXX 函数可能内联在 verifyFormInput 函数中， 代码显得多而有点乱，甚至有点冗余。\n\n想起模拟电路课程上学到的『与门』，只有所有电路都是通路时，整个电路才是通路。\n\n而表单验证也是这样：\n\n * 某个表单元素的所有验证逻辑都通过验证时，这个表单元素才算通过验证。\n * 整个表单的所有表单元素都通过验证时，才算这个表单通过验证。\n\n同时基于『逻辑与』表达式的语言特性，一旦前面的条件可以判断逻辑失败，立即返回 失败，不再进行后面的条件判断。\n\nLogicalANDExpression:\n\n> Semantics\n> \n> The production LogicalANDExpression : LogicalANDExpression &&\n> BitwiseORExpression is evaluated as follows:\n> \n>  1. Evaluate LogicalANDExpression.\n>  2. Call GetValue(Result(1)).\n>  3. Call ToBoolean(Result(2)).\n>  4. If Result(3) is false, return Result(2).\n>  5. Evaluate BitwiseORExpression.\n>  6. Call GetValue(Result(5)).\n>  7. Return Result(6).\n\nBitwiseORExpression:\n\n> Semantics\n> \n> The production A : A@B, where @ is one of the bitwise operators in the\n> productions above, is evaluated as follows:\n> \n>  1. Evaluate A.\n>  2. Call GetValue(Result(1)).\n>  3. Evaluate B.\n>  4. Call GetValue(Result(3)).\n>  5. Call ToInt32(Result(2)).\n>  6. Call ToInt32(Result(4)).\n>  7. Apply the bitwise operator @ to Result(5) and Result(6). The result is a\n>     signed 32 bit integer.\n>  8. Return Result(7).\n\n于是验证算法改良如下：\n\n\n\n\n延伸#\n\n以前也 Hack 的用过逻辑与表达式，比如：\n\n\n\n但这个用法只是用到了条件判断的作用，类似于：\n\n\n\n\n参考阅读#\n\n * ECMAScript\n * 逻辑与 Logical_conjunction\n * 与门 AND_gate","routePath":"/blog/post/2012/logical-conjunction","lang":"zh-CN","toc":[{"text":"延伸","id":"延伸","depth":2,"charIndex":1332},{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":1390}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2012-05-01T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":135,"title":"使用 MacVim 做 svn diff","content":"#\n\n\n对于终端的 vim#\n\n 1. ~/.subversion/config\n    \n    \n\n \n\n 2. 将下面的代码保存为 svndiff：\n    \n    \n\n 3. 拷贝到 /usr/local/bin/svndiff 并设置权限：\n    \n    \n\n\n对于 MacVim#\n\n修改 /usr/local/bin/svndiff 内容如下：\n\n\n\n之前尝试过修改终端方案中的\n\n\n\n为：\n\n\n\n未遂，右侧的代码会为空。\n\n\nSee Also#\n\n * svn diffの結果をMacVimで。\n   * diffwrap.sh","routePath":"/blog/post/2012/macvim-svndiff","lang":"zh-CN","toc":[{"text":"对于终端的 vim","id":"对于终端的-vim","depth":2,"charIndex":3},{"text":"对于 MacVim","id":"对于-macvim","depth":2,"charIndex":138},{"text":"See Also","id":"see-also","depth":2,"charIndex":223}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2012-10-31T00:00:00.000Z"},"2":{"tags":"MacVim, Vim, SVN"}},"version":""},{"id":136,"title":"在 Vim 上安装使用 Tagbar","content":"#\n\n\n\n会提示将 NODE_PATH 加入到环境变量 ~/.bash_profile ：\n\n\n\n\nSee Also#\n\n * Tagbar\n * Support for additional filetypes\n * Vim学习 Jsctags\n * Doctor.js - jsctags.\n * .ctags\n * Awesome vim support for javascript with jsctags and taglist-plus\n * 更好的用vim浏览Javascript代码","routePath":"/blog/post/2012/vim-install-tagbar","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":49}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2012-10-28T00:00:00.000Z"},"2":{"tags":"Vim"}},"version":""},{"id":137,"title":"杭州萧山无人村骑行","content":"#\n\n从驴友哪里知道杭州附近有个无人村，网上看了帖子盘山公路很风景都很吸引人， 但是地图山就是搜索不到在哪里，后来才知道地图上是狮山村，大概是后来没有人住了\n才被大家称为无人村的。\n\n骑行路线：\n\nhttps://ditu.google.com/maps/ms?msa=0&msid=201867621321994349317.0004ccf3731b6db\n4167b5&brcurrent=3,0x344bb629439aaa99:0xa7bfd183824de83a,0%3B5,0,0&ie=UTF8&t=h&l\nl=30.123883,120.152439&spn=0.296055,0.075098&output=embed\n\n\n\n其他同学都有事没能一起，只有一个测试好基友 @peacefulgoose 一起。","routePath":"/blog/post/2012/wurencun","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2012-10-27T00:00:00.000Z"},"2":{"tags":"自由的骑行"}},"version":""},{"id":138,"title":"JavaScript 异常回顾 之支付宝 2013年双 11大促","content":"#\n\n天猫在今年双十一大放异彩，日交易额达 350亿元人民币之多。支付宝作为天猫购物中 最重要的支付渠道，同样也毫不逊色。\n\n\n准备工作#\n\n往年像用于行为监控、前端异常监控这种辅助性的数据，在大促当天、甚至是封网之前 就被关闭掉，以避免监控服务压力过大对大促造成影响。尤其是前端监控，往年处于僵死\n状态，更是无人关心。\n\n为了验证系统的负载能力，我提前申请了一台压测服务器，测试验证了前端监控单台服务 可以处理至少 1500 QPS 的并发。\n\n\n大促当天#\n\n双 11当天我没有在淘宝城现场，但我\n\n\n后记#\n\n今年有幸重新设计开发了支付宝前端监控系统，整个系统包含前端相关的多种异常监控， 其中最重要的 JavaScript 异常监控部分，更是放了不少异彩。\n\n眼看前端地位在支付宝的没落，前端在支付宝消亡也是指日可待。今年的双 11 也许是 前端监控在支付宝的巅峰了，特此纪念。","routePath":"/blog/post/2013/20131111-alipay-javascript-exceptions-review","lang":"zh-CN","toc":[{"text":"准备工作","id":"准备工作","depth":2,"charIndex":63},{"text":"大促当天","id":"大促当天","depth":2,"charIndex":224},{"text":"后记","id":"后记","depth":2,"charIndex":252}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-11-17T00:00:00.000Z"},"2":{"tags":"JavaScript, Exceptions"},"3":{"status":"draft"}},"version":""},{"id":139,"title":"就近原则：JavaScript 块级作用域的变量定义","content":"#\n\n> 代码是写给人看的，顺便给机器执行。[1]\n\n\n引子#\n\n上周有位前端同学周报里分享了段 for 循环的『好代码』：\n\n\n\n这位同学是看了 jQuery 里类似下面这种用法之后做的这个分享：\n\n\n\njQuery 还有不少地方使用这种用法，也有不少地方是传统的使用 length 方法。 但是 jQuery 这样用有其特定场景，需要正视。我回复说：\n\n 1. 如果数组项中有 0, false, null, undefined, \"\"，代码就出 bug 了。\n 2. 好像没看到少了变量，一定要少的话，典型的 for 写法也可以少（但是不推荐）。\n 3. 代码是写给人读的，顺便给机器执行。\n 4. 另外，对 list 本身有操作，尤其是长度有影响的操作要特别注意。\n\n我个人推荐下面这种写法：\n\n\n\np.s. 使用 Vim snipMate 的同学可以参考 javascript.snippet 这个代码片段模板。\n\n好了，使用溢出判断数组循环结束的讨论到此就结束了，但是好戏还在后头。\n\n由于 JavaScript 作用域的问题，有同学建议说将 i, l 变量定义在 for 循环之外。 于是进入另一个变量定义的话题。\n\n\n如何定义块级作用域中使用的变量？#\n\n持有变量应前置定义观点的同学，估计有不少是受了《JavaScript 权威指南》或其他权威著作的影响。\n\n《JavaScript 权威指南》第 4 章 4.3.1 小节 [2] 详细分析了块级作用域中变量定义的问题。\n\n由于 JavaScript 只有函数作用域，没有块级作用域，因此在 for, if/else, do/while, switch/case, try/catch\n这些块中定义的变量，实际在块之外也可以使用。\n\n\n\n例如上面的代码，在 for 这个块之中定义的变量，在 for 之外也可以使用。 这在其他支持块级作用域(如C/C++ [3],\nJava)的编程语言中是无法理解，甚至不可接受的。\n\n这是 JavaScript 设计的 BUG，书中作者建议将所有变量声明集中放置在函数开头， 说这是个好习惯。\n\n> This example illustrates why it is good programming practice to place all of\n> your variable declarations together at the start of any function.\n\nJavaScript 传教士老道也有 [类似的教诲](http://javascript.crockford.com/code.html#variable\ndeclarations)：\n\n> The var statements should be the first statements in the function body.\n> \n> ...\n> \n> JavaScript does not have block scope, so defining variables in blocks can\n> confuse programmers who are experienced with other C family languages. Define\n> all variables at the top of the function.\n\n他们的理由是，既然在块级作用域之内定义的变量可以被块级作用域之外使用， 那么就应该把变量定义在块级作用域之外，让它们看起来和它们实际的作用域表现一致。\n\n\n\n--------------------------------------------------------------------------------\n\n但是这个我稍微持不同的观点 ：）\n\n实际上我们定义 i, l 是为了给 for 用的，JavaScript 解释器在执行的时候可以 给块级作用域外面用，不代表就应该定义在外面。\n定义在外面给人的暗示是这个变量是给整个 function 用的，而不只是 for 循环， 就会给人『在外面用也没关系』的错觉。但这其实不是我们定义 i, l\n的本意。\n\n另外变量前置声明，会导致变量声明、定义和使用之间分离，变量含义自我解释性被削弱， 而且容易造成误清理、或遗漏清理变量的问题。\n\n对于 JavaScript 的这个糟粕，让人来适应机器的问题而修改代码，甚至改变本性习惯， 和另一个使用逗号连续定义变量的话题是何其的相似。\n为什么不让机器来适应人，在编辑器中编辑、或在编译器中编译 JavaScript 代码时， 发现块级作用域之外有使用块级作用域内部定义的变量时，给予恰当的警告。\n这是否更合理呢。\n\n如果遵循权威的教诲，把变量定义在函数前面，编辑器和编译器都没有办法帮我们了。\n\n我认为：\n\n 1. 定义在块级作用域之内的变量不应该被块级作用域之外使用。\n 2. 如果被块级作用域之外使用了：\n    \n    1. 要么这是一个错误的用法，会带来隐患。 人、编辑器、编译器、甚至将来的解释器可以发现这个问题并给出警告。\n    \n    2. 或者确实有这样的使用需求，那么这个变量应该被声明在块级作用域之外。\n\n所以我比较认同 就近原则 [4] 这种更合理、更人性的风格。\n\n * 文档、注释应尽可能的靠近代码。\n\n * 变量声明应尽可能的靠近变量使用。\n\n * 应尽量限制变量的作用域。\n\n\n那么#\n\n请问你持什么样的观点呢？\n\n--------------------------------------------------------------------------------\n\n\n注#\n\n 1. 出自《Structure and Interpretation of Computer Programs》，中文版《计算机程序的构造和解释》\n    \n    > Thus, programs must be written for people to read, and only incidentally\n    > for machines to execute.\n    > \n    > -- by Harold Abelson and Gerald Jay Sussman with Julie Sussman\n\n 2. 《JavaScript 权威指南》第六版章节和标题有所变更。第六版对应章节在第 3 章 第 3.10.1 小节：函数作用域和声明提前。\n    第六版中，关于变量声明提前的结束语中相对中立了很多。\n    \n    > In programming languages with block scope, it is generally good\n    > programming practice to declare variables as close as possible to where\n    > they are used and with the narrowest possible scope. Since JavaScript does\n    > not have block scope, some programmers make a point of declaring all their\n    > variables at the top of the function, rather than trying to declare them\n    > closer to the point at which they are used. This technique makes their\n    > source code accurately reflect the true scope of the variables.\n    \n    大意是说： 在支持块级作用域的编程语言中，变量就近定义是一个非常好的编程实践。 变量定义尽量靠近变量使用，变量尽量限制在最小的作用域之内。 由于\n    JavaScript 没有块级作用域，一些程序员提出将变量定义在函数的顶部， 而不是靠近使用变量的地方。这使得源码准确反映了其真正的作用域范围。\n\n 3. 早在 C89 规范 中，规定了变量必须声明在作用域的最前面， 但是 C99 和 C++ 取消了这个限制，支持就近声明变量。\n    \n    由于就近声明可以让变量作用于恰当的作用域之中，而且变量声明更靠近变量的使用， 因此也更容易理解。就近原则\n    在很多编程语言当中都是最佳实践，JavaScript 也不例外。\n\n 4. 就近原则(The Principle of Proximity) 是一项社会心理学 的理论，实际在 计算机编程 、 视觉设计 、 网页设计\n    领域也有很多的延伸与实践。","routePath":"/blog/post/2013/block-scope-variable-defined","lang":"zh-CN","toc":[{"text":"引子","id":"引子","depth":2,"charIndex":27},{"text":"如何定义块级作用域中使用的变量？","id":"如何定义块级作用域中使用的变量","depth":2,"charIndex":516},{"text":"那么","id":"那么","depth":2,"charIndex":2287},{"text":"注","id":"注","depth":3,"charIndex":2389}],"domain":"","frontmatter":{"0":{"template":"post"},"1":{"date":"2013-04-25T00:00:00.000Z"},"2":{"tags":"JavaScript"}},"version":""},{"id":140,"title":"日历控件(Calendar)","content":"#\n\n\n\n\n参考#\n\n * Disable browser native datepicker\n * Remove background arrow from date input in Google Chrome v20\n * How can I disable the new Chrome HTML5 date input?\n * Method to show native datepicker in Chrome\n * Why has the behavior of input type=“date” changed?\n * Styling Form Controls Using Pseudo Classes\n * Implementing a cross browser HTML5 pop up calendar control\n * HTML5: Form Validation Turned Off","routePath":"/blog/post/2013/calendar","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":5}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-09-02T00:00:00.000Z"},"2":{"tags":"JavaScript"},"3":{"status":"draft"}},"version":""},{"id":141,"title":"combo 还是不 combo？","content":"#\n\n * combo 可以减少页面 http 请求数。\n * combo 非公共模块导致本地缓存命中率低。\n * 使用公共模块和非公共模块分开 combo 策略？","routePath":"/blog/post/2013/combo-or-not-combo","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-09-26T00:00:00.000Z"},"2":{"status":"draft"}},"version":""},{"id":142,"title":"Cookie 长度限制","content":"#","routePath":"/blog/post/2013/cookie-limit","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-03-20T00:00:00.000Z"},"2":{"status":"draft"}},"version":""},{"id":143,"title":"客户端识别的设计","content":"#\n\ndetector 是一个 JavaScript CMD 模块，用于检测用户所处的客户端环境， 检查信息包括：\n\n * 硬件设备\n * 操作系统\n * 浏览器\n * 浏览器渲染引擎\n\n--------------------------------------------------------------------------------\n\n在 detector 出现之前，已经有了很多的前辈。但是尽管如此，detector 的出现还是 如此有必要。\n\n后面会介绍的前辈们包括：\n\n * jQuery\n * YUI\n * Kissy\n * light\n * Mootools\n * PrototypeJS @github","routePath":"/blog/post/2013/detector","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-05-17T00:00:00.000Z"},"2":{"status":"draft"}},"version":""},{"id":144,"title":"使用 Space 还是 Tab 缩进代码？","content":"#\n\n\n\n这也是一个经典的问题吧。很长一段时间以来我都是被影响为使用空格，而且似乎大多数 人都使用 4 个空格吧。。\n\n\n可视空间#\n\n空格：\n\n * 几乎所有编辑器或代码查看器中的占位一致，缩进风格统一。\n\nTab:\n\n * 每个编辑器可视占位空间可能不一致，但大多数编辑器可以设置，所以每个用户可以 使用自己的视觉习惯。\n\n\n缩进风格#\n\nK&R风格： 由Kernighan & Ritchie 给出的格式而得名，又称“核心风格”，因为UNIX核心应用了这种编程风格。\n每一层缩进使用8个空格（或者一个制表符），有时也使用4个空格，但很少。\n\n\n\nAllman风格： 因Eric Allman而得名，Eric Allman是伯克利的一名黑客，写了大量BSD程序，（这种风格又称BSD风格）\n每一层缩进使用8个空格，4个空格也经常被使用。\n\n\n\nWhitesmiths风格： 这种风格来源于早期一种C语言的商用编译器。 每一层缩进使用8个空格，4个空格也偶尔被使用。\n\n\n\nGNU风格: 不用说，自然是来自GNU了。 每一层缩进总是使用4个空格。在“{”和“}”号的缩进则使用半个缩进位。\n\n\n\n\n展开阅读#\n\n * Indent style\n * Editor war\n * Tabs versus Spaces: An Eternal Holy War.\n * Why I love having tabs in source code.\n * Tabs versus Spaces: An Eternal Holy War.\n * Tab versus space indentation in C#\n * Tabs versus spaces—what is the proper indentation character for everything,\n   in every situation, ever?\n * Tabs vs. spaces for indentation\n * Death to the Space Infidels!\n * Indent with tabs, align with spaces\n * Indentation: Tabs vs. Spaces\n * tabs or spaces?\n * Why tabs are clearly superior\n * Indent style\n * Indent style\n * C语言编码风格（一）——缩进和空白\n * 文章段落起首空格（缩进）风格的讨论\n\n--------------------------------------------------------------------------------\n\n * 代码缩进 tab space\n * 用空格还是制表符缩进有什么好争的？\n * 写代码时，缩进使用 tab 还是空格？","routePath":"/blog/post/2013/format-by-spaces-or-tabs","lang":"zh-CN","toc":[{"text":"可视空间","id":"可视空间","depth":2,"charIndex":60},{"text":"缩进风格","id":"缩进风格","depth":2,"charIndex":164},{"text":"展开阅读","id":"展开阅读","depth":2,"charIndex":499}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-01-06T00:00:00.000Z"},"2":{"tags":"Code, Indent"}},"version":""},{"id":145,"title":"Github 的 404 页面是个好路由","content":"#\n\n上周五周会上 @玉伯 做了个微分享：由于新浪微博的 BUG，不会将 https 的 URL 自动 转成可点击的链接，于是玉伯给\nlifesinger.github.com Project 做了个 index.html 页面：\n\n\n\n然后就可以通过 http://lifesinger.github.com/?126 这个链接来访问对应的 issues (玉伯的博客使用 Github 的\nissues 管理发布)\n\n我看到这个 URL 第一感觉是不爽，立即想到可以用 404 页面来做路由跳转页，然后访问 地址可以改成\nhttp://lifesinger.github.com/126 这样。\n\n于是玉伯的分享完败，也为下一个我要做的分享加了分 XD\n\n今天仔细想了想，使用 404 页面做路由跳转的思路本身很不错， 但是 http://lifesinger.github.com/126 这样的 URL\n其实是不具有可扩展性的， 也没有良好的语义性，而且也不是很好验证 URL 的业务合法性。于是可以改成如下：\n\nhttp://lifesinger.github.com/blog/126\n\n好了，根据 URL 前缀信息，404 页面可以扩展成你需要的任意路由跳转页， 或者非路由的 404 原始页了。\n\n散花~","routePath":"/blog/post/2013/github-404-is-a-good-route","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-03-24T00:00:00.000Z"},"2":{"tags":"Github, 404"}},"version":""},{"id":146,"title":"糊说 DRY","content":"#\n\nlifesinger/lifesinger.github.com#152\n\n 1. jQuery 是 All-in-One 非内聚的\n 2. lifesinger/lifesinger.github.com#152 里说到的 YUI 要依赖太多模块的问题，\n    根本不是问题。这个应该由工具自动管理依赖和打包，人无需钻进去纠结。\n 3. lifesinger/lifesinger.github.com#158 里玉伯提到的自然法则，在这里也适用。 人自然的进行编码，自然的使用依赖。\n\n如果已有简单可靠的方案在模块中够用，我赞同内置在模块中，比如 isString 之类。\n但我还是觉得依赖可靠的独立模块是毫无问题而且理所当然的。『高内聚、低耦合』也是有待商榷的，或者我们理解的有差异。\n\n我理解的『高内聚、低耦合』：单个模块是高内聚的；非这个模块要做的事情不要放置在这个模块中，降低或解除这样耦合。","routePath":"/blog/post/2013/hotoo-about-dry","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-05-15T00:00:00.000Z"},"2":{"status":"draft"}},"version":""},{"id":147,"title":"JavaScript 异常档案","content":"#\n\n\n\n\n\n作为前端工程师，看到上面的异常，我们该如何进行排查？\n\n 1. 根据异常所在文件及其异常所在行，找到引发异常的相关代码附近， 对代码进行分析？\n 2. 然后呢？就只能依靠我们以往的经验进行猜测和尝试了。\n 3. 没有这个异常的相关经验？哪有这么巧的事情？好吧，那你悲剧了。\n 4. 呃，Google 吧，也许 Bing 或 Baidu 也有点答案。\n 5. 试过了各种各样的关键词，打开了 N 多个 tab 页。。。\n 6. 然后也许你搜索到了散落在 MSDN，CSDN，蓝色理想，某某个人博客的一些只言片语？\n 7. 看到楼主给出的好多行无关代码，接下来是其他热心观众的猜测，试试这个、试试那个。\n 8. 还是不行啊，急，在线等。\n 9. 然后就没有了然后。。。\n\n\n\n--------------------------------------------------------------------------------\n\n各位同学，我们在排查调试 JavaScript 异常时，是不是经常感觉到乏力呢？\n\n * JavaScript 作为一门弱类型动态编程语言，在调试、排查异常方面一直都非常薄弱。\n * 客户端浏览器种类、版本、用户语言环境繁多，同样一个异常，在不同浏览器中表现和反馈都不同。\n * 尤其面对某某大牌浏览器厂商埋下高质量的坑，一般人还真没办法发现或解决。\n * 每个浏览器厂商的开发者文档或社区都是独立的，各种异常文档或分享散落各个社区或者个人博客中。\n\n凡此种种，我都觉得有必要建立这样的一套异常档案，他可以：\n\n * 对于已知或未知的 JavaScript 异常，都存档有对应的异常信息、场景上下文、源码片段、 对应的分析说明、及核心异常代码演示。\n * 长久的存在，不因时间的流逝、博客的关闭、URL 的变更等等原因而消逝。\n * 开放，分享和交流每个人的异常分析经验，让异常分析经验和知识更为普及和提升。\n\n\n\n--------------------------------------------------------------------------------\n\n因此，我们在 Github 上初步建立了一个 『 JavaScript 异常档案 』 的开源项目。任何人都可以 fork、提交\nissues、评论、邮件、或社区推广等各种方式来参与。\n\n等一下，你突然发现了这么一个页面： 对象不支持此属性或方法 @github 这个页面里有这个异常在各个语种下的异常消息描述，同一个异常代码在不同浏览器里的\n详细分析，还有有血有肉的实际案例分析，关键代码，实际异常演示页，，， 可能还很不完善，还需要我们一起来参与，但是泪奔的感觉有木有~\n\n--------------------------------------------------------------------------------\n\n希望有一天：\n\n * 我们遇到的脚本异常都可以在这个档案中找到原因、解决或规避的方案。\n * 我们分析的脚本异常都可以出现在这个档案中以惠及他人。\n\n最良好的祝愿！\n\n","routePath":"/blog/post/2013/javascript-exceptions-archives","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-05-22T00:00:00.000Z"},"2":{"tags":"JavaScript, Bugs"}},"version":""},{"id":148,"title":"JavaScript 异常最佳实践","content":"#\n\n\n参考#\n\n * 异常处理的最佳实践\n * Java 编程中关于异常处理的 10 个最佳实践\n * Java异常处理的陋习展播\n\n--------------------------------------------------------------------------------\n\n * 异常处理的最佳实践\n * Java 编程中关于异常处理的 10 个最佳实践\n * Java异常处理的陋习展播\n\n--------------------------------------------------------------------------------\n\n * C++异常的概念和处理机制\n * 异常处理经验谈\n * Java和C++在细节上的差异\n * Exceptions\n   * Unchecked Exceptions — The Controversy\n   * 【译文】Java异常处理的建议\n * Does Java need Checked Exceptions?\n * Checked vs Unchecked Exceptions in Java\n * Checked versus unchecked exceptions\n * A Pragmatic Look at Exception Specifications\n * 异常处理 - 维基百科\n * 异常处理 - 百度百科\n * 关于异常和异常错误处理的思考\n * Java基教--异常与错误区别 Error and Exception\n\n--------------------------------------------------------------------------------\n\n * javascript异常处理使用总结try…catch…finally window.onerror\n * JavaScript异常处理\n * javascript 异常处理使用总结","routePath":"/blog/post/2013/javascript-exceptions-in-action","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":3}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-08-16T00:00:00.000Z"},"2":{"tags":"JavaScript"},"3":{"status":"draft"}},"version":""},{"id":149,"title":"关于 JavaScript 拼音的分享","content":"#\n\n3年前(2010年7月)写了 pinyin.js 项目， 当时特别重视性能，项目描述还特别强调了『极速』，","routePath":"/blog/post/2013/javascript-pinyin-share","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-04-08T00:00:00.000Z"},"2":{"tags":"JavaScript, Pinyin"},"3":{"status":"draft"}},"version":""},{"id":150,"title":"中国农历","content":"#\n\nGoogle 日历内置了中国农历的支持，但是各种桌面客户端如 Mac iCal, iPhone 默认日历\n都无法正常使用，网上搜索了一遍也没有更好的订阅地址，大都不更新了。\n\n而且我又不想装各种乱七八糟的第三方日历应用。\n\n因此我自己制作了一个公开农历日历，需要的同学可以订阅到 Google Calendar，并且在 Google Calendar\n中可以隐藏这个日历，只是在各个客户端中显示即可。\n\n不过不爽的是，客户端不能针对特定日历设置提醒，有更好的方案的同学欢迎指教哈。\n\n\n启用 Google Calendar 内置农历（推荐）#\n\n 1. 设置(Settings)\n    \n    \n\n 2. 基本(General)\n\n 3. 备用日历(Alternate calendar)\n    \n    \n\n 4. 选择 农历 - 简体中文 (Chinese calendar - Simplified Chinese)\n\n 5. 保存(Save)\n\n 6. 最终可以在每日的日历顶部，有对应农历的显示。\n    \n    \n\n--------------------------------------------------------------------------------\n\nGoogle 日历的这个特性真是太赞了，以前为每天创建一个全天日历的挫 B方案没脸比。\n\n不过，现有的桌面（包括移动设备）应用中，都没能很好的支持这个特性。我又不想安装\n第三方的乱七八糟的日历应用，希望一个日历应用管理所有的日历数据，希望数据是开放的。\n\n因此挫 B 的方案只能继续。\n\n通过互联网在整个世界找了一圈，分享出来的农历订阅日历都已经失效、或者不更新了， 因此我决定自己来维护世界和平，创建并分享了下面的中国农历，大家只需要订阅\n到自己的日历中就可以了。\n\n\n订阅地址#\n\n * ical\n * xml\n * html\n\n\n订阅方法#\n\n桌面应用本身支持直接订阅 ical 日历，但是为了便于管理，我统一使用了 Google Calendar 管理我的日历，桌面应用只是客户端，数据来源于\nGoogle Calendar。\n\n * Other calendars 右侧的菜单，选择 Add by URL\n   \n   \n\n * 填入 ical 地址：\n   \n   https://www.google.com/calendar/ical/896414ier7cs228f2fp4mkn02g%40group.calen\n   dar.google.com/public/basic.ics\n   \n   \n\n * 点击 Add Calendar 按钮。\n\n * 由于 Google Calendar 本身内置了农历的支持，可以在 Google Calendar 中隐藏不显示这个日历。\n\n预览：\n\nhttps://www.google.com/calendar/embed?height=600&wkst=1&bgcolor=%23FFFFFF&src=89\n6414ier7cs228f2fp4mkn02g%40group.calendar.google.com&color=%23875509&ctz=Asia%2F\nShanghai\n\n\n\n\n其他#\n\n * 如果在使用过程中发现其中的错误，请邮件给我。\n * 同时欢迎 Fork 这个 『中国农历』开放项目 。 或者给我们提交 Issues。","routePath":"/blog/post/2013/lunar-calendar","lang":"zh-CN","toc":[{"text":"启用 Google Calendar 内置农历（推荐）","id":"启用-google-calendar-内置农历推荐","depth":2,"charIndex":245},{"text":"订阅地址","id":"订阅地址","depth":2,"charIndex":788},{"text":"订阅方法","id":"订阅方法","depth":2,"charIndex":820},{"text":"其他","id":"其他","depth":2,"charIndex":1383}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-11-13T00:00:00.000Z"},"2":{"tags":"Calendar"}},"version":""},{"id":151,"title":"多个 SSH KEY","content":"#\n\n\n\n\ngit config --local#\n\n\n\nproject/.git/config\n\n\n\n\n延伸阅读#\n\n * 多个github帐号的SSH key切换\n * Generating SSH Keys\n * ssh-keygen 中文手册","routePath":"/blog/post/2013/multi-ssh-key-for-git","lang":"zh-CN","toc":[{"text":"git config --local","id":"git-config---local","depth":2,"charIndex":5},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":52}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-11-25T00:00:00.000Z"},"2":{"tags":"SSH, Git"}},"version":""},{"id":152,"title":"不缓存 CDN 静态资源方案","content":"#\n\n支付宝目前使用淘宝提供的 CDN 服务，这个服务中的 CDN 节点在自身找不到对应资源时 主动到源服务器拉取的策略。\n\n支付宝使用的静态资源合并(combo)方案，导致在不同的访问参数情况下，被认为是不同 的静态资源。如果挟带的是避免缓存的随机参数，CDN\n在没有缓存这个资源的情况下， 会到源服务器拉取资源。\n\n原则上，我们使用特定的版本机制，每个新版本文件以不同的文件名发布，不允许使用 参数，尤其是随机数方式避免缓存问题。\n\n\n问题#\n\n由于我们使用的版本策略，我们可以指定用户缓存静态资源时效为永久，实际方案上 我们指定用户缓存时间为 1年，但是在某些场景下（如测量用户网络速度），\n用户客户端（非 CDN 节点）访问某些特定静态资源需要禁止使用缓存。\n\n目前常见的方案都是在客户端使用时间戳+随机数。这个方案本身看似没什么问题，但是 实际上有非常大的隐患，测量的数据参考性也不佳。\n\n * CDN 节点上缓存了大量挟带永不重复随机数的资源，对磁盘造成影响。\n * CDN 缓存命中率降低，这些挟带随机数的静态资源缓存率命中率为 0。\n * 增加源服务器的访问压力。\n * 测量的用户网络响应时间实际不是到 CDN 节点的，还包含 CDN 回源的时间。\n\n\n解决方案#\n\n为了解决这种明确不允许用户客户端缓存，同时又不建议使用随机参数访问的需求，我们 有以下几种方案：\n\n 1. CDN 服务器端控制浏览器不缓存。『最佳方案』\n    \n    设置指定目录下的静态资源禁止缓存头信息，有需要禁止缓存需求时上传静态资源到 这个目录。\n\n 2. 直接访问源服务器。\n    \n    现在的加随机数访问 CDN 方案和直接访问源服务器本质上相同，这方案只能测用户到 源服务器的响应时间。\n\n 3. 使用有限随机数方案。\n    \n    虽然第一种是最佳方案，但也不排除某些浏览器或壳在不关闭页面情况下，有缓存的 问题，所以这和第一种方案结合使用可能是更靠谱一些的方案。『待验证』\n    \n    页面脚本请求静态资源时，带上从零递增的参数，避免单页面缓存问题，亦可避免 CDN 缓存大量无意义资源的问题。\n\n\n延伸#\n\n实际上，对于静态资源来说，纯粹的参数是无意义的，CDN 节点本可以忽略这个参数。 虽然合并策略使用了参数方式，但是我们使用双问号激活合并服务的方案可以让我们\n明确区分出合并参数和其他参数，因此技术上是完全可以忽略其他参数导致的回源。\n\n\n参考#\n\n 1. 拉取式相比推送式的对比的参考","routePath":"/blog/post/2013/no-cache-in-cdn","lang":"zh-CN","toc":[{"text":"问题","id":"问题","depth":2,"charIndex":219},{"text":"解决方案","id":"解决方案","depth":2,"charIndex":535},{"text":"延伸","id":"延伸","depth":2,"charIndex":912},{"text":"参考","id":"参考","depth":2,"charIndex":1036}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-09-21T00:00:00.000Z"},"2":{"tags":"Web-Design, CDN"}},"version":""},{"id":153,"title":"个人资金管理软件","content":"#\n\n过年花掉不少钱，而其中有一部分是喜酒之类的礼金，按照礼尚往来的习俗，这些礼金 早晚都是要被送回来的，而被送回来的途径，则是喜酒回请。\n\n这些俗礼，即使不是为了收回礼金，回请对方也是必须的。\n\n为了避免忘记吃过的酒席（前几年的都忘记差不多了），也为了对自己的资金有更清晰 的掌握，于是开始记账。\n\n我现在用上了 Macbook Pro 和 iPhone，于是想找一个可以运行于 Mac OSX 和 iOS 平台\n的软件，两者同步数据是必须的要求。毕竟移动设备记账有很多的便利优势，而 PC 做 更细致的管理与分析则更为方便和强大。\n\n\nGNUCash#\n\nGNUCash 非常有名，也是我最早知道的开源金融管理软件 之一，复式记账一直是我觉得很厉害但是又不明白的概念。后来看了一些金融相关不入门 的信息，才有所了解。\n\n以前也在 Windows 下使用过 GNUCash，本身还是很不错的，但是当时我没有坚持下来。\n\n这次下载最新版回来在 Mac 上安装好之后发现，除了菜单之外，界面上中文全部是乱码， 一行中文被缩挤到第一列。新建账户或者其他任何操作都是不知所以，完全没法用。\n最奇怪的是，网络上各个搜索引擎居然都搜索不到 GNUCash 乱码的内容，偶尔有一篇， 还是将数据库的。原来 GNUCash 使用的是 MySQL 存储数据？\n\nGNUCash 目前支持 Windows, Mac, Linux, 和 Android 平台。\n\n\niCash#\n\n后来看到有人推荐使用 iCash， Mac 下 i 系列的好像都不错，于是尝试了下。\n\niCash 支持 Windows, Mac 平台，也有中文支持。\n\n但就是觉得操作不算便利，一大堆莫名其妙的表单，有些会自动根据后面的表单自动适配， 不需要显示但居然安排在最前面，后来我才知道可以不填。\n\n界面有点点土，用户体验也不好。概览里管理资金账户，如果需要更新交易，则需要 切换到『交易』页签，然后选择是哪个账户的交易。表单恐惧症~\n\n填了不到 50条左右（存储的 .icash 文件有 23.8M 这么大）就烦了， 于是继续寻找其他软件。\n\n\nMoney#\n\n最后才找到 Money by jumsoft 界面设计非常赞， 大部分使用体验也很棒，有部分瑕疵，而最要命的启动速度非常慢，导入从 iCash 导出的 QIF\n格式数据(.money 文件 500+KB) 启动时间大概需要 10秒。\n\n另外如果上次退出 Money 的时候没有打开的文档（每个 .money 文件是一个文档）的话， 下次启动会要求创建新文档，只好打开最近的文档，再等\n10秒钟。所以建议直接 <Command-q> 退出文档 & 程序，不要使用 <Command-w 之类的关闭文档。\n\n另外还有 iOS(iPhone, iPad)版本，收费也不贵。可以通过 Wi-Fi 或 iCloud 同步数据。 虽然呼声很高，目前还不支持 Dropbox\n同步。不过像其他重要资料一样，我的 .money 文件存储在 Dropbox 中。\n\n总之是很赞啦，如果解决了性能问题就更好了，还有就是缺少中文本地化，另外 Mac 版 显示全部交易也不好，还有那啥~","routePath":"/blog/post/2013/personal-financial-manage-soft","lang":"zh-CN","toc":[{"text":"GNUCash","id":"gnucash","depth":2,"charIndex":269},{"text":"iCash","id":"icash","depth":2,"charIndex":622},{"text":"Money","id":"money","depth":2,"charIndex":901}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-02-17T00:00:00.000Z"},"2":{"tags":"金融管理, 软件, Mac OS X, iOS"}},"version":""},{"id":154,"title":"","content":"","routePath":"/blog/post/2013/regexp-for-password","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-11-17T00:00:00.000Z"},"2":{"tags":"RegExp"}},"version":""},{"id":155,"title":"迁移博客到 Jekyll","content":"#\n\n\n_posts 文件结构#\n\nJekyll 支持两种结构：\n\n 1. 平铺所有文件，每个文件使用日期前缀。\n 2. 按照完整的日期目录结构。\n\n\n静态链接(Permalink)#\n\n我的个人博客并非用于发布新闻，即使非常旧的博客，也会不断更新维护， 所以无需添加时间标识，直接使用 title 即可。\n\n如果需要多个版本，为避免出现冲突，可以在 title 中添加序号。如 II 或 2。\n\n\n草稿(Draft)#\n\nJekyll 支持 published 标记，设置为 false 就可以避免被转换发布。 这本身很不错，但是这些草稿和正常发布的文件混淆在一起，无法清晰区分。\n\n所以我创建了 _draft 目录，用于存放草稿。在文章准备好之后拷贝到 _posts 目录即可。\n\np.s. 话说相比 published 标记，我更喜欢 draft，如果支持的话。\n\n\nmore#\n\nCreating Excerpts in Jekyll with Wordpress-style HTML Comments\n\n\n存档(Archive)#\n\nenaeher / tiered_archives.rb\n\n\n目录(TOC)#\n\nhttp://stackoverflow.com/questions/9602936/how-to-add-a-table-of-contents-to-jek\nyll-blog-post\nhttp://stackoverflow.com/questions/13481572/jekyll-automatic-table-of-contents\nhttp://du1abadd.org/2010/usr/make_toc_support_for_jekyll_with_rdiscount.html\n\n\n标签(Tags)#\n\n\n代码高亮#\n\n\n分页#\n\n\n\n\n参考：#\n\n * Jekyll Draft Publishing Plugin\n * Jekyll Draft Posts\n\n\n与 Vimwiki 结合#\n\n之前的博客使用 Vimwiki 管理，可以无需转换或发布，直接使用 Vim 即可简单浏览。\n\n\n\n\n不足#\n\n_posts/*.md 文档理论上只会作为内容输出，其中的代码（尤其是 Jekyll 使用的模板 代码，及其 pre > code\n中的代码，应该合理转义处理。但是实际上 Jekyll 没有这样 做，导致一些代码没有符合期望。","routePath":"/blog/post/2013/start-jekyll-for-blog","lang":"zh-CN","toc":[{"text":"_posts 文件结构","id":"_posts-文件结构","depth":2,"charIndex":3},{"text":"静态链接(Permalink)","id":"静态链接permalink","depth":2,"charIndex":75},{"text":"草稿(Draft)","id":"草稿draft","depth":2,"charIndex":199},{"text":"more","id":"more","depth":2,"charIndex":386},{"text":"存档(Archive)","id":"存档archive","depth":2,"charIndex":458},{"text":"目录(TOC)","id":"目录toc","depth":2,"charIndex":503},{"text":"标签(Tags)","id":"标签tags","depth":2,"charIndex":766},{"text":"代码高亮","id":"代码高亮","depth":2,"charIndex":778},{"text":"分页","id":"分页","depth":2,"charIndex":786},{"text":"参考：","id":"参考","depth":3,"charIndex":794},{"text":"与 Vimwiki 结合","id":"与-vimwiki-结合","depth":2,"charIndex":858},{"text":"不足","id":"不足","depth":2,"charIndex":923}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-02-13T00:00:00.000Z"},"2":{"tags":"Blog, Jekyll"}},"version":""},{"id":156,"title":"JavaScript Strict Mode","content":"#\n\nECMAScript 5 定义了严格模式。开发者在代码中写上 \"use strict\" 标识，浏览器就会 按照严格模式来执行 JavaScript。\n\n而且还非常强大的支持局部作用域，不影响其他外部作用域使用非严格模式。 多么贴心的服务。\n\n很多人（包括我之前）的直觉会认为这是非常好的特性，向前兼容，严格模式也必定是未来的趋势。\n\n但是我想说的是：严格模式是未来的趋势也许没有错，但绝对不会是让开发者手工在各个 作用域中到处写 \"use strict\"。\n\n使用严格模式是开发者的事，所以最重要、也是最直接有效的方式是在开发阶段就完成 严格模式的所需的所有工作，包括代码静态分析、校验等待。\"use strict\"\n选项应该 在 IDE/编辑器中配置而不是写在代码中。\n\n同时像 HTML 的严格模式一样，浏览器运行时使用严格/非严格模式只需要在 DOCTYPE 中声明一次，而无需不同作用域使用不同的模式。\n\n肯定有人站出来说，对于历史遗留的非严格模式的代码怎么办，支持作用域模式不是应该 考虑的兼容性问题么？\n\n确实，历史遗留代码的兼容性问题比较麻烦，我很同情我们。\n\n但是想想我们从 HTML 转到 XHTML 的痛苦经历，难道我们应该允许文档中某些 DOM\n片段是不标准的，另外一些片段写上一些特殊属性声明自己是遵循标准使用严格模式的吗？\n\n完全没有，我们只有一个 DOCTYPE。\n\n不标准的代码只有重写，就是这样。\n\n--------------------------------------------------------------------------------\n\n我认为：\n\n * 严格模式是未来的趋势。\n * 严格模式应该在 IDE/编辑器和浏览器中声明。\n * 严格模式无需也不应该在各个 JavaScript 作用域片段中到处声明。\n\n\n参考#\n\n * ECMA-262-5 in detail. Chapter 2. Strict Mode.\n * 译：It’s time to start using JavaScript strict mode\n * ECMAScript 5 Strict Mode, JSON, and More\n * [Strict Mode\n   (JavaScript)](http://msdn.microsoft.com/en-us/library/ie/br230269(v=vs.94\\).a\n   spx)\n * What does “use strict” do in JavaScript?\n * What does “use strict” do in JavaScript, and what is the reasoning behind it?\n * JavaScript语法支持严格模式：”use strict”","routePath":"/blog/post/2013/use-strict-mode","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":790}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-05-19T00:00:00.000Z"}},"version":""},{"id":157,"title":"Vim Talk in 来往扎堆","content":"#\n\n> 首先感谢支持加我的『来往』好友们，你们太让人感动了。\n\n经过一阵狂热，下面开始冷静正常的使用来往，好好利用这个应用。\n\n扎堆是一个类似贴吧、论坛类信息分享交流的移动平台。 大家可以在这里随时随机的分享话题、信息、图片等， 也可以对他人发起的话题进行回复交流。\n\n\n\n欢迎加入 Vim Talk 扎堆，一起聊些有用有趣的技术话题。\n\n加入方法：\n\n 1. 安装并启动 来往 客户端。\n 2. 打开『通讯录』-『添加好友』-『扫一扫加好友』-扫描上面的二维码即可。","routePath":"/blog/post/2013/vim-talk-laiwangzhadui","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-10-23T00:00:00.000Z"},"2":{"tags":"Vim"},"3":{"status":"draft"}},"version":""},{"id":158,"title":"『已结束』庆祝 Vim 7.4 发布，发起团购 Tee + 团捐活动(2013)","content":"#\n\n> 团购活动已经结束，但你仍然可以自行印制或购买 团捐活动已经结束，但你仍然可以 自行捐助\n\n--------------------------------------------------------------------------------\n\n> 本次活动有 41人参加，团购 Tee 47件。 最终以 @vimcn 的身份 捐赠 159欧元，实际人民币 1377.94元。 参加团捐的同学请查收邮件并于\n> 2013年10月份之前行使您的 Vim 新特性赞同或反对票。\n\n于 2013年08月10日发发布的 Vim 7.4 的主要特性更新如下：\n\n 1. 增强 Python 支持；\n 2. 内置更快的正则表达式引擎；\n 3. bugs fix.\n\n为了庆祝这一重大的事件，发起这次团购 VimTee + 团队捐助的活动。 活动截至 2013年08月15日，请有兴趣的同学火速参与。\n\n\nTee#\n\n * 初步确定为 POLO 男款（店家没有专门的女款，抱歉 :( 如果你不介意，这款女生穿着也很帅 ：)）\n\n * 个人觉得需要适当增大胸前的胶印 LOGO。待讨论确定。\n\n * 增加个性袖标。\n   \n   > :version VIM - Vi IMproved 7.4 (2013 Aug 10) @hotoo\n\n由于袖标需要使用正确的时间，所以 Tee 的印刷需要在 Vim 正式发布之后。\n\n\n\n\n局部特写：#\n\n\n\n\n尺码：#\n\n我个人喜欢穿稍微宽松的 Tee，一般会买大一号的，仅作参考 :)\n\n通用款    M         L         XL        XXL\n适合身高   165~170   170~175   175~180   180~190\n胸围     98        104       116       121\n衣长     67        70        75        78\n肩宽     42        45        48        50\n\n--------------------------------------------------------------------------------\n\n官方推荐的 Tee 要 18.5欧元， 将近 150元人民币，其中每件会捐助 3欧元（相当于24元人民币）给 Vim。\n相对来说很贵，而且还需要从国外运到国内，会麻烦很多（可能还需要关税）。\n\n所以组织在国内自印，会划算靠谱很多。这个 Tee 的质量更好，大概只需要其 2/3 的价格， 就可以捐助给 Vim 多一倍的爱心。\n\n\n捐助#\n\n每件 Tee 需要额外的 20元左右的人民币，以 vimcn 团队的身份捐助给 Vim 以帮助乌干达 可怜的儿童。\n\n\n报名#\n\n * 每件 Tee 的价格在 65~70 元左右；\n * 快递费另外算。可以同城合并快递，线下认识下也不错。\n * 我可以代收杭州的部分。\n * 其他地区的同学如果同意被代收，我会随机选同城的一位同学代收。\n\n邮件发送以下内容到 hotoo.cn+vimtee[AT]gmail.com （点击链接即可）\n\n> 尺码： 颜色：军绿色|蓝色|黑色|白色 袖标信息：例如 @hotoo 件数：默认 1件 联系方式（手机或固话）： 收货人姓名： 收货地址和邮编：\n> \n> 是否同意同城代收或被代收？ 是否有必要适当增大胸前 LOGO？ 袖标印在左手还是右手？\n\n报名截至时间：Vim 7.4 正式发布之日。\n\n费用待团购数量及折扣程度，和快递费用确定之后通知大家。\n\n\n声明#\n\n这是一次庆祝、纪念的活动，另外还兼有公益的团队捐助活动。\n\n如果你对 Tee 的设计不满意，可以自行设计印制。你也可以以个人身份捐助 Vim。\n\n\n有图有真相#\n\n\n\n\n\n\n\n\nVimTee 回顾#\n\n 1. 2010年7月，Vim 7.3 发布的时候，我组织了一次 团购 VimTee 的活动。\n 2. 2011年应邀又组织了一次 趣味 Vim Tee 的活动。\n 3. 2012年由于种种原因我没有组织。\n 4. 2013年5月，Vim 7.4 即将发布，我想再发起一次组织团购 VimTee 的活动。","routePath":"/blog/post/2013/vim74-tee","lang":"zh-CN","toc":[{"text":"Tee","id":"tee","depth":2,"charIndex":404},{"text":"局部特写：","id":"局部特写","depth":3,"charIndex":614},{"text":"尺码：","id":"尺码","depth":3,"charIndex":625},{"text":"捐助","id":"捐助","depth":2,"charIndex":1120},{"text":"报名","id":"报名","depth":2,"charIndex":1185},{"text":"声明","id":"声明","depth":2,"charIndex":1523},{"text":"有图有真相","id":"有图有真相","depth":2,"charIndex":1602},{"text":"VimTee 回顾","id":"vimtee-回顾","depth":2,"charIndex":1617}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-05-26T00:00:00.000Z"},"2":{"tags":"Vim, VimTee"}},"version":""},{"id":159,"title":"每周异常：第 1 期","content":"#\n\n2013-07-15 14:00~14:03，来自北京市时代互联(180.184.99.37) 的\npc/-1|windows/6.2|firefox/22.0|gecko/20100101 用户向支付宝 katongweb 系统发起1480次猛烈的总攻。\n\n详情如下：\n\nKEY          VALUE\nRef          https://ref.example.com/ref.htm\nURL          https://www.example.com/index.htm\nFile         chrome://grabword/content/grabword.js\nLine         0\nMessage      Script error.\nstacktrace   \n\n该用户通过 Ref 页面到目标 URL 之后，连续不断的通过 Firefox 插件脚本触发脚本异常。\n\n--------------------------------------------------------------------------------\n\n通过最近的几次异常报警来看，由客户端连续发起攻击引起的 JavaScript 异常 PV 非正常波动，对异常监控数据有比较大的影响。\n\n因此考虑以下方案来提升监控数据的稳定有效性：\n\n * 监控 JavaScript 异常 UV(根据 Session)\n * 监控 JavaScript 异常独立 IP 数。\n * 排除客户端本地脚本引起的异常（多数攻击是由客户端脚本发起）\n   * 今日客户端脚本异常率：45.14%\n   * 正常情况下客户端脚本异常率：3.45%\n\n--------------------------------------------------------------------------------\n\n下图是排除了客户端本地脚本抛出的异常之后的结果：\n\n\n\n（当天数据对比，图中圆点是开启过滤客户端本地异常的时间点，下同）\n\n\n\n（相近2天数据对比）","routePath":"/blog/post/2013/weekly-topic-about-exceptions-1","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-07-15T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":160,"title":"每周异常：第 10期，异常评分算法","content":"#\n\nabc\n\n> 本文同步发表于『JavaScript 异常档案库』， 欢迎 Star, Watch, Fork & Pull Request.\n\n经过不知多少次的纠结、学习与尝试，我们来对异常评分算法做一个了结。\n\n\n\n\n\n\n参考#\n\n * How Not To Sort By Average Rating\n * 基于用户投票的排名算法（一）：Delicious和Hacker News\n * 基于用户投票的排名算法（二）：Reddit\n * 基于用户投票的排名算法（三）：Stack Overflow\n * 基于用户投票的排名算法（四）：牛顿冷却定律\n * 基于用户投票的排名算法（五）：威尔逊区间\n * 基于用户投票的排名算法（六）：贝叶斯平均\n * Binomial proportion confidence interval\n * 置信区间(Confidence_interval)","routePath":"/blog/post/2013/weekly-topic-about-exceptions-10","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":114}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-09-25T00:00:00.000Z"},"2":{"tags":"每周异常"},"3":{"status":"draft"}},"version":""},{"id":161,"title":"每周异常：第 2 期（续）","content":"#\n\n上篇 分析了上周的异常 TOP4，顺便发现 TOP3 和 TOP5 是同一个问题造成的异常。\n\n下面我们来分析 TOP1 和 TOP 2 的异常，事实上，这两个异常也是由同一个问题造成的。\n\n\nTOP1#\n\nKEY       VALUE\nURL       https://www.example.com/index.htm\nFile      https://a.example.com/??seajs/1.3.1/sea.js,seajs/1.3.1/plugi\n          n-combo.js,jquery/jquery/1.7.2/jquery.js\nLine      35\nMessage   无法获取未定义或 null 引用的属性“length”\n\nSTACK TRACE                                               DEVICE   OS            BROWSER             ENGINE        COUNT\nat function(a,c,d)                                        pc/-1    windows/6.1   ie/10.0             trident/6.0   2740\nat function(a,c,d)                                        pc/-1    windows/6.1   sg/2.x              trident/6.0   868\nat function(a,c,d)                                        pc/-1    windows/6.2   ie/10.0             trident/6.0   538\nat function(a,c,d)                                        pc/-1    windows/6.1   tao/3.2             trident/6.0   236\nat function(a,c,d)                                        pc/-1    windows/6.1   baidu/2.x           trident/6.0   113\nat function(a,c,d)                                        pc/-1    windows/6.1   tw/3.6.1.1          trident/6.0   36\nat function(a,c,d)                                        pc/-1    windows/6.2   tao/3.2             trident/6.0   26\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/4.0.5.2000       trident/6.0   25\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/4.1.0.2000       trident/6.0   20\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/4.0.6.2000       trident/6.0   15\nat function(a,c,d)                                        pc/-1    na/-1         ie/10.0             trident/6.0   14\nat function(a,c,d)                                        pc/-1    windows/5.0   ie/10.0             trident/6.0   12\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/4.1.1.600        trident/6.0   10\nat function(a,c,d)                                        pc/-1    windows/6.1   tw/3.6.1.0          trident/6.0   10\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/4.0.3.1000       trident/6.0   8\nat function(a,c,d)                                        pc/-1    windows/6.2   mx/4.0.6.2000       trident/6.0   8\nat function(a,c,d)                                        pc/-1    windows/6.1   tao/3.0             trident/6.0   7\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/3.4.5.2000       trident/6.0   6\nat function(a,c,d)                                        pc/-1    windows/6.1   qq/6.14.15493.201   trident/6.0   6\nat function(a,c,d)                                        pc/-1    windows/6.1   qq/7.3.11251.400    trident/6.0   6\nat function(a,c,d)                                        pc/-1    windows/5.1   ie/10.0             trident/6.0   4\nat function(a,c,d)                                        pc/-1    windows/6.0   ie/10.0             trident/6.0   4\nat function(a,c,d)                                        pc/-1    windows/6.1   360/3.2.0.6         trident/6.0   4\nat function(a,c,d)                                        pc/-1    windows/6.1   lb/3.1.15.3877      trident/6.0   4\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/3.5.2.1000       trident/6.0   4\nat function(a,c,d)                                        pc/-1    windows/6.1   mx/4.0.5.4000       trident/6.0   4\nat function(a,c,d)                                        pc/-1    windows/6.2   tao/3.1             trident/6.0   4\nat function setCaretToInput(input)at function(event)at    pc/-1    windows/6.1   sg/2.x              trident/6.0   3\nfunction(a,c,d)\nat function(a,c,d)                                        pc/-1    windows/6.2   tao/3.0             trident/6.0   3\nat function(a,c,d)                                        pc/-1    windows/6.1   qq/7.3.8581.400     trident/6.0   2\nat function setCaretToInput(input)at function (event)at   pc/-1    windows/6.2   ie/10.0             trident/6.0   2\nfunction(a,c,d)\nat function(a,c,d)                                        pc/-1    windows/6.1   qq/6.14.14517.201   trident/6.0   1\nat function setCaretToInput(input)at function (event)at   pc/-1    windows/6.1   sg/2.x              trident/6.0   1\nfunction(a,c,d)\n                                                                                                                   4744\n\n\nTOP2#\n\nKEY       VALUE\nURL       https://www.example.com/index.htm\nFile      https://a.example.com/??seajs/1.3.1/sea.js,seajs/1.3.1/plugi\n          n-combo.js,jquery/jquery/1.7.2/jquery.js\nLine      35\nMessage   无法获取未定义或 null 引用的属性“length”\n\nSTACK TRACE          DEVICE   OS            BROWSER             ENGINE        COUNT\nat function(a,c,d)   pc/-1    windows/6.1   ie/10.0             trident/6.0   2192\nat function(a,c,d)   pc/-1    windows/6.1   sg/2.x              trident/6.0   1255\nat function(a,c,d)   pc/-1    windows/6.2   ie/10.0             trident/6.0   352\nat function(a,c,d)   pc/-1    windows/6.1   baidu/2.x           trident/6.0   143\nat function(a,c,d)   pc/-1    windows/6.1   tw/3.6.1.1          trident/6.0   42\nat function(a,c,d)   pc/-1    windows/6.1   mx/4.0.6.2000       trident/6.0   33\nat function(a,c,d)   pc/-1    windows/6.1   tw/3.6.1.0          trident/6.0   32\nat function(a,c,d)   pc/-1    windows/6.1   tao/3.0             trident/6.0   13\nat function(a,c,d)   pc/-1    windows/6.2   tw/3.6.1.1          trident/6.0   13\nat function(a,c,d)   pc/-1    windows/6.1   mx/3.4.5.2000       trident/6.0   11\nat function(a,c,d)   pc/-1    windows/6.1   qq/7.3.8126.400     trident/6.0   9\nat function(a,c,d)   pc/-1    windows/6.2   tao/3.0             trident/6.0   9\nat function(a,c,d)   pc/-1    windows/6.1   360/3.9.1.5         trident/6.0   6\nat function(a,c,d)   pc/-1    windows/6.1   mx/3.4.1.1000       trident/6.0   6\nat function(a,c,d)   pc/-1    windows/6.1   mx/4.0.3.3000       trident/6.0   6\nat function(a,c,d)   pc/-1    windows/6.1   qq/6.14.14517.201   trident/6.0   6\nat function(a,c,d)   pc/-1    windows/6.1   qq/6.14.15493.201   trident/6.0   5\nat function(a,c,d)   pc/-1    windows/6.1   360/3.2.0.2         trident/6.0   4\nat function(a,c,d)   pc/-1    windows/6.1   qq/7.3.11251.400    trident/6.0   4\nat function(a,c,d)   pc/-1    windows/6.1   360/3.1.6.7         trident/6.0   3\nat function(a,c,d)   pc/-1    windows/6.2   sy/-1               trident/6.0   3\n                                                                              4147\n\n--------------------------------------------------------------------------------\n\nTOP1 和 TOP2 两个异常都是中 memberprod 系统的注册页面上（重要程度不想而知），\n一个页面是注册的起始页，一个是注册的完成页。我们先分析起始页。\n\n打开异常所在文件第 35行，搜索异常栈信息中的 function(a,c,d)，我们发现有 3 个如下：\n\n\n\n再找异常信息中的关键字 length，发现上面的 prop 方法中并没有这个关键字， 所以可以排除。剩下的两个函数对应的原始码如下：\n\n\n\n这两个函数都有可能性，但是从经验上 each 方法用的更多，我猜这个命中率更高。 但是单纯的从这些异常信息字面量来看，已经没有了更多信息。我们当时还没有注意到\n异常都是 Trident 6.0 抛出的。\n\n--------------------------------------------------------------------------------\n\n打开页面标准模式或兼容模式下都没有抛出这个异常，只是兼容模式下有个 『找不到成员。』的异常。\n\n手贱点了表单第一个输入框，终于重现了梦寐以求的异常。它就是 each 方法中抛出的。 从调用堆栈信息中可以看到 this.items 是\nundefined，导致 each 失败。\n\n\n\n而 this.items 为 undefined 是由于 validator 的 core 模块中 setup() 函数中 设置 novalidator\n属性异常导致后续代码没有执行造成。\n\n\n\n至此，上周支付宝全站 TOP5 的异常均已告破，他们都是同一个问题造成的。\n\n\n如何解决这个异常？#\n\nValidator 组件已于 3个月前的 v0.9.3 版本得到修复，请升级到 Validator 最新版。\n\n\n一个问题？#\n\n基础组件中小版本升级修复各种 BUG 的过程中，如何同步推动业务代码的对应升级？","routePath":"/blog/post/2013/weekly-topic-about-exceptions-2-2","lang":"zh-CN","toc":[{"text":"TOP1","id":"top1","depth":2,"charIndex":99},{"text":"TOP2","id":"top2","depth":2,"charIndex":4512},{"text":"如何解决这个异常？","id":"如何解决这个异常","depth":2,"charIndex":7374},{"text":"一个问题？","id":"一个问题","depth":2,"charIndex":7443}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-07-23T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":162,"title":"每周异常：第 2 期","content":"#\n\n这是全站排名第 4 的一个异常，详情如下：\n\nKEY       VALUE\nURL       https://www.example.com/console/selectStrategy.htm\nFile      https://a.example.com/??seajs/1.3.1/sea.js,seajs/1.3.1/plugi\n          n-combo.js,jquery/jquery/1.7.2/jquery.js\nLine      35\nMessage   找不到成员。\n\nSTACK TRACE          DEVICE   OS            BROWSER             ENGINE        COUNT\nat function(a,b,d)   pc/-1    windows/6.1   ie/10.0             trident/6.0   826\nat function(a,b,d)   pc/-1    windows/6.1   sg/2.x              trident/6.0   423\nat function(a,b,d)   pc/-1    windows/6.2   ie/10.0             trident/6.0   151\nat function(a,b,d)   pc/-1    windows/6.1   baidu/2.x           trident/6.0   27\nat function(a,b,d)   pc/-1    windows/6.1   mx/3.4.5.2000       trident/6.0   10\nat function(a,b,d)   pc/-1    windows/6.1   tw/3.6.1.1          trident/6.0   10\nat function(a,b,d)   pc/-1    windows/6.2   mx/4.0.6.2000       trident/6.0   3\nat function(a,b,d)   pc/-1    windows/6.1   lb/undefined        trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.1   mx/3.5.2.1000       trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.1   mx/4.0.5.3000       trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.1   mx/4.0.5.4000       trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.1   mx/4.0.6.2000       trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.1   qq/7.3.11251.400    trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.2   tw/-1               trident/6.0   2\nat function(a,b,d)   pc/-1    windows/6.1   360/3.7.1.6         trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   360/4.0.3.6         trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   360/4.0.5.2         trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   mx/2.5.15.1000      trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   mx/2.5.16.100       trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   mx/4.0.3.6000       trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   mx/4.0.5.2000       trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   mx/4.1.0.2000       trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   qq/6.13.13719.201   trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   qq/6.14.15493.201   trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   tw/3.4.0.5          trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.1   tw/3.6.1.0          trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.2   mx/3.5.2.1000       trident/6.0   1\nat function(a,b,d)   pc/-1    windows/6.2   mx/4.0.5.3000       trident/6.0   1\n                                                                              1478\n\n--------------------------------------------------------------------------------\n\n首先我们找到异常所在文件的第 35行，在上面的异常栈信息中我们可以知道异常从 压缩后的匿名函数 function(a,b,d) 中抛出，这个函数是：\n\n\n\n对应压缩前的源码是：\n\n\n\n这个代码是用来兼容 IE6/7 的属性操作（代码注释中号称几乎修复了 IE6/7 所有的问题）， 页面中的业务源码中我们找到不少 DOM\n属性的操作，其中有一些看起来几乎不会有问题， 另外一些则出现问题的可能性更高。\n\n我们从这些可能性更高的部分着手，最终发现 IE10 兼容模式下会抛出『找不到成员。』 的异常，这时我们注意到，异常详情中全部都是 Trident 6.0\n内核的浏览器抛出的异常。 看来我们这个增加兼容模式信息的 Issues#13 是正确的。\n\n我们看到兼容模式下表单中的 Select 模拟组件显示不正常，最初以为是 Select 组件设置属性造成的异常。\n\n\n\n（正常情况下的 Select 模拟组件）\n\n\n\n（兼容模式下的 Select 模拟组件）\n\nIE10 的调试工具还是不错的，最终我们发现在设置 \"novalidate\" 属性时抛出这个异常， 想到 Validator 的相关 Issues#30\n\n\n\n于是这个异常就破解完成。\n\n\n如何修复这个异常？#\n\n找回密码的这个页面使用的 Validator@0.8.9，而 novalidate 属性造成的异常在 Validator@0.9.3\n及其后续版本中得到修复。建议升级到最新版本。","routePath":"/blog/post/2013/weekly-topic-about-exceptions-2","lang":"zh-CN","toc":[{"text":"如何修复这个异常？","id":"如何修复这个异常","depth":2,"charIndex":3280}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-07-22T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":163,"title":"每周异常：第 3期，宏观异常分析方法","content":"#\n\n为了有效的分析 JavaScript 异常，我们从宏观的统计数据中做了大量的分析，初步结果如下：\n\n\n全站每日异常统计#\n\n首先我们从每天的全站总体数据进行分析，得到下面这些报表。其中：\n\n * all_pv: 全站所有有效异常次数 (PV)\n * all_uv: 全站所有有效异常人数 (UV)\n * all_pv_rate: 全站所有异常率 (按 PV 统计)\n * all_uv_rate: 全站所有异常率 (按 UV 统计)\n * valid_rate_pv: 有效异常率（按 PV 统计）\n * valid_rate_uv: 有效异常率（按 UV 统计）\n\n\n\n\n\n\n\n\n\n\n\n从趋势图中我们可以明显的看到第 2天和最后一天，异常 PV 有较大波动，这是由于用户 攻击爆发大量异常造成的。\n\n我们在 异常评分算法 的讨论中有提到，即使是少量用户进行攻击，异常 UV 也不应该有波动的（除非页面 UV 本身有较大波动），但是实际上我们看到最后一天的异常\nUV 也有明显波动，因此粗略 分析这个异常 PV 的上升是由于页面访问人数增多造成的。\n\n事后我们查了当天的页面访问 PV 和 UV，可惜并没有明显波动。\n\n实际经过细致的异常日志分析，我们看到攻击用户同时没过一段时间就更换 IP 地址或清理 Cookie，因此全天的综合数据中异常 PV 和异常 UV\n有了一些明显波动。\n\n而且实际上，每天都有攻击造成的异常波动。\n\n * 每天都有攻击造成的异常，累加在一起好像每天都没什么问题。\n * 由于攻击造成异常总数相对一天的异常总数太小，从全天异常总数的层面来看， 无法发现，甚至排除攻击造成的异常。\n * T+1 的统计数据，对于异常监控来说，太迟钝了。\n\n\n全站每分钟异常统计#\n\n从上面每日异常总和的分析我们可以看出，一天的总和数据能发现的问题还是比较有限的。 于是我从分钟的粒度来统计异常。\n\n\n\n图有点大，点击可以看大图。\n\n从图中我们可以看到，凌晨 2点多到 3点多期间，有少量用户发起了猛烈的攻击； 凌晨 4点多到凌晨7点多期间也有少量温和的攻击。攻击时全站异常 PV （绿色）\n和全站有效异常（深红色）明显飙升，但是异常 UV 和有效异常 UV 都没有太大波动， 而且与前后的时间切片有较好的连贯性，没有大起大落。\n\n而如果异常 UV 出现较大波动，在很可能是由于我们正在发布的新代码影响大面积用户。\n\n合适的时间粒度对于及时发现真正有效的异常有非常重要的意义。","routePath":"/blog/post/2013/weekly-topic-about-exceptions-3","lang":"zh-CN","toc":[{"text":"全站每日异常统计","id":"全站每日异常统计","depth":2,"charIndex":53},{"text":"全站每分钟异常统计","id":"全站每分钟异常统计","depth":2,"charIndex":737}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-08-02T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":164,"title":"每周异常：第 4期，如何避免客户端攻击造成的大量异常报警","content":"#\n\n在 JavaScript 异常监控过程中，发现有很多由于客户端连续攻击造成的大量异常，导致 监控系统报警。\n\n\n\n（图中大量不连续的波动，都是攻击造成的）\n\n这种少量用户(UV)发起攻击造成的大量异常(PV)波动，不是我们实时监控需要关注的部分。\n我们实时监控最重要的是要发现由于系统发布过程中，我们的发布的代码有问题导致大量 用户受影响而出现的波动（波形可能跟上图的每一个异常波形相似）。\n\n理论上导致异常数据波动的场景包括：\n\n * 少量用户发起大量攻击。\n * 大量用户同时涌入或离开。\n * 发布问题代码影响到大量用户。\n\n少量用户发起大量攻击造成数据波动，是我们可以不必实时关注实时报警的部分。\n\n大量用户同时涌入或离开造成的异常数量(PV)波动，也是我们无需实时关注的部分， 另外我们也可以通过异常率规避波动。\n\n场景   异常 PV   异常 UV   异常率(PV)   异常率(UV)\n攻击   波动      无波动     波动        无波动\n涌入   波动      波动      无波动       无波动\n发布   波动      波动      波动        波动\n\n注：\n\n * 异常率(PV) = 异常PV / 所在页面PV\n * 异常率(UV) = 异常UV / 所在页面UV\n\n从上面的对照表可以看出，理论上我们只需要关注异常率(UV) 是否正常波动就可以了。\n\n理想很性感，现实很骨感。\n\n我们的数据仓库、数据分析系统对于实时 PV 有很强的处理能力，但是对于 UV 就感觉力有不逮。\n\n起初想到在实时日志处理逻辑中使用缓存（伪代码）：\n\n\n\n * 但是实时数据分析系统是分布式的，由多台服务器组成的集群同时处理日志，所以里面 的内部状态只有本机有效\n * 另外更致命的是，实时数据分析系统是无状态的，下次执行会 new 新的 LogParser 实例， 同一台机器的状态也保证不了。\n\n于是我们又想到一种从客户端来标识用户的方法：\n\n 1. 客户端单位时间内同一个页面抛出的同一个异常，第一次打上 uv 标记。\n 2. 数据处理时遇到 uv 标记的日志，同时统计算做一个异常 uv。\n\n由于客户端时间和服务端有时间差，每个客户端时间和服务端时间差也不一致，导致这种 方案会有稍大误差，但也基本能解决问题。\n\n但是要在客户端打标记，则需要在客户端（cookie 或其他本地存储）记录每个异常 （url, file, line, message\n相同被当作同一个异常）最后抛出的时间，每次抛出异常 都需要读写本地存储，稍嫌臃肿。\n\n通过深入分析实际的攻击案例，发现攻击引发大量异常的场景中，客户端页面是不刷新或 重新访问的，都是直接在当前访问的页面执行上批量脚本。\n\n因此我们可以使用局部变量，将当前访问的页面的每个异常最后抛出时间记录在内存中， 重新访问页面则重新开始记录。\n\n这种方案对于防范攻击造成的大量异常非常有效；对于大量用户涌入引起的异常也有一定 效用，毕竟正常用户较少会频繁触发异常。\n\n总之，通过这个方案，我们可以非常有效的实时监控异常波动，较少误报。\n\np.s. 这个想法是早上洗澡的时候想到的，还没开始实践。但是我信心满满写下这篇， 数据会来证明我是对的。\n\n\n续 on 2013-08-20#\n\n是时候结帐了。正好发布一天，大家看数据：\n\n\n\n图中的灰色竖线是发布点，橙色是 JavaScript 异常，绿色是静态资源异常。\n\n妈妈再也不用担心我的手机会收到误报的报警短信了。","routePath":"/blog/post/2013/weekly-topic-about-exceptions-4","lang":"zh-CN","toc":[{"text":"续 on 2013-08-20","id":"续-on-2013-08-20","depth":2,"charIndex":1370}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-08-07T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":165,"title":"每周异常：第 5期，由静态资源异常引发的质疑","content":"#\n\n今天要说的是一个『静态资源异常监控』的话题。虽然静态资源异常可以非常有效的跟 JavaScript 异常结合起来做有力的分析，但是今天这个话题跟\nJavaScript 异常没什么关系。\n\n--------------------------------------------------------------------------------\n\n传说某著名公司的网站监控方案是申请了专利的技术，我有幸看到过，真的是非常牛逼。\n\n这个网站监控方案中提供了网页的访问量、页面访问流向、页面有效点击量、点击热图， 灰度发布（包括 ABTest）等都有完善的支持。\n\n这个方案总体上是用 JavaScript 通过 new Image() 发送监控的数据到日志服务器， 然后由数据仓库做数据清洗。\n\n通过业务系统服务器端的日志分析，这套方案的数据质量有确实有一定的问题， 比如它统计到的访问量要比业务系统服务器端统计到的少，丢失率一般在 5% ~ 10%\n左右， 少量特殊页面（比如跳转页）丢失率会高达 50% ~ 60%。\n\n尽管如此我们也基本上可以接受这样的误差，而且部分从理论上讲，『应该』大部分是 无效或无意义的访问（比如爬虫、快速跳转等），丢掉是合理的。\n\n一直以来，我们都认为这个方案的数据是相对比较可靠的，虽然偶尔有些不正常的丢失率 让业务方质疑，但是我们总是用上面的理论和理由解释给对方听，让他们接受我们的现实。\n\n这样过了好多年，他们过着幸福的生活~\n\n--------------------------------------------------------------------------------\n\n直到有个家伙的膝盖被射了一箭，搞出来个静态资源监控系统。\n\n静态资源监控系统是通过分析静态服务器的访问日志，来统计各个资源状态的趋势及其分布情况。\n\n因为静态资源监控是通过静态服务器访问日志来分析的，理论上和业务服务端的日志是一致的。\n\n但是我们惊奇的发现某个静态页面引用了某个不存在的静态资源，异常率理论上应该是 100%， 但是对照网站监控方案统计的数据发现，这个静态资源异常率高达 200%。\n\n我的第一直觉是网站监控丢失率高达 50%。遂跟网站监控相关同学沟通，然后他们第一反映 是质疑我对他们的质疑。\n\n让业务服务端同学统计日志发现他们的访问量确实要大于网站监控访问量，但又小于静态资源异常量。\n\n我虽然毫不怀疑自己的数据，但一时也无法质疑业务服务端的数据。\n\n业务服务端同学随意说了一句：『难道有缓存？』\n\n于是这个疑惑破解了：\n\n 1. 用户访问页面时，有一部分可能是读取的本地缓存，这部分业务服务端无法统计到。\n 2. 有些读取缓存的场景不会执行初始化 JavaScript，这些场景网站监控没有统计到。\n 3. 外联的 404 资源是不会被缓存的。\n\n因此这些有缓存的静态页面（这个知名公司有不少页面是这种纯静态、伪静态页面）的场景下，使用 JavaScript 发送监控的监控手段目前丢失率是 50% 左右。\n\n\n参考#\n\n * Caching problem with asynchronous javascript loading with onload event\n * IE6 加载不执行 JS\n * IE6 加载不执行 JS 2\n * 因为缓存Page_Load不执行的情况\n * Opera在点击回退按钮后，原来页面的js都不执行了吗?\n * Detecting when a page is loaded from the browser cache","routePath":"/blog/post/2013/weekly-topic-about-exceptions-5","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":3,"charIndex":1286}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-08-16T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":166,"title":"每周异常：第 6期，JavaScript 异常监控脚本引发的 JavaScript 异常","content":"#\n\n\n背景#\n\n早上收到比较重要的用户反馈说某个重要的系统的页面在 IE 浏览器中卡死，无法继续。\n\n\n\n问题很严重。\n\n系统比较特殊复杂，不是一般人能登录进去的。找到对应同学在小概率重现的情况下终于拿到了第一手的问题源码。\n\n\n分析#\n\n修改配置和采样率之后在本地跑起来，发现在 IE6 里非常有问题。\n\n 1.  性能这么大的问题，首先想到的是页面中大面积扫描 HTML 代码的部分，但是注释掉这部分仍然没有改善。\n\n 2.  再次把整个回调处理函数注释掉，仍然没有改善。\n\n 3.  直接把加载后置脚本的 seajs.use 注释掉之后，终于没问题了。（坑爹的缓存问题就不说了，好久之后才发现，都是泪~）\n\n 4.  这么看来有两种可能：\n\n 5.  模块本身有性能问题。\n\n 6.  seajs 性能有问题（这个问题页面目前使用的 1.3.1）\n\n 7.  首先考虑自身的问题。return 整个 factory，性能无问题，因此不是模块过多导致 seajs 性能问题。\n\n 8.  逐步修改 return 位置（其实可以打断点），终于发现问题出在 初始化事件绑定函数部分。\n     \n     \n\n 9.  此时 _events = undefined。访问 undefined.length 或其他属性会导致浏览器挂起？ IE6 还有这样的坑？\n\n 10. 新建一个最小代码的新页面，直接 script[src] 引入这个脚本没有问题，IE 会正常的抛出异常，不会挂起。\n\n 11. 动态创建 script 插入脚本，仍然不会挂起，正常抛出异常。\n\n 12. 奇怪。各种尝试，最终加入前置脚本后在这个最小重现代码中重现了异常。\n\n 13. 然后发现是在 window.onerror 中出现问题。\n\n 14. 继续发现的模拟调用栈信息的算法出现问题。\n\ncmd 模块在 define 的 factory 中本身抛出异常，会被前置脚本的 window.onerror 捕获，捕获过程中尝试\n还原函数调用栈。模拟还原调用栈信息是通过 arguments.callee.caller 向上递归，直到找到函数调用的发起者。但是悲剧的是发现 seajs\n这个调用栈是无穷无尽的：\n\n\n\n这也就是为什么用户的浏览器会挂起的原因。\n\n--------------------------------------------------------------------------------\n\n\n小结#\n\n用户浏览器被挂起，最终发现：\n\n * 不是扫描整个文档的性能问题。\n\n * 不是 seajs 加载多个模块的性能问题。\n\n * 主要不是 cmd define 中报错的问题。\n\n * 不是 window.onerror 捕获异常的问题。\n\n * 而是获取异常函数调用栈出现无限循环链的问题，\n\n * 这其实是 IE 的问题。\n\n * 好吧，最终还是我的问题。\n\n\n监控脚本自身的 cmd 模块定义的异常是怎么出现的？#\n\nmonitor 2.2.0 新增了 事件机制，支持监控任意的自定义数据。\n\n其中在前置脚本中新增了 monitor.on() 方法，将自定义事件处理函数临时存储在 monitor._EVENTS 属性中 参考代码\n。后置脚本加载完成后，会复写 monitor.on() 方法，并将之前用户自定义事件处理函数绑定到对应事件，以使事件机制生效。\n\n这些理论上都是非常不错的设计思路。\n\n但是现实太残酷，全站公共区域被实际部署的情况有太复杂：\n\n 1. 有些系统没有完全引入前置脚本。\n 2. 有些系统仍然引用的老版本的前置脚本。\n\n后置脚本对于后面的这个场景没有考虑到，因此这段保险栓未能正确执行导致后续脚本报错。\n\n\n为什么这个异常会到生产环境？#\n\n都是我的错，没有考虑周全。没有考虑到这种特殊的系统部署环境，而且我也从来不能进去实际体验、验证。\n\n\n如何处理这个异常？#\n\n 1. 作为全站全局运行的代码，要详细评估考虑到各种系统变态的部署环境。\n 2. 打断循环调用栈\n 3. 限制监控的最大函数调用栈深度。\n 4. 对于已经调用的栈，不再深入递归，或现在递归次数（待评估，实际项目存在正常的递归或多次调用的代码。）\n\n\n为什么 seajs define 模块中报错会出现函数调用栈无限递归？#\n\n这是 seajs 1.3.1 的 BUG，更准确的说，可能是 IE6,7,8闭包的问题。参考：\nhttps://github.com/seajs/seajs/issues/911","routePath":"/blog/post/2013/weekly-topic-about-exceptions-6","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"分析","id":"分析","depth":2,"charIndex":115},{"text":"小结","id":"小结","depth":3,"charIndex":1050},{"text":"监控脚本自身的 cmd 模块定义的异常是怎么出现的？","id":"监控脚本自身的-cmd-模块定义的异常是怎么出现的","depth":2,"charIndex":1237},{"text":"为什么这个异常会到生产环境？","id":"为什么这个异常会到生产环境","depth":2,"charIndex":1574},{"text":"如何处理这个异常？","id":"如何处理这个异常","depth":2,"charIndex":1642},{"text":"为什么 seajs define 模块中报错会出现函数调用栈无限递归？","id":"为什么-seajs-define-模块中报错会出现函数调用栈无限递归","depth":2,"charIndex":1779}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-08-22T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":167,"title":"每周异常：第 7期，保持简单，保持拙朴","content":"#\n\n\n副标题：如何简单有效的发现最重要的有效异常#\n\n> Keep It Simple, Stupid.\n> \n> -- U.S. Navy (1960)\n\n在这之前，我一直苦苦寻求牛逼的算法 #12 ， 来解决这个看似简单，其实不易；仿佛不易，最终简单的问题： 找出最重要的有效异常。\n\n最早的时候，我们定义了『一个异常』由以下核心部分组成：\n\n * URL: 异常所在页面。\n * File: 异常代码所在文件。\n * Line: 异常代码所在行数。\n * Message: 异常消息。\n\n这些是不变的，相同页面中，同一个异常代码文件同一行，异常消息相同的异常，我们可以近似的认为它是同一个异常。\n\n另外还定义了异常率：\n\n * 异常率(PV)：『一个异常』的 PV，除以这个异常所在页面的 PV。\n * 异常率(UV)：『一个异常』的 UV，除以这个异常所在页面的 UV。\n\n于是我们通过 URL, File, Line, Message 四个核心信息来统计每一个异常的 PV, UV, PV异常率，UV异常率。\n并按照其中的某个字段为主进行排序。\n\n但是得到的结果总是让人不尽如人意，总会有很多无法排查，甚至还有一些显然不是我们代码的问题的异常排前排。\n\n我们尝试限制异常 PV, UV 的基数，尝试限制页面 PV, UV 的基数，结果仍然不理想。 而且也没有想出其他牛逼的权重算法来评估每个异常。\n\n我们想过异常是跟代码所在文件和行号、异常消息有关系的，跟页面 URL\n的关系不那么强，因为公共代码会在很多页面使用，把这同一个异常分散算到不同页面中会严重影响这个异常的排名。\n\n但是实际上公共代码（尤其是基础类库）的异常很多情况下是业务系统调用不当，或者使用的版本有 BUG\n导致，最终还是需要这个页面的开发者调整调用方法，或升级使用更新的公共脚本来解决。所以忽略或弱化异常所在页面是不可接受的。\n\n而且排除了异常所在页面的信息，对于排查异常来说更为困难。\n\n够了，我已经受够了，脑袋一片浆糊。 累、困，早点回家睡觉。\n\n--------------------------------------------------------------------------------\n\n回到家随手画了几笔，然后去洗澡。洗澡的时候想着刚刚画的思维草图，逐渐想清楚了很多。\n\n * File: 由于是 seajs 自动管理依赖，以及 combo 的使用，异常所在文件本身具有不稳定性。\n * Line: 由于上面 File 的原因，不仅仅是 HTML 代码中的异常行号不稳定，静态脚本异常行号也具有不稳定性。\n * Message: 不同浏览器（包括不同版本，或者在不同操作系统中）对同一个异常有不同的消息反馈，另外还有本地化的原因，异常消息也具有不稳定性。\n\n最后，只有异常所在页面 URL（或者页面 ID，一个页面源文件可能有多个 URL 地址，但是它们是有关系的，ID 相同）才是最稳定的。\n\n--------------------------------------------------------------------------------\n\n于是我根据页面 URL 排列出每个页面的异常 PV, UV, PV异常率，UV异常率。并根据 PV\n异常率为主进行倒序排序（每次访问都抛出的异常，比每个用户访问都抛出的异常的优先级更高）于是我们轻易得出了全站异常率最高的页面。\n\n根据这个关键的页面信息，再次查询出每『一个异常』的 PV, UV, PV异常率，UV异常率。\n\n以不变（页面 URL 或 ID），应万变。我们一个个把这些异常大户揪出来，各个击破。即使暂时没有发布解决，我们仍可以轻易识别排除这个已经揪出的异常。\n\n好了，妈妈再也不用操心我的每周异常 TOP 数据分析了。\n\n嗯， #12 这个 issue 也可以关了。\n\n--------------------------------------------------------------------------------\n\n在做静态资源异常监控时，也有类似的经历。\n\n静态资源监控最重要的是发现哪个页面引用了哪个 404资源，尤其是漏发的资源。因此最重要的有两个关联维度：\n\n * 404资源所在页面\n * 404资源文件地址\n\n但是引起 404 的场景很多，包括：\n\n * 漏发文件。\n * 静态引用地址错误。\n * 动态引用地址错误。\n\n其中动态引用是由于动态脚本计算得出的静态资源地址，引发的 404\n非常频繁，多样、而且分布的很散。因此这两个维度的排列组合结果就非常巨大。而且我们的分析系统是基于索引的，这些内容不确定、数量庞大的指标非常不适合用这个系统分析。\n（我们还有另一个非常时候实时异常分析的系统，这里不做介绍）\n\n因此我们把重心放在更为稳定的页面 URL，只关注出现 404 的页面，至于是什么资源可以直接根据 URL 查询日志，或直接访问这个页面。\n\n\n小结#\n\n这篇讲的几个关键内容再强调下：\n\n * 保持简单，保持拙朴。\n * 抓住重点，真正的核心重点。\n\n--------------------------------------------------------------------------------\n\n终于可以睡了，晚安~","routePath":"/blog/post/2013/weekly-topic-about-exceptions-7","lang":"zh-CN","toc":[{"text":"副标题：如何简单有效的发现最重要的有效异常","id":"副标题如何简单有效的发现最重要的有效异常","depth":2,"charIndex":3},{"text":"小结","id":"小结","depth":2,"charIndex":2085}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-08-28T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":168,"title":"每周异常：第 8期，异常象限","content":"#\n\n上周的 每周异常：第 7期，保持简单，保持拙朴 中介绍了通过页面关键的 URL/ID 信息，简单有效的发现异常的方案。\n本周我们在这个异常分析方法之上，再稍微深入下：\n\n对于整个网站来说，每个系统、页面是有重要级别的，比如支付宝收银台就是 A1 级系统。 这些系统、页面一般可以按照以下方法来判断重要性：\n\n * 访问量极大，是最主要的业务，对用户影响极大。\n * 用户本身重要（例如商户，尤其是大商户），是最重要的业务，对企业影响巨大。\n\n对于前者，我们可以通过系统、域名的访问量来近似的划分； 对于后者，我们可以建立白名单机制。\n\n对于异常来说，可以通过异常率来判断异常自身的紧急程度。\n\n--------------------------------------------------------------------------------\n\n * 系统、页面重要性作为『异常重要性』的一个指标。\n * 异常率及异常量作为『异常紧急程度』作为一个指标。\n   * 异常率超过阈值的为高发率异常。\n   * （可选）异常量超过阈值的也是高发量异常。\n   * 并且以高发率为主。\n\n我们画出以下异常象限：\n\n\n\n * 图中一、二、三、四为象限代号。\n * (0, 1, 2, 3) 为异常重要性序号。\n\n经过一些分析，我们可以得出结论：\n\n * 第一、第二象限的异常，是我们最需要关注的部分。尤其是第一象限的异常， 实时高发异常一般也是在这个象限。\n\n * 第四、三象限的低发异常，则几乎可以不用关注。\n\n * 总之我们只需要关注高发异常，但应该以页面的重要性来排优先级。\n\n\n如何设定阈值？#\n\n要确定异常象限，确定各个阈值是关键，这里只提供一些简单的参考。\n\n * 重要程度：全站重要页面占全站所有页面的 5% 左右，可以根据自身情况调整。\n * 紧迫程度：\n   * 目前的经验数据是异常率 4‰ 以上可以认为是高发率异常，但仍需继续 分析实际数据做调整。\n   * （可选）异常 PV 超过 (全站访问最高页面 PV 乘以 1‰) 的也可以认为是高发量异常， 实际可以根据自身情况调整。","routePath":"/blog/post/2013/weekly-topic-about-exceptions-8","lang":"zh-CN","toc":[{"text":"如何设定阈值？","id":"如何设定阈值","depth":2,"charIndex":697}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-09-05T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":169,"title":"每周异常：第 9期，搜狗浏览器中神一样的 try/catch 特性","content":"#\n\n\n背景#\n\n某日 16时 30分，监控实时大盘中全站 JavaScript 异常和 404 异常分别朝着不同的方向延伸， 橙色的 JavaScript 异常急剧上升。\n\n\n\n详细数据中我们看到一向高标准高质量的收银台出现异常大量的异常。\n\n\n\n\n排查#\n\n我们发现其中有两个页面异常最多，而这两个页面中异常最多的『一个异常』详情如下：\n\n * File: 同页面 URL\n * Line: 1\n * Message: Uncaught SyntaxError: Unexpected token a\n\n客户端信息：\n\n * pc/-1;windows/5.1;sg/2.x;webkit/535.1\n * pc/-1;windows/6.1;sg/2.x;webkit/535.1\n\n堆栈信息：\n\n\n\n分析过程非常艰辛，重现异常的过程也是一波三折，这里不做赘述，最终分析得出：\n\n * 搜狗浏览器的 userAgent 太坑爹，几乎所有版本都是 2.x，开发者太不专业了。最终找到内核为 webkit/535.1 的是 3.2 版。\n\n * 重现到老版 arale 中的 ajax 模块中对 JSON 有特殊的处理，如果浏览器内置的 JSON 不支持非标准的 JSON （如 {a:1}）则\n   hack 做兼容。\n   \n   \n\n * 抛出异常的代码是 JSON.parse(\"{a: 1}\")\n\n * 但奇怪的是这段代码是放在 try/catch 中，为什么还会有异常被监控捕获？\n\n * 最终发现这是搜狗浏览器 3.2版极速(webkit)模式中的特性：即使 try/catch 住的异常， 同样会被 window.onerror\n   捕获，但并未因此中断业务逻辑，后续的代码仍然会按照正确的 try/catch 异常处理流程进行，所以对业务本身没有影响。\n\n * p.s. 搜狗浏览器没有控制台，用户不会知道出了异常。\n\n * 另外收银台之前异常量少的主要原因是主要的页面没有引入前端监控，用户抛出了异常而我们不知道而已。\n\n\n相关截图#\n\n\n\n\n解决方案#\n\n最初虽然有些争议，但我们最终决定的处理方案是监控中临时排除 sg/2.x|webkit/535.1 中 Uncaught SyntaxError:\nUnexpected token a 异常。\n\n\n是否要排除这个浏览器中所有的异常？#\n\n呃，考虑到搜狗浏览器的份额，我们的策略是只排除已知的异常，未知的异常看最终分析结果再考虑。\n\n\n广告#\n\n这个异常排查的主要功臣 @wsvn53，我们在排查过程中频繁使用了他开发的工具 Fedit，可以直接修改线上代码。 排查线上故\n障、线下接⼝什么的都非常⽅方便。强烈建议⼤家都装上⽤用。\n\n\n最后#\n\n我仅代表我自己，想说某些毫无责任心的国产浏览器壳厂商们，你们没有创造价值， 只是在各种不同方式的索取。","routePath":"/blog/post/2013/weekly-topic-about-exceptions-9","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"排查","id":"排查","depth":2,"charIndex":125},{"text":"相关截图","id":"相关截图","depth":2,"charIndex":873},{"text":"解决方案","id":"解决方案","depth":2,"charIndex":883},{"text":"是否要排除这个浏览器中所有的异常？","id":"是否要排除这个浏览器中所有的异常","depth":3,"charIndex":989},{"text":"广告","id":"广告","depth":2,"charIndex":1057},{"text":"最后","id":"最后","depth":2,"charIndex":1157}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2013-09-13T00:00:00.000Z"},"2":{"tags":"每周异常"}},"version":""},{"id":170,"title":"代码风格之争的终结","content":"#\n\n代码风格分为两种：\n\n 1. 表现风格。从视觉上看的表层代码格式风格。\n 2. 逻辑风格。从逻辑习惯及算法上的隐式风格。\n\n就像写文章，也分为：\n\n 1. 段落、标点等视觉表现风格。\n 2. 和逻辑顺序、排比等句式、小说诗歌等隐性的风格。\n\n文学在很早之前就已经相对固定了表现风格，虽然现在有少量的如段落是否要缩进的争论， 但都无伤大雅。\n\n所以从早期的一人独立完成写作，还是现在的多人协作合著书籍，在表现风格上，都没有 太大的差异和争议。\n\n但是计算机编程的代码风格之争从未间断，没有一种代码风格可以一统天下，而编程当中 的团队多人协作又非常常见，这便导致每个团队都会有代码风格指南或规范，甚至需要\n使用 hint/lint 工具来检查。这导致团队内、团队间、团队外的合作都会出现分歧和争论。\n\n特殊的，Python 这种从语法层面来定义代码风格的编程语言是个例外。文章的部分风格， 如标点，也是语法层面定义好的。\n\n\n常见的代码风格#\n\n\n空白缩进#\n\n\n花括号缩进#\n\n对于传统的如 C, C++, Java 语言，使用花括号限制作用域，有不同的缩进风格。\n\nK&R 风格[1]：\n\n\n\n微软风格：\n\n\n\n\n参考#\n\n * [1] (注：1978年贝尔实验室正式发表了 C 语言。同时由 B.W.Kernighan 和 D.M.Ritchie (K&R) 合著了著名的《The\n   C Programming Language》一书。 书中推荐了一套代码编写标准，有人称之为《K&R》标准。)","routePath":"/blog/post/2014/2014-08-代码风格之争的终结","lang":"zh-CN","toc":[{"text":"常见的代码风格","id":"常见的代码风格","depth":2,"charIndex":413},{"text":"空白缩进","id":"空白缩进","depth":3,"charIndex":424},{"text":"花括号缩进","id":"花括号缩进","depth":3,"charIndex":432},{"text":"参考","id":"参考","depth":2,"charIndex":509}],"domain":"","frontmatter":{"0":{"date":"2014-08"},"1":{"author":"闲耘<hotoo.cn@gmail.com>"},"2":{"status":"draft"}},"version":""},{"id":171,"title":"阿里巴巴三年醇","content":"#\n\n今天 @玉伯 给我送来的三年醇礼物。\n\n一个阿里真棒玉坠。\n\n\n\n三周年成（阿里）人手印礼。\n\n\n\n和女朋友一起用手印礼多出来的印泥自制的小猪猪。\n\n\n\n感谢阿里。","routePath":"/blog/post/2014/alibaba-3-years","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-02-25T00:00:00.000Z"},"2":{"tags":"Life"}},"version":""},{"id":172,"title":"转换 Vimwiki 为 Markdown","content":"#\n\n> sed -f ex -i *.md\n\n\nREADME#\n\n相对 Wiki 语法，和 Wiki 对应工具支持情况，我更加喜欢 Markdown 了。 本地配合使用 Vimwiki 来编辑查看，发布使用 nico\n来转换，而且有 Github 的原生支持， 使用 Markdown 是不二之选。\n\n为了减少转换工作量，我简要写了这个脚本，可以初步将 vimwiki 语法的项目， 自动转换成 markdown 语法。\n\n转换的内容包括：\n\n * header\n * codes\n * wikiword.\n * links\n * images\n * comments\n * %toc\n * %title\n * %nohtml\n\n\nUsage#\n\n假设上面的脚本保存结构如下：\n\n\n\n在 convert.sh 同级目录执行：\n\n\n\n然后自动或手动调整之后，删除 .wiki 文件即可。\n\n\nCodes#\n\n\nconvert.sh#\n\n\n\n\nex#\n\n","routePath":"/blog/post/2014/convert-vimwiki-to-markdown","lang":"zh-CN","toc":[{"text":"README","id":"readme","depth":2,"charIndex":24},{"text":"Usage","id":"usage","depth":2,"charIndex":316},{"text":"Codes","id":"codes","depth":2,"charIndex":395},{"text":"convert.sh","id":"convertsh","depth":3,"charIndex":404},{"text":"ex","id":"ex","depth":3,"charIndex":420}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-03-31T00:00:00.000Z"},"2":{"tags":"Vimwiki, Markdown"}},"version":""},{"id":173,"title":"定位到服务器集群的特定节点","content":"#\n\n> 齐宣王使人吹竽，必三百人。南郭处士请为王吹竽，宣王说之，廪食以数百人。 宣王死，湣王立，好一一听之，处士逃。\n> \n> 《韩非子·内储说上》\n\n\n背景#\n\n某日，突然收到报警，某发现实时异常监控趋势图上，静态资源 404 异常有明显的上升。 分析详细的异常信息发现是某个发布操作引起某几个系统引起的。\n\n--------------------------------------------------------------------------------\n\n找到对应的开发，分析结论是部分配置文件未生效，导致拼接资源文件地址错误。 按照业务量计算，这个异常量大约是其中一、两台机器有问题。\n\n可能发布系统或其他问题，重新发布一次仍没能修复这个异常。\n\n我们需要快速定位到这只滥竽，尽快将问题修复。 但是实际上却没有这么简单，我们最终花费 了 7个多小时，最终是因为这个系统正好有 其他发布才顺便解决。\n\n\n\n上图有两个造成异常的发布，分别是『CMS 发布』和『后台系统发布』。\n\n橙色是 JavaScript 实时异常，绿色是静态资源 404 异常。\n\n\n方案#\n\n事后我们坐下来讨论如何解决这个问题，避免在以后遇到类似问题时能快速有效的应对。\n\n\n\n如上图，问题出在某个问题业务应用服务器节点配置文件未生效，拼接出来的 JavaScript 资源地址不正确导致 CDN\n节点未命中而最终回源，源服务器也没有这个文件，最终发生 404 悲剧。\n\n实际的业务系统中，会提供用户访问的节点信息，但是请求静态资源时无法获得这个信息， 是不是有办法在静态资源源服务器上获得来源页面所在的服务器节点信息呢？\n\n 1. 方案一：我们首先想到 Cookie。但是应用服务器和静态资源服务器分别在不同的域名 下，即使在访问应用服务器时写入节点信息到 Cookie\n    中，这个信息也不会携带到静态 资源服务器。『失败』。\n 2. 方案二：CDN 节点域提供外部写 Cookie 的接口，用户访问应用服务时，同时调用接口 在 CDN\n    节点所在域写入用户访问应用服务器节点信息。『放弃』，缺点：\n 3. 成本高。\n 4. 风险大。\n 5. 方案三：然后想到每个应用系统重写静态资源地址，在地址中携带当前应用服务器节点 信息。『放弃』，缺点：\n 6. 成本过高。\n 7. 导致 CDN 命中率下降。\n 8. 方案四：重写用户访问页面地址，附带应用服务器节点信息。成本过高，『放弃』。\n\n从前端角度直接解决这个看似无望，换个思路。\n\n 5. 方案五：在网络内部，使用内部代理。如 curl -I -x internal-host:port url 『可行』，缺点：\n 6. 需要在服务器所在内网执行，指定目标服务器内部 IP，因此只有系统管理员可以操作。\n 7. 而系统管理员不清楚实际应用业务。\n 8. 方案六：如果可以在外部指定服务器节点访问应用，是不是可行呢？\n\n这个跟负载均衡规则有关，如果负载均衡服务器支持这个特性，或可一试。\n\n跟相关同学沟通后，表示可以做。而且从外网直接访问，清楚业务的开发同学可以自行 排查。\n\n『可行』。需要注意的问题：\n\n\n\n 7. 方案七：客户端脚本扫描所有外部资源，并发起请求来确认各个资源状态。『放弃』， 缺点：\n\n * 增加静态资源服务器压力。\n * 增加网络请求和流量。\n\n 8. 方案八：客户端脚本监听静态资源异常事件。HTML5 现在提供了 Performance Timing\n    API，可以用来监控网页及其引用的外部资源加载时间，将来提供类似的 API 可以监听 静态资源的 error 事件也未可知。『期待』\n 9. 方案九：Web 服务器端输出时拦截器扫描。尤其目前前端往后端延伸，能做的事情更多 了。『可行』。\n\n\n结论#\n\n综上所述，在成本、风险、自动化、扩展性等方面来讲，方案九是最优的。\n\n\n延伸思考#\n\n图二所示，这次问题出在业务应用服务器集群的节点 1。\n\n * 如果问题节点是静态资源 CDN 集群的节点 2 呢？\n * 问题节点是节点 3？","routePath":"/blog/post/2014/find-nodes-from-server-cluster","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":77},{"text":"方案","id":"方案","depth":2,"charIndex":487},{"text":"结论","id":"结论","depth":2,"charIndex":1594},{"text":"延伸思考","id":"延伸思考","depth":2,"charIndex":1635}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-04-17T00:00:00.000Z"},"2":{"tags":"CDN, 每周异常"}},"version":""},{"id":174,"title":"GitHub, GitLab, or BitBucket?","content":"#\n\n> GitHub 是汇集了众多开源项目的闭源系统，\n> \n> GitLab 是汇聚了较多闭源项目的开源系统。\n> \n> -- @hotoo\n\n对于个人开发者，不可避免的会有私有项目的需求。\n\n目前比较靠谱的私有项目托管服务有：\n\n * GitHub\n * GitLab\n * BitBucket\n\n下面我们稍做评比。\n\n\nGitHub#\n\nGitHub 当下大红大紫，主要在于其社交性质。\n\n对于开源项目来说，上面大量的开发者参与带来了非常活跃的开发氛围。\n\n但是对于私有仓库来说，个人觉得价格偏贵（屌丝气质暴露）。\n\n而且个人账户下的私有仓库，不能共享给个人所拥有的团队账户，因此如果团队账户需要 私有仓库，则需要另外再为团队账户购买。\n\n如果不缺钱，可以考虑 GitHub，甚至还有 Enterprise 版本。\n\n\nGitLab#\n\nGitLab 是当下最火的 Git 仓库管理的开源项目，有提供的 gitlab.com 服务，同时可以自行部署。\n\ngitlab.com 服务可以创建不限数量的私有仓库，除了少量的缺点外，GitLab 几乎可以 媲美 GitHub。\n\n但是，作为完美主义者，真的受不了 GitLab 的一些小伤疤。\n\n\nBitBucket#\n\nBitBucket 是 Atlassian 公司的产品 （还有 Confluence，JIRA， HipChat 等著名产品）。\n\n个人觉得除了 Issues 不够简洁之外，其他都很完美。 适合小团队私有项目托管。\n\n\n对比#\n\n             GITHUB                            GITLAB                           BITBUCKET\n私有仓库         收费教育身份赞助 2年的 Micro Plan           免费，无限制                           免费，限制协作人数\n权限控制         个人账户无控制团队账户有限控制                   仓库级控制指定一个保护分支                    分支级控制\nTransfer     完美                                几乎完美                             完美\n仓库重命名        完美                                不能修改 clone 地址                    完美\n仓库名          完美                                不能使用 .，自动修改为 -                   完美\nIssues       完美                                功能复杂，但界面简洁早期有 Issues ID 缺陷，已修复   功能复杂，界面不够简洁\nIssues URL   完美                                完美                               默认附加可选的标题信息\nPages        username.github.io 仓库gh-page 分支   demo 分支                          username.bitbucket.org 仓库\n自定义域名        每个仓库都可以自定义域名                      无                                个人 Profile 页\n\n\n小结#\n\n * GitHub 适合开源项目管理。不缺钱的同学，私有项目也适合统一在 GitHub 管理。\n * GitLab 和 BitBucket 都很适合私有项目的管理。\n * GitLab 是开源项目，活跃程度很高，未来很有潜力，如果不在乎那些小硬伤，个人更推荐 GitLab。\n * BitBucket 系出名门，产品本身也非常好，没有明显的伤疤，作为完美主义者，我目前稍喜欢这个。","routePath":"/blog/post/2014/github-gitlab-or-bitbucket","lang":"zh-CN","toc":[{"text":"GitHub","id":"github","depth":2,"charIndex":163},{"text":"GitLab","id":"gitlab","depth":2,"charIndex":363},{"text":"BitBucket","id":"bitbucket","depth":2,"charIndex":524},{"text":"对比","id":"对比","depth":2,"charIndex":646},{"text":"小结","id":"小结","depth":2,"charIndex":1551}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-08-03T00:00:00.000Z"},"2":{"tags":"Git"}},"version":""},{"id":175,"title":"深入 JavaScript Date 对象","content":"#\n\n * GMT Greenwich Mean Time 格林尼治标准时间\n\n * CST Central Standard Time (USA) UT-6:00\n\n * CST Central Standard Time (Australia) UT+9:30\n\n * CST China Standard Time UT+8:00\n\n * CST Cuba Standard Time UT-4:00\n\n\n参考#\n\n * Date.UTC() for years between 0-100","routePath":"/blog/post/2014/javascript-new-date","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":205}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2015-01-13T00:00:00.000Z"},"2":{"tags":"JavaScript"},"3":{"status":"draft"}},"version":""},{"id":176,"title":"多多益善","content":"#\n\n> 子貢問：「師與商也孰賢？」 子曰：「師也過，商也不及。」 曰：「然則師愈與？」 子曰：「過猶不及。」\n> \n> ——《論語‧先進》\n\n有很多设计师迷信『少既是多』，认为让用户操作步骤『简化』到越少越好。 每每他们祭出这个杀招，其他人便无以辩驳，至多以成本、时间之类的来搪塞。\n\n\n参考#\n\n * 小细节大作为：提高iOS访问权限通过率有这几个办法","routePath":"/blog/post/2014/more-is-less","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":144}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-04-25T00:00:00.000Z"},"2":{"tags":"UED"},"3":{"status":"draft"}},"version":""},{"id":177,"title":"人事档案丢失记","content":"#\n\n\n背景#\n\n * 老家是 A省 A市 A县的农村。\n * 高考被 B省 B市 B大学录取。\n * 大学毕业前在 B省 B2市某公司实习了半年。\n * 大学毕业后，拿了蓝色联报道证，报道单位是『A省教育厅』，报道证有效期是 7月1日至8月1日。\n * 我当时只知道户口，不知道档案的事情，在有效期内托关系挂名在 A县 A公司，落户某某社区。\n   * 转户口时需要 A公司的什么证明。\n   * 在 A县公安局办理。\n   * 验血及简单体检，这时才知道自己的血型。\n   * 拍照片。\n   * 记得还去过人事劳动局，但是干什么就记不清了（恍惚跟档案有关？）。\n * 办好户口就去深圳打工了，没有去 A省教育厅报道。\n * 多年来所在公司不需要档案，也没有办理过户口相关的事情，一直不知道档案的事情。\n\n毕业 8年后我准备把户口调入杭州，咨询公司 HR，说要先把档案调入到杭州。 我想当然以为档案会和户口一起也在 A县，于是我申请了发到 A县劳动人才市场的调档函，\n开始了为期 1年多的寻找之旅。\n\n\n寻找档案#\n\n拿着调档函来到 A县的人才市场、劳动局查档案，都没有找到。\n\nA县的人才市场档案管理员妹子挺热心负责的，不会诳我。说让我去 A市找找看，还帮我 找了相关的联系方式。\n\nA市人才交流服务中心电话不好打入，花了大半天时间才打通，说查过了没有。顺便要了 省人才市场的联系方式。\n\nA省人才市场更难联系上了，经常没人接（不是占线），为此我甚至投诉到 A省某新闻相关单位。\n\n好不容易联系上了，说查了没有。\n\n大伯以前是校长，关系比较多，找他帮忙联系看看。说找过省人才市场某主任，也说没有找到。\n\n整个 A省算是联系遍了，都没有找到。于是尝试各种可能。\n\n大学变化很大，以前的计算机『系』现在升级为『院』了，辅导员老师也升到其他部门工作，\n联系到学校的毕业生就业指导中心老师，李老师非常热心负责，说学校里找过了没有我的档案，\n我的档案是已经邮寄出去了的，并且通过给我发了一张照片，内容是一张表格，上面书写了 都是我们班的同学名字，也包含了我的名字，最下面是邮递员的签名。\n\n学校里这张年代久远的纸张证明了学校是已经将我的档案邮寄出去了的。如果在 2年之内， 是可以去邮局查到底将档案发送到哪里了，被谁签收什么的。但是我的档案太久了。\n当时学校的档案信息还没有电子化，没有详细记录寄往地址等信息（即使有，如果目标寄往处 不承认也没有办法，时间太久了）。\n\n毕业后去了 C省 C市 C公司工作，民营企业，并没有要求档案相关信息，我也从来没有要求过 调转户口到 C市，所以一直没有用到档案。\n\n经过如此，我还是抱着一丝希望，打电话到 C市人才市场、C公司人事部、及C公司所在的区人才市场， 查询我的档案信息。最后当然都没有找到任何信息。\n\n但是记不清是否有签三方协议。问同去并且后来转正的同学， 说是隔了2年才给他们签的正式合同，三方协议的事情也记不清了。\n\n\n补办档案#\n\n\n其他#\n\n * 高考录取之后才真正开始建档，没有正式录取的考生档案是没有什么用的。 所以如果需要补档案也是从高中开始。\n\n\n参考#\n\n * http://www.zhihu.com/question/20994303","routePath":"/blog/post/2014/personal-files-lost","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"寻找档案","id":"寻找档案","depth":2,"charIndex":453},{"text":"补办档案","id":"补办档案","depth":2,"charIndex":1233},{"text":"其他","id":"其他","depth":2,"charIndex":1241},{"text":"参考","id":"参考","depth":2,"charIndex":1303}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-10-24T00:00:00.000Z"},"2":{"tags":"Life"},"3":{"status":"draft"}},"version":""},{"id":178,"title":"二维码个人收款主页","content":"#","routePath":"/blog/post/2014/qrcode-for-alipay-on-me","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-04-04T00:00:00.000Z"},"2":{"tags":"QR-Code"},"3":{"status":"draft"}},"version":""},{"id":179,"title":"译：Resource Timing (资源计时) 使用技巧","content":"#\n\nW3C Web 性能工作组 在 2012 年给我们带来了 Navigation Timing，这个 API 现在\n基本上在主流浏览器上都可用。Navigation Timing 定义了一套用于测量主页面性能的 JavaScript API。例如：\n\n\n\n能够度量主页面的时间消耗真是太棒了，但是要诊断现实当中的性能问题，往往需要深入 到各个资源当中。所以我们拥有了更进一步的 Resource Timing\n（资源计时）规范， 这个 JavaScript API 提供类似 Navigation Timing 的功能，但是能精确到每一个资源的 耗时。举个例子：\n\n\n\n到目前为止，Chrome, Chrome for Android, Opera, IE10 和 IE11 浏览器都支持 Resource\nTiming，这也许超过了你的网站 50% 的流量。 这应该可以提供足够的数据，来揭示这些资源缓慢的原因。\n\n使用 Resource Timing 看似很简单，但是当我在写第一个用于生产环境的 Resource Timing 代码\n时，遇到了许多问题。这里我想分享一些现实当中记录 Resource Timing 指标的实用技巧。\n\n\n1. 使用 getEntriesByType(\"resource\") 而不是 getEntries()#\n\n在使用 Resource Timing 来获取当前页面的资源集合的资源耗时性能对象时，许多 Resource Timing 示例都是使用\nperformance.getEntries()，这意味着唯一的 resource timing 对象 由该调用进行返回。但是 getEntries()\n会一并返回潜在的 4 种类型的 timing 对象： resource（资源），navigation （导航）, mark （标记）, 和 measure\n（测量）。\n\n这并没有造成多大问题，因为目前 resource 是大多数网页的唯一类型。 navigation 类型是 Navigation Timing 2\n的一部分，据我所知目前没有被任何浏览器所实现。 mark 和 measure 类型是从 User Timing 规范衍生出来的，在部分浏览器中可用，\n但是还没有被广泛使用。\n\n也就是说，getEntriesByType(\"resource\") 以及 getEntries() 在今天可能返回相同 的结果，但是可能\ngetEntries() 将很快返回多种性能对象的混合集合，所以最好是 使用\nperformance.getEntriesByType(\"resource\")，你可以明确的只获取 resource timing 对象。（感谢 Andy\nDavies 给我解释这一点）\n\n\n2. 使用 Navigation Timing 测量主页面的请求。#\n\n当通过典型的请求获取一个网页的主 HTML 文档，但是这个资源并不能通过 performance.getEntriesByType(\"resource\")\n得到返回，要得到这个主页面 HTML 文档 的 timing 信息，需要使用 Navigation Timing 对象（performance.timing）。\n\n虽然不太可能，当页面上没有其他资源时，这可能会导致错误发生。 例如，刚才 Resource Timing 示例使用如下代码：\n\n\n\n如果一个页面唯一的资源就是主页面的 HTML 文档，然后 getEntriesByType(\"resource\") 返回一个空数组，这时候应用\nelement[0] 会引起 JavaScript 异常。如果你找不到 没有引用子资源的页面，你可以试试\nhttp://fast.stevesouders.com/\n\n\n3. 小心 secureConnectionStart 的问题。#\n\nsecureConnectionStart 属性我们衡量 SSL 协商需要多长时间。这非常重要，我经常 看到 500 毫秒以上的 SSL\n协商时间，甚至更多。secureConnectionStart 有 3 种 可能的值：\n\n * 如果该属性不可用，则必须设置为 undefined。\n * 如果不使用 HTTPS 的，则必须设置为 0.\n * 如果该属性可用，并且使用了 HTTPS，则必须设置为一个时间戳。\n\n关于 secureConnectionStart，有三件事情需要了解下：\n\n首先，在 Internet Explorer 中，secureConnectionStart 的值总是 undefined， 因为它是不可用的（该值被埋在\n[WinINet](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383630(v=vs.\n85\\).aspx) 之下）。\n\n其次，在 Chrome 中有个 BUG 会导致 secureConnectionStart 被错误的设置为 0 的问题。 如果获取一个资源时使用预先存在的\nHTTPS 连接，则 secureConnectionStart 将被设置 为 0，而实际上它应该是一个时间戳。（详情请参考 bug 404501 ）\n为了避免这个问题，测量 SSL 协商时间时，一定要检查 secureConnectionStart 既不是 undefined 也不是 0：\n\n\n\n第三，规范中关于 这一行 有一些误导：“...如果当前页面的协议是 HTTPS，这个属性必须立即返回用户代理(user agent)开始握手过程的时间...”\n（我的重点）。有可能当前页面是 HTTP，但仍然包含我们需要测量 SSL 协商时间的 HTTPS 资源。 规范应该改为：“...如果资源的协议是 HTTPS\n协议，该属性必须立即返回用户代理开始握手过程的时间...”。 幸运的是，浏览器是使用纠正后的行为，而已就是说， secureConnectionStart\n可用于 HTTP 页面中的 HTTPS 资源。\n\n\n4. 给跨域资源添加 Timing-Allow-Origin HTTP 响应头#\n\n出于隐私保护的原因，在获得资源的 Resource Timing 详情时有跨域限制。 默认情况下，与主页面不同域的资源，下列属性被设置为 0：\n\n * redirectStart\n * redirectEnd\n * domainLookupStart\n * domainLookupEnd\n * connectStart\n * connectEnd\n * secureConnectionStart\n * requestStart\n * responseStart\n\n在某些情况下，仍然希望测量跨域资源的性能，例如，当网站使用不用域名的 CDN（例如 \"youtube.com\" 使用\n\"s.ytimg.com\"），以及某些第三方资源（例如 \"ajax.googleapis.com\"）。 如果资源返回 Timing-Allow-Origin\n响应头，跨域资源的 timing 详情将被授权访问。这个头信息指定了被允许访问 timing 详情的（主页面）来源列表，多数情况下，会使用通配符(*)\n允许所有来源访问。 举个例子，http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\n返回 的 Timing-Allow-Origin 响应头信息是：\n\n\n\n当第三方添加这个响应头信息时，真是太棒了。它允许站长来统计在他们网页上使用的 第三方资源的性能。感谢 Ilya Grigorik\n报告了一些添加了这个响应头的第三方资讯，下面是一些指定了 Timing-Allow-Origin: * 的资源例子：\n\n * Google Hosted Libraries:\n   http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\n * Google+ widgets: https://apis.google.com/js/plusone.js\n * Google Fonts: http://fonts.gstatic.com/s/opensans/v9/DXI[snip...]N3Vs.woff2\n * Facebook widgets: http://connect.facebook.net/en_US/all.js\n * Disqus widgets: http://go.disqus.com/embed.js\n\n当需要访问有限制的 timing 属性时，决定统计 Resource Timing 是非常重要的。\n可以通过检测（上面列出的，secureConnectionStart 除外）限制性属性是否为 0 的方式 来避免限制性问题，我总是使用\nrequestStart。下面是用于在计算详细的性能指标之前， 检测和计算限制性属性是否可用的代码片段：\n\n\n\n做这些检测是非常重要的，否则，当访问这些受限属性时，你不会得到任何异常，除了 这些虚假的数据。当属性受限访问时，它们的值被设置为 0，例如\ndomainLookupEnd - domainLookupStart 翻译成 0 - 0，它返回一个似是而非的结果 0，而这可能并不是真实 DNS 查询时间。\n这将导致过多的指标为 0 而让你过于乐观。\n\n\n5. 理解 0 意味着什么。#\n\n在第 4 节当中提到，一些因为跨域导致的受限访问的 Resource Timing 属性会被设置为\n0。再强调一次，在访问属性详情之前，要检查属性状态是非常重要的。 但是即使受限属性都是可访问的，度量计算的返回结果也有可能是 0，所以理解这意味着\n什么非常重要。\n\n例如，（假设没有访问限制）domainLookupStart 和 domainLookupEnd 的值是两个 时间戳，这两个值之差是该资源在 DNS\n解析上耗时。通常情况下，一个页面中指定的域名 只有一个非 0 的 DNS 解析耗时，因为浏览器会缓存 DNS 解析，所有后续的请求都使用 这个缓存的 DNS\n解析。而且由于跨页面的 DNS 解析缓存，一个页面所有的 DNS 解析 计算结果可能都是 0。关键点：DNS 解析耗时为 0 意味着资源是从缓存中读取的。\n\n同样，对于指定的主机名，如果重复利用已存在的 TCP 连接，那么建立 TCP 连接（connectEnd - connectStart） 的耗时也会是\n0。每个主机有大约 6 个独立的 TCP 连接，这表明应该有 6 个非 0 的 TCP 连接测量值，但是这个主机后续的请求将使用已存在的 TCP\n连接，并且他们的 TCP 连接耗时为 0。关键点：TCP 连接耗时为 0 意味着重复使用了已存在的 TCP 连接。\n\n这同样适用于计算 SSL 协商（connectEnd - secureConnectionStart）。这个可能 有 6\n个以上的资源，但是同一主机名的所有的后续请求可能都使用同一个已存在的 HTTPS 连接，以至于它的 SSL 协商时间为 0。\n\n最后，如果属性持续的为 0，这可能意味资源是从缓存中读取的。\n\n\n6. 确定 304 是否被测量。#\n\n这是另一个 Chrome 稳定版（版本号 36）的 BUG，这个 BUG 在 37 版时被修复。 这个问题已经被修复了，但是由于大多数用户还是使用 Chrome\n稳定版，你当前的性能 指标可能跟实际上的并不相同。这个 BUG 是：一个拥有 Timing-Allow-Origin 的跨域 页面，200 响应状态并不会考虑\n304 响应状态，因此，304 响应下所有的受限属性都 将显示为 0，例如 这个测试页面。\n\n这是不应该发生的，因为从 200 响应的缓存中读取的 Timing-Allow-Origin 头信息 应该应用到 304 响应中。在 Internet\nExplorer 浏览器中就是这样。（可以在 IE 10 或者 11 中尝试 这个页面 来确认。） （感谢 Eric Lawrence 指出这一点。）\n\n这会影响你的 Chrome Resource Timing 结果如下：\n\n * 如果（如第 4 节所述）使用检查 0 值的方式来判断受限字段，则会跳过测量 304 响应， 也就是说值测量了 200 状态响应，但是由于 200\n   状态响应比 304 要慢，所以 Resource Timing 测量总量会比实际的要大。\n * 反之如果不检查受限字段为 0 的情况，会得到许多的 0 值记录， 这实际上又比 304 响应要快，这样 Resource Timing\n   统计结果又会过于乐观。\n\n没有简单的方式来避免这些偏见，但是好消息是这个 BUG 被修复了。另外还可以尝试做的 事情是，304 响应头中发送 Timing-Allow-Origin\n头，不幸的是，流行的 Apache Web 服务器不支持在 304 响应头中发送这个头信息（查看 BUG 51223）。 缺乏进一步证件证明第 4\n节提到那些第三方资源的 304 响应头中的 Timing-Allow-Origin 可以被找到。如前所述，这些第三方资源在 200 响应头中返回\nTiming-Allow-Origin 头， 但是 304 响应头中不返回 Timing-Allow-Origin 头，这真是太好了。 到 Chrome 37\n成为稳定版之前，因为缺少了受限属性的细节，Resource Timing 测量结果 可能偏高或偏低。幸运的是，时间会改变一切。\n\n\n7. 看看 Boomerang（回旋镖）.#\n\n如果你准备写自己 Resource Timing 代码，建议你最好看看 Resource Timing 插件 Boomerang。 （代码在 GitHub\n上。） Boomerang 是 Philip Tellis 维护的一个非常流行的开源 RUM 包。他起初在 Yahoo 工作 的时候就开源了\nBoomerang，而现在作为在 SOASTA 工作的商业版的一部分（mPulse），\n他仍然在持续的提供维护和增强。t它的代码很清晰、简洁和健壮，并解决了上面提到的许多问题。\n\n总之，Navigation Timing 和 Resource Timing 都是非常优秀的新规范，为站长了解他们 的页面性能提供了很好的支持。Resource\nTiming 是这两个规范中更新的一个规范，因此 还是会有一些问题待解决。这些小提示将帮助你充分的利用 Resource Timing 指标。\n我建议你现在就开始监控这些指标，以理解你的网站性能，为了最关心这个问题的真实用户。\n\n> 更新：有一些第三方资源提供了 Timing-Allow-Origin 响应头，以允许站长测量这些 第三方资源的性能：\n> \n>  * Boomerang: http://c.go-mpulse.net/boomerang/CEN[snip...]YQE\n>  * Typekit: https://use.typekit.net/previewkits/pk-v1.js\n\n> 更新：getEntriesByType(\"resource\") 和 getEntries() 不包含 iframe 页面的性能， 如果 iframe\n> 是同源的，可以在父页面通过 contentWindow.performance 对象访问 这些指标。\n\n\n译者补充#\n\n * Resource Timing practical tips - 原文出处。","routePath":"/blog/post/2014/resource-timing-practical-tips","lang":"zh-CN","toc":[{"text":"1. 使用 `getEntriesByType(\"resource\")` 而不是 `getEntries()`","id":"1-使用-getentriesbytyperesource-而不是-getentries","depth":2,"charIndex":-1},{"text":"2. 使用 Navigation Timing 测量主页面的请求。","id":"2-使用-navigation-timing-测量主页面的请求","depth":2,"charIndex":1174},{"text":"3. 小心 `secureConnectionStart` 的问题。","id":"3-小心-secureconnectionstart-的问题","depth":2,"charIndex":-1},{"text":"4. 给跨域资源添加 `Timing-Allow-Origin` HTTP 响应头","id":"4-给跨域资源添加-timing-allow-origin-http-响应头","depth":2,"charIndex":-1},{"text":"5. 理解 0 意味着什么。","id":"5-理解-0-意味着什么","depth":2,"charIndex":3964},{"text":"6. 确定 304 是否被测量。","id":"6-确定-304-是否被测量","depth":2,"charIndex":4713},{"text":"7. 看看 Boomerang（回旋镖）.","id":"7-看看-boomerang回旋镖","depth":2,"charIndex":5712},{"text":"译者补充","id":"译者补充","depth":2,"charIndex":6492}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-12-30T00:00:00.000Z"},"2":{"tags":"HTML5, 翻译"}},"version":""},{"id":180,"title":"或者说『耗时包含了 Blocking 部分的时间』","content":"译：严重混乱的 Resource Timing#\n\n\n或者说『耗时包含了 Blocking 部分的时间』#\n\n用 Resource Timing 来同统计资源下载性能 是非常赞的方式，但不幸的是，几乎所有和我聊过的人都是使用 duration 属性，\n而且他们都没有意识到 duration 包含了 blocking 时间。结果 duration 时间\n比实际的下载时间要长很多，超出了开发者意料之外的结果。这个问题在跨域资源中 尤为糟糕，duration\n是唯一可用的。在这篇博文中我将解释这个问题，并提出解决方案。\n\n\nResource Timing 回顾#\n\nResource Timing 规范 定义了收集网页中 所有资源耗时统计的 API。现在可用于 Chrome, Chrome for Android, IE\n10-11, 和 Opera。 可以通过 getEntries(), getEntriesByType() 和 getEntriesByName() 得到一个\nPerformanceEntry 列表，一个 PerformanceEntry 对象包含以下属性：\n\n * name – URL 地址\n * entryType – 通常是 “resource”\n * startTime – 开始处理这个资源的时间（相对开始导航到页面时的毫秒数）\n * duration – 处理这个资源的总耗时（毫秒）\n\n上面的属性在所有的资源中都可用，包括同域和跨域的。而同域的资源拥有另外一些可以 访问的附加属性，这些属性定义在\nPerformanceResourceTiming 接口中。这些属性名称 很简洁清晰，完全可以见名思意，并且以时间顺序排序：\n\n * redirectStart\n * redirectEnd\n * fetchStart\n * domainLookupStart\n * domainLookupEnd\n * connectStart\n * connectEnd\n * secureConnectionStart\n * requestStart\n * responseStart\n * responseEnd\n\n这里有个权威的 处理模型(processing model) 图 显示了这些属性所在的各个不同阶段。备注：duration 相当于 responseEnd -\nstartTime。\n\n\n\n如何使用 Resource Timing 的详细信息，可以参考我的文章 Resource Timing Practical Tips 『译者的中文翻译』\n\n\nduration 中出乎意外的 blocking 膨胀#\n\n出于隐私的考虑，同源资源的 PerformanceResourceTiming 属性是受限的。（备注： 任何资源可以通过 Timing-Allow-Origin\n响应头达到“同源”效果。）现在大约有一半 的资源是跨域的，因此 duration 是度量加载时间的唯一方式。而且即使是同源资源， duration\n也是唯一以增量方式提供的属性，大概是因为它度量了最重要的阶段。 这样一来，所有我见过的 Resource Timing 实现都以 duration\n做为主要的性能指标。\n\n不幸的是，duration 比下载时间要大，它包含了阻塞时间（blocking time）—— 浏览器\n意识到需要下载一个资源，到这个资源实际被下载直接的时间延迟。阻塞会在几种情况时 发生，最典型的资源数量比 TCP 连接数要多的情况。大多数浏览器为每个主机开放了\n6 个 TCP 连接，IE10（8个连接）和 IE11（12个连接）例外。\n\n这个 Resource Timing 阻塞测试页面 有 16 个图片，因此无论哪个浏览器都会阻塞一部分图片。每个图片被编程为在服务器 有 1 秒的延迟，这 16\n个图片，每个图片都显示了 startTime 和 duration。 另外还有这个测试页面在 WebPagetest 中通过 Chrome, IE10 和\nIE11 加载的测试结果， 可以通过查看截屏来分析时序结果。注，为什么所有的图片的 startTime 大致都相同？ 英文这个时间是浏览器解析 IMG\n标签并意识到需要下载改资源的时间，由于先下载的图片 阻塞的原因，但在页面出现后，图片的 duration 值大约步进 1 秒左右。\n\n\n译者补充#\n\n * SERIOUS CONFUSION with Resource Timing - 原文出处。","routePath":"/blog/post/2014/serious-confusion-with-resource-timing","lang":"zh-CN","toc":[{"text":"Resource Timing 回顾","id":"resource-timing-回顾","depth":2,"charIndex":261},{"text":"`duration` 中出乎意外的 blocking 膨胀","id":"duration-中出乎意外的-blocking-膨胀","depth":2,"charIndex":-1},{"text":"译者补充","id":"译者补充","depth":2,"charIndex":1841}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2014-12-30T00:00:00.000Z"},"2":{"tags":"HTML5, 翻译"}},"version":""},{"id":181,"title":"gitopen, Smart partner of git, hg and svn.","content":"#\n\n使用 Git 的你，想必会更喜欢在终端（命令行）中使用 Git。在终端中，可以将 Git 的特性发挥的淋漓尽致。\n\n\n\n咦，我想立即提交一个 Pull/Merge Request 怎么办，还要打开浏览器，输入 Git 仓库的 URL 地址，点击进入 PR 列表，再点击新建\nPR，选择 feat-sample 分支， 点击确认按钮，balabala...\n\n嗯，好麻烦。\n\n于是 Git 的最佳伴侣 gitopen 横空出世了。\n\npush 了新分支，想立即提交 PR/MR，So simple.\n\n\n\n她会把当前分支提交一个新的 PR。\n\n如果你是使用的 GitHub，在发布了新版时可能还想写个 Release Note：\n\n\n\n咦，有个新的想法，提交个 Issue 先：\n\n\n\n再来个 milestone 尝尝：\n\n\n\n这货支持：\n\n * git, hg, svn.\n * Mac OS X, Linux, Windows.\n * GitHub (Enterprise), GitLab (CE, EE), BitBucket (Atlassian Stash), GitCafe\n   (Enterprise) ...\n\n更多功能参考：\n\n","routePath":"/blog/post/2015/gitopen","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2015-07-24T00:00:00.000Z"},"2":{"tags":"git"}},"version":""},{"id":182,"title":"git+, a hack of git, smart for you.","content":"#\n\n为了信息安全，公司搭建了 gitlab.company.com 管理代码，同时限制了必须使用工作邮箱 hotoo@company.com 进行提交。\n\n公司 gitlab 有大大小小很多仓库，不时的需要 clone 代码下来，有时忘记设置就开始提交， 提交了几次开始 push 到 gitlab 并准备提交 MR\n时发现，push 被拒绝，或者 MR 无法 自动合并，因为没有使用公司的邮箱进行提交。只好取消之前的提交操作，修改邮箱配置 之后重新提交。\n\n虽然 clone 下来配置一次就可以了，但是每个仓库都需要配置，每次 clone 都需要配置， 忘记设置了需要取消之前的提交并再来一次。\n\n有没有办法自动进行配置呢？\n\n于是 gitplus 出现了，它可以根据 git 的子操作命令，及其所在的仓库信息，自动的执行指定命令，帮助你完成一些自动化任务。 例如：\n\n\n\n * 有了 gitplus，你再也不会忘记设置公司邮箱。因此也不需要取消提交再重复提交了。\n * 还可以在提交前自动做校验工作。没有 gitplus 之前你只能给每个仓库设置 pre-commit hooks。\n * 你也可以发挥自己的想象力，做更多其他的事情。","routePath":"/blog/post/2015/gitplus","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2015-05-27T00:00:00.000Z"},"2":{"tags":"git"}},"version":""},{"id":183,"title":"集团开源星人奖和 IKBC POKER II 机械键盘","content":"#\n\n很幸运获得了集团开源星人奖：最活跃个人奖，奖品是 IKBC POKER II 机械键盘，同时 还有一件 Tee。\n\n获得这个奖，主要得益于前端天然的开源","routePath":"/blog/post/2015/ikbc-poker-ii","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2015-05-27T00:00:00.000Z"},"2":{"tags":"Open Source, 开源, 机械键盘"}},"version":""},{"id":184,"title":"末尾的逗号","content":"#\n\n\n\n早期的 JavaScript 运行环境大都不支持末尾多出来的逗号，或者会抛出异常，或者不符合期望。\n\n比如：\n\n\n\n由于不支持尾逗号，我们以前写代码都需要手动去除尾逗号（工具最多提示你这里多了个逗号）。 因此我们增加、删除一个属性、数组项时，总是需要担心相邻项的逗号问题。\n\n比如增加一项：\n\n * 如果被增加项是列表的最后一项，则需要给前一项（原最后一项）添加一个逗号，但被添加项本身不添加逗号。\n   * 新增一项本来并不需要修改前一项，但是在非尾逗号情况下则必须做这个无本质意义的修改。\n   * 这很麻烦，也很容易导致错误。\n   * 实际你只是增加了一项，但你在 diff 中会看到又是删除项，又是增加项。review 时你就需要关注这些无谓的变更。\n * 如果被添加项不是列表的最后一项，则被添加项要加上逗号。\n\n\n\n删除一项也是：\n\n * 你本来只是要删除了最后一项，但你不得不修改前一项。麻烦，容易出问题。\n * 你本来只是删除了一项，但在 diff 中也是看到又是删除，又是增加。\n\n\n\n值得高兴的是，现在的 JavaScript 运行环境、预编译工具、语法检查工具都支持了尾逗号。 一旦我们统一使用尾逗号风格：\n\n * 我们在增加或删除一项时，再也不需要关心相邻项了。\n * diff 看起来也更直观清爽。\n\n新增一项：\n\n\n\n删除一项：\n\n\n\n另外也有些语言是不需要逗号的，每一项都不需要。比如 Markdown 的列表，yml，yaml， xml，html 等。\n\n全要逗号，或者全不要逗号，他们的共同点就是一致性。这种一致性让书写和阅读都非常简洁清晰。 可维护性也更好。\n\n你觉得呢？","routePath":"/blog/post/2015/trailing-commas","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2015-08-10T00:00:00.000Z"},"2":{"tags":"Code, Style"}},"version":""},{"id":185,"title":"马来西亚之旅（2016）","content":"#\n\n杭州 -> 亚庇沙巴 -> 斗湖 (Tawau) -> 仙本那 (Semporna) -> 马达京 (Mataking) -> 斯巴丹 (Sipadan)\n\n * Semporna\n * Madaking Island Reef Dive Resort\n * Sipadan island dive spot\n\n\n观感#\n\n * 行人少，过马路没绿灯\n * 分布式小城，要有车。每家至少都是 2 部车。\n * 公厕锁住\n * 环境好，海洋保护意识好。\n * 沙巴大学好大。\n * 飞机安检简单\n\n\n行程游记#\n\n * 杭州 -> 沙巴","routePath":"/blog/post/2016/Malaysia-2016","lang":"zh-CN","toc":[{"text":"观感","id":"观感","depth":2,"charIndex":159},{"text":"行程游记","id":"行程游记","depth":2,"charIndex":251}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2016-06-12T00:00:00.000Z"},"2":{"tags":"旅行"},"3":{"status":"draft"}},"version":""},{"id":186,"title":"杭州购车记","content":"#\n\n终于在年前把车的事情搞定了，这是 2015 年做成的唯一一件大事，经历了不少坎坷，一路摸索过来，很多都是懵懂，\n因此想通过这篇流水记录，帮助到一点大家，如果有写的不好不对的地方，大家可以给我提出，我尽力改进。\n\n『车图』\n\n\n驾照#\n\n杭州限牌限行前，我就拿到了驾照，跟另两个同事一起在公司对面的驾校学的。\n\n报名、体检、缴费、领教程学习理论知识，科目一没有拿到满分，但一次性通过了，没有补考。\n\n教练在时间上安排的比较合理，科目二场地练习时，一般每周有两个工作日早上 7 点半左右到驾校练习 1 个半小时，9 点到公司上班。\n（科目二包括项目：出库、倒库、移库、侧方停车、曲线行驶、停坡起步、直角转弯、单边桥、起伏路行驶等）。满分通过。\n\n模拟学习，可以选择周末去坐几个小时。\n\n模拟考试，尽早预约。\n\n路上没开过多少次，大都是邻近考试前两天冲刺恶补，但是很快就熟悉了。 但是教练没教各种灯怎么用，只会转向灯（和刹车灯），大灯都不会。\n考试时不知道怎么关双闪，好紧张，挂科一次。当场补考，很紧张慢腾腾的开，考官说这么好的路况开快点，\n于是加油门、变道、超车，行云流水，把平时学车时的状态发挥出来了，满分通过。 事后同考的同事说，还好你补考 HOLD 住了，表现不错。\n\n从开始学车，到拿到驾照，差不多 3 个月时间，挺快的。\n\n\n购车#\n\n老婆喜欢 SUV，汽车之家上看的也基本都是 SUV，然后去 4S 店看实体车试驾。\n\n * 马自达 CX-5，说实话，外观确实漂亮，操纵也非常好。但是老婆晕车，说坐着头晕。\n * 奔驰 GLA，也挺漂亮，但是紧凑型偏小，早晚被换。\n * 宝马 X1 紧凑型小，拥挤；X3 小贵。\n * 奥迪 Q3 紧凑型有点小，坐着挤；Q5 小贵。\n * 本田 XR-V，CR-V 看着、坐着都不喜欢，没试驾。\n * MINI，老婆很喜欢，但是看了评价都说避震硬垫屁股，综合评价第一辆车不合适。\n * 昂克威，看起来胖嘟嘟的有点可爱，但是试驾起来还是一个胖子步态。\n * 比亚迪・唐，电动车日常上下班代步还是很有优势的，不知道小区车库是否可以安装充电设备。\n   主要考虑到电动车目前可能还太成熟，基础设施也不够齐全。因为是混动，这个价钱可以买个 好点的传统汽油发动机的车。\n * Jeep 自由光，看车的时候正好即将推出，但是我应该是等不到了，图片看起来不错， 但是也有人说 Jeep 车不好，小毛病多。\n * 随便听到公司同事在说大众高尔夫，挺牛逼的样子，虽然我不懂。但是网上一看就不是我的菜。\n * 沃尔沃 XC60，驾驶感不错，车身很稳，老婆说很舒服不晕了，但是小贵。\n * 顺便看了沃尔沃 S60L，总体很喜欢，但不是 SUV。\n\n最后综合多方面情况考虑，选了沃尔沃 S60L，找老婆的朋友的朋友的 4S 店朋友，拿到相对比较高的优惠。\n\n小吐槽下，第一次经历买车很多东西都不懂，被坑到不少。\n\n * 比如车子大约是 8 个月前生产的，放了大半年。虽然是新车没错，而且据说沃尔沃车子小众\n   （但是买车之后我路上经常会碰到沃尔沃的车），所以一般会放的相对久点，看运气。 我建议对于放了时间长的车，如果不能接受，可以要求换车，或者提出其他要求。\n * 被强制安装了导航模块，加了 2 千元左右。\n * 平安银行无息免抵押贷款，本来说不需要购买盗抢险，结果说总行有新政策又要求必须买盗抢险。\n * 有一次在 4S 店结果轮毂被他们蹭花。\n\n\n临牌#\n\n 1. 买车时，4S 店会帮申请一张 15 天的杭州市蓝色临牌。\n 2. 第 15 天时，自己带上身份证、车辆合格证、一致性证书、发票、交强险保单，及其复印件 到车管所申领临牌。自己最多可以申领 2 次，即有最多 45\n    天的杭州临牌可以用。杭州临牌 只能在杭州市辖范围内使用，不可跨市甚至跨省使用，违反被抓的话属于无牌驾驶，直接扣 12 分，扣车。\n 3. 1 号楼拿身份证在服务台拿号等候审核资料。\n\n * 我第一次下午去前面有 100 人，等候了 1 小时左右。\n * 第二次上午 11 点半去，本以为赶不上了，结果没什么人，直接窗户审核资料，缴费，总共 20 分钟左右拿到临牌。\n\n 1. 资料审核完备后拿到回执单缴费，每张临牌 5 元，总共 10 元。\n 2. 缴费拿到另一张回执单等候取牌照，一般 20 分钟左右。\n\n\n竞拍车牌#\n\n 1. 每月 8 日之前提交资料进行审核（3 个月有效期，到期前也是 8 号之前可以提交延长 3 个月有效期）。\n 2. 每月 23 日公布审核结果（登录到系统中查询状态）。\n 3. 每个月的都有竞拍日历，可以自己做个日历通知。\n 4. 5 个工作日的缴付 2000 元的竞价保证金，可以通过银行柜台、网银转账，但不要用支付宝、微信等第三方支付工具。\n 5. 竞价前 2 天可以激活竞价资格，设置竞价密码。\n 6. 一般每月 25 日（遇节假日顺延至工作日）早上 9:00 ~ 15:00 直接进行报价竞拍， 11:00 和 13:00\n    两个整点会统计当时的均价，自行根据实际情况调整报价，每人有 2 次修改报价机会。\n 7. 15:00 时统计出最终均价和底价等数据，可以查询自己是否中标。\n 8. 竞拍到车牌的，下个工作日可以打印《杭州市小客车增量指标竞价收入缴款通知书》1 份，到杭州银行营业厅\n    缴款即可，缴款完成后，杭州银行会给一张《浙江省非税收统一票据》，放好，上牌要用。\n\n * 注：没有杭州银行卡的，只能使用现金缴款，另外银行 ATM 机取款好像有 2 万限额。\n * 注：通知书打印比较痛苦，提示要用 Windows 在 IE 并安装了专用浏览器控件后才能打印， 但是最终使用 A4\n   纸打印出来的尺寸很小，我最终采用了前端工程师特有技术解决了打印结果不完美的问题。\n\n 1. 竞拍日后第 3 个工作日（一般 28 日）18:00 之后（可能会延迟数小时）就可以登录 杭州市小客车总量调控管理信息系统\n    ，在底部有指标信息可以下载和打印。\n\n\n缴税#\n\n 1. 上牌前需要缴购置税（中国是双向收税制度，没办法）。购置税额 = 车辆官方指导价 ÷ 1.17 × 10%\n 2. 缴税地点在杭州汽车城 6 楼的税务大厅，我早上 9 点到那边，人不多，取号就被叫号了。 审核好资料后，拿回执单到缴费窗口刷卡即可，可以用信用卡。15\n    分钟就办好。\n\n所需材料：\n\n * 身份证原件、复印件。\n * 合格证原件、复印件。\n * 发票联、纳税联原件、复印件。\n * 打印的《个人指标证明文件》\n\n\n选车牌号#\n\n可以在网上查可选的号码，和家人朋友一起参谋选择意向车牌号码。\n\n * 《掌上车管》手机 App。游客模式 - 车辆业务 - 自主选号 - 同意 - 输入手机号 - 点击“获取验证码” - 可选车号查询。\n * 机动车号牌自主查询系统\n\n可以很方便的使用任意键查询可选号码，比如 888**。\n\n选好意向车牌后，还可以在上牌前一天选号车牌号码（有效期 3 天，不要太早选号）\n\n * 《掌上车管》手机 App。游客模式 - 车辆业务 - 自主选号 - 同意 - 输入手机号 - 点击“获取验证码” - 自主选号。\n * 浙江省机动车号牌互联网自编自选系统 - 同意 - 手机号 - 验证码 - 确定 - ...\n\n\n上牌#\n\n汽车城也可以办理上牌，但是我在网上看的三墩车管所办理流程，写的很到位，再加上办理临牌时我对这边相对熟悉，所以选择了三墩车管所。\n\n 1. 杭州市公安局交警支队车管所（三墩车管所，古墩路 699 号）东门是不让车进的，要从南边圣苑北街进去。\n\n门口很多代办的，一般要 100 元服务费（4S 店要 300 元比较黑），因为要本人在场，而且业务不是很复杂， 代办没有太多必要。\n\n 1. 开车进南门后往前，沿入口指示牌方向右转直走到底，再右转到底就到 2 号楼门口了，排队，车轮打正，下车， 看到有拿卡片机拍照的工作人员就找他帮你拍照（4S\n    店提供的照片不能用）。\n 2. 去 2 好大厅拍照的几个窗口找给你牌照的工作人员拿照片和《机动车检查记录表》，把车架号拓印贴上，照片留着办理行驶证时要用。\n 3. 拿到后排队并把车往前挪到车棚下，打开发动机仓，解锁车门。\n\n * 合格证原件\n * 机动车检查记录表\n\n 1. 验车的交警是一批车来检验一次，所以要等等。验车交警出来验车时，一般根据车辆停的顺序从前往后验，\n    但国产车和进口车验车交警不同，所以交警可能直接跳过前面的进口车。\n 2. 将《检查记录表》和车辆合格证原件交给验车交警，解开前后车门锁，方便验车。交警主要检查发动机仓、\n    副驾驶座底下看了半天不知道看什么，副驾驶座后面的座位底下也看了下，新车一般没什么问题。\n\n注：因为我的车轮毂被 4S 店刮坏了，多问了 4S 店的销售几句，说他们有个客户，因为车门撞了红色车漆花了，\n产生了明显的不一致，被要求修车重新喷了新漆，所以未上牌期间开车尽量小心，避免给上牌带来麻烦。\n\n 1. 验车 OK 之后，交警会让你把车开走，开到停车场停好，然后回到 2 号楼 1 号窗口等拿回《检查记录表》。\n    如果业务办理人多的话，这期间可以把其他材料放到业务办理窗口排队，后面拿到《检查记录表》后再补充进去。\n\n * 《检查记录表》业务办理是必须的材料，所以如果刚验好车的话，建议放在前面有 5、6 个人的窗口排队。\n * 如果已经拿到了记录表，可以多看看不同的业务办理窗口，排队人数可能很不平均的。\n\n 1. 材料齐全后开始正式业务办理，把工作人员要求的材料交给她就好了，剩下的事情都交她来处理。\n 2. 正常来说，邻近办好业务时，工作人员会给你一个选号单，可以在 2 号大厅东侧的小隔间里的选号机上进行选号。\n\n * 因为我事先通过手机《掌上车管》App 选好了号码，因此这一步免了，工作人员口头跟我确认了车牌号，办理好之后给个回执单。\n * 另外掌上车管选号时可以选择在办理上牌的网点自取，或者邮寄。我想着过年了快递可能不给力，万一过年回家前没寄到就麻烦了，\n   所以选择了自取，但是工作人员告知自取要 10 个工作日后，邮寄则 3 个工作日内寄出。10 个工作日肯定来不及，因此修改为邮寄了，\n   将收件人姓名、手机号、收件地址写到身份证复印件背面空白处即可（可以提前写好）。\n\n 1. 去大厅东侧的缴费窗口缴费，125 元上牌费再加 10 元的金黄色全国临牌费，总共 135 元。\n 2. 在缴费窗口旁边的窗口等待发放行驶证、登记证书、临牌。\n 3. 旁边的另一个窗口拿环保标志。\n 4. 收工。\n\n\n安装车牌#\n\n邮寄是 EMS 到付 10 元，市区内还是不慢的，上周五邻近中午办理好的，周一中午就收到邮寄的车牌了。 因为是防盗螺栓没装过，而且需要专用的螺丝刀，所以花 20\n元请修车工作人员帮忙装好了。另外 4S 店也可以帮忙安装。 其实如果有专用螺丝刀，和安装普通螺丝没太多差别：\n\n 1. 将垫片和螺丝拧紧。\n 2. 将螺帽用力摁进去即可。\n\n注：新的交通法规要求每块车牌安装四个螺丝，否则按照无牌判罚（12 分、扣车、罚款），\n安装不是很麻烦，请人安装也不会因为这个多加钱，没必要把车管所寄给你的螺丝放那里备用。\n\n\n贴标#\n\n车辆合格标志、环保标志、交强险标志都是要贴到前挡风玻璃上的（一般贴在右上角位置）。 直接贴玻璃上后续换新标会比较难揭下来，一般 4S\n店、保险公司、网购汽车用品的商家都会附送静电贴膜， 把车标粘在静电贴膜上，再把静电贴膜贴到车窗上会比较方便。\n\n\n贴膜#\n\n一般防晒防紫外线，但是不宜颜色过深，否则光线暗的地方看不清后视镜，有安全隐患。 同时，2004 年 10 月 1\n日实施的国家标准《机动车运行安全技术条件》（GB7258—2004）第 11.6.4 条规定， 机动车驾驶室必须保证驾驶员前方视野和侧方视野，\n前挡风窗玻璃及风窗以外玻璃用于驾驶员视区部位的可见光透射比不允许小于 70%， 所有车窗玻璃不允许张贴镜面反光遮阳膜。\n\n据悉，车辆进行年检时，检测人员会对车辆驾驶室的“透光率”进行检测， 一般来说，在车辆两侧玻璃上张贴反光膜的车辆都不可能通过“透光率”这个标准。\n\n\n加油卡#\n\n大部分加油站的营业店里都可以办理加油卡，带好身份证原件和 15 元现金作为押金即可，办好后可以当场使用信用卡充值加油。\n\n淘宝有折扣充值的，9.8 折看起来不多，但每加 1 箱汽油的钱，大约可以多加 1、2 升汽油，还是挺不错的了。\n支付宝等网上充值也很方便。但是因为加油卡是芯片卡，网上充值后要去圈存下比较麻烦，不过很多加油站可以自助圈存。\n\n有加油卡的用户，可以自助加油。自助加油要注意安全，静电、明火要小心。\n\n\n汽车用品#\n\n * 盲区镜：贴在两侧后视镜上的小圆镜，我个人喜欢有万向节无边的。\n * 方向盘助力器：大角度打方向盘会非常顺利。\n * 手机支架：个人推荐夹在空调出风口、万向节、吸铁石的这种，小巧简洁实用。\n * 空气清新剂：香水不错，固态的也行。\n * 吸尘器：家用的即可，换个稍小的吸嘴。\n * 免清洗抹布：自己洗车、擦个雨水污渍什么的还是很有用的，比较容易清洗。\n * 后备箱或后排挂钩：挂些不能倒的东西很有用，买不到合适的也可以考虑自制。\n * 对讲机：2 辆车及其以上的车队，沟通起来会比较方便，没有信号的地方也不愁。\n * 陈皮糖、橙子、橘子、晕车贴：防晕车、防饿。\n\n\n其他#\n\n * 汽车之家的《用车小百科》系列不错，可以挑些自己不了解的看看，像车灯语义、山路行车注意事项等。\n * 多看看交通事故视频，自己多想想什么场景应该注意什么，出现状况时应该如何正确应对等。\n * 放平心态，遇到不平用喇叭或车灯提示下就好了，不要太计较。\n * 不要犹豫，该快快、该慢慢；能通过毫不犹豫的快速通过，不能通过也要毫不犹豫的减速停下。\n\n\n灯语#\n\n * 提示后车（大灯、车距等）：短暂雾灯，或危险警告灯（双跳灯）。\n * 提示前车（信号灯变化、注意压线行驶、并线等）：大灯闪两次。\n * 不可超车：左转向灯。\n * 可以超车：右转向灯。\n * 前方盲区：大灯闪一下，比如车库直角转弯处等。\n\n\nTODO#\n\n快没电了，后面抽空再补充附图。\n\n\n参考资料#\n\n * http://www.19lou.com/forum-464848-thread-6561443007363713-1-1.html\n * http://www.19lou.com/forum-293-thread-19001324626574730-1-1.html\n * http://wenda.haosou.com/q/1378221335061966\n * http://jingyan.baidu.com/article/454316ab575e72f7a7c03a91.html","routePath":"/blog/post/2016/buying-a-car-in-hangzhou","lang":"zh-CN","toc":[{"text":"驾照","id":"驾照","depth":2,"charIndex":115},{"text":"购车","id":"购车","depth":2,"charIndex":568},{"text":"临牌","id":"临牌","depth":2,"charIndex":1440},{"text":"竞拍车牌","id":"竞拍车牌","depth":2,"charIndex":1814},{"text":"缴税","id":"缴税","depth":2,"charIndex":2514},{"text":"选车牌号","id":"选车牌号","depth":2,"charIndex":2739},{"text":"上牌","id":"上牌","depth":2,"charIndex":3053},{"text":"安装车牌","id":"安装车牌","depth":2,"charIndex":4424},{"text":"贴标","id":"贴标","depth":2,"charIndex":4687},{"text":"贴膜","id":"贴膜","depth":2,"charIndex":4816},{"text":"加油卡","id":"加油卡","depth":2,"charIndex":5085},{"text":"汽车用品","id":"汽车用品","depth":2,"charIndex":5301},{"text":"其他","id":"其他","depth":2,"charIndex":5593},{"text":"灯语","id":"灯语","depth":2,"charIndex":5773},{"text":"TODO","id":"todo","depth":2,"charIndex":5901},{"text":"参考资料","id":"参考资料","depth":2,"charIndex":5926}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2016-01-27T00:00:00.000Z"},"2":{"tags":"车，车牌"}},"version":""},{"id":187,"title":"使用 GPG 签名 Git Commits","content":"#\n\n前段时间 GitHub 支持在 Git Commits 中使用 GPG 签名验证，可以避免其他人使用你的 Email 进行 commit。\n\n\n\n\n安装 GPG#\n\n下载地址： https://www.gnupg.org/download/\n\nMac 下有两个可选工具，分别是 Mac GPG 和 GnuPG for OS X，我都尝试了下，觉得 Mac GPG\n相对比较容易点，安装过程中同时引导创建一个 GPG key 存储到 GPG keychain 中，并且在 Git 提交时记住\npassphrase，避免每次提交输入 passphrase。\n\n\n生成 GPG key#\n\n> 如果在安装过程中，自动引导生成了 GPG key 的话，这一步可以省略。\n\n除了安装时引导生成的 GPG key 之外，你还可以手动生成 GPG key：\n\n\n\n\n配置 Git#\n\n配置好 GPG key 之后，可以配置让 git 在某个仓库所有的 commits 都添加 GPG key 验证：\n\n\n\n也可以让本地所有的仓库都进行 GPG 验证：\n\n\n\n\n验证 Git commits#\n\n如果没有设置局部仓库或全局仓库默认开启 commits GPG 验证，提交时可以附加 -S 参考， 要求进行 GPG 验证。\n\n\n\n如果提交使用的账户信息和 GPG 签名不一致，则无法通过 GPG 验证，会导致提交失败。\n\n\n\n正常的话，会提示输入 passphrase 解锁 PGP 密钥，此时可以选中保存到 Mac OS X 系统 的 Keychain 中，避免每次输入\npassphrase。\n\n\n\n\n将 GPG 密钥添加到 GitHub#\n\n这时 push 到 GitHub 仓库的 commits，查看 commits 记录会显示 unverified。\n\n\n\n将上面 export 出来的 GPG 密钥添加到 GitHub 的 SSH and GPG keys 即可。\n\n\n参考#\n\n * GPG signature verification\n * Signing commits using GPG\n * Generating a new GPG key\n * Adding a new GPG key to your GitHub account\n * GnuPG - download\n\n\n延伸阅读#\n\n * A Git Horror Story: Repository Integrity With Signed Commits\n * Git 使用中的教训：签名提交确保代码完整可信\n * 使用 GPG 签名 Git 提交和标签\n * Step-by-step guide on how to create a GPG key on keybase.io, adding it to a\n   local GPG setup and use it with Git and GitHub","routePath":"/blog/post/2016/gpg-sign-for-git-comments","lang":"zh-CN","toc":[{"text":"安装 GPG","id":"安装-gpg","depth":2,"charIndex":76},{"text":"生成 GPG key","id":"生成-gpg-key","depth":2,"charIndex":281},{"text":"配置 Git","id":"配置-git","depth":2,"charIndex":378},{"text":"验证 Git commits","id":"验证-git-commits","depth":2,"charIndex":475},{"text":"将 GPG 密钥添加到 GitHub","id":"将-gpg-密钥添加到-github","depth":2,"charIndex":696},{"text":"参考","id":"参考","depth":2,"charIndex":835},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":996}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2016-06-11T00:00:00.000Z"},"2":{"tags":"Git, GPG"}},"version":""},{"id":188,"title":"测试代码和可测试代码","content":"#\n\n项目中有一个要将指定时间和当前时间比较，计算相对时间的逻辑（比如显示 3 分钟前），\n由于当前时间和执行测试用例的时机有关，每次执行用例都会不同，如何让这个代码可测试呢？ 有些人可能想到 Mock\n当前时间，测试的时候让当前时间凝固，于是有了如下代码：\n\n\n\n这个业务代码是 可测试 的代码吗？我认为不是。\n\n这个业务代码为了测试，使用了一个不必要的方法，而且让测试代码和业务逻辑相互依赖， 一旦业务代码重构，测试代码将不可测试。这个代码是为测试写的，称之为 测试 代码\n而不是 可测试 代码更合适点。\n\n再举一个例子，还是时间相关的动态数据输入问题：\n\n项目中有一个今日收益更新的提醒消息，只有是今天的更新才显示，所以第一直觉应该是造一个\n收益更新时间是今天的测试数据，而不是造一个固定的数据（可能固定测试数据比较偷懒方便）， 然后篡改业务逻辑中当前时间的计算。\n\n\n\n> 测试代码应该只关注正常的数据输入和输出 （即使输入、输出是难以预测的）。\n> \n> 而不应该关注业务实现逻辑，试图篡改业务代码，让测试可以进行。\n\n更好一点的可测试代码，可以将当前时间传入以便让输入、输出可以预测：\n\n\n\n\n2017-02-09 更新#\n\n群里又有了类似的一个案例，开发想写测试用例来测 location.href 的赋值是否正确， 用以测试页面跳转逻辑是否正确。于是想通过重载 location\n对象来监听给 location.href 赋值时，所赋值是否符合期望。\n\n还辛苦找到 Chrome 出了个小 bug：论如何在 Chrome 下劫持原生只读对象 这么牛逼变态到令人折服的方法。但是，这是正确的方法吗？我认为不是。\n\nlocation 的案例中，我觉得应该是测试赋值给 location.href 的 值本身是否正确， 而不是测试企图篡改 location 来监听 href\n属性是否正确。即：\n\n\n\n单元测试用例只需要测试 getUrl 在各种边界输入条件下，输出是否符合期望就可以了。","routePath":"/blog/post/2016/test-code-and-testable-code","lang":"zh-CN","toc":[{"text":"2017-02-09 更新","id":"2017-02-09-更新","depth":2,"charIndex":502}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2016-06-04T00:00:00.000Z"},"2":{"tags":"Code"}},"version":""},{"id":189,"title":"Git 提效篇","content":"#\n\n集团的流程工具会生成一团奇形怪状的分支名称，要记忆这些分支名是一项难题，默认的 git branch\n列出的本地分支都是几乎无法识别的乱码，如何快速标识、识别、打开这些丑陋的分支名呢？\n\n\n1. 备注分支#\n\n\n\n还可以使用 git branch --edit-description 命令编辑复杂的备注信息。\n\n\n2. 显示备注#\n\n默认 git branch 列出的本地分支不会附带备注信息，git 内置的 git config\nbranch.{branch_name}.description 可以显示单个分支的备注。\n\n以下方法可以一次性列出所有分支，并附上各个分支对应的备注信息。\n\n\n\n\n3. 分支别名#\n\n上面的方法备注了一团乱码的分支名，但真正要切换到这种分支时，仍然需要 git br 列出所有分支，并从中找出目标分支，复制，git co <C-v>。\n\n有没有更便捷的方法呢，答案是肯定的。\n\n\n3.1. git symbolic-ref#\n\nGit 内置了强大的 symbolic-ref 方法，可以给分支增加引用（别名）：\n\n\n\n\n3.2. git-branch-alias#\n\n直接使用 symboilc-ref 虽然可以满足需求，但是用起来非常不方便，这时候可以使用 git-branch-alias 工具来方便管理分支别名。\n\n\n\n\n4. 提交 MR/PR 时自动找到找到目标分支#\n\n特性分支需要合并到迭代分支、主干分支时，要手工找到目标分支也是很困难的，这时候 可以使用 gitopen 这个小工具来帮忙。\n\n\n\ngitopen 会自动找到目标分支，并打开创建 MR 的在线地址，一键提交 MR。\n\ngitopen 还有很多其他方便的特性。\n\n\n参考#\n\n * https://github.com/bahmutov/git-branches\n * https://github.com/hotoo/gitopen\n * https://github.com/hotoo/git-branch-alias\n * https://gist.github.com/mauricerkelly/0b12b20a870d1e38081e","routePath":"/blog/post/2017/git-branch","lang":"zh-CN","toc":[{"text":"1. 备注分支","id":"1-备注分支","depth":2,"charIndex":97},{"text":"2. 显示备注","id":"2-显示备注","depth":2,"charIndex":160},{"text":"3. 分支别名","id":"3-分支别名","depth":2,"charIndex":302},{"text":"3.1. git symbolic-ref","id":"31-git-symbolic-ref","depth":3,"charIndex":410},{"text":"3.2. git-branch-alias","id":"32-git-branch-alias","depth":3,"charIndex":480},{"text":"4. 提交 MR/PR 时自动找到找到目标分支","id":"4-提交-mrpr-时自动找到找到目标分支","depth":2,"charIndex":584},{"text":"参考","id":"参考","depth":2,"charIndex":742}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2017-05-12T00:00:00.000Z"},"2":{"tags":"Git"}},"version":""},{"id":190,"title":"时髦的 Git Diff","content":"#\n\n\n安装#\n\n\n\n\n使用#\n\n简单的一次性使用：\n\n\n\ngit diff 默认时髦模式\n\n\n\n.gitconfig\n\n\n\n.gitconfig\n\n\n\n\n参考#\n\n * https://github.com/so-fancy/diff-so-fancy/","routePath":"/blog/post/2017/git-diff-fancy","lang":"zh-CN","toc":[{"text":"安装","id":"安装","depth":2,"charIndex":3},{"text":"使用","id":"使用","depth":2,"charIndex":11},{"text":"参考","id":"参考","depth":2,"charIndex":77}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2017-04-09T00:00:00.000Z"},"2":{"tags":"Git, Diff"},"3":{"status":"draft"}},"version":""},{"id":191,"title":"HTML Tabs 最佳实践","content":"#\n\nTabs 面板的显示和隐藏一般以 display 来控制显示和隐藏，但是如果默认未显示的 Tabs 面板中渲染需要知道面板宽高的组件 （如\nCanvas，某些轮播组件等）时，就会因为面板在 display:none 的状态下无法拿到宽高导致渲染组件异常。\n\n这里建议 Tabs 使用 position:absolute 来将不可见的组件移动到用户不可见的负坐标区域，需要时再将面板移动到可见区域，\n来避免面板不可见时渲染内部组件异常的问题。而且也可以做一些滑动显示的动画效果。\n\n简单示例代码：\n\nHTML:\n\n\n\nLESS:\n\n\n\n\n切换 Tab 时，面板所在位置问题#\n\n无论使用 display 还是 position 方案，切换 tab 的时候，面板的位置会停留在上个显示的面板离开时的同一位置（默认是 0）。\n\n有两个解决方案：\n\n 1. 对于可以固定面板高度的场景（如整个页面都是 Tab），固定面板容器的高度，则 position 方案在切换 Tab 的时候，\n    默认就定位在当前面板之前停留的位置，但是需要使用 iScroll 类似的方案来实现上下拉回弹，及刷新、加载更多的功能 （也可以使用 Native\n    默认的上下拉回弹功能，但是 Tabbar 会随着整个 webview 一起拉动，体验不是太好）。\n 2. 切换 Tab 时，记录各个面板的所在位置，切换回来时使用 scrollTo(x, y) 的方式来滚动到面板上次的位置。","routePath":"/blog/post/2017/html-tabs","lang":"zh-CN","toc":[{"text":"切换 Tab 时，面板所在位置问题","id":"切换-tab-时面板所在位置问题","depth":2,"charIndex":270}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2017-03-21T00:00:00.000Z"},"2":{"tags":"Code, Tabs"}},"version":""},{"id":192,"title":"暂时未读","content":"#\n\n","routePath":"/blog/post/2017/temporary-unreaded","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2017-02-09T00:00:00.000Z"},"2":{"tags":"Code"},"3":{"status":"draft"}},"version":""},{"id":193,"title":"钱塘之怪现状","content":"#\n\n戊戌年癸亥月某日，钱塘某妇人因小轿车司机未让行遂踹轿车，司机恼怒成羞狠揍妇人， 妇人遂通过记者新闻、微博、论坛等多种途径发声爆光，众键盘侠也假正义之名义声讨\n谴责车主，同时对小轿车、小客车、大客车、大货车、中华田园车、叉车、铲车、自行车、 电动车、摩托车、碰碰车、火车、动车等全国众多车辆，及不文明驾车行为进行了猛烈的\n舆论抨击。\n\n钱塘衙门立即援引十四年前之交规法令，要求所有车辆注册登记上牌，但大客车、大货车、\n铲车、中华田园车等车辆因为体型较大不予登记上牌。准予登记上牌者，首年上牌费千元，\n次年及以后每年五百。另外火车、动车虽然体型更大，但是体制属于国有编制，不在此限。\n\n同时衙门还限制所有车辆上路时间（已登记上牌车辆），所有车辆均仅允许在卯时之前， 戌时之后摸黑上路，否则扣车。按规定时间上路者，亦不允许进入公路、高速、土路、\n地面停车场、地下车库等路段和场所。\n\n恶人因车而行恶事，却罪怪全中华车辆，怪者乎？\n\n妇人弱者乎？非也。除了鸣笛之外，无法发声的车辆才是弱者，孰来为其发声？ （备注：鸣笛亦属于违反衙门规定之行为）\n\n--------------------------------------------------------------------------------\n\n> “杭州图书馆对所有读者免费开放，因此就有乞丐和拾荒者进门阅览。 图书馆对他们的唯一要求，就是把手洗干净再阅读。有人无法接受，找到褚树青馆长，\n> 说允许乞丐和拾荒者进馆，是对其他读者的不尊重。\n> \n> 褚树青回答：我无权拒绝他们入内读书，但您有权利选择离开。”\n\nref\n\n有些人觉得狗狗出现在他们的视野中是对他们的不尊重，动辄要棒杀。 人心何以凶残到如此地步。","routePath":"/blog/post/2018/dogs-cars","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2018-11-18T00:00:00.000Z"},"2":{"tags":"dogs, Hangzhou"}},"version":""},{"id":194,"title":"macOS Mojave 的 Vim 出现 Exception MemoryError","content":"#\n\n手贱升级到 macOS Mojave，惊喜的地方不多，问题却遇到了不少，其中之一就是终端的 vim 运行不起来了。启动时直接抛出 Vim: Caught\ndeadly signal SEGV 退出。\n\n\n\nGoogle 了相关关键字都没找到相关的问题。\n\n看错误信息是 Python MemoryError 异常，其中还有 function <SNR>120_PollServerReady 相关信息，于是判断是有\nVim 插件","routePath":"/blog/post/2018/macos-mojave-vim-memoryerror","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2018-09-29T00:00:00.000Z"},"2":{"tags":"MacOS"},"3":{"status":"draft"}},"version":""},{"id":195,"title":"带滑块的进度条","content":"#\n\n在支付宝钱包，“我的 - 总资产”里面，有一个累计收益的卡片，其中还有一个带滑块的进度条， 显示我的收益对比同地区理财的用户中，处于什么样的一个水平。\n\n\n\n这种带滑块的卡片，如果不假思索简单处理，做出的效果就会出现进度 0% 和 100% 时在左右超出顶格，滑块只显示一半。\n\n为了解决这个问题，开发者最早的方案考虑的特别复杂，\n\n\n纯 CSS 实现#\n\nhttp://gitlab.alipay-inc.com/h5_release/wealth/blob/3.6.11/src/index/asset/compo\nnents/profitRate/index.jsx\nhttp://gitlab.alipay-inc.com/h5_release/wealth/blob/3.6.11/src/index/asset/compo\nnents/profitRate/index.less\n\n\nJS + CSS 的复杂不完美实现#\n\n\nJS + CSS 的简单完美实现#\n\n","routePath":"/blog/post/2018/process-with-bar","lang":"zh-CN","toc":[{"text":"纯 CSS 实现","id":"纯-css-实现","depth":2,"charIndex":170},{"text":"JS + CSS 的复杂不完美实现","id":"js--css-的复杂不完美实现","depth":2,"charIndex":400},{"text":"JS + CSS 的简单完美实现","id":"js--css-的简单完美实现","depth":2,"charIndex":421}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2018-04-11T00:00:00.000Z"},"2":{"tags":"算法"}},"version":""},{"id":196,"title":"Git index.lock 锁","content":"#\n\n在使用 Git 时，突然提示 fatal: Unable to create 'xxx/.git/index.lock': File exists.\n\n\n\n原来在使用较费时操作（例如可交互模式）时，Git 会生成一个 .lock 文件锁， 避免同时操作出现问题。正常情况下结束可交互模式时会自动删除 .lock\n文件， 但是当使用强制手段终止这个较费时的操作时，可能会无法正常删除 .lock 文件。 下次再操作 Git 时，Git\n发现目前项目正在被锁定无法操作，就会提示上面的信息。\n\n如果你确定没有正在进行中的其他 Git 操作，可以手动删除 .lock 文件。\n\n","routePath":"/blog/post/2019/git-lock","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2019-07-11T00:00:00.000Z"},"2":{"tags":"Git"},"3":{"status":"draft"}},"version":""},{"id":197,"title":"可恢复的 rm 删除","content":"#\n\n用过终端（Terminal）的人都知道， rm 删除的文件，不会像 Mac Finder 里删除文件、文件夹 一样，会先进入到废纸篓（Trash），一旦 rm\n删除，就很难撤销、恢复。\n\n但是作为程序员，做终端里 rm 删除文件是稀松平常的事，那么如何保障在终端中可以放心 大胆的删除文件、文件夹，而不用担心误删后不可恢复呢？\n\n最直接的想法就是 rm 删除的文件也像 Finder 一样先进废纸篓。\n\n我网上搜寻一番，发现了以下几个工具：\n\n\nAppleScript#\n\n在 Mac 下使用命令行或脚本删除文件到废纸篓 这篇文章中介绍，Mac Finder 中删除的文件其实是进入到 ~/.Trash 文件夹。 但是如果简单的讲文件\nmv 到 ~/.Trash 文件夹，是无法做废纸篓里右键恢复到原处的， 因为这个移动操作没有记录完整的操作行为。\n\n通过 AppleScript 可以通知 Finder 删除文件：\n\n\n\n优点：\n\n 1. 删除时有声效。\n 2. 有操作记录可“放回原处”。\n\n缺点：\n\n 1. 首次使用是有授权提示，可接受。\n\n\nrmtrash 1#\n\n在网上找到好几个不同版本但命名相同的 rmtrash 程序，有的是 shell 脚本，有的是 Xcode 程序。\n\n\n\n缺点：\n\n 1. 删除时没有声效。\n 2. 在废纸篓不可直接“放回原处”。\n\n\nrmtrash 2: Objective-C#\n\n * http://www.nightproductions.net/cli.htm\n\n这个版本的 rmtrash 是用 Objective-C 编写的应用程序，但是版本有点老，下载安装好 rmtrash 发现并不能在 macOS Mojave\n(10.14) 中正常运行。\n\n\n\n缺点：不支持 macOS Mojave。\n\n\nrmtrash 3: Shell#\n\nhttps://github.com/LaiJingli/rmtrash\n\n从源码上看，被删除的文件是进入了自定义的 ~/.rmtrash/ 文件夹（这不是期望的）， 另外还有一堆其他的功能，例如 list, mv, restore,\nempty。\n\n缺点：代码写的太烂，我是不会用的。\n\n\nrm-trash: Shell#\n\nhttps://github.com/nateshmbhat/rm-trash\n\n\n\n不过 ~/tmp 实际已被删除到未知域。\n\n优点：\n\n 1. 支持 Linux。\n 2. 代码写的很漂亮。\n\n缺点：\n\n 1. 不太支持 macOS，可以删除文件但在 macOS 下执行有报错。\n 2. 删除的目录不是 macOS 的 .Trash 目录，无法在 macOS 的废纸篓中找到并放回原处。\n 3. 安装有点麻烦。\n\n\nrmtrash: Shell#\n\nhttps://github.com/PhrozenByte/rmtrash\n\n\nrmtrash for Mac OS X: Objective-C#\n\n * https://github.com/sebikeller/rmtrash-for-Mac-OS-X\n\n\n参考#\n\n * Why doesn't the 'rm' command dump file in Trash?\n * How can I make 'rm' move files to the trash can?\n * https://github.com/andreafrancia/trash-cli\n * 回收站功能在 Linux 中的实现\n\n\n总结#\n\n基于上面的这么多的对比，我实现了一个便于安装、使用的脚本，欢迎使用。\n\nhttps://github.com/hotoo/rm-trash\n\n","routePath":"/blog/post/2019/rm-to-trash","lang":"zh-CN","toc":[{"text":"AppleScript","id":"applescript","depth":2,"charIndex":225},{"text":"rmtrash 1","id":"rmtrash-1","depth":2,"charIndex":-1},{"text":"rmtrash 2: Objective-C","id":"rmtrash-2-objective-c","depth":2,"charIndex":589},{"text":"rmtrash 3: Shell","id":"rmtrash-3-shell","depth":2,"charIndex":778},{"text":"rm-trash: Shell","id":"rm-trash-shell","depth":2,"charIndex":943},{"text":"rmtrash: Shell","id":"rmtrash-shell","depth":2,"charIndex":1170},{"text":"rmtrash for Mac OS X: Objective-C","id":"rmtrash-for-mac-os-x-objective-c","depth":2,"charIndex":1228},{"text":"参考","id":"参考","depth":2,"charIndex":1320},{"text":"总结","id":"总结","depth":2,"charIndex":1498}],"domain":"","frontmatter":{"0":{"template":"post.html"},"1":{"date":"2019-03-04T00:00:00.000Z"},"2":{"category":"Technology"},"3":{"tags":"rm, Trash, Mac, Terminal"}},"version":""},{"id":198,"title":"CSS 颜色值规范革命・去洁癖化","content":"#\n\n由于历史原因，古代前端开发写 CSS 为了统一大小写，和节省网络流量，定义 CSS 颜色值的规范如下：\n\n 1. 和所有 CSS 值保持一致，统一使用小写字符；\n 2. 为了尽量节省流量传输，能用 3 位简写的统一用 3 位简写。\n\n\n\n这在古代没有生产力工具的情况下，主要通过人肉来保障执行这些规范，老一辈前端忍耐力很好，逐渐习惯了这一约定。目前绝大部分仓库都沿用这一规范。\n\n随着生产力的发展，前端早已不直接书写 CSS 代码，而是类似 less，sass\n之类的上层语言，代码可读性和可维护性才是最重要的，但颜色值还继续延续着古老的传统。\n\n这些扭曲人性的古老传统，其阻碍可读性和可维护性的影响越来越突出。\n\n可读性：大写字符具有更好的可读性。\n\n\n\n可维护性：\n\n * 新增：Sketch 里复制和生成出来的颜色值都是 6 位大写字符的，何苦要人肉改成 3 位小写；\n * 修改：一个 原本 6 位颜色（例如 #FFFFFE 改为 #FFFFFF）后，为了所谓洁癖要人肉改成 3 位（#FFF）；反之亦然，修改一个 3\n   位的可能也需要改成 6 位，都是不必要的体力劳动。\n\n新增示例：（即使是 Vim 编辑器之神，也需要 viwu3x 或 ciwfff 这么多键来完成修改。）\n\n\n\n修改示例：\n\n\n\n\n\n代码是写给人看的，顺便给机器执行。\n\n简写 3 位的方式来减少体积这是编译工具考虑的事情，给人看的代码不要削足适履。\n\n我建议 CSS 颜色值规范：\n\n 1. 建议书写完整的 6 位；\n 2. 建议大写。不限制大小但同一值大小写相同也行。","routePath":"/blog/post/2021/css-color-value-spec","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"category":"Technology"},"1":{"tags":"CSS"},"2":{"date":"2021-07-30T00:00:00.000Z"}},"version":""},{"id":199,"title":"","content":"","routePath":"/blog/post/2021/underline-file-name-or-camel-case","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"0":{"category":"Technology"},"1":{"tags":null},"2":{"date":"2021-09-27T00:00:00.000Z"}},"version":""},{"id":200,"title":"Vim markdown plugins PK","content":"#\n\nMarkdown 是我最常用的文档读写格式，需要频繁用到；Vim 也是我最常用的编辑器，需要在 Vim 中处理 Markdown， 因此调查了一番 Vim 的\nMarkdown 插件，为了更好的文档书写和阅读体验。\n\n\nhttps://github.com/tpope/vim-markdown 1 星#\n\n 1. 显示隐藏\n    \n    * 默认开启\n    * 只支持加粗、斜体，其他都不支持。\n\n 2. 折叠\n    \n    * 无。\n    * 可以配合 masukomi/vim-markdown-folding 插件。\n\n 3. 链接：没有 <Tab> 获得焦点功能，不能打开链接\n\n 4. 列表\n    \n    * 完全没有自动补全列表项功能，插入模式回车，或普通模式 o, O 等都没有。\n\n 5. 不支持表格\n\n\nhttps://github.com/plasticboy/vim-markdown 2 星#\n\n 1. 隐藏显示\n    \n    * 需要设置 autocmd FileType markdown set conceallevel=2 隐藏功能，默认没开启。\n    * 代码块隐藏不是很好，显示了反而可读性更好。\n    * 内联代码隐藏了也 OK，但没有给合适的语法高亮。\n\n 2. 折叠\n    \n    * 可以折叠标题栏，包含子标题。\n    * 不稳定，经常不能折叠。\n    * 折叠在标题栏下一行，我希望是折叠中标题栏本身。\n\n 3. 链接没有 <Tab> 获得焦点，不能打开链接。\n\n 4. 列表项\n    \n    * 普通模式下 <o> 不会新开列表项，且缩进有问题。\n    * 只支持 - + * 开启头的列表回车时自动开启新列表项，不支持有序列表自动开启。\n    * 不支持 checkbox，被当作普通列表项，回车只会自动开启新列表。\n    * 空行时不会自动回缩缩进至取消列表项。\n\n 5. 需要手工 :TableFormat 命令格式化表格，不像 vimwiki 一样自动格式化。\n\n\nhttps://github.com/gabrielelana/vim-markdown 3 星#\n\n 1. 隐藏显示\n    * 默认不支持\n    * let g:markdown_enable_conceal = 1 开启，功能刚刚好。\n 2. 折叠\n    * let g:markdown_enable_folding = 1 开启，功能完备。\n 3. 链接：\n    * 普通链接识别不准确，如果链接定格写，协议部分不高亮\n 4. 画蛇添足：内置了单词拼写检查，所有中文都会显示红色波浪线报错。\n    * let g:markdown_enable_spell_checking = 0 关闭\n    * <Tab> 不能获得焦点。\n 5. 列表项\n    * 不支持有序列表\n    * 有自动补全新列表项\n 6. 表格\n    * 配合 godlygeek/tabular 按 <Leader>ft 格式化。\n    * 但是不支持带标题栏的语法，会无法格式化。\n    * 插入模式输入时有较好的体验，映射了 |\n\n\nVimwiki 4 星#\n\n * 隐藏显示，支持很完备。\n * 折叠：不支持\n * 链接：支持高亮、隐藏、打开本地链接和远程链接。\n * 列表：\n   * 强大的列表项支持\n   * 缺点：回车换行会先切换到普通模式再切到插入模式，RIME 输入法回无法回切状态，导致每次换行都要重新切输入法。\n * 表格：强大的表格格式化。\n\n最大的缺点： 卡慢。\n\n建议可以使用早期版本。我正在考虑是基于 gabrielelana/vim-markdown 扩展，还是基于 vimwiki 裁剪优化。","routePath":"/blog/post/2021/vim-markdown-plugins","lang":"zh-CN","toc":[{"text":"https://github.com/tpope/vim-markdown 1 星","id":"httpsgithubcomtpopevim-markdown-1-星","depth":2,"charIndex":112},{"text":"https://github.com/plasticboy/vim-markdown 2 星","id":"httpsgithubcomplasticboyvim-markdown-2-星","depth":2,"charIndex":372},{"text":"https://github.com/gabrielelana/vim-markdown 3 星","id":"httpsgithubcomgabrielelanavim-markdown-3-星","depth":2,"charIndex":885},{"text":"Vimwiki 4 星","id":"vimwiki-4-星","depth":2,"charIndex":1354}],"domain":"","frontmatter":{"0":{"category":"Technology"},"1":{"tags":"Vim"},"2":{"date":"2021-09-16T00:00:00.000Z"}},"version":""},{"id":201,"title":"MacVim 释出 r182 版","content":"#\n\nMacVim r182 更新到 Vim 9.1.1887\n\n此更新仍然基于 macOS 15 Sequoia 构建，不包含针对 macOS 26 Tahoe 的任何特定修复或改进。这些将在未来的更新中提供。\n\n\n将 macOS 10.13 - 10.15 支持移至遗留版本#\n\n目前，MacVim 二进制发布版本分为两个版本：标准版本（macOS 10.13 或更高版本）和遗留版本（macOS 10.9\n或更高版本）。从下一个发布版本（r183）开始，标准版本将要求 macOS 11.0 Big Sur（由于 Xcode 26 的要求），而 macOS\n10.13-10.15 用户将需要使用遗留版本。这将基本上是一个透明的变更，更新器将自动更新到正确的版本。遗留版本对用户来说应该几乎相同，因为他们使用的是较旧的\nmacOS 版本，这些版本从一开始就无法利用新的操作系统功能。\n\n未来我们可能会移除对 macOS 10.9-10.12 的支持，但目前它们仍然受支持。\n\n\n特性：更好的鼠标支持#\n\n在 MacVim 中，滚轮的使用体验应该会更好。现在，小幅度滚动保证至少滚动一行，并且水平滚动（Shift\n滚动）现在可以正常工作。你还可以在“输入”设置面板中关闭 macOS 的滚轮加速，以滚动固定数量的行。\n\n鼠标的第四和第五个按钮现在可以绑定到 Vim 映射中的 <X1Mouse> 和 <X2Mouse> （ :h X1Mouse ）。\n\n\nVim 新特性#\n\n * Diff 差异模式改进\n   * Vim diff 现在可以高亮显示行内每个字符或每个单词的差异。默认情况下使用每个字符的高亮显示。参见 \"inline\" 下的 :h\n     'diffopt' 。v9.1.1243\n   * Diff 锚点允许对 diff 算法跨文件对齐文本的方式和位置进行更明确的控制 ( :h diff-anchors )。v9.1.1557\n * 许多自动补全的改进。以下是一些高亮显示：\n   * 新选项： autocomplete 。在输入时获取补全建议。参见 :h ins-autocompletion 。v9.1.1590\n   * 模糊匹配现在使用 fzf 算法。v9.1.1627\n   * 弹出菜单边框现在可以设置样式（ :h 'pumborder' / :h 'completepopup' ）。v9.1.1835 / v9.1.1856\n   * 在使用插入模式补全时，现在可以指定自定义补全源（ :h 'complete' ）。v9.1.1301\n   * set completeopt+=nearest 将根据光标附近的距离对补全项进行排序。v9.1.1308\n   * 命令行补全\n     * 搜索命令如 / 和 :g 现在可以 Tab 补全。 v9.1.1490 v9.1.1526\n     * 命令如 :filetype 和 :highlight 具有更好的自动补全。 v9.1.1340 / v9.1.1138\n * 新的垂直标签面板（ :h tabpanel ）。 v9.1.1391\n   * 新增可选捆绑插件（使用 packadd 启用它们）：\n   * hlyank ( :h package-hlyank ): 简要高亮上次复制命令的区域\n * 新增命令：\n   * :uniq ( :h :uniq ): 删除相邻重复行 v9.1.1477\n\n\n综合#\n\n * Sparkle（MacVim 的更新器）现已更新至 2.8.0 版本。 #1605\n\n\n安全修复#\n\n * 修复了 MacVim 错误地设置 get-task-allow 权限的问题，这可能导致其他用户安装的应用程序检查该权限。 #1585\n\n\n修复#\n\n * 解决了在非视觉模式下，macOS 服务（可在\"服务\"菜单中找到）无法插入文本的问题。 #1571 #1569\n * 修复了 guifont 不接受带下划线的 PostScript 名称（例如\"CascadiaMono-Regular_Light\"）的问题。 #1600\n * MacVim 现在使用标准的 v:colornames 变量来选择高亮颜色。 #1568\n * Vim 语法现在支持 MacVim 特定的函数 showdefinition() 。 #1601\n\n\n兼容性#\n\n需要 macOS 10.9 或更高版本。（10.9 - 10.12 需要下载单独的旧版本构建）\n\n脚本接口与这些版本兼容：\n\n * Lua 5.4\n * Perl 5.34\n * Python2 2.7\n * Python3 3.9 或更高版本\n * Ruby 3.4","routePath":"/blog/post/2025/macvim-r182","lang":"zh-CN","toc":[{"text":"将 macOS 10.13 - 10.15 支持移至遗留版本","id":"将-macos-1013---1015-支持移至遗留版本","depth":2,"charIndex":108},{"text":"特性：更好的鼠标支持","id":"特性更好的鼠标支持","depth":2,"charIndex":441},{"text":"Vim 新特性","id":"vim-新特性","depth":2,"charIndex":629},{"text":"综合","id":"综合","depth":2,"charIndex":1453},{"text":"安全修复","id":"安全修复","depth":2,"charIndex":1505},{"text":"修复","id":"修复","depth":2,"charIndex":1584},{"text":"兼容性","id":"兼容性","depth":2,"charIndex":1829}],"domain":"","frontmatter":{"0":{"Category":"Technology"},"1":{"tags":"Vim"},"2":{"date":"2025-11-09T00:00:00.000Z"}},"version":""},{"id":202,"title":"读书","content":"#","routePath":"/books/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":203,"title":"","content":"","routePath":"/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{"sidebar":false,"pageType":"pages"},"version":""},{"id":204,"title":"闲耘的诗","content":"#\n\n\n陀螺 （2004-02）#\n\n在被抽打中不羁执着，在痛苦里继续发现快乐。\n\n信仰唯有围绕我心，才能实现不倒的自我。\n\n\n曾经有一份真挚的爱情 (2005)#\n\n曾经我把一份真挚的爱情放在她面前\n\n她没有珍惜\n\n等失去她的时候我才追悔莫及\n\n人世间最痛苦的事莫过于此\n\n如果上天能够给她一个再来一次的机会\n\n我希望那个女孩对我说三个字：\n\n请重试\n\n我问还要试多少次 ?\n\n我希望只是一万次\n\n可她说：\n\n一辈子\n\n\n闲・耘 (2007-05-20)#\n\n看风扫尘事；\n\n听雨踩泥声。\n\n\n是非曲直 (2017-06)#\n\n可将曲直比高下；\n\n勿与口舌争是非。\n\n\n没人管着你 (2022-05-04)#\n\n小时候，妈妈说：\n\n现在好好读书学习吧，\n\n长大了想怎么玩怎么玩，\n\n没人管你。\n\n现在正值壮年，老婆说：\n\n多陪陪女儿吧，\n\n一眨眼她就长大了，\n\n以后你想多陪她将不得。\n\n老婆还说：等女儿长大了，\n\n你想怎么自由自在玩都可以。\n\n没人管你。\n\n我信你个鬼，\n\n女儿长大了，她就会来管我：\n\n老爸，别喝酒了，对身体不好。\n\n老爸，别骑车吧，多危险呀。\n\n女儿也许会说：\n\n等你退休了，\n\n想干什么干什么，\n\n没人管你。\n\n胡说！你懂什么？\n\n60岁以后，\n\n即使我心有余而力充足，\n\n即使你祖母、你母亲、还有你，\n\n都不拦着我，\n\n“祖国母亲”大人也会拦着，\n\n高龄、高血压、心脏病患者🈲️止入内！\n\n闲耘 (hotoo)\n\n2022-05-04 青年节","routePath":"/poem/","lang":"zh-CN","toc":[{"text":"陀螺 （2004-02）","id":"陀螺-2004-02","depth":2,"charIndex":3},{"text":"曾经有一份真挚的爱情 (2005)","id":"曾经有一份真挚的爱情-2005","depth":2,"charIndex":63},{"text":"闲・耘 (2007-05-20)","id":"闲耘-2007-05-20","depth":2,"charIndex":211},{"text":"是非曲直 (2017-06)","id":"是非曲直-2017-06","depth":2,"charIndex":247},{"text":"没人管着你 (2022-05-04)","id":"没人管着你-2022-05-04","depth":2,"charIndex":285}],"domain":"","frontmatter":{},"version":""},{"id":205,"title":"项目","content":"#\n\n\npinyin#\n\n最流行的开源汉字转拼音库之一，使用 TypeScript/JavaScript 实现，运行速度快，字库全，支持简体中文、繁体中文和各种偏僻汉字。\n\n * WebSite: https://pinyin.js.org\n * GitHub: https://github.com/hotoo/pinyin\n\n\nMarkline#\n\n基于 Markdown 格式的轻量级时间线(Timeline)软件，目前有 Web 版、Obsidian 版，其他版本（如\nVSCode、Eleteron）开发中， 敬请期待。如果您有其他需求，请提交 Issue、或给我发送邮件。\n\n * WebSite: https://hotoo.github.io/markline\n * GitHub: https://github.com/hotoo/markline\n * Obsidian: https://github.com/hotoo/obsidian-markline\n\n演示：\n\n * 我的一生： https://hotoo.github.io/life/\n * 曾养过的 Samoyed 犬： https://hotoo.github.io/samoyed/ 名字叫 Summer，因为是夏天出生。\n\n\ngitopen#\n\n命令行(CLI)用户的福音，直接在命令行环境一键提交 PR/MR、打开 Git 仓库主页、Issues 页面等。\n\n * GitHub: https://github.com/hotoo/gitopen\n\n\ngit-branch-alias#\n\n一个给 Git 分支添加别名的命令行工具，解决蚂蚁集团、字节跳动、抖音集团等公司级 Git 平台的分支命名规范复杂不易识别、不易输入的问题。\n\n * GitHub: https://github.com/hotoo/git-branch-alias\n\n\nGitLab-Notifications#\n\n早年开源的 GitLab 没有通知中心，通知都是通过邮件发送和接收。项目协同时会很麻烦，需要打开邮件通知（这样每封邮件都会打扰你），\n收到提及或关注的通知时，需要先打开邮箱、再点击链接到相关的 Issue/MergeRequest，处理到什么位置和进度都是不自动化的。\n\n这个浏览器插件可以关注特定仓库，或者被提及的任务才给你通知，避免打扰。同时可以点击通知消息一键打开相关 Issue/MergeRequest，\n直接定位到上次处理的位置。通知中心还会列出所有待处理的任务，提高异步处理任务效率。\n\n * GitHub: https://github.com/hotoo/gitlab-notifications\n * GitLab: https://gitlab.com/hotoo/gitlab-notifications\n\n\nrm-trash#\n\nMacOS 系统中命令行(CLI)环境下安全的一键删除文件、删除目录的软件。发现误删时，可以在回收站中一键放回原处。\n\n * GitHub: https://github.com/hotoo/rm-trash\n\n\nVim desktop calendar#\n\n一个 Vim 主题、可一键打印、方便放置在办公桌面上的纸质日历。\n\n继承 Bram Moolenaar (米勒) 的遗志。\n\n * WebSite: link\n * GitHub: https://github.com/hotoo/vim-desktop-calendar\n\n\npangu.vim#\n\n盘古开天地，化混沌为清朗，给汉字和英文之间添加盘古之白的 Vim 插件，在保存文件时自动规范化。\n\n * GitHub: https://github.com/hotoo/pangu.vim\n\n\ncanendar-vim#\n\n由于 mattn/calendar-vim 长期未维护，提交的年报、月报、周报等功能未被合并，因此保持了 Fork。\n\n * GitHub: https://github.com/hotoo/calendar-vim\n\n\njsgf.vim#\n\n增强的 TypeScript, JavaScript, React, Vue, package.json 版 Vim gf 指令，一键打开跳转到光标所在文件。\n\n * GitHub: https://github.com/hotoo/jsgf.vim\n * For Alibaba's Eggjs Framework: https://github.com/eggjs-gf.vim\n * For ByteDance's Gulu Framework: https://github.com/hotoo/gulu-gf.vim\n\n\nUniString#\n\n一个高性能的使 TypeScript/JavaScript 支持 Unicode String 的类库，让 3 字节、4 字节或更长字节的字符、Emoji\n等作为完整的字符进行处理，避免将多字节字符错误的拆断。\n\n * GitHub: https://github.com/hotoo/unistring\n\n\ndetector#\n\n一个浏览器环境识别库，早年很受欢迎，甚至得到 webpack 的青睐，奈何我当时认知不够，拒绝了 webpack 的橄榄枝。\n\n * GitHub: https://github.com/hotoo/detector\n\n\nversioning#\n\n一个语义化版本号比较模块。\n\n * GitHub: https://github.com/hotoo/versioning\n * Npm: https://www.npmjs.com/package/versioning\n\n\norderby#\n\n一个类似 SQL order by 排序语法的函数库，让排序操作快速、清晰、易读。\n\n * GitHub: https://github.com/hotoo/orderby","routePath":"/project/","lang":"zh-CN","toc":[{"text":"pinyin","id":"pinyin","depth":2,"charIndex":3},{"text":"Markline","id":"markline","depth":2,"charIndex":165},{"text":"gitopen","id":"gitopen","depth":2,"charIndex":558},{"text":"git-branch-alias","id":"git-branch-alias","depth":2,"charIndex":672},{"text":"GitLab-Notifications","id":"gitlab-notifications","depth":2,"charIndex":818},{"text":"rm-trash","id":"rm-trash","depth":2,"charIndex":1208},{"text":"Vim desktop calendar","id":"vim-desktop-calendar","depth":2,"charIndex":1326},{"text":"pangu.vim","id":"panguvim","depth":2,"charIndex":1488},{"text":"canendar-vim","id":"canendar-vim","depth":2,"charIndex":1598},{"text":"jsgf.vim","id":"jsgfvim","depth":2,"charIndex":1724},{"text":"UniString","id":"unistring","depth":2,"charIndex":2001},{"text":"detector","id":"detector","depth":2,"charIndex":2168},{"text":"versioning","id":"versioning","depth":2,"charIndex":2290},{"text":"orderby","id":"orderby","depth":2,"charIndex":2416}],"domain":"","frontmatter":{},"version":""},{"id":206,"title":"Vim desktop Calendar","content":"#\n\n> for Bram Moolenaar （米勒） https://moolenaar.net/#Calendar\n\nA desktop calendar for 2026, made from one sheet of paper. After folding, one\nside contains a useful 12-month calendar. On the other side there is brief\ninformation about ICCF-Holland, and Vim. All files are PDF format, about 628\nKbyte.\n\nlanguage - paper size\n\nEnglish - A4\n\nEnglish - Letter\n\nDutch - A4\n\n--------------------------------------------------------------------------------","routePath":"/project/vim-desktop-calendar","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":207,"title":"赞助 (Sponsors)","content":"#\n\n如果我的工作帮助到了您、或您的公司，您可以使用 GitHub Sponsor、支付宝、微信赞助我，\n稍后您会出现在赞助列表中，您可以将赞助时写上备注信息，或直接联系我。\n\n\n赞助方式：#\n\n\n赞助方#\n\n\n来自 GitHub Sponsors#\n\nhttps://github.com/sponsors/hotoo\n\n\n来自微信#\n\n捐助者   捐助金额      捐助日期                        捐助附言\n*玲    ￥55.00    2024-12-01                  \n*季    ￥10.00    2024-05-17                  \n*Z    ￥1.00     2024-04-23 你好，可以请教么？+***    \nd*    r ￥0.10   2023-11-01                  \n*😜   ￥10.00    2023-09-14 感谢hotoo/pinyin   \nZ*d   ￥100.00   2022-02-08 看到pinyin库聊表心意    \n*欢    ￥0.99     2021-09-05                  \n*拿    ￥30.00    2021-06-26                  \nk*g   ￥2.00     2020-08-01                  \n*罗    ￥10.00    2020-04-15                  \n*贵    ￥10.00    2019-08-23                  感谢你的拼音库！\n*围    ￥1.00     2019-07-01                  pinyin\n疾*y   ￥1.00     2019-05-09                  感谢作者\n*🌄   ￥1.00     2019-04-18                  希望得到您的回复\n*逸    ￥900.00   2019-01-13                  \n*水    ￥50.00    2018-12-25                  \n*强    ￥2.00     2018-11-10                  \n*海    ￥88.00    2018-11-02                  \n龘*)   ￥5.00     2018-10-15                  \n*口    ￥5.00     2018-09-17                  \n*望    ￥2.00     2018-09-11                  \nd*n   ￥0.01     2018-08-28                  \n*叶    ￥0.05     2018-03-13                  \nG*P   ￥15.00    2018-03-09                  \n*页    ￥8.88     2017-12-18                  \nLiz   ￥0.10     2017-10-25                  test\n\n\n来自支付宝#","routePath":"/sponsors","lang":"zh-CN","toc":[{"text":"赞助方式：","id":"赞助方式","depth":2,"charIndex":89},{"text":"赞助方","id":"赞助方","depth":2,"charIndex":98},{"text":"来自 GitHub Sponsors","id":"来自-github-sponsors","depth":3,"charIndex":105},{"text":"来自微信","id":"来自微信","depth":3,"charIndex":162},{"text":"来自支付宝","id":"来自支付宝","depth":3,"charIndex":-1}],"domain":"","frontmatter":{},"version":""},{"id":208,"title":"文章列表","content":"#","routePath":"/blog/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":209,"title":"文章列表","content":"#","routePath":"/blog/page/2/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":210,"title":"文章列表","content":"#","routePath":"/blog/page/4/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":211,"title":"文章列表","content":"#","routePath":"/blog/page/3/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":212,"title":"文章列表","content":"#","routePath":"/blog/page/6/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":213,"title":"文章列表","content":"#","routePath":"/blog/page/5/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":214,"title":"文章列表","content":"#","routePath":"/blog/page/7/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":215,"title":"文章列表","content":"#","routePath":"/blog/page/8/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":216,"title":"文章列表","content":"#","routePath":"/blog/page/9/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":217,"title":"文章列表","content":"#","routePath":"/blog/page/10/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":218,"title":"文章列表","content":"#","routePath":"/blog/page/11/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":219,"title":"文章列表","content":"#","routePath":"/blog/page/12/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":220,"title":"文章列表","content":"#","routePath":"/blog/page/13/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":221,"title":"文章列表","content":"#","routePath":"/blog/page/14/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":222,"title":"文章列表","content":"#","routePath":"/blog/page/15/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":223,"title":"文章列表","content":"#","routePath":"/blog/page/16/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":224,"title":"文章列表","content":"#","routePath":"/blog/page/17/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":225,"title":"文章列表","content":"#","routePath":"/blog/page/18/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":226,"title":"Categories","content":"#\n\n * Technology (4)","routePath":"/blog/categories/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":227,"title":"Tags","content":"#\n\n * Life (7)\n * Tools (7)\n * Family-Tree (2)\n * Web-Design (14)\n * DateTime (1)\n * Books (1)\n * IM (1)\n * Email (1)\n * 算法 (8)\n * Firefox (2)\n * JavaScript (28)\n * 性能 (2)\n * iGo (1)\n * Music (2)\n * Foobar2000 (1)\n * RegExp (5)\n * Javascript (1)\n * Jobs (1)\n * Vim (36)\n * Blog (4)\n * Cpp (2)\n * CSS (6)\n * Think (1)\n * UED (21)\n * GFW (2)\n * Search (1)\n * Seach (1)\n * Browser (3)\n * HTML (1)\n * CSS3 (1)\n * HTML5 (4)\n * WorldCup (1)\n * 3D (1)\n * 唧唧歪歪 (1)\n * SQL (1)\n * Jokes (1)\n * Encoding (1)\n * IE6 (1)\n * Dropbox (3)\n * Editor (1)\n * [Search Engine](/blog/tags/Search Engine/) (1)\n * Forms (4)\n * Freedom (1)\n * Git (6)\n * Talks (1)\n * BUG (2)\n * .LOG (1)\n * [Text to Speech](/blog/tags/Text to Speech/) (1)\n * Calendar (2)\n * Vimwiki (3)\n * Tee (1)\n * Google (1)\n * HTTP (1)\n * Wiki (1)\n * Confluence (1)\n * Dream (1)\n * Exceptions (1)\n * 设计模式 (1)\n * VimTee (2)\n * 自由的骑行 (2)\n * MacVim (1)\n * SVN (1)\n * Code (4)\n * Indent (1)\n * Github (1)\n * 404 (1)\n * Bugs (1)\n * SSH (1)\n * CDN (2)\n * 金融管理 (1)\n * 软件 (1)\n * [Mac OS X](/blog/tags/Mac OS X/) (1)\n * iOS (1)\n * Jekyll (1)\n * 每周异常 (11)\n * Markdown (1)\n * 翻译 (2)\n * git (2)\n * [Open Source](/blog/tags/Open Source/) (1)\n * 开源 (1)\n * 机械键盘 (1)\n * Style (1)\n * 车，车牌 (1)\n * GPG (1)\n * Tabs (1)\n * dogs (1)\n * Hangzhou (1)\n * rm (1)\n * Trash (1)\n * Mac (1)\n * Terminal (1)","routePath":"/blog/tags/","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":228,"title":"MacVim 释出 r182 版","content":"#\n\nMacVim r182 更新到 Vim 9.1.1887\n\n此更新仍然基于 macOS 15 Sequoia 构建，不包含针对 macOS 26 Tahoe 的任何特定修复或改进。这些将在未来的更新中提供。\n\n\n将 macOS 10.13 - 10.15 支持移至遗留版本#\n\n目前，MacVim 二进制发布版本分为两个版本：标准版本（macOS 10.13 或更高版本）和遗留版本（macOS 10.9\n或更高版本）。从下一个发布版本（r183）开始，标准版本将要求 macOS 11.0 Big Sur（由于 Xcode 26 的要求），而 macOS\n10.13-10.15 用户将需要使用遗留版本。这将基本上是一个透明的变更，更新器将自动更新到正确的版本。遗留版本对用户来说应该几乎相同，因为他们使用的是较旧的\nmacOS 版本，这些版本从一开始就无法利用新的操作系统功能。\n\n未来我们可能会移除对 macOS 10.9-10.12 的支持，但目前它们仍然受支持。\n\n\n特性：更好的鼠标支持#\n\n在 MacVim 中，滚轮的使用体验应该会更好。现在，小幅度滚动保证至少滚动一行，并且水平滚动（Shift\n滚动）现在可以正常工作。你还可以在“输入”设置面板中关闭 macOS 的滚轮加速，以滚动固定数量的行。\n\n鼠标的第四和第五个按钮现在可以绑定到 Vim 映射中的 <X1Mouse> 和 <X2Mouse> （ :h X1Mouse ）。\n\n\nVim 新特性#\n\n * Diff 差异模式改进\n   * Vim diff 现在可以高亮显示行内每个字符或每个单词的差异。默认情况下使用每个字符的高亮显示。参见 \"inline\" 下的 :h\n     'diffopt' 。v9.1.1243\n   * Diff 锚点允许对 diff 算法跨文件对齐文本的方式和位置进行更明确的控制 ( :h diff-anchors )。v9.1.1557\n * 许多自动补全的改进。以下是一些高亮显示：\n   * 新选项： autocomplete 。在输入时获取补全建议。参见 :h ins-autocompletion 。v9.1.1590\n   * 模糊匹配现在使用 fzf 算法。v9.1.1627\n   * 弹出菜单边框现在可以设置样式（ :h 'pumborder' / :h 'completepopup' ）。v9.1.1835 / v9.1.1856\n   * 在使用插入模式补全时，现在可以指定自定义补全源（ :h 'complete' ）。v9.1.1301\n   * set completeopt+=nearest 将根据光标附近的距离对补全项进行排序。v9.1.1308\n   * 命令行补全\n     * 搜索命令如 / 和 :g 现在可以 Tab 补全。 v9.1.1490 v9.1.1526\n     * 命令如 :filetype 和 :highlight 具有更好的自动补全。 v9.1.1340 / v9.1.1138\n * 新的垂直标签面板（ :h tabpanel ）。 v9.1.1391\n   * 新增可选捆绑插件（使用 packadd 启用它们）：\n   * hlyank ( :h package-hlyank ): 简要高亮上次复制命令的区域\n * 新增命令：\n   * :uniq ( :h :uniq ): 删除相邻重复行 v9.1.1477\n\n\n综合#\n\n * Sparkle（MacVim 的更新器）现已更新至 2.8.0 版本。 #1605\n\n\n安全修复#\n\n * 修复了 MacVim 错误地设置 get-task-allow 权限的问题，这可能导致其他用户安装的应用程序检查该权限。 #1585\n\n\n修复#\n\n * 解决了在非视觉模式下，macOS 服务（可在\"服务\"菜单中找到）无法插入文本的问题。 #1571 #1569\n * 修复了 guifont 不接受带下划线的 PostScript 名称（例如\"CascadiaMono-Regular_Light\"）的问题。 #1600\n * MacVim 现在使用标准的 v:colornames 变量来选择高亮颜色。 #1568\n * Vim 语法现在支持 MacVim 特定的函数 showdefinition() 。 #1601\n\n\n兼容性#\n\n需要 macOS 10.9 或更高版本。（10.9 - 10.12 需要下载单独的旧版本构建）\n\n脚本接口与这些版本兼容：\n\n * Lua 5.4\n\n * Perl 5.34\n\n * Python2 2.7\n\n * Python3 3.9 或更高版本\n\n * Ruby 3.4\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2025-11-09","routePath":"/blog/post/macvim-r182","lang":"zh-CN","toc":[{"text":"将 macOS 10.13 - 10.15 支持移至遗留版本","id":"将-macos-1013---1015-支持移至遗留版本","depth":2,"charIndex":108},{"text":"特性：更好的鼠标支持","id":"特性更好的鼠标支持","depth":2,"charIndex":441},{"text":"Vim 新特性","id":"vim-新特性","depth":2,"charIndex":629},{"text":"综合","id":"综合","depth":2,"charIndex":1453},{"text":"安全修复","id":"安全修复","depth":2,"charIndex":1505},{"text":"修复","id":"修复","depth":2,"charIndex":1584},{"text":"兼容性","id":"兼容性","depth":2,"charIndex":1829}],"domain":"","frontmatter":{},"version":""},{"id":229,"title":"文件名：下划线、还是驼峰？","content":"#\n\n很久之前写了个 jsgf.vim 插件，可以在 js 代码中 gf 两键打开 import 的定义文件。\n\n后来又针对 eggjs 的特性写了个 Vim 插件，可以 gf 两键打开 controllers, service 定义文件，阅读 eggjs\n的代码方便多了，例如\n\n\n\n光标在箭头上方的任意位置按 gf 键就可以打开对应的代码定义文件。\n\n\n\n但是有个问题，就是 eggjs 针对文件名带有下划线或中划线的，会替换成驼峰形式。即文件名为\napp/service/path-name/mode_name.js 的路径，Loader 会转换成驼峰形式，在业务代码中必须以驼峰形式调用：\n\n\n\n\n\n当时 eggjs 做这个目的，估计也说为了支持和顺应当时的文件名命名规范，当时大多数命名规范要求文件名用小写字母、数字、下划线和中划线。\n\n但是，这种命名规范真的好吗？\n\n我的答案是：绝对不好。\n\n 1. 一致性：代码中的名字，和实际文件系统名字不一致。\n 2. 确定性：代码中调用的是驼峰的，而实际文件名到底是驼峰，是下划线，还是中划线？这是不确定的。\n 3. 唯一性：下划线和中划线都被替换成驼峰，如果同时存在 2 者甚至 3 者，这个定义不是唯一的。\n\neggjs Loader 要支持这种文件名，一个正则表达式就搞定了。很简单。\n\n是的。但是用户要找到定义它的文件，可就苦了。首先需要知道这种（约定俗成的）替换逻辑（程序员的常识？），其次需要 O(3^n) 的时间复杂度和文件系统查询判断才能\n不那么准确的 找到对应的定义文件。\n\neggjs Loader\n加的这个功能，当时不觉得有什么不好，甚至觉得很不错。但是现在细想起来，有点画蛇添足，如果当时不做这个替换，开发者可以用下划线和中划线，下划线也可以在代码中直接使\n用，中划线你就自己难堪点，用 ctx.servcie['path-name']['mode-name'].method() 也不是不能用。\n\n这样一致性、确定性、唯一性的问题都没有了。少即是多，什么都不做，反而是更好的选择。\n\n--------------------------------------------------------------------------------\n\n随便一提：\n\n有人说，用 vscode 就没这个困扰，确实，用户输入关键字，vscode\n通过模糊算法把所有可能性都列出来，让用户判断和选择，长长的待选列表里确实是有你要的的选项，但更多的是你不要的选项，而且首先你得知道这个黑暗的替换逻辑，其次如果文\n件系统因为不唯一性，出现 2 个甚至 3 个可能的选项，用户是懵的。\n\n排除不确定性，Vim 插件可以 gf 两键准确定位并打开对应文件，不可同日而语。\n\n--------------------------------------------------------------------------------\n\n最后，我不想写个 O(3^n) 复杂度的算法来支持这个东西，然后用了一行命令搞定，业务代码都不用改一行，毫无违和感：\n\n\n\n\n参考#\n\n * https://github.com/eggjs/egg-core/blob/99ef7541b80f73ec4f616628454afde717495f\n   9f/lib/loader/file_loader.js#L230\n\n * 为什么文件名要小写？ - 阮一峰的网络日志\n\n * blog/前端项目命名规范.md at master · wwpeng520/blog\n\n * 文件名下划线还是中划线？ - SegmentFault 思否\n\n--------------------------------------------------------------------------------\n\nCategory: Technology\n\nPublished on 2021-09-27","routePath":"/blog/post/underline-file-name-or-camel-case","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":1312}],"domain":"","frontmatter":{},"version":""},{"id":230,"title":"Vim markdown plugins PK","content":"#\n\nMarkdown 是我最常用的文档读写格式，需要频繁用到；Vim 也是我最常用的编辑器，需要在 Vim 中处理 Markdown， 因此调查了一番 Vim 的\nMarkdown 插件，为了更好的文档书写和阅读体验。\n\n\nhttps://github.com/tpope/vim-markdown 1 星#\n\n 1. 显示隐藏\n    \n    * 默认开启\n    * 只支持加粗、斜体，其他都不支持。\n\n 2. 折叠\n    \n    * 无。\n    * 可以配合 masukomi/vim-markdown-folding 插件。\n\n 3. 链接：没有 <Tab> 获得焦点功能，不能打开链接\n\n 4. 列表\n    \n    * 完全没有自动补全列表项功能，插入模式回车，或普通模式 o, O 等都没有。\n\n 5. 不支持表格\n\n\nhttps://github.com/plasticboy/vim-markdown 2 星#\n\n 1. 隐藏显示\n    \n    * 需要设置 autocmd FileType markdown set conceallevel=2 隐藏功能，默认没开启。\n    * 代码块隐藏不是很好，显示了反而可读性更好。\n    * 内联代码隐藏了也 OK，但没有给合适的语法高亮。\n\n 2. 折叠\n    \n    * 可以折叠标题栏，包含子标题。\n    * 不稳定，经常不能折叠。\n    * 折叠在标题栏下一行，我希望是折叠中标题栏本身。\n\n 3. 链接没有 <Tab> 获得焦点，不能打开链接。\n\n 4. 列表项\n    \n    * 普通模式下 <o> 不会新开列表项，且缩进有问题。\n    * 只支持 - + * 开启头的列表回车时自动开启新列表项，不支持有序列表自动开启。\n    * 不支持 checkbox，被当作普通列表项，回车只会自动开启新列表。\n    * 空行时不会自动回缩缩进至取消列表项。\n\n 5. 需要手工 :TableFormat 命令格式化表格，不像 vimwiki 一样自动格式化。\n\n\nhttps://github.com/gabrielelana/vim-markdown 3 星#\n\n 1. 隐藏显示\n    * 默认不支持\n    * let g:markdown_enable_conceal = 1 开启，功能刚刚好。\n 2. 折叠\n    * let g:markdown_enable_folding = 1 开启，功能完备。\n 3. 链接：\n    * 普通链接识别不准确，如果链接定格写，协议部分不高亮\n 4. 画蛇添足：内置了单词拼写检查，所有中文都会显示红色波浪线报错。\n    * let g:markdown_enable_spell_checking = 0 关闭\n    * <Tab> 不能获得焦点。\n 5. 列表项\n    * 不支持有序列表\n    * 有自动补全新列表项\n 6. 表格\n    * 配合 godlygeek/tabular 按 <Leader>ft 格式化。\n    * 但是不支持带标题栏的语法，会无法格式化。\n    * 插入模式输入时有较好的体验，映射了 |\n\n\nVimwiki 4 星#\n\n * 隐藏显示，支持很完备。\n * 折叠：不支持\n * 链接：支持高亮、隐藏、打开本地链接和远程链接。\n * 列表：\n   * 强大的列表项支持\n   * 缺点：回车换行会先切换到普通模式再切到插入模式，RIME 输入法回无法回切状态，导致每次换行都要重新切输入法。\n * 表格：强大的表格格式化。\n\n最大的缺点： 卡慢。\n\n建议可以使用早期版本。我正在考虑是基于 gabrielelana/vim-markdown 扩展，还是基于 vimwiki 裁剪优化。\n\n--------------------------------------------------------------------------------\n\nCategory: Technology\n\nTags:\n\nPublished on 2021-09-16","routePath":"/blog/post/vim-markdown-plugins","lang":"zh-CN","toc":[{"text":"https://github.com/tpope/vim-markdown 1 星","id":"httpsgithubcomtpopevim-markdown-1-星","depth":2,"charIndex":112},{"text":"https://github.com/plasticboy/vim-markdown 2 星","id":"httpsgithubcomplasticboyvim-markdown-2-星","depth":2,"charIndex":372},{"text":"https://github.com/gabrielelana/vim-markdown 3 星","id":"httpsgithubcomgabrielelanavim-markdown-3-星","depth":2,"charIndex":885},{"text":"Vimwiki 4 星","id":"vimwiki-4-星","depth":2,"charIndex":1354}],"domain":"","frontmatter":{},"version":""},{"id":231,"title":"CSS 颜色值规范革命・去洁癖化","content":"#\n\n由于历史原因，古代前端开发写 CSS 为了统一大小写，和节省网络流量，定义 CSS 颜色值的规范如下：\n\n 1. 和所有 CSS 值保持一致，统一使用小写字符；\n 2. 为了尽量节省流量传输，能用 3 位简写的统一用 3 位简写。\n\n\n\n这在古代没有生产力工具的情况下，主要通过人肉来保障执行这些规范，老一辈前端忍耐力很好，逐渐习惯了这一约定。目前绝大部分仓库都沿用这一规范。\n\n随着生产力的发展，前端早已不直接书写 CSS 代码，而是类似 less，sass\n之类的上层语言，代码可读性和可维护性才是最重要的，但颜色值还继续延续着古老的传统。\n\n这些扭曲人性的古老传统，其阻碍可读性和可维护性的影响越来越突出。\n\n可读性：大写字符具有更好的可读性。\n\n\n\n可维护性：\n\n * 新增：Sketch 里复制和生成出来的颜色值都是 6 位大写字符的，何苦要人肉改成 3 位小写；\n * 修改：一个 原本 6 位颜色（例如 #FFFFFE 改为 #FFFFFF）后，为了所谓洁癖要人肉改成 3 位（#FFF）；反之亦然，修改一个 3\n   位的可能也需要改成 6 位，都是不必要的体力劳动。\n\n新增示例：（即使是 Vim 编辑器之神，也需要 viwu3x 或 ciwfff 这么多键来完成修改。）\n\n\n\n修改示例：\n\n\n\n\n\n代码是写给人看的，顺便给机器执行。\n\n简写 3 位的方式来减少体积这是编译工具考虑的事情，给人看的代码不要削足适履。\n\n我建议 CSS 颜色值规范：\n\n 1. 建议书写完整的 6 位；\n\n 2. 建议大写。不限制大小但同一值大小写相同也行。\n\n--------------------------------------------------------------------------------\n\nCategory: Technology\n\nTags:\n\nPublished on 2021-07-30","routePath":"/blog/post/css-color-value-spec","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":232,"title":"可恢复的 rm 删除","content":"#\n\n用过终端（Terminal）的人都知道， rm 删除的文件，不会像 Mac Finder 里删除文件、文件夹 一样，会先进入到废纸篓（Trash），一旦 rm\n删除，就很难撤销、恢复。\n\n但是作为程序员，做终端里 rm 删除文件是稀松平常的事，那么如何保障在终端中可以放心 大胆的删除文件、文件夹，而不用担心误删后不可恢复呢？\n\n最直接的想法就是 rm 删除的文件也像 Finder 一样先进废纸篓。\n\n我网上搜寻一番，发现了以下几个工具：\n\n\nAppleScript#\n\n在 Mac 下使用命令行或脚本删除文件到废纸篓 这篇文章中介绍，Mac Finder 中删除的文件其实是进入到 ~/.Trash 文件夹。 但是如果简单的讲文件\nmv 到 ~/.Trash 文件夹，是无法做废纸篓里右键恢复到原处的， 因为这个移动操作没有记录完整的操作行为。\n\n通过 AppleScript 可以通知 Finder 删除文件：\n\n\n\n优点：\n\n 1. 删除时有声效。\n 2. 有操作记录可“放回原处”。\n\n缺点：\n\n 1. 首次使用是有授权提示，可接受。\n\n\nrmtrash 1#\n\n在网上找到好几个不同版本但命名相同的 rmtrash 程序，有的是 shell 脚本，有的是 Xcode 程序。\n\n\n\n缺点：\n\n 1. 删除时没有声效。\n 2. 在废纸篓不可直接“放回原处”。\n\n\nrmtrash 2: Objective-C#\n\n * http://www.nightproductions.net/cli.htm\n\n这个版本的 rmtrash 是用 Objective-C 编写的应用程序，但是版本有点老，下载安装好 rmtrash 发现并不能在 macOS Mojave\n(10.14) 中正常运行。\n\n\n\n缺点：不支持 macOS Mojave。\n\n\nrmtrash 3: Shell#\n\nhttps://github.com/LaiJingli/rmtrash\n\n从源码上看，被删除的文件是进入了自定义的 ~/.rmtrash/ 文件夹（这不是期望的）， 另外还有一堆其他的功能，例如 list, mv, restore,\nempty。\n\n缺点：代码写的太烂，我是不会用的。\n\n\nrm-trash: Shell#\n\nhttps://github.com/nateshmbhat/rm-trash\n\n\n\n不过 ~/tmp 实际已被删除到未知域。\n\n优点：\n\n 1. 支持 Linux。\n 2. 代码写的很漂亮。\n\n缺点：\n\n 1. 不太支持 macOS，可以删除文件但在 macOS 下执行有报错。\n 2. 删除的目录不是 macOS 的 .Trash 目录，无法在 macOS 的废纸篓中找到并放回原处。\n 3. 安装有点麻烦。\n\n\nrmtrash: Shell#\n\nhttps://github.com/PhrozenByte/rmtrash\n\n\nrmtrash for Mac OS X: Objective-C#\n\n * https://github.com/sebikeller/rmtrash-for-Mac-OS-X\n\n\n参考#\n\n * Why doesn't the 'rm' command dump file in Trash?\n * How can I make 'rm' move files to the trash can?\n * https://github.com/andreafrancia/trash-cli\n * 回收站功能在 Linux 中的实现\n\n\n总结#\n\n基于上面的这么多的对比，我实现了一个便于安装、使用的脚本，欢迎使用。\n\nhttps://github.com/hotoo/rm-trash\n\n\n\n--------------------------------------------------------------------------------\n\nCategory: Technology\n\nTags: , , ,\n\nPublished on 2019-03-04","routePath":"/blog/post/rm-to-trash","lang":"zh-CN","toc":[{"text":"AppleScript","id":"applescript","depth":2,"charIndex":225},{"text":"rmtrash 1","id":"rmtrash-1","depth":2,"charIndex":-1},{"text":"rmtrash 2: Objective-C","id":"rmtrash-2-objective-c","depth":2,"charIndex":589},{"text":"rmtrash 3: Shell","id":"rmtrash-3-shell","depth":2,"charIndex":778},{"text":"rm-trash: Shell","id":"rm-trash-shell","depth":2,"charIndex":943},{"text":"rmtrash: Shell","id":"rmtrash-shell","depth":2,"charIndex":1170},{"text":"rmtrash for Mac OS X: Objective-C","id":"rmtrash-for-mac-os-x-objective-c","depth":2,"charIndex":1228},{"text":"参考","id":"参考","depth":2,"charIndex":1320},{"text":"总结","id":"总结","depth":2,"charIndex":1498}],"domain":"","frontmatter":{},"version":""},{"id":233,"title":"钱塘之怪现状","content":"#\n\n戊戌年癸亥月某日，钱塘某妇人因小轿车司机未让行遂踹轿车，司机恼怒成羞狠揍妇人， 妇人遂通过记者新闻、微博、论坛等多种途径发声爆光，众键盘侠也假正义之名义声讨\n谴责车主，同时对小轿车、小客车、大客车、大货车、中华田园车、叉车、铲车、自行车、 电动车、摩托车、碰碰车、火车、动车等全国众多车辆，及不文明驾车行为进行了猛烈的\n舆论抨击。\n\n钱塘衙门立即援引十四年前之交规法令，要求所有车辆注册登记上牌，但大客车、大货车、\n铲车、中华田园车等车辆因为体型较大不予登记上牌。准予登记上牌者，首年上牌费千元，\n次年及以后每年五百。另外火车、动车虽然体型更大，但是体制属于国有编制，不在此限。\n\n同时衙门还限制所有车辆上路时间（已登记上牌车辆），所有车辆均仅允许在卯时之前， 戌时之后摸黑上路，否则扣车。按规定时间上路者，亦不允许进入公路、高速、土路、\n地面停车场、地下车库等路段和场所。\n\n恶人因车而行恶事，却罪怪全中华车辆，怪者乎？\n\n妇人弱者乎？非也。除了鸣笛之外，无法发声的车辆才是弱者，孰来为其发声？ （备注：鸣笛亦属于违反衙门规定之行为）\n\n--------------------------------------------------------------------------------\n\n> “杭州图书馆对所有读者免费开放，因此就有乞丐和拾荒者进门阅览。 图书馆对他们的唯一要求，就是把手洗干净再阅读。有人无法接受，找到褚树青馆长，\n> 说允许乞丐和拾荒者进馆，是对其他读者的不尊重。\n> \n> 褚树青回答：我无权拒绝他们入内读书，但您有权利选择离开。”\n\nref\n\n有些人觉得狗狗出现在他们的视野中是对他们的不尊重，动辄要棒杀。 人心何以凶残到如此地步。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2018-11-18","routePath":"/blog/post/dogs-cars","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":234,"title":"带滑块的进度条","content":"#\n\n在支付宝钱包，“我的 - 总资产”里面，有一个累计收益的卡片，其中还有一个带滑块的进度条， 显示我的收益对比同地区理财的用户中，处于什么样的一个水平。\n\n\n\n这种带滑块的卡片，如果不假思索简单处理，做出的效果就会出现进度 0% 和 100% 时在左右超出顶格，滑块只显示一半。\n\n为了解决这个问题，开发者最早的方案考虑的特别复杂，\n\n\n纯 CSS 实现#\n\nhttp://gitlab.alipay-inc.com/h5_release/wealth/blob/3.6.11/src/index/asset/compo\nnents/profitRate/index.jsx\nhttp://gitlab.alipay-inc.com/h5_release/wealth/blob/3.6.11/src/index/asset/compo\nnents/profitRate/index.less\n\n\nJS + CSS 的复杂不完美实现#\n\n\nJS + CSS 的简单完美实现#\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2018-04-11","routePath":"/blog/post/process-with-bar","lang":"zh-CN","toc":[{"text":"纯 CSS 实现","id":"纯-css-实现","depth":2,"charIndex":170},{"text":"JS + CSS 的复杂不完美实现","id":"js--css-的复杂不完美实现","depth":2,"charIndex":400},{"text":"JS + CSS 的简单完美实现","id":"js--css-的简单完美实现","depth":2,"charIndex":421}],"domain":"","frontmatter":{},"version":""},{"id":235,"title":"Git 提效篇","content":"#\n\n集团的流程工具会生成一团奇形怪状的分支名称，要记忆这些分支名是一项难题，默认的 git branch\n列出的本地分支都是几乎无法识别的乱码，如何快速标识、识别、打开这些丑陋的分支名呢？\n\n\n1. 备注分支#\n\n\n\n还可以使用 git branch --edit-description 命令编辑复杂的备注信息。\n\n\n2. 显示备注#\n\n默认 git branch 列出的本地分支不会附带备注信息，git 内置的 git config\nbranch.{branch_name}.description 可以显示单个分支的备注。\n\n以下方法可以一次性列出所有分支，并附上各个分支对应的备注信息。\n\n\n\n\n3. 分支别名#\n\n上面的方法备注了一团乱码的分支名，但真正要切换到这种分支时，仍然需要 git br 列出所有分支，并从中找出目标分支，复制，git co <C-v>。\n\n有没有更便捷的方法呢，答案是肯定的。\n\n\n3.1. git symbolic-ref#\n\nGit 内置了强大的 symbolic-ref 方法，可以给分支增加引用（别名）：\n\n\n\n\n3.2. git-branch-alias#\n\n直接使用 symboilc-ref 虽然可以满足需求，但是用起来非常不方便，这时候可以使用 git-branch-alias 工具来方便管理分支别名。\n\n\n\n\n4. 提交 MR/PR 时自动找到找到目标分支#\n\n特性分支需要合并到迭代分支、主干分支时，要手工找到目标分支也是很困难的，这时候 可以使用 gitopen 这个小工具来帮忙。\n\n\n\ngitopen 会自动找到目标分支，并打开创建 MR 的在线地址，一键提交 MR。\n\ngitopen 还有很多其他方便的特性。\n\n\n参考#\n\n * https://github.com/bahmutov/git-branches\n\n * https://github.com/hotoo/gitopen\n\n * https://github.com/hotoo/git-branch-alias\n\n * https://gist.github.com/mauricerkelly/0b12b20a870d1e38081e\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2017-05-12","routePath":"/blog/post/git-branch","lang":"zh-CN","toc":[{"text":"1. 备注分支","id":"1-备注分支","depth":2,"charIndex":97},{"text":"2. 显示备注","id":"2-显示备注","depth":2,"charIndex":160},{"text":"3. 分支别名","id":"3-分支别名","depth":2,"charIndex":302},{"text":"3.1. git symbolic-ref","id":"31-git-symbolic-ref","depth":3,"charIndex":410},{"text":"3.2. git-branch-alias","id":"32-git-branch-alias","depth":3,"charIndex":480},{"text":"4. 提交 MR/PR 时自动找到找到目标分支","id":"4-提交-mrpr-时自动找到找到目标分支","depth":2,"charIndex":584},{"text":"参考","id":"参考","depth":2,"charIndex":742}],"domain":"","frontmatter":{},"version":""},{"id":236,"title":"HTML Tabs 最佳实践","content":"#\n\nTabs 面板的显示和隐藏一般以 display 来控制显示和隐藏，但是如果默认未显示的 Tabs 面板中渲染需要知道面板宽高的组件 （如\nCanvas，某些轮播组件等）时，就会因为面板在 display:none 的状态下无法拿到宽高导致渲染组件异常。\n\n这里建议 Tabs 使用 position:absolute 来将不可见的组件移动到用户不可见的负坐标区域，需要时再将面板移动到可见区域，\n来避免面板不可见时渲染内部组件异常的问题。而且也可以做一些滑动显示的动画效果。\n\n简单示例代码：\n\nHTML:\n\n\n\nLESS:\n\n\n\n\n切换 Tab 时，面板所在位置问题#\n\n无论使用 display 还是 position 方案，切换 tab 的时候，面板的位置会停留在上个显示的面板离开时的同一位置（默认是 0）。\n\n有两个解决方案：\n\n 1. 对于可以固定面板高度的场景（如整个页面都是 Tab），固定面板容器的高度，则 position 方案在切换 Tab 的时候，\n    默认就定位在当前面板之前停留的位置，但是需要使用 iScroll 类似的方案来实现上下拉回弹，及刷新、加载更多的功能 （也可以使用 Native\n    默认的上下拉回弹功能，但是 Tabbar 会随着整个 webview 一起拉动，体验不是太好）。\n\n 2. 切换 Tab 时，记录各个面板的所在位置，切换回来时使用 scrollTo(x, y) 的方式来滚动到面板上次的位置。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2017-03-21","routePath":"/blog/post/html-tabs","lang":"zh-CN","toc":[{"text":"切换 Tab 时，面板所在位置问题","id":"切换-tab-时面板所在位置问题","depth":2,"charIndex":270}],"domain":"","frontmatter":{},"version":""},{"id":237,"title":"使用 GPG 签名 Git Commits","content":"#\n\n前段时间 GitHub 支持在 Git Commits 中使用 GPG 签名验证，可以避免其他人使用你的 Email 进行 commit。\n\n\n\n\n安装 GPG#\n\n下载地址： https://www.gnupg.org/download/\n\nMac 下有两个可选工具，分别是 Mac GPG 和 GnuPG for OS X，我都尝试了下，觉得 Mac GPG\n相对比较容易点，安装过程中同时引导创建一个 GPG key 存储到 GPG keychain 中，并且在 Git 提交时记住\npassphrase，避免每次提交输入 passphrase。\n\n\n生成 GPG key#\n\n> 如果在安装过程中，自动引导生成了 GPG key 的话，这一步可以省略。\n\n除了安装时引导生成的 GPG key 之外，你还可以手动生成 GPG key：\n\n\n\n\n配置 Git#\n\n配置好 GPG key 之后，可以配置让 git 在某个仓库所有的 commits 都添加 GPG key 验证：\n\n\n\n也可以让本地所有的仓库都进行 GPG 验证：\n\n\n\n\n验证 Git commits#\n\n如果没有设置局部仓库或全局仓库默认开启 commits GPG 验证，提交时可以附加 -S 参考， 要求进行 GPG 验证。\n\n\n\n如果提交使用的账户信息和 GPG 签名不一致，则无法通过 GPG 验证，会导致提交失败。\n\n\n\n正常的话，会提示输入 passphrase 解锁 PGP 密钥，此时可以选中保存到 Mac OS X 系统 的 Keychain 中，避免每次输入\npassphrase。\n\n\n\n\n将 GPG 密钥添加到 GitHub#\n\n这时 push 到 GitHub 仓库的 commits，查看 commits 记录会显示 unverified。\n\n\n\n将上面 export 出来的 GPG 密钥添加到 GitHub 的 SSH and GPG keys 即可。\n\n\n参考#\n\n * GPG signature verification\n * Signing commits using GPG\n * Generating a new GPG key\n * Adding a new GPG key to your GitHub account\n * GnuPG - download\n\n\n延伸阅读#\n\n * A Git Horror Story: Repository Integrity With Signed Commits\n\n * Git 使用中的教训：签名提交确保代码完整可信\n\n * 使用 GPG 签名 Git 提交和标签\n\n * Step-by-step guide on how to create a GPG key on keybase.io, adding it to a\n   local GPG setup and use it with Git and GitHub\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2016-06-11","routePath":"/blog/post/gpg-sign-for-git-comments","lang":"zh-CN","toc":[{"text":"安装 GPG","id":"安装-gpg","depth":2,"charIndex":76},{"text":"生成 GPG key","id":"生成-gpg-key","depth":2,"charIndex":281},{"text":"配置 Git","id":"配置-git","depth":2,"charIndex":378},{"text":"验证 Git commits","id":"验证-git-commits","depth":2,"charIndex":475},{"text":"将 GPG 密钥添加到 GitHub","id":"将-gpg-密钥添加到-github","depth":2,"charIndex":696},{"text":"参考","id":"参考","depth":2,"charIndex":835},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":996}],"domain":"","frontmatter":{},"version":""},{"id":238,"title":"测试代码和可测试代码","content":"#\n\n项目中有一个要将指定时间和当前时间比较，计算相对时间的逻辑（比如显示 3 分钟前），\n由于当前时间和执行测试用例的时机有关，每次执行用例都会不同，如何让这个代码可测试呢？ 有些人可能想到 Mock\n当前时间，测试的时候让当前时间凝固，于是有了如下代码：\n\n\n\n这个业务代码是 可测试 的代码吗？我认为不是。\n\n这个业务代码为了测试，使用了一个不必要的方法，而且让测试代码和业务逻辑相互依赖， 一旦业务代码重构，测试代码将不可测试。这个代码是为测试写的，称之为 测试 代码\n而不是 可测试 代码更合适点。\n\n再举一个例子，还是时间相关的动态数据输入问题：\n\n项目中有一个今日收益更新的提醒消息，只有是今天的更新才显示，所以第一直觉应该是造一个\n收益更新时间是今天的测试数据，而不是造一个固定的数据（可能固定测试数据比较偷懒方便）， 然后篡改业务逻辑中当前时间的计算。\n\n\n\n> 测试代码应该只关注正常的数据输入和输出 （即使输入、输出是难以预测的）。\n> \n> 而不应该关注业务实现逻辑，试图篡改业务代码，让测试可以进行。\n\n更好一点的可测试代码，可以将当前时间传入以便让输入、输出可以预测：\n\n\n\n\n2017-02-09 更新#\n\n群里又有了类似的一个案例，开发想写测试用例来测 location.href 的赋值是否正确， 用以测试页面跳转逻辑是否正确。于是想通过重载 location\n对象来监听给 location.href 赋值时，所赋值是否符合期望。\n\n还辛苦找到 Chrome 出了个小 bug：论如何在 Chrome 下劫持原生只读对象 这么牛逼变态到令人折服的方法。但是，这是正确的方法吗？我认为不是。\n\nlocation 的案例中，我觉得应该是测试赋值给 location.href 的 值本身是否正确， 而不是测试企图篡改 location 来监听 href\n属性是否正确。即：\n\n\n\n单元测试用例只需要测试 getUrl 在各种边界输入条件下，输出是否符合期望就可以了。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2016-06-04","routePath":"/blog/post/test-code-and-testable-code","lang":"zh-CN","toc":[{"text":"2017-02-09 更新","id":"2017-02-09-更新","depth":2,"charIndex":502}],"domain":"","frontmatter":{},"version":""},{"id":239,"title":"末尾的逗号","content":"#\n\n\n\n早期的 JavaScript 运行环境大都不支持末尾多出来的逗号，或者会抛出异常，或者不符合期望。\n\n比如：\n\n\n\n由于不支持尾逗号，我们以前写代码都需要手动去除尾逗号（工具最多提示你这里多了个逗号）。 因此我们增加、删除一个属性、数组项时，总是需要担心相邻项的逗号问题。\n\n比如增加一项：\n\n * 如果被增加项是列表的最后一项，则需要给前一项（原最后一项）添加一个逗号，但被添加项本身不添加逗号。\n   * 新增一项本来并不需要修改前一项，但是在非尾逗号情况下则必须做这个无本质意义的修改。\n   * 这很麻烦，也很容易导致错误。\n   * 实际你只是增加了一项，但你在 diff 中会看到又是删除项，又是增加项。review 时你就需要关注这些无谓的变更。\n * 如果被添加项不是列表的最后一项，则被添加项要加上逗号。\n\n\n\n删除一项也是：\n\n * 你本来只是要删除了最后一项，但你不得不修改前一项。麻烦，容易出问题。\n * 你本来只是删除了一项，但在 diff 中也是看到又是删除，又是增加。\n\n\n\n值得高兴的是，现在的 JavaScript 运行环境、预编译工具、语法检查工具都支持了尾逗号。 一旦我们统一使用尾逗号风格：\n\n * 我们在增加或删除一项时，再也不需要关心相邻项了。\n * diff 看起来也更直观清爽。\n\n新增一项：\n\n\n\n删除一项：\n\n\n\n另外也有些语言是不需要逗号的，每一项都不需要。比如 Markdown 的列表，yml，yaml， xml，html 等。\n\n全要逗号，或者全不要逗号，他们的共同点就是一致性。这种一致性让书写和阅读都非常简洁清晰。 可维护性也更好。\n\n你觉得呢？\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2015-08-10","routePath":"/blog/post/trailing-commas","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":240,"title":"gitopen, Smart partner of git, hg and svn.","content":"#\n\n使用 Git 的你，想必会更喜欢在终端（命令行）中使用 Git。在终端中，可以将 Git 的特性发挥的淋漓尽致。\n\n\n\n咦，我想立即提交一个 Pull/Merge Request 怎么办，还要打开浏览器，输入 Git 仓库的 URL 地址，点击进入 PR 列表，再点击新建\nPR，选择 feat-sample 分支， 点击确认按钮，balabala...\n\n嗯，好麻烦。\n\n于是 Git 的最佳伴侣 gitopen 横空出世了。\n\npush 了新分支，想立即提交 PR/MR，So simple.\n\n\n\n她会把当前分支提交一个新的 PR。\n\n如果你是使用的 GitHub，在发布了新版时可能还想写个 Release Note：\n\n\n\n咦，有个新的想法，提交个 Issue 先：\n\n\n\n再来个 milestone 尝尝：\n\n\n\n这货支持：\n\n * git, hg, svn.\n * Mac OS X, Linux, Windows.\n * GitHub (Enterprise), GitLab (CE, EE), BitBucket (Atlassian Stash), GitCafe\n   (Enterprise) ...\n\n更多功能参考：\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2015-07-24","routePath":"/blog/post/gitopen","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":241,"title":"杭州购车记","content":"#\n\n终于在年前把车的事情搞定了，这是 2015 年做成的唯一一件大事，经历了不少坎坷，一路摸索过来，很多都是懵懂，\n因此想通过这篇流水记录，帮助到一点大家，如果有写的不好不对的地方，大家可以给我提出，我尽力改进。\n\n『车图』\n\n\n驾照#\n\n杭州限牌限行前，我就拿到了驾照，跟另两个同事一起在公司对面的驾校学的。\n\n报名、体检、缴费、领教程学习理论知识，科目一没有拿到满分，但一次性通过了，没有补考。\n\n教练在时间上安排的比较合理，科目二场地练习时，一般每周有两个工作日早上 7 点半左右到驾校练习 1 个半小时，9 点到公司上班。\n（科目二包括项目：出库、倒库、移库、侧方停车、曲线行驶、停坡起步、直角转弯、单边桥、起伏路行驶等）。满分通过。\n\n模拟学习，可以选择周末去坐几个小时。\n\n模拟考试，尽早预约。\n\n路上没开过多少次，大都是邻近考试前两天冲刺恶补，但是很快就熟悉了。 但是教练没教各种灯怎么用，只会转向灯（和刹车灯），大灯都不会。\n考试时不知道怎么关双闪，好紧张，挂科一次。当场补考，很紧张慢腾腾的开，考官说这么好的路况开快点，\n于是加油门、变道、超车，行云流水，把平时学车时的状态发挥出来了，满分通过。 事后同考的同事说，还好你补考 HOLD 住了，表现不错。\n\n从开始学车，到拿到驾照，差不多 3 个月时间，挺快的。\n\n\n购车#\n\n老婆喜欢 SUV，汽车之家上看的也基本都是 SUV，然后去 4S 店看实体车试驾。\n\n * 马自达 CX-5，说实话，外观确实漂亮，操纵也非常好。但是老婆晕车，说坐着头晕。\n * 奔驰 GLA，也挺漂亮，但是紧凑型偏小，早晚被换。\n * 宝马 X1 紧凑型小，拥挤；X3 小贵。\n * 奥迪 Q3 紧凑型有点小，坐着挤；Q5 小贵。\n * 本田 XR-V，CR-V 看着、坐着都不喜欢，没试驾。\n * MINI，老婆很喜欢，但是看了评价都说避震硬垫屁股，综合评价第一辆车不合适。\n * 昂克威，看起来胖嘟嘟的有点可爱，但是试驾起来还是一个胖子步态。\n * 比亚迪・唐，电动车日常上下班代步还是很有优势的，不知道小区车库是否可以安装充电设备。\n   主要考虑到电动车目前可能还太成熟，基础设施也不够齐全。因为是混动，这个价钱可以买个 好点的传统汽油发动机的车。\n * Jeep 自由光，看车的时候正好即将推出，但是我应该是等不到了，图片看起来不错， 但是也有人说 Jeep 车不好，小毛病多。\n * 随便听到公司同事在说大众高尔夫，挺牛逼的样子，虽然我不懂。但是网上一看就不是我的菜。\n * 沃尔沃 XC60，驾驶感不错，车身很稳，老婆说很舒服不晕了，但是小贵。\n * 顺便看了沃尔沃 S60L，总体很喜欢，但不是 SUV。\n\n最后综合多方面情况考虑，选了沃尔沃 S60L，找老婆的朋友的朋友的 4S 店朋友，拿到相对比较高的优惠。\n\n小吐槽下，第一次经历买车很多东西都不懂，被坑到不少。\n\n * 比如车子大约是 8 个月前生产的，放了大半年。虽然是新车没错，而且据说沃尔沃车子小众\n   （但是买车之后我路上经常会碰到沃尔沃的车），所以一般会放的相对久点，看运气。 我建议对于放了时间长的车，如果不能接受，可以要求换车，或者提出其他要求。\n * 被强制安装了导航模块，加了 2 千元左右。\n * 平安银行无息免抵押贷款，本来说不需要购买盗抢险，结果说总行有新政策又要求必须买盗抢险。\n * 有一次在 4S 店结果轮毂被他们蹭花。\n\n\n临牌#\n\n 1. 买车时，4S 店会帮申请一张 15 天的杭州市蓝色临牌。\n 2. 第 15 天时，自己带上身份证、车辆合格证、一致性证书、发票、交强险保单，及其复印件 到车管所申领临牌。自己最多可以申领 2 次，即有最多 45\n    天的杭州临牌可以用。杭州临牌 只能在杭州市辖范围内使用，不可跨市甚至跨省使用，违反被抓的话属于无牌驾驶，直接扣 12 分，扣车。\n 3. 1 号楼拿身份证在服务台拿号等候审核资料。\n\n * 我第一次下午去前面有 100 人，等候了 1 小时左右。\n * 第二次上午 11 点半去，本以为赶不上了，结果没什么人，直接窗户审核资料，缴费，总共 20 分钟左右拿到临牌。\n\n 1. 资料审核完备后拿到回执单缴费，每张临牌 5 元，总共 10 元。\n 2. 缴费拿到另一张回执单等候取牌照，一般 20 分钟左右。\n\n\n竞拍车牌#\n\n 1. 每月 8 日之前提交资料进行审核（3 个月有效期，到期前也是 8 号之前可以提交延长 3 个月有效期）。\n 2. 每月 23 日公布审核结果（登录到系统中查询状态）。\n 3. 每个月的都有竞拍日历，可以自己做个日历通知。\n 4. 5 个工作日的缴付 2000 元的竞价保证金，可以通过银行柜台、网银转账，但不要用支付宝、微信等第三方支付工具。\n 5. 竞价前 2 天可以激活竞价资格，设置竞价密码。\n 6. 一般每月 25 日（遇节假日顺延至工作日）早上 9:00 ~ 15:00 直接进行报价竞拍， 11:00 和 13:00\n    两个整点会统计当时的均价，自行根据实际情况调整报价，每人有 2 次修改报价机会。\n 7. 15:00 时统计出最终均价和底价等数据，可以查询自己是否中标。\n 8. 竞拍到车牌的，下个工作日可以打印《杭州市小客车增量指标竞价收入缴款通知书》1 份，到杭州银行营业厅\n    缴款即可，缴款完成后，杭州银行会给一张《浙江省非税收统一票据》，放好，上牌要用。\n\n * 注：没有杭州银行卡的，只能使用现金缴款，另外银行 ATM 机取款好像有 2 万限额。\n * 注：通知书打印比较痛苦，提示要用 Windows 在 IE 并安装了专用浏览器控件后才能打印， 但是最终使用 A4\n   纸打印出来的尺寸很小，我最终采用了前端工程师特有技术解决了打印结果不完美的问题。\n\n 1. 竞拍日后第 3 个工作日（一般 28 日）18:00 之后（可能会延迟数小时）就可以登录 杭州市小客车总量调控管理信息系统\n    ，在底部有指标信息可以下载和打印。\n\n\n缴税#\n\n 1. 上牌前需要缴购置税（中国是双向收税制度，没办法）。购置税额 = 车辆官方指导价 ÷ 1.17 × 10%\n 2. 缴税地点在杭州汽车城 6 楼的税务大厅，我早上 9 点到那边，人不多，取号就被叫号了。 审核好资料后，拿回执单到缴费窗口刷卡即可，可以用信用卡。15\n    分钟就办好。\n\n所需材料：\n\n * 身份证原件、复印件。\n * 合格证原件、复印件。\n * 发票联、纳税联原件、复印件。\n * 打印的《个人指标证明文件》\n\n\n选车牌号#\n\n可以在网上查可选的号码，和家人朋友一起参谋选择意向车牌号码。\n\n * 《掌上车管》手机 App。游客模式 - 车辆业务 - 自主选号 - 同意 - 输入手机号 - 点击“获取验证码” - 可选车号查询。\n * 机动车号牌自主查询系统\n\n可以很方便的使用任意键查询可选号码，比如 888**。\n\n选好意向车牌后，还可以在上牌前一天选号车牌号码（有效期 3 天，不要太早选号）\n\n * 《掌上车管》手机 App。游客模式 - 车辆业务 - 自主选号 - 同意 - 输入手机号 - 点击“获取验证码” - 自主选号。\n * 浙江省机动车号牌互联网自编自选系统 - 同意 - 手机号 - 验证码 - 确定 - ...\n\n\n上牌#\n\n汽车城也可以办理上牌，但是我在网上看的三墩车管所办理流程，写的很到位，再加上办理临牌时我对这边相对熟悉，所以选择了三墩车管所。\n\n 1. 杭州市公安局交警支队车管所（三墩车管所，古墩路 699 号）东门是不让车进的，要从南边圣苑北街进去。\n\n门口很多代办的，一般要 100 元服务费（4S 店要 300 元比较黑），因为要本人在场，而且业务不是很复杂， 代办没有太多必要。\n\n 1. 开车进南门后往前，沿入口指示牌方向右转直走到底，再右转到底就到 2 号楼门口了，排队，车轮打正，下车， 看到有拿卡片机拍照的工作人员就找他帮你拍照（4S\n    店提供的照片不能用）。\n 2. 去 2 好大厅拍照的几个窗口找给你牌照的工作人员拿照片和《机动车检查记录表》，把车架号拓印贴上，照片留着办理行驶证时要用。\n 3. 拿到后排队并把车往前挪到车棚下，打开发动机仓，解锁车门。\n\n * 合格证原件\n * 机动车检查记录表\n\n 1. 验车的交警是一批车来检验一次，所以要等等。验车交警出来验车时，一般根据车辆停的顺序从前往后验，\n    但国产车和进口车验车交警不同，所以交警可能直接跳过前面的进口车。\n 2. 将《检查记录表》和车辆合格证原件交给验车交警，解开前后车门锁，方便验车。交警主要检查发动机仓、\n    副驾驶座底下看了半天不知道看什么，副驾驶座后面的座位底下也看了下，新车一般没什么问题。\n\n注：因为我的车轮毂被 4S 店刮坏了，多问了 4S 店的销售几句，说他们有个客户，因为车门撞了红色车漆花了，\n产生了明显的不一致，被要求修车重新喷了新漆，所以未上牌期间开车尽量小心，避免给上牌带来麻烦。\n\n 1. 验车 OK 之后，交警会让你把车开走，开到停车场停好，然后回到 2 号楼 1 号窗口等拿回《检查记录表》。\n    如果业务办理人多的话，这期间可以把其他材料放到业务办理窗口排队，后面拿到《检查记录表》后再补充进去。\n\n * 《检查记录表》业务办理是必须的材料，所以如果刚验好车的话，建议放在前面有 5、6 个人的窗口排队。\n * 如果已经拿到了记录表，可以多看看不同的业务办理窗口，排队人数可能很不平均的。\n\n 1. 材料齐全后开始正式业务办理，把工作人员要求的材料交给她就好了，剩下的事情都交她来处理。\n 2. 正常来说，邻近办好业务时，工作人员会给你一个选号单，可以在 2 号大厅东侧的小隔间里的选号机上进行选号。\n\n * 因为我事先通过手机《掌上车管》App 选好了号码，因此这一步免了，工作人员口头跟我确认了车牌号，办理好之后给个回执单。\n * 另外掌上车管选号时可以选择在办理上牌的网点自取，或者邮寄。我想着过年了快递可能不给力，万一过年回家前没寄到就麻烦了，\n   所以选择了自取，但是工作人员告知自取要 10 个工作日后，邮寄则 3 个工作日内寄出。10 个工作日肯定来不及，因此修改为邮寄了，\n   将收件人姓名、手机号、收件地址写到身份证复印件背面空白处即可（可以提前写好）。\n\n 1. 去大厅东侧的缴费窗口缴费，125 元上牌费再加 10 元的金黄色全国临牌费，总共 135 元。\n 2. 在缴费窗口旁边的窗口等待发放行驶证、登记证书、临牌。\n 3. 旁边的另一个窗口拿环保标志。\n 4. 收工。\n\n\n安装车牌#\n\n邮寄是 EMS 到付 10 元，市区内还是不慢的，上周五邻近中午办理好的，周一中午就收到邮寄的车牌了。 因为是防盗螺栓没装过，而且需要专用的螺丝刀，所以花 20\n元请修车工作人员帮忙装好了。另外 4S 店也可以帮忙安装。 其实如果有专用螺丝刀，和安装普通螺丝没太多差别：\n\n 1. 将垫片和螺丝拧紧。\n 2. 将螺帽用力摁进去即可。\n\n注：新的交通法规要求每块车牌安装四个螺丝，否则按照无牌判罚（12 分、扣车、罚款），\n安装不是很麻烦，请人安装也不会因为这个多加钱，没必要把车管所寄给你的螺丝放那里备用。\n\n\n贴标#\n\n车辆合格标志、环保标志、交强险标志都是要贴到前挡风玻璃上的（一般贴在右上角位置）。 直接贴玻璃上后续换新标会比较难揭下来，一般 4S\n店、保险公司、网购汽车用品的商家都会附送静电贴膜， 把车标粘在静电贴膜上，再把静电贴膜贴到车窗上会比较方便。\n\n\n贴膜#\n\n一般防晒防紫外线，但是不宜颜色过深，否则光线暗的地方看不清后视镜，有安全隐患。 同时，2004 年 10 月 1\n日实施的国家标准《机动车运行安全技术条件》（GB7258—2004）第 11.6.4 条规定， 机动车驾驶室必须保证驾驶员前方视野和侧方视野，\n前挡风窗玻璃及风窗以外玻璃用于驾驶员视区部位的可见光透射比不允许小于 70%， 所有车窗玻璃不允许张贴镜面反光遮阳膜。\n\n据悉，车辆进行年检时，检测人员会对车辆驾驶室的“透光率”进行检测， 一般来说，在车辆两侧玻璃上张贴反光膜的车辆都不可能通过“透光率”这个标准。\n\n\n加油卡#\n\n大部分加油站的营业店里都可以办理加油卡，带好身份证原件和 15 元现金作为押金即可，办好后可以当场使用信用卡充值加油。\n\n淘宝有折扣充值的，9.8 折看起来不多，但每加 1 箱汽油的钱，大约可以多加 1、2 升汽油，还是挺不错的了。\n支付宝等网上充值也很方便。但是因为加油卡是芯片卡，网上充值后要去圈存下比较麻烦，不过很多加油站可以自助圈存。\n\n有加油卡的用户，可以自助加油。自助加油要注意安全，静电、明火要小心。\n\n\n汽车用品#\n\n * 盲区镜：贴在两侧后视镜上的小圆镜，我个人喜欢有万向节无边的。\n * 方向盘助力器：大角度打方向盘会非常顺利。\n * 手机支架：个人推荐夹在空调出风口、万向节、吸铁石的这种，小巧简洁实用。\n * 空气清新剂：香水不错，固态的也行。\n * 吸尘器：家用的即可，换个稍小的吸嘴。\n * 免清洗抹布：自己洗车、擦个雨水污渍什么的还是很有用的，比较容易清洗。\n * 后备箱或后排挂钩：挂些不能倒的东西很有用，买不到合适的也可以考虑自制。\n * 对讲机：2 辆车及其以上的车队，沟通起来会比较方便，没有信号的地方也不愁。\n * 陈皮糖、橙子、橘子、晕车贴：防晕车、防饿。\n\n\n其他#\n\n * 汽车之家的《用车小百科》系列不错，可以挑些自己不了解的看看，像车灯语义、山路行车注意事项等。\n * 多看看交通事故视频，自己多想想什么场景应该注意什么，出现状况时应该如何正确应对等。\n * 放平心态，遇到不平用喇叭或车灯提示下就好了，不要太计较。\n * 不要犹豫，该快快、该慢慢；能通过毫不犹豫的快速通过，不能通过也要毫不犹豫的减速停下。\n\n\n灯语#\n\n * 提示后车（大灯、车距等）：短暂雾灯，或危险警告灯（双跳灯）。\n * 提示前车（信号灯变化、注意压线行驶、并线等）：大灯闪两次。\n * 不可超车：左转向灯。\n * 可以超车：右转向灯。\n * 前方盲区：大灯闪一下，比如车库直角转弯处等。\n\n\nTODO#\n\n快没电了，后面抽空再补充附图。\n\n\n参考资料#\n\n * http://www.19lou.com/forum-464848-thread-6561443007363713-1-1.html\n\n * http://www.19lou.com/forum-293-thread-19001324626574730-1-1.html\n\n * http://wenda.haosou.com/q/1378221335061966\n\n * http://jingyan.baidu.com/article/454316ab575e72f7a7c03a91.html\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2016-01-27","routePath":"/blog/post/buying-a-car-in-hangzhou","lang":"zh-CN","toc":[{"text":"驾照","id":"驾照","depth":2,"charIndex":115},{"text":"购车","id":"购车","depth":2,"charIndex":568},{"text":"临牌","id":"临牌","depth":2,"charIndex":1440},{"text":"竞拍车牌","id":"竞拍车牌","depth":2,"charIndex":1814},{"text":"缴税","id":"缴税","depth":2,"charIndex":2514},{"text":"选车牌号","id":"选车牌号","depth":2,"charIndex":2739},{"text":"上牌","id":"上牌","depth":2,"charIndex":3053},{"text":"安装车牌","id":"安装车牌","depth":2,"charIndex":4424},{"text":"贴标","id":"贴标","depth":2,"charIndex":4687},{"text":"贴膜","id":"贴膜","depth":2,"charIndex":4816},{"text":"加油卡","id":"加油卡","depth":2,"charIndex":5085},{"text":"汽车用品","id":"汽车用品","depth":2,"charIndex":5301},{"text":"其他","id":"其他","depth":2,"charIndex":5593},{"text":"灯语","id":"灯语","depth":2,"charIndex":5773},{"text":"TODO","id":"todo","depth":2,"charIndex":5901},{"text":"参考资料","id":"参考资料","depth":2,"charIndex":5926}],"domain":"","frontmatter":{},"version":""},{"id":242,"title":"git+, a hack of git, smart for you.","content":"#\n\n为了信息安全，公司搭建了 gitlab.company.com 管理代码，同时限制了必须使用工作邮箱 hotoo@company.com 进行提交。\n\n公司 gitlab 有大大小小很多仓库，不时的需要 clone 代码下来，有时忘记设置就开始提交， 提交了几次开始 push 到 gitlab 并准备提交 MR\n时发现，push 被拒绝，或者 MR 无法 自动合并，因为没有使用公司的邮箱进行提交。只好取消之前的提交操作，修改邮箱配置 之后重新提交。\n\n虽然 clone 下来配置一次就可以了，但是每个仓库都需要配置，每次 clone 都需要配置， 忘记设置了需要取消之前的提交并再来一次。\n\n有没有办法自动进行配置呢？\n\n于是 gitplus 出现了，它可以根据 git 的子操作命令，及其所在的仓库信息，自动的执行指定命令，帮助你完成一些自动化任务。 例如：\n\n\n\n * 有了 gitplus，你再也不会忘记设置公司邮箱。因此也不需要取消提交再重复提交了。\n\n * 还可以在提交前自动做校验工作。没有 gitplus 之前你只能给每个仓库设置 pre-commit hooks。\n\n * 你也可以发挥自己的想象力，做更多其他的事情。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2015-05-27","routePath":"/blog/post/gitplus","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":243,"title":"集团开源星人奖和 IKBC POKER II 机械键盘","content":"#\n\n很幸运获得了集团开源星人奖：最活跃个人奖，奖品是 IKBC POKER II 机械键盘，同时 还有一件 Tee。\n\n获得这个奖，主要得益于前端天然的开源\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2015-05-27","routePath":"/blog/post/ikbc-poker-ii","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":244,"title":"译：Resource Timing (资源计时) 使用技巧","content":"#\n\nW3C Web 性能工作组 在 2012 年给我们带来了 Navigation Timing，这个 API 现在\n基本上在主流浏览器上都可用。Navigation Timing 定义了一套用于测量主页面性能的 JavaScript API。例如：\n\n\n\n能够度量主页面的时间消耗真是太棒了，但是要诊断现实当中的性能问题，往往需要深入 到各个资源当中。所以我们拥有了更进一步的 Resource Timing\n（资源计时）规范， 这个 JavaScript API 提供类似 Navigation Timing 的功能，但是能精确到每一个资源的 耗时。举个例子：\n\n\n\n到目前为止，Chrome, Chrome for Android, Opera, IE10 和 IE11 浏览器都支持 Resource\nTiming，这也许超过了你的网站 50% 的流量。 这应该可以提供足够的数据，来揭示这些资源缓慢的原因。\n\n使用 Resource Timing 看似很简单，但是当我在写第一个用于生产环境的 Resource Timing 代码\n时，遇到了许多问题。这里我想分享一些现实当中记录 Resource Timing 指标的实用技巧。\n\n\n1. 使用 getEntriesByType(\"resource\") 而不是 getEntries()#\n\n在使用 Resource Timing 来获取当前页面的资源集合的资源耗时性能对象时，许多 Resource Timing 示例都是使用\nperformance.getEntries()，这意味着唯一的 resource timing 对象 由该调用进行返回。但是 getEntries()\n会一并返回潜在的 4 种类型的 timing 对象： resource（资源），navigation （导航）, mark （标记）, 和 measure\n（测量）。\n\n这并没有造成多大问题，因为目前 resource 是大多数网页的唯一类型。 navigation 类型是 Navigation Timing 2\n的一部分，据我所知目前没有被任何浏览器所实现。 mark 和 measure 类型是从 User Timing 规范衍生出来的，在部分浏览器中可用，\n但是还没有被广泛使用。\n\n也就是说，getEntriesByType(\"resource\") 以及 getEntries() 在今天可能返回相同 的结果，但是可能\ngetEntries() 将很快返回多种性能对象的混合集合，所以最好是 使用\nperformance.getEntriesByType(\"resource\")，你可以明确的只获取 resource timing 对象。（感谢 Andy\nDavies 给我解释这一点）\n\n\n2. 使用 Navigation Timing 测量主页面的请求。#\n\n当通过典型的请求获取一个网页的主 HTML 文档，但是这个资源并不能通过 performance.getEntriesByType(\"resource\")\n得到返回，要得到这个主页面 HTML 文档 的 timing 信息，需要使用 Navigation Timing 对象（performance.timing）。\n\n虽然不太可能，当页面上没有其他资源时，这可能会导致错误发生。 例如，刚才 Resource Timing 示例使用如下代码：\n\n\n\n如果一个页面唯一的资源就是主页面的 HTML 文档，然后 getEntriesByType(\"resource\") 返回一个空数组，这时候应用\nelement[0] 会引起 JavaScript 异常。如果你找不到 没有引用子资源的页面，你可以试试\nhttp://fast.stevesouders.com/\n\n\n3. 小心 secureConnectionStart 的问题。#\n\nsecureConnectionStart 属性我们衡量 SSL 协商需要多长时间。这非常重要，我经常 看到 500 毫秒以上的 SSL\n协商时间，甚至更多。secureConnectionStart 有 3 种 可能的值：\n\n * 如果该属性不可用，则必须设置为 undefined。\n * 如果不使用 HTTPS 的，则必须设置为 0.\n * 如果该属性可用，并且使用了 HTTPS，则必须设置为一个时间戳。\n\n关于 secureConnectionStart，有三件事情需要了解下：\n\n首先，在 Internet Explorer 中，secureConnectionStart 的值总是 undefined， 因为它是不可用的（该值被埋在\n[WinINet](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383630(v=vs.\n85\\).aspx) 之下）。\n\n其次，在 Chrome 中有个 BUG 会导致 secureConnectionStart 被错误的设置为 0 的问题。 如果获取一个资源时使用预先存在的\nHTTPS 连接，则 secureConnectionStart 将被设置 为 0，而实际上它应该是一个时间戳。（详情请参考 bug 404501 ）\n为了避免这个问题，测量 SSL 协商时间时，一定要检查 secureConnectionStart 既不是 undefined 也不是 0：\n\n\n\n第三，规范中关于 这一行 有一些误导：“...如果当前页面的协议是 HTTPS，这个属性必须立即返回用户代理(user agent)开始握手过程的时间...”\n（我的重点）。有可能当前页面是 HTTP，但仍然包含我们需要测量 SSL 协商时间的 HTTPS 资源。 规范应该改为：“...如果资源的协议是 HTTPS\n协议，该属性必须立即返回用户代理开始握手过程的时间...”。 幸运的是，浏览器是使用纠正后的行为，而已就是说， secureConnectionStart\n可用于 HTTP 页面中的 HTTPS 资源。\n\n\n4. 给跨域资源添加 Timing-Allow-Origin HTTP 响应头#\n\n出于隐私保护的原因，在获得资源的 Resource Timing 详情时有跨域限制。 默认情况下，与主页面不同域的资源，下列属性被设置为 0：\n\n * redirectStart\n * redirectEnd\n * domainLookupStart\n * domainLookupEnd\n * connectStart\n * connectEnd\n * secureConnectionStart\n * requestStart\n * responseStart\n\n在某些情况下，仍然希望测量跨域资源的性能，例如，当网站使用不用域名的 CDN（例如 \"youtube.com\" 使用\n\"s.ytimg.com\"），以及某些第三方资源（例如 \"ajax.googleapis.com\"）。 如果资源返回 Timing-Allow-Origin\n响应头，跨域资源的 timing 详情将被授权访问。这个头信息指定了被允许访问 timing 详情的（主页面）来源列表，多数情况下，会使用通配符(*)\n允许所有来源访问。 举个例子，http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\n返回 的 Timing-Allow-Origin 响应头信息是：\n\n\n\n当第三方添加这个响应头信息时，真是太棒了。它允许站长来统计在他们网页上使用的 第三方资源的性能。感谢 Ilya Grigorik\n报告了一些添加了这个响应头的第三方资讯，下面是一些指定了 Timing-Allow-Origin: * 的资源例子：\n\n * Google Hosted Libraries:\n   http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\n * Google+ widgets: https://apis.google.com/js/plusone.js\n * Google Fonts: http://fonts.gstatic.com/s/opensans/v9/DXI[snip...]N3Vs.woff2\n * Facebook widgets: http://connect.facebook.net/en_US/all.js\n * Disqus widgets: http://go.disqus.com/embed.js\n\n当需要访问有限制的 timing 属性时，决定统计 Resource Timing 是非常重要的。\n可以通过检测（上面列出的，secureConnectionStart 除外）限制性属性是否为 0 的方式 来避免限制性问题，我总是使用\nrequestStart。下面是用于在计算详细的性能指标之前， 检测和计算限制性属性是否可用的代码片段：\n\n\n\n做这些检测是非常重要的，否则，当访问这些受限属性时，你不会得到任何异常，除了 这些虚假的数据。当属性受限访问时，它们的值被设置为 0，例如\ndomainLookupEnd - domainLookupStart 翻译成 0 - 0，它返回一个似是而非的结果 0，而这可能并不是真实 DNS 查询时间。\n这将导致过多的指标为 0 而让你过于乐观。\n\n\n5. 理解 0 意味着什么。#\n\n在第 4 节当中提到，一些因为跨域导致的受限访问的 Resource Timing 属性会被设置为\n0。再强调一次，在访问属性详情之前，要检查属性状态是非常重要的。 但是即使受限属性都是可访问的，度量计算的返回结果也有可能是 0，所以理解这意味着\n什么非常重要。\n\n例如，（假设没有访问限制）domainLookupStart 和 domainLookupEnd 的值是两个 时间戳，这两个值之差是该资源在 DNS\n解析上耗时。通常情况下，一个页面中指定的域名 只有一个非 0 的 DNS 解析耗时，因为浏览器会缓存 DNS 解析，所有后续的请求都使用 这个缓存的 DNS\n解析。而且由于跨页面的 DNS 解析缓存，一个页面所有的 DNS 解析 计算结果可能都是 0。关键点：DNS 解析耗时为 0 意味着资源是从缓存中读取的。\n\n同样，对于指定的主机名，如果重复利用已存在的 TCP 连接，那么建立 TCP 连接（connectEnd - connectStart） 的耗时也会是\n0。每个主机有大约 6 个独立的 TCP 连接，这表明应该有 6 个非 0 的 TCP 连接测量值，但是这个主机后续的请求将使用已存在的 TCP\n连接，并且他们的 TCP 连接耗时为 0。关键点：TCP 连接耗时为 0 意味着重复使用了已存在的 TCP 连接。\n\n这同样适用于计算 SSL 协商（connectEnd - secureConnectionStart）。这个可能 有 6\n个以上的资源，但是同一主机名的所有的后续请求可能都使用同一个已存在的 HTTPS 连接，以至于它的 SSL 协商时间为 0。\n\n最后，如果属性持续的为 0，这可能意味资源是从缓存中读取的。\n\n\n6. 确定 304 是否被测量。#\n\n这是另一个 Chrome 稳定版（版本号 36）的 BUG，这个 BUG 在 37 版时被修复。 这个问题已经被修复了，但是由于大多数用户还是使用 Chrome\n稳定版，你当前的性能 指标可能跟实际上的并不相同。这个 BUG 是：一个拥有 Timing-Allow-Origin 的跨域 页面，200 响应状态并不会考虑\n304 响应状态，因此，304 响应下所有的受限属性都 将显示为 0，例如 这个测试页面。\n\n这是不应该发生的，因为从 200 响应的缓存中读取的 Timing-Allow-Origin 头信息 应该应用到 304 响应中。在 Internet\nExplorer 浏览器中就是这样。（可以在 IE 10 或者 11 中尝试 这个页面 来确认。） （感谢 Eric Lawrence 指出这一点。）\n\n这会影响你的 Chrome Resource Timing 结果如下：\n\n * 如果（如第 4 节所述）使用检查 0 值的方式来判断受限字段，则会跳过测量 304 响应， 也就是说值测量了 200 状态响应，但是由于 200\n   状态响应比 304 要慢，所以 Resource Timing 测量总量会比实际的要大。\n * 反之如果不检查受限字段为 0 的情况，会得到许多的 0 值记录， 这实际上又比 304 响应要快，这样 Resource Timing\n   统计结果又会过于乐观。\n\n没有简单的方式来避免这些偏见，但是好消息是这个 BUG 被修复了。另外还可以尝试做的 事情是，304 响应头中发送 Timing-Allow-Origin\n头，不幸的是，流行的 Apache Web 服务器不支持在 304 响应头中发送这个头信息（查看 BUG 51223）。 缺乏进一步证件证明第 4\n节提到那些第三方资源的 304 响应头中的 Timing-Allow-Origin 可以被找到。如前所述，这些第三方资源在 200 响应头中返回\nTiming-Allow-Origin 头， 但是 304 响应头中不返回 Timing-Allow-Origin 头，这真是太好了。 到 Chrome 37\n成为稳定版之前，因为缺少了受限属性的细节，Resource Timing 测量结果 可能偏高或偏低。幸运的是，时间会改变一切。\n\n\n7. 看看 Boomerang（回旋镖）.#\n\n如果你准备写自己 Resource Timing 代码，建议你最好看看 Resource Timing 插件 Boomerang。 （代码在 GitHub\n上。） Boomerang 是 Philip Tellis 维护的一个非常流行的开源 RUM 包。他起初在 Yahoo 工作 的时候就开源了\nBoomerang，而现在作为在 SOASTA 工作的商业版的一部分（mPulse），\n他仍然在持续的提供维护和增强。t它的代码很清晰、简洁和健壮，并解决了上面提到的许多问题。\n\n总之，Navigation Timing 和 Resource Timing 都是非常优秀的新规范，为站长了解他们 的页面性能提供了很好的支持。Resource\nTiming 是这两个规范中更新的一个规范，因此 还是会有一些问题待解决。这些小提示将帮助你充分的利用 Resource Timing 指标。\n我建议你现在就开始监控这些指标，以理解你的网站性能，为了最关心这个问题的真实用户。\n\n> 更新：有一些第三方资源提供了 Timing-Allow-Origin 响应头，以允许站长测量这些 第三方资源的性能：\n> \n>  * Boomerang: http://c.go-mpulse.net/boomerang/CEN[snip...]YQE\n>  * Typekit: https://use.typekit.net/previewkits/pk-v1.js\n\n> 更新：getEntriesByType(\"resource\") 和 getEntries() 不包含 iframe 页面的性能， 如果 iframe\n> 是同源的，可以在父页面通过 contentWindow.performance 对象访问 这些指标。\n\n\n译者补充#\n\n * Resource Timing practical tips - 原文出处。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2014-12-30","routePath":"/blog/post/resource-timing-practical-tips","lang":"zh-CN","toc":[{"text":"1. 使用 `getEntriesByType(\"resource\")` 而不是 `getEntries()`","id":"1-使用-getentriesbytyperesource-而不是-getentries","depth":2,"charIndex":-1},{"text":"2. 使用 Navigation Timing 测量主页面的请求。","id":"2-使用-navigation-timing-测量主页面的请求","depth":2,"charIndex":1174},{"text":"3. 小心 `secureConnectionStart` 的问题。","id":"3-小心-secureconnectionstart-的问题","depth":2,"charIndex":-1},{"text":"4. 给跨域资源添加 `Timing-Allow-Origin` HTTP 响应头","id":"4-给跨域资源添加-timing-allow-origin-http-响应头","depth":2,"charIndex":-1},{"text":"5. 理解 0 意味着什么。","id":"5-理解-0-意味着什么","depth":2,"charIndex":3964},{"text":"6. 确定 304 是否被测量。","id":"6-确定-304-是否被测量","depth":2,"charIndex":4713},{"text":"7. 看看 Boomerang（回旋镖）.","id":"7-看看-boomerang回旋镖","depth":2,"charIndex":5712},{"text":"译者补充","id":"译者补充","depth":2,"charIndex":6492}],"domain":"","frontmatter":{},"version":""},{"id":245,"title":"或者说『耗时包含了 Blocking 部分的时间』","content":"译：严重混乱的 Resource Timing#\n\n\n或者说『耗时包含了 Blocking 部分的时间』#\n\n用 Resource Timing 来同统计资源下载性能 是非常赞的方式，但不幸的是，几乎所有和我聊过的人都是使用 duration 属性，\n而且他们都没有意识到 duration 包含了 blocking 时间。结果 duration 时间\n比实际的下载时间要长很多，超出了开发者意料之外的结果。这个问题在跨域资源中 尤为糟糕，duration\n是唯一可用的。在这篇博文中我将解释这个问题，并提出解决方案。\n\n\nResource Timing 回顾#\n\nResource Timing 规范 定义了收集网页中 所有资源耗时统计的 API。现在可用于 Chrome, Chrome for Android, IE\n10-11, 和 Opera。 可以通过 getEntries(), getEntriesByType() 和 getEntriesByName() 得到一个\nPerformanceEntry 列表，一个 PerformanceEntry 对象包含以下属性：\n\n * name – URL 地址\n * entryType – 通常是 “resource”\n * startTime – 开始处理这个资源的时间（相对开始导航到页面时的毫秒数）\n * duration – 处理这个资源的总耗时（毫秒）\n\n上面的属性在所有的资源中都可用，包括同域和跨域的。而同域的资源拥有另外一些可以 访问的附加属性，这些属性定义在\nPerformanceResourceTiming 接口中。这些属性名称 很简洁清晰，完全可以见名思意，并且以时间顺序排序：\n\n * redirectStart\n * redirectEnd\n * fetchStart\n * domainLookupStart\n * domainLookupEnd\n * connectStart\n * connectEnd\n * secureConnectionStart\n * requestStart\n * responseStart\n * responseEnd\n\n这里有个权威的 处理模型(processing model) 图 显示了这些属性所在的各个不同阶段。备注：duration 相当于 responseEnd -\nstartTime。\n\n\n\n如何使用 Resource Timing 的详细信息，可以参考我的文章 Resource Timing Practical Tips 『译者的中文翻译』\n\n\nduration 中出乎意外的 blocking 膨胀#\n\n出于隐私的考虑，同源资源的 PerformanceResourceTiming 属性是受限的。（备注： 任何资源可以通过 Timing-Allow-Origin\n响应头达到“同源”效果。）现在大约有一半 的资源是跨域的，因此 duration 是度量加载时间的唯一方式。而且即使是同源资源， duration\n也是唯一以增量方式提供的属性，大概是因为它度量了最重要的阶段。 这样一来，所有我见过的 Resource Timing 实现都以 duration\n做为主要的性能指标。\n\n不幸的是，duration 比下载时间要大，它包含了阻塞时间（blocking time）—— 浏览器\n意识到需要下载一个资源，到这个资源实际被下载直接的时间延迟。阻塞会在几种情况时 发生，最典型的资源数量比 TCP 连接数要多的情况。大多数浏览器为每个主机开放了\n6 个 TCP 连接，IE10（8个连接）和 IE11（12个连接）例外。\n\n这个 Resource Timing 阻塞测试页面 有 16 个图片，因此无论哪个浏览器都会阻塞一部分图片。每个图片被编程为在服务器 有 1 秒的延迟，这 16\n个图片，每个图片都显示了 startTime 和 duration。 另外还有这个测试页面在 WebPagetest 中通过 Chrome, IE10 和\nIE11 加载的测试结果， 可以通过查看截屏来分析时序结果。注，为什么所有的图片的 startTime 大致都相同？ 英文这个时间是浏览器解析 IMG\n标签并意识到需要下载改资源的时间，由于先下载的图片 阻塞的原因，但在页面出现后，图片的 duration 值大约步进 1 秒左右。\n\n\n译者补充#\n\n * SERIOUS CONFUSION with Resource Timing - 原文出处。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2014-12-30","routePath":"/blog/post/serious-confusion-with-resource-timing","lang":"zh-CN","toc":[{"text":"Resource Timing 回顾","id":"resource-timing-回顾","depth":2,"charIndex":261},{"text":"`duration` 中出乎意外的 blocking 膨胀","id":"duration-中出乎意外的-blocking-膨胀","depth":2,"charIndex":-1},{"text":"译者补充","id":"译者补充","depth":2,"charIndex":1841}],"domain":"","frontmatter":{},"version":""},{"id":246,"title":"定位到服务器集群的特定节点","content":"#\n\n> 齐宣王使人吹竽，必三百人。南郭处士请为王吹竽，宣王说之，廪食以数百人。 宣王死，湣王立，好一一听之，处士逃。\n> \n> 《韩非子·内储说上》\n\n\n背景#\n\n某日，突然收到报警，某发现实时异常监控趋势图上，静态资源 404 异常有明显的上升。 分析详细的异常信息发现是某个发布操作引起某几个系统引起的。\n\n--------------------------------------------------------------------------------\n\n找到对应的开发，分析结论是部分配置文件未生效，导致拼接资源文件地址错误。 按照业务量计算，这个异常量大约是其中一、两台机器有问题。\n\n可能发布系统或其他问题，重新发布一次仍没能修复这个异常。\n\n我们需要快速定位到这只滥竽，尽快将问题修复。 但是实际上却没有这么简单，我们最终花费 了 7个多小时，最终是因为这个系统正好有 其他发布才顺便解决。\n\n\n\n上图有两个造成异常的发布，分别是『CMS 发布』和『后台系统发布』。\n\n橙色是 JavaScript 实时异常，绿色是静态资源 404 异常。\n\n\n方案#\n\n事后我们坐下来讨论如何解决这个问题，避免在以后遇到类似问题时能快速有效的应对。\n\n\n\n如上图，问题出在某个问题业务应用服务器节点配置文件未生效，拼接出来的 JavaScript 资源地址不正确导致 CDN\n节点未命中而最终回源，源服务器也没有这个文件，最终发生 404 悲剧。\n\n实际的业务系统中，会提供用户访问的节点信息，但是请求静态资源时无法获得这个信息， 是不是有办法在静态资源源服务器上获得来源页面所在的服务器节点信息呢？\n\n 1. 方案一：我们首先想到 Cookie。但是应用服务器和静态资源服务器分别在不同的域名 下，即使在访问应用服务器时写入节点信息到 Cookie\n    中，这个信息也不会携带到静态 资源服务器。『失败』。\n 2. 方案二：CDN 节点域提供外部写 Cookie 的接口，用户访问应用服务时，同时调用接口 在 CDN\n    节点所在域写入用户访问应用服务器节点信息。『放弃』，缺点：\n 3. 成本高。\n 4. 风险大。\n 5. 方案三：然后想到每个应用系统重写静态资源地址，在地址中携带当前应用服务器节点 信息。『放弃』，缺点：\n 6. 成本过高。\n 7. 导致 CDN 命中率下降。\n 8. 方案四：重写用户访问页面地址，附带应用服务器节点信息。成本过高，『放弃』。\n\n从前端角度直接解决这个看似无望，换个思路。\n\n 5. 方案五：在网络内部，使用内部代理。如 curl -I -x internal-host:port url 『可行』，缺点：\n 6. 需要在服务器所在内网执行，指定目标服务器内部 IP，因此只有系统管理员可以操作。\n 7. 而系统管理员不清楚实际应用业务。\n 8. 方案六：如果可以在外部指定服务器节点访问应用，是不是可行呢？\n\n这个跟负载均衡规则有关，如果负载均衡服务器支持这个特性，或可一试。\n\n跟相关同学沟通后，表示可以做。而且从外网直接访问，清楚业务的开发同学可以自行 排查。\n\n『可行』。需要注意的问题：\n\n 1. 逐个击破，定向攻击。\n    1. 可以通过拒绝频繁的指定节点访问请求来防范。\n    2. 可以通过白名单内部 IP 才可以使用。\n 2. 方案七：客户端脚本扫描所有外部资源，并发起请求来确认各个资源状态。『放弃』， 缺点：\n\n * 增加静态资源服务器压力。\n * 增加网络请求和流量。\n\n 8. 方案八：客户端脚本监听静态资源异常事件。HTML5 现在提供了 Performance Timing\n    API，可以用来监控网页及其引用的外部资源加载时间，将来提供类似的 API 可以监听 静态资源的 error 事件也未可知。『期待』\n 9. 方案九：Web 服务器端输出时拦截器扫描。尤其目前前端往后端延伸，能做的事情更多 了。『可行』。\n\n\n结论#\n\n综上所述，在成本、风险、自动化、扩展性等方面来讲，方案九是最优的。\n\n\n延伸思考#\n\n图二所示，这次问题出在业务应用服务器集群的节点 1。\n\n * 如果问题节点是静态资源 CDN 集群的节点 2 呢？\n\n * 问题节点是节点 3？\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2014-04-17","routePath":"/blog/post/find-nodes-from-server-cluster","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":77},{"text":"方案","id":"方案","depth":2,"charIndex":487},{"text":"结论","id":"结论","depth":2,"charIndex":1663},{"text":"延伸思考","id":"延伸思考","depth":2,"charIndex":1704}],"domain":"","frontmatter":{},"version":""},{"id":247,"title":"GitHub, GitLab, or BitBucket?","content":"#\n\n> GitHub 是汇集了众多开源项目的闭源系统，\n> \n> GitLab 是汇聚了较多闭源项目的开源系统。\n> \n> -- @hotoo\n\n对于个人开发者，不可避免的会有私有项目的需求。\n\n目前比较靠谱的私有项目托管服务有：\n\n * GitHub\n * GitLab\n * BitBucket\n\n下面我们稍做评比。\n\n\nGitHub#\n\nGitHub 当下大红大紫，主要在于其社交性质。\n\n对于开源项目来说，上面大量的开发者参与带来了非常活跃的开发氛围。\n\n但是对于私有仓库来说，个人觉得价格偏贵（屌丝气质暴露）。\n\n而且个人账户下的私有仓库，不能共享给个人所拥有的团队账户，因此如果团队账户需要 私有仓库，则需要另外再为团队账户购买。\n\n如果不缺钱，可以考虑 GitHub，甚至还有 Enterprise 版本。\n\n\nGitLab#\n\nGitLab 是当下最火的 Git 仓库管理的开源项目，有提供的 gitlab.com 服务，同时可以自行部署。\n\ngitlab.com 服务可以创建不限数量的私有仓库，除了少量的缺点外，GitLab 几乎可以 媲美 GitHub。\n\n但是，作为完美主义者，真的受不了 GitLab 的一些小伤疤。\n\n\nBitBucket#\n\nBitBucket 是 Atlassian 公司的产品 （还有 Confluence，JIRA， HipChat 等著名产品）。\n\n个人觉得除了 Issues 不够简洁之外，其他都很完美。 适合小团队私有项目托管。\n\n\n对比#\n\n             GITHUB                            GITLAB                           BITBUCKET\n私有仓库         收费教育身份赞助 2年的 Micro Plan           免费，无限制                           免费，限制协作人数\n权限控制         个人账户无控制团队账户有限控制                   仓库级控制指定一个保护分支                    分支级控制\nTransfer     完美                                几乎完美                             完美\n仓库重命名        完美                                不能修改 clone 地址                    完美\n仓库名          完美                                不能使用 .，自动修改为 -                   完美\nIssues       完美                                功能复杂，但界面简洁早期有 Issues ID 缺陷，已修复   功能复杂，界面不够简洁\nIssues URL   完美                                完美                               默认附加可选的标题信息\nPages        username.github.io 仓库gh-page 分支   demo 分支                          username.bitbucket.org 仓库\n自定义域名        每个仓库都可以自定义域名                      无                                个人 Profile 页\n\n\n小结#\n\n * GitHub 适合开源项目管理。不缺钱的同学，私有项目也适合统一在 GitHub 管理。\n\n * GitLab 和 BitBucket 都很适合私有项目的管理。\n\n * GitLab 是开源项目，活跃程度很高，未来很有潜力，如果不在乎那些小硬伤，个人更推荐 GitLab。\n\n * BitBucket 系出名门，产品本身也非常好，没有明显的伤疤，作为完美主义者，我目前稍喜欢这个。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2014-08-03","routePath":"/blog/post/github-gitlab-or-bitbucket","lang":"zh-CN","toc":[{"text":"GitHub","id":"github","depth":2,"charIndex":163},{"text":"GitLab","id":"gitlab","depth":2,"charIndex":363},{"text":"BitBucket","id":"bitbucket","depth":2,"charIndex":524},{"text":"对比","id":"对比","depth":2,"charIndex":646},{"text":"小结","id":"小结","depth":2,"charIndex":1551}],"domain":"","frontmatter":{},"version":""},{"id":248,"title":"转换 Vimwiki 为 Markdown","content":"#\n\n> sed -f ex -i *.md\n\n\nREADME#\n\n相对 Wiki 语法，和 Wiki 对应工具支持情况，我更加喜欢 Markdown 了。 本地配合使用 Vimwiki 来编辑查看，发布使用 nico\n来转换，而且有 Github 的原生支持， 使用 Markdown 是不二之选。\n\n为了减少转换工作量，我简要写了这个脚本，可以初步将 vimwiki 语法的项目， 自动转换成 markdown 语法。\n\n转换的内容包括：\n\n * header\n * codes\n * wikiword.\n * links\n * images\n * comments\n * %toc\n * %title\n * %nohtml\n\n\nUsage#\n\n假设上面的脚本保存结构如下：\n\n\n\n在 convert.sh 同级目录执行：\n\n\n\n然后自动或手动调整之后，删除 .wiki 文件即可。\n\n\nCodes#\n\n\nconvert.sh#\n\n\n\n\nex#\n\n\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2014-03-31","routePath":"/blog/post/convert-vimwiki-to-markdown","lang":"zh-CN","toc":[{"text":"README","id":"readme","depth":2,"charIndex":24},{"text":"Usage","id":"usage","depth":2,"charIndex":316},{"text":"Codes","id":"codes","depth":2,"charIndex":395},{"text":"convert.sh","id":"convertsh","depth":3,"charIndex":404},{"text":"ex","id":"ex","depth":3,"charIndex":420}],"domain":"","frontmatter":{},"version":""},{"id":249,"title":"阿里巴巴三年醇","content":"#\n\n今天 @玉伯 给我送来的三年醇礼物。\n\n一个阿里真棒玉坠。\n\n\n\n三周年成（阿里）人手印礼。\n\n\n\n和女朋友一起用手印礼多出来的印泥自制的小猪猪。\n\n\n\n感谢阿里。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2014-02-25","routePath":"/blog/post/alibaba-3-years","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":250,"title":"多个 SSH KEY","content":"#\n\n\n\n\ngit config --local#\n\n\n\nproject/.git/config\n\n\n\n\n延伸阅读#\n\n * 多个github帐号的SSH key切换\n\n * Generating SSH Keys\n\n * ssh-keygen 中文手册\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-11-25","routePath":"/blog/post/multi-ssh-key-for-git","lang":"zh-CN","toc":[{"text":"git config --local","id":"git-config---local","depth":2,"charIndex":5},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":52}],"domain":"","frontmatter":{},"version":""},{"id":251,"title":"密码与正则","content":"#\n\n通常我们需要校验验证用户输入的密码是否符合强度要求。\n\n密码字符包括以下几种：\n\n * 小写英文字符 [a-z]\n * 大写英文字符 [A-Z]\n * 阿拉伯数字 [0-9]\n * 部分特殊字符 [&#96;~!@#$%^&*()_\\-+=|\\\\\\[\\]{}:;'\"<>,.\\/?]， 简化为 [ -\\/:-@\\[-&#96;{-~]\n\n> 注，md 的限制，上面特殊字符中 ` 使用 &#96; 代替。\n\n目前常见的密码强度包括以下几种\n\n * 普通强度：必须同时包含 2种字符。\n * 高强度：必须同时包含 3种字符。\n * 极高强度：必须同时包含 4种密码字符。\n\n通常情况下，我们可能会基于种种考虑采用字符串方法计算密码强度，或校验密码合法性， 下面我们更多的考虑使用正则表达式来解决这个问题。\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-11-17","routePath":"/blog/post/regexp-for-password","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":252,"title":"中国农历","content":"#\n\nGoogle 日历内置了中国农历的支持，但是各种桌面客户端如 Mac iCal, iPhone 默认日历\n都无法正常使用，网上搜索了一遍也没有更好的订阅地址，大都不更新了。\n\n而且我又不想装各种乱七八糟的第三方日历应用。\n\n因此我自己制作了一个公开农历日历，需要的同学可以订阅到 Google Calendar，并且在 Google Calendar\n中可以隐藏这个日历，只是在各个客户端中显示即可。\n\n不过不爽的是，客户端不能针对特定日历设置提醒，有更好的方案的同学欢迎指教哈。\n\n\n启用 Google Calendar 内置农历（推荐）#\n\n 1. 设置(Settings)\n    \n    \n\n 2. 基本(General)\n\n 3. 备用日历(Alternate calendar)\n    \n    \n\n 4. 选择 农历 - 简体中文 (Chinese calendar - Simplified Chinese)\n\n 5. 保存(Save)\n\n 6. 最终可以在每日的日历顶部，有对应农历的显示。\n    \n    \n\n--------------------------------------------------------------------------------\n\nGoogle 日历的这个特性真是太赞了，以前为每天创建一个全天日历的挫 B方案没脸比。\n\n不过，现有的桌面（包括移动设备）应用中，都没能很好的支持这个特性。我又不想安装\n第三方的乱七八糟的日历应用，希望一个日历应用管理所有的日历数据，希望数据是开放的。\n\n因此挫 B 的方案只能继续。\n\n通过互联网在整个世界找了一圈，分享出来的农历订阅日历都已经失效、或者不更新了， 因此我决定自己来维护世界和平，创建并分享了下面的中国农历，大家只需要订阅\n到自己的日历中就可以了。\n\n\n订阅地址#\n\n * ical\n * xml\n * html\n\n\n订阅方法#\n\n桌面应用本身支持直接订阅 ical 日历，但是为了便于管理，我统一使用了 Google Calendar 管理我的日历，桌面应用只是客户端，数据来源于\nGoogle Calendar。\n\n * Other calendars 右侧的菜单，选择 Add by URL\n   \n   \n\n * 填入 ical 地址：\n   \n   https://www.google.com/calendar/ical/896414ier7cs228f2fp4mkn02g%40group.calen\n   dar.google.com/public/basic.ics\n   \n   \n\n * 点击 Add Calendar 按钮。\n\n * 由于 Google Calendar 本身内置了农历的支持，可以在 Google Calendar 中隐藏不显示这个日历。\n\n预览：\n\nhttps://www.google.com/calendar/embed?height=600&wkst=1&bgcolor=%23FFFFFF&src=89\n6414ier7cs228f2fp4mkn02g%40group.calendar.google.com&color=%23875509&ctz=Asia%2F\nShanghai\n\n\n\n\n其他#\n\n * 如果在使用过程中发现其中的错误，请邮件给我。\n\n * 同时欢迎 Fork 这个 『中国农历』开放项目 。 或者给我们提交 Issues。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-11-13","routePath":"/blog/post/lunar-calendar","lang":"zh-CN","toc":[{"text":"启用 Google Calendar 内置农历（推荐）","id":"启用-google-calendar-内置农历推荐","depth":2,"charIndex":245},{"text":"订阅地址","id":"订阅地址","depth":2,"charIndex":788},{"text":"订阅方法","id":"订阅方法","depth":2,"charIndex":820},{"text":"其他","id":"其他","depth":2,"charIndex":1383}],"domain":"","frontmatter":{},"version":""},{"id":253,"title":"不缓存 CDN 静态资源方案","content":"#\n\n支付宝目前使用淘宝提供的 CDN 服务，这个服务中的 CDN 节点在自身找不到对应资源时 主动到源服务器拉取的策略。\n\n支付宝使用的静态资源合并(combo)方案，导致在不同的访问参数情况下，被认为是不同 的静态资源。如果挟带的是避免缓存的随机参数，CDN\n在没有缓存这个资源的情况下， 会到源服务器拉取资源。\n\n原则上，我们使用特定的版本机制，每个新版本文件以不同的文件名发布，不允许使用 参数，尤其是随机数方式避免缓存问题。\n\n\n问题#\n\n由于我们使用的版本策略，我们可以指定用户缓存静态资源时效为永久，实际方案上 我们指定用户缓存时间为 1年，但是在某些场景下（如测量用户网络速度），\n用户客户端（非 CDN 节点）访问某些特定静态资源需要禁止使用缓存。\n\n目前常见的方案都是在客户端使用时间戳+随机数。这个方案本身看似没什么问题，但是 实际上有非常大的隐患，测量的数据参考性也不佳。\n\n * CDN 节点上缓存了大量挟带永不重复随机数的资源，对磁盘造成影响。\n * CDN 缓存命中率降低，这些挟带随机数的静态资源缓存率命中率为 0。\n * 增加源服务器的访问压力。\n * 测量的用户网络响应时间实际不是到 CDN 节点的，还包含 CDN 回源的时间。\n\n\n解决方案#\n\n为了解决这种明确不允许用户客户端缓存，同时又不建议使用随机参数访问的需求，我们 有以下几种方案：\n\n 1. CDN 服务器端控制浏览器不缓存。『最佳方案』\n    \n    设置指定目录下的静态资源禁止缓存头信息，有需要禁止缓存需求时上传静态资源到 这个目录。\n\n 2. 直接访问源服务器。\n    \n    现在的加随机数访问 CDN 方案和直接访问源服务器本质上相同，这方案只能测用户到 源服务器的响应时间。\n\n 3. 使用有限随机数方案。\n    \n    虽然第一种是最佳方案，但也不排除某些浏览器或壳在不关闭页面情况下，有缓存的 问题，所以这和第一种方案结合使用可能是更靠谱一些的方案。『待验证』\n    \n    页面脚本请求静态资源时，带上从零递增的参数，避免单页面缓存问题，亦可避免 CDN 缓存大量无意义资源的问题。\n\n\n延伸#\n\n实际上，对于静态资源来说，纯粹的参数是无意义的，CDN 节点本可以忽略这个参数。 虽然合并策略使用了参数方式，但是我们使用双问号激活合并服务的方案可以让我们\n明确区分出合并参数和其他参数，因此技术上是完全可以忽略其他参数导致的回源。\n\n\n参考#\n\n 1. 拉取式相比推送式的对比的参考\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-09-21","routePath":"/blog/post/no-cache-in-cdn","lang":"zh-CN","toc":[{"text":"问题","id":"问题","depth":2,"charIndex":219},{"text":"解决方案","id":"解决方案","depth":2,"charIndex":535},{"text":"延伸","id":"延伸","depth":2,"charIndex":912},{"text":"参考","id":"参考","depth":2,"charIndex":1036}],"domain":"","frontmatter":{},"version":""},{"id":254,"title":"每周异常：第 9期，搜狗浏览器中神一样的 try/catch 特性","content":"#\n\n\n背景#\n\n某日 16时 30分，监控实时大盘中全站 JavaScript 异常和 404 异常分别朝着不同的方向延伸， 橙色的 JavaScript 异常急剧上升。\n\n\n\n详细数据中我们看到一向高标准高质量的收银台出现异常大量的异常。\n\n\n\n\n排查#\n\n我们发现其中有两个页面异常最多，而这两个页面中异常最多的『一个异常』详情如下：\n\n * File: 同页面 URL\n * Line: 1\n * Message: Uncaught SyntaxError: Unexpected token a\n\n客户端信息：\n\n * pc/-1;windows/5.1;sg/2.x;webkit/535.1\n * pc/-1;windows/6.1;sg/2.x;webkit/535.1\n\n堆栈信息：\n\n\n\n分析过程非常艰辛，重现异常的过程也是一波三折，这里不做赘述，最终分析得出：\n\n * 搜狗浏览器的 userAgent 太坑爹，几乎所有版本都是 2.x，开发者太不专业了。最终找到内核为 webkit/535.1 的是 3.2 版。\n\n * 重现到老版 arale 中的 ajax 模块中对 JSON 有特殊的处理，如果浏览器内置的 JSON 不支持非标准的 JSON （如 {a:1}）则\n   hack 做兼容。\n   \n   \n\n * 抛出异常的代码是 JSON.parse(\"{a: 1}\")\n\n * 但奇怪的是这段代码是放在 try/catch 中，为什么还会有异常被监控捕获？\n\n * 最终发现这是搜狗浏览器 3.2版极速(webkit)模式中的特性：即使 try/catch 住的异常， 同样会被 window.onerror\n   捕获，但并未因此中断业务逻辑，后续的代码仍然会按照正确的 try/catch 异常处理流程进行，所以对业务本身没有影响。\n\n * p.s. 搜狗浏览器没有控制台，用户不会知道出了异常。\n\n * 另外收银台之前异常量少的主要原因是主要的页面没有引入前端监控，用户抛出了异常而我们不知道而已。\n\n\n相关截图#\n\n\n\n\n解决方案#\n\n最初虽然有些争议，但我们最终决定的处理方案是监控中临时排除 sg/2.x|webkit/535.1 中 Uncaught SyntaxError:\nUnexpected token a 异常。\n\n\n是否要排除这个浏览器中所有的异常？#\n\n呃，考虑到搜狗浏览器的份额，我们的策略是只排除已知的异常，未知的异常看最终分析结果再考虑。\n\n\n广告#\n\n这个异常排查的主要功臣 @wsvn53，我们在排查过程中频繁使用了他开发的工具 Fedit，可以直接修改线上代码。 排查线上故\n障、线下接⼝什么的都非常⽅方便。强烈建议⼤家都装上⽤用。\n\n\n最后#\n\n我仅代表我自己，想说某些毫无责任心的国产浏览器壳厂商们，你们没有创造价值， 只是在各种不同方式的索取。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-09-13","routePath":"/blog/post/weekly-topic-about-exceptions-9","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"排查","id":"排查","depth":2,"charIndex":125},{"text":"相关截图","id":"相关截图","depth":2,"charIndex":873},{"text":"解决方案","id":"解决方案","depth":2,"charIndex":883},{"text":"是否要排除这个浏览器中所有的异常？","id":"是否要排除这个浏览器中所有的异常","depth":3,"charIndex":989},{"text":"广告","id":"广告","depth":2,"charIndex":1057},{"text":"最后","id":"最后","depth":2,"charIndex":1157}],"domain":"","frontmatter":{},"version":""},{"id":255,"title":"每周异常：第 8期，异常象限","content":"#\n\n上周的 每周异常：第 7期，保持简单，保持拙朴 中介绍了通过页面关键的 URL/ID 信息，简单有效的发现异常的方案。\n本周我们在这个异常分析方法之上，再稍微深入下：\n\n对于整个网站来说，每个系统、页面是有重要级别的，比如支付宝收银台就是 A1 级系统。 这些系统、页面一般可以按照以下方法来判断重要性：\n\n * 访问量极大，是最主要的业务，对用户影响极大。\n * 用户本身重要（例如商户，尤其是大商户），是最重要的业务，对企业影响巨大。\n\n对于前者，我们可以通过系统、域名的访问量来近似的划分； 对于后者，我们可以建立白名单机制。\n\n对于异常来说，可以通过异常率来判断异常自身的紧急程度。\n\n--------------------------------------------------------------------------------\n\n * 系统、页面重要性作为『异常重要性』的一个指标。\n * 异常率及异常量作为『异常紧急程度』作为一个指标。\n   * 异常率超过阈值的为高发率异常。\n   * （可选）异常量超过阈值的也是高发量异常。\n   * 并且以高发率为主。\n\n我们画出以下异常象限：\n\n\n\n * 图中一、二、三、四为象限代号。\n * (0, 1, 2, 3) 为异常重要性序号。\n\n经过一些分析，我们可以得出结论：\n\n * 第一、第二象限的异常，是我们最需要关注的部分。尤其是第一象限的异常， 实时高发异常一般也是在这个象限。\n\n * 第四、三象限的低发异常，则几乎可以不用关注。\n\n * 总之我们只需要关注高发异常，但应该以页面的重要性来排优先级。\n\n\n如何设定阈值？#\n\n要确定异常象限，确定各个阈值是关键，这里只提供一些简单的参考。\n\n * 重要程度：全站重要页面占全站所有页面的 5% 左右，可以根据自身情况调整。\n * 紧迫程度：\n   \n   * 目前的经验数据是异常率 4‰ 以上可以认为是高发率异常，但仍需继续 分析实际数据做调整。\n   \n   * （可选）异常 PV 超过 (全站访问最高页面 PV 乘以 1‰) 的也可以认为是高发量异常， 实际可以根据自身情况调整。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-09-05","routePath":"/blog/post/weekly-topic-about-exceptions-8","lang":"zh-CN","toc":[{"text":"如何设定阈值？","id":"如何设定阈值","depth":2,"charIndex":697}],"domain":"","frontmatter":{},"version":""},{"id":256,"title":"每周异常：第 7期，保持简单，保持拙朴","content":"#\n\n\n副标题：如何简单有效的发现最重要的有效异常#\n\n> Keep It Simple, Stupid.\n> \n> -- U.S. Navy (1960)\n\n在这之前，我一直苦苦寻求牛逼的算法 #12 ， 来解决这个看似简单，其实不易；仿佛不易，最终简单的问题： 找出最重要的有效异常。\n\n最早的时候，我们定义了『一个异常』由以下核心部分组成：\n\n * URL: 异常所在页面。\n * File: 异常代码所在文件。\n * Line: 异常代码所在行数。\n * Message: 异常消息。\n\n这些是不变的，相同页面中，同一个异常代码文件同一行，异常消息相同的异常，我们可以近似的认为它是同一个异常。\n\n另外还定义了异常率：\n\n * 异常率(PV)：『一个异常』的 PV，除以这个异常所在页面的 PV。\n * 异常率(UV)：『一个异常』的 UV，除以这个异常所在页面的 UV。\n\n于是我们通过 URL, File, Line, Message 四个核心信息来统计每一个异常的 PV, UV, PV异常率，UV异常率。\n并按照其中的某个字段为主进行排序。\n\n但是得到的结果总是让人不尽如人意，总会有很多无法排查，甚至还有一些显然不是我们代码的问题的异常排前排。\n\n我们尝试限制异常 PV, UV 的基数，尝试限制页面 PV, UV 的基数，结果仍然不理想。 而且也没有想出其他牛逼的权重算法来评估每个异常。\n\n我们想过异常是跟代码所在文件和行号、异常消息有关系的，跟页面 URL\n的关系不那么强，因为公共代码会在很多页面使用，把这同一个异常分散算到不同页面中会严重影响这个异常的排名。\n\n但是实际上公共代码（尤其是基础类库）的异常很多情况下是业务系统调用不当，或者使用的版本有 BUG\n导致，最终还是需要这个页面的开发者调整调用方法，或升级使用更新的公共脚本来解决。所以忽略或弱化异常所在页面是不可接受的。\n\n而且排除了异常所在页面的信息，对于排查异常来说更为困难。\n\n够了，我已经受够了，脑袋一片浆糊。 累、困，早点回家睡觉。\n\n--------------------------------------------------------------------------------\n\n回到家随手画了几笔，然后去洗澡。洗澡的时候想着刚刚画的思维草图，逐渐想清楚了很多。\n\n * File: 由于是 seajs 自动管理依赖，以及 combo 的使用，异常所在文件本身具有不稳定性。\n * Line: 由于上面 File 的原因，不仅仅是 HTML 代码中的异常行号不稳定，静态脚本异常行号也具有不稳定性。\n * Message: 不同浏览器（包括不同版本，或者在不同操作系统中）对同一个异常有不同的消息反馈，另外还有本地化的原因，异常消息也具有不稳定性。\n\n最后，只有异常所在页面 URL（或者页面 ID，一个页面源文件可能有多个 URL 地址，但是它们是有关系的，ID 相同）才是最稳定的。\n\n--------------------------------------------------------------------------------\n\n于是我根据页面 URL 排列出每个页面的异常 PV, UV, PV异常率，UV异常率。并根据 PV\n异常率为主进行倒序排序（每次访问都抛出的异常，比每个用户访问都抛出的异常的优先级更高）于是我们轻易得出了全站异常率最高的页面。\n\n根据这个关键的页面信息，再次查询出每『一个异常』的 PV, UV, PV异常率，UV异常率。\n\n以不变（页面 URL 或 ID），应万变。我们一个个把这些异常大户揪出来，各个击破。即使暂时没有发布解决，我们仍可以轻易识别排除这个已经揪出的异常。\n\n好了，妈妈再也不用操心我的每周异常 TOP 数据分析了。\n\n嗯， #12 这个 issue 也可以关了。\n\n--------------------------------------------------------------------------------\n\n在做静态资源异常监控时，也有类似的经历。\n\n静态资源监控最重要的是发现哪个页面引用了哪个 404资源，尤其是漏发的资源。因此最重要的有两个关联维度：\n\n * 404资源所在页面\n * 404资源文件地址\n\n但是引起 404 的场景很多，包括：\n\n * 漏发文件。\n * 静态引用地址错误。\n * 动态引用地址错误。\n\n其中动态引用是由于动态脚本计算得出的静态资源地址，引发的 404\n非常频繁，多样、而且分布的很散。因此这两个维度的排列组合结果就非常巨大。而且我们的分析系统是基于索引的，这些内容不确定、数量庞大的指标非常不适合用这个系统分析。\n（我们还有另一个非常时候实时异常分析的系统，这里不做介绍）\n\n因此我们把重心放在更为稳定的页面 URL，只关注出现 404 的页面，至于是什么资源可以直接根据 URL 查询日志，或直接访问这个页面。\n\n\n小结#\n\n这篇讲的几个关键内容再强调下：\n\n * 保持简单，保持拙朴。\n * 抓住重点，真正的核心重点。\n\n--------------------------------------------------------------------------------\n\n终于可以睡了，晚安~\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-08-28","routePath":"/blog/post/weekly-topic-about-exceptions-7","lang":"zh-CN","toc":[{"text":"副标题：如何简单有效的发现最重要的有效异常","id":"副标题如何简单有效的发现最重要的有效异常","depth":2,"charIndex":3},{"text":"小结","id":"小结","depth":2,"charIndex":2085}],"domain":"","frontmatter":{},"version":""},{"id":257,"title":"每周异常：第 6期，JavaScript 异常监控脚本引发的 JavaScript 异常","content":"#\n\n\n背景#\n\n早上收到比较重要的用户反馈说某个重要的系统的页面在 IE 浏览器中卡死，无法继续。\n\n\n\n问题很严重。\n\n系统比较特殊复杂，不是一般人能登录进去的。找到对应同学在小概率重现的情况下终于拿到了第一手的问题源码。\n\n\n分析#\n\n修改配置和采样率之后在本地跑起来，发现在 IE6 里非常有问题。\n\n 1.  性能这么大的问题，首先想到的是页面中大面积扫描 HTML 代码的部分，但是注释掉这部分仍然没有改善。\n\n 2.  再次把整个回调处理函数注释掉，仍然没有改善。\n\n 3.  直接把加载后置脚本的 seajs.use 注释掉之后，终于没问题了。（坑爹的缓存问题就不说了，好久之后才发现，都是泪~）\n\n 4.  这么看来有两种可能：\n\n 5.  模块本身有性能问题。\n\n 6.  seajs 性能有问题（这个问题页面目前使用的 1.3.1）\n\n 7.  首先考虑自身的问题。return 整个 factory，性能无问题，因此不是模块过多导致 seajs 性能问题。\n\n 8.  逐步修改 return 位置（其实可以打断点），终于发现问题出在 初始化事件绑定函数部分。\n     \n     \n\n 9.  此时 _events = undefined。访问 undefined.length 或其他属性会导致浏览器挂起？ IE6 还有这样的坑？\n\n 10. 新建一个最小代码的新页面，直接 script[src] 引入这个脚本没有问题，IE 会正常的抛出异常，不会挂起。\n\n 11. 动态创建 script 插入脚本，仍然不会挂起，正常抛出异常。\n\n 12. 奇怪。各种尝试，最终加入前置脚本后在这个最小重现代码中重现了异常。\n\n 13. 然后发现是在 window.onerror 中出现问题。\n\n 14. 继续发现的模拟调用栈信息的算法出现问题。\n\ncmd 模块在 define 的 factory 中本身抛出异常，会被前置脚本的 window.onerror 捕获，捕获过程中尝试\n还原函数调用栈。模拟还原调用栈信息是通过 arguments.callee.caller 向上递归，直到找到函数调用的发起者。但是悲剧的是发现 seajs\n这个调用栈是无穷无尽的：\n\n\n\n这也就是为什么用户的浏览器会挂起的原因。\n\n--------------------------------------------------------------------------------\n\n\n小结#\n\n用户浏览器被挂起，最终发现：\n\n * 不是扫描整个文档的性能问题。\n\n * 不是 seajs 加载多个模块的性能问题。\n\n * 主要不是 cmd define 中报错的问题。\n\n * 不是 window.onerror 捕获异常的问题。\n\n * 而是获取异常函数调用栈出现无限循环链的问题，\n\n * 这其实是 IE 的问题。\n\n * 好吧，最终还是我的问题。\n\n\n监控脚本自身的 cmd 模块定义的异常是怎么出现的？#\n\nmonitor 2.2.0 新增了 事件机制，支持监控任意的自定义数据。\n\n其中在前置脚本中新增了 monitor.on() 方法，将自定义事件处理函数临时存储在 monitor._EVENTS 属性中 参考代码\n。后置脚本加载完成后，会复写 monitor.on() 方法，并将之前用户自定义事件处理函数绑定到对应事件，以使事件机制生效。\n\n这些理论上都是非常不错的设计思路。\n\n但是现实太残酷，全站公共区域被实际部署的情况有太复杂：\n\n 1. 有些系统没有完全引入前置脚本。\n 2. 有些系统仍然引用的老版本的前置脚本。\n\n后置脚本对于后面的这个场景没有考虑到，因此这段保险栓未能正确执行导致后续脚本报错。\n\n\n为什么这个异常会到生产环境？#\n\n都是我的错，没有考虑周全。没有考虑到这种特殊的系统部署环境，而且我也从来不能进去实际体验、验证。\n\n\n如何处理这个异常？#\n\n 1. 作为全站全局运行的代码，要详细评估考虑到各种系统变态的部署环境。\n 2. 打断循环调用栈\n 3. 限制监控的最大函数调用栈深度。\n 4. 对于已经调用的栈，不再深入递归，或现在递归次数（待评估，实际项目存在正常的递归或多次调用的代码。）\n\n\n为什么 seajs define 模块中报错会出现函数调用栈无限递归？#\n\n这是 seajs 1.3.1 的 BUG，更准确的说，可能是 IE6,7,8闭包的问题。参考：\nhttps://github.com/seajs/seajs/issues/911\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-08-22","routePath":"/blog/post/weekly-topic-about-exceptions-6","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"分析","id":"分析","depth":2,"charIndex":115},{"text":"小结","id":"小结","depth":3,"charIndex":1050},{"text":"监控脚本自身的 cmd 模块定义的异常是怎么出现的？","id":"监控脚本自身的-cmd-模块定义的异常是怎么出现的","depth":2,"charIndex":1237},{"text":"为什么这个异常会到生产环境？","id":"为什么这个异常会到生产环境","depth":2,"charIndex":1574},{"text":"如何处理这个异常？","id":"如何处理这个异常","depth":2,"charIndex":1642},{"text":"为什么 seajs define 模块中报错会出现函数调用栈无限递归？","id":"为什么-seajs-define-模块中报错会出现函数调用栈无限递归","depth":2,"charIndex":1779}],"domain":"","frontmatter":{},"version":""},{"id":258,"title":"每周异常：第 5期，由静态资源异常引发的质疑","content":"#\n\n今天要说的是一个『静态资源异常监控』的话题。虽然静态资源异常可以非常有效的跟 JavaScript 异常结合起来做有力的分析，但是今天这个话题跟\nJavaScript 异常没什么关系。\n\n--------------------------------------------------------------------------------\n\n传说某著名公司的网站监控方案是申请了专利的技术，我有幸看到过，真的是非常牛逼。\n\n这个网站监控方案中提供了网页的访问量、页面访问流向、页面有效点击量、点击热图， 灰度发布（包括 ABTest）等都有完善的支持。\n\n这个方案总体上是用 JavaScript 通过 new Image() 发送监控的数据到日志服务器， 然后由数据仓库做数据清洗。\n\n通过业务系统服务器端的日志分析，这套方案的数据质量有确实有一定的问题， 比如它统计到的访问量要比业务系统服务器端统计到的少，丢失率一般在 5% ~ 10%\n左右， 少量特殊页面（比如跳转页）丢失率会高达 50% ~ 60%。\n\n尽管如此我们也基本上可以接受这样的误差，而且部分从理论上讲，『应该』大部分是 无效或无意义的访问（比如爬虫、快速跳转等），丢掉是合理的。\n\n一直以来，我们都认为这个方案的数据是相对比较可靠的，虽然偶尔有些不正常的丢失率 让业务方质疑，但是我们总是用上面的理论和理由解释给对方听，让他们接受我们的现实。\n\n这样过了好多年，他们过着幸福的生活~\n\n--------------------------------------------------------------------------------\n\n直到有个家伙的膝盖被射了一箭，搞出来个静态资源监控系统。\n\n静态资源监控系统是通过分析静态服务器的访问日志，来统计各个资源状态的趋势及其分布情况。\n\n因为静态资源监控是通过静态服务器访问日志来分析的，理论上和业务服务端的日志是一致的。\n\n但是我们惊奇的发现某个静态页面引用了某个不存在的静态资源，异常率理论上应该是 100%， 但是对照网站监控方案统计的数据发现，这个静态资源异常率高达 200%。\n\n我的第一直觉是网站监控丢失率高达 50%。遂跟网站监控相关同学沟通，然后他们第一反映 是质疑我对他们的质疑。\n\n让业务服务端同学统计日志发现他们的访问量确实要大于网站监控访问量，但又小于静态资源异常量。\n\n我虽然毫不怀疑自己的数据，但一时也无法质疑业务服务端的数据。\n\n业务服务端同学随意说了一句：『难道有缓存？』\n\n于是这个疑惑破解了：\n\n 1. 用户访问页面时，有一部分可能是读取的本地缓存，这部分业务服务端无法统计到。\n 2. 有些读取缓存的场景不会执行初始化 JavaScript，这些场景网站监控没有统计到。\n 3. 外联的 404 资源是不会被缓存的。\n\n因此这些有缓存的静态页面（这个知名公司有不少页面是这种纯静态、伪静态页面）的场景下，使用 JavaScript 发送监控的监控手段目前丢失率是 50% 左右。\n\n\n参考#\n\n * Caching problem with asynchronous javascript loading with onload event\n\n * IE6 加载不执行 JS\n\n * IE6 加载不执行 JS 2\n\n * 因为缓存Page_Load不执行的情况\n\n * Opera在点击回退按钮后，原来页面的js都不执行了吗?\n\n * Detecting when a page is loaded from the browser cache\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-08-16","routePath":"/blog/post/weekly-topic-about-exceptions-5","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":3,"charIndex":1286}],"domain":"","frontmatter":{},"version":""},{"id":259,"title":"每周异常：第 4期，如何避免客户端攻击造成的大量异常报警","content":"#\n\n在 JavaScript 异常监控过程中，发现有很多由于客户端连续攻击造成的大量异常，导致 监控系统报警。\n\n\n\n（图中大量不连续的波动，都是攻击造成的）\n\n这种少量用户(UV)发起攻击造成的大量异常(PV)波动，不是我们实时监控需要关注的部分。\n我们实时监控最重要的是要发现由于系统发布过程中，我们的发布的代码有问题导致大量 用户受影响而出现的波动（波形可能跟上图的每一个异常波形相似）。\n\n理论上导致异常数据波动的场景包括：\n\n * 少量用户发起大量攻击。\n * 大量用户同时涌入或离开。\n * 发布问题代码影响到大量用户。\n\n少量用户发起大量攻击造成数据波动，是我们可以不必实时关注实时报警的部分。\n\n大量用户同时涌入或离开造成的异常数量(PV)波动，也是我们无需实时关注的部分， 另外我们也可以通过异常率规避波动。\n\n场景   异常 PV   异常 UV   异常率(PV)   异常率(UV)\n攻击   波动      无波动     波动        无波动\n涌入   波动      波动      无波动       无波动\n发布   波动      波动      波动        波动\n\n注：\n\n * 异常率(PV) = 异常PV / 所在页面PV\n * 异常率(UV) = 异常UV / 所在页面UV\n\n从上面的对照表可以看出，理论上我们只需要关注异常率(UV) 是否正常波动就可以了。\n\n理想很性感，现实很骨感。\n\n我们的数据仓库、数据分析系统对于实时 PV 有很强的处理能力，但是对于 UV 就感觉力有不逮。\n\n起初想到在实时日志处理逻辑中使用缓存（伪代码）：\n\n\n\n * 但是实时数据分析系统是分布式的，由多台服务器组成的集群同时处理日志，所以里面 的内部状态只有本机有效\n * 另外更致命的是，实时数据分析系统是无状态的，下次执行会 new 新的 LogParser 实例， 同一台机器的状态也保证不了。\n\n于是我们又想到一种从客户端来标识用户的方法：\n\n 1. 客户端单位时间内同一个页面抛出的同一个异常，第一次打上 uv 标记。\n 2. 数据处理时遇到 uv 标记的日志，同时统计算做一个异常 uv。\n\n由于客户端时间和服务端有时间差，每个客户端时间和服务端时间差也不一致，导致这种 方案会有稍大误差，但也基本能解决问题。\n\n但是要在客户端打标记，则需要在客户端（cookie 或其他本地存储）记录每个异常 （url, file, line, message\n相同被当作同一个异常）最后抛出的时间，每次抛出异常 都需要读写本地存储，稍嫌臃肿。\n\n通过深入分析实际的攻击案例，发现攻击引发大量异常的场景中，客户端页面是不刷新或 重新访问的，都是直接在当前访问的页面执行上批量脚本。\n\n因此我们可以使用局部变量，将当前访问的页面的每个异常最后抛出时间记录在内存中， 重新访问页面则重新开始记录。\n\n这种方案对于防范攻击造成的大量异常非常有效；对于大量用户涌入引起的异常也有一定 效用，毕竟正常用户较少会频繁触发异常。\n\n总之，通过这个方案，我们可以非常有效的实时监控异常波动，较少误报。\n\np.s. 这个想法是早上洗澡的时候想到的，还没开始实践。但是我信心满满写下这篇， 数据会来证明我是对的。\n\n\n续 on 2013-08-20#\n\n是时候结帐了。正好发布一天，大家看数据：\n\n\n\n图中的灰色竖线是发布点，橙色是 JavaScript 异常，绿色是静态资源异常。\n\n妈妈再也不用担心我的手机会收到误报的报警短信了。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-08-07","routePath":"/blog/post/weekly-topic-about-exceptions-4","lang":"zh-CN","toc":[{"text":"续 on 2013-08-20","id":"续-on-2013-08-20","depth":2,"charIndex":1370}],"domain":"","frontmatter":{},"version":""},{"id":260,"title":"每周异常：第 3期，宏观异常分析方法","content":"#\n\n为了有效的分析 JavaScript 异常，我们从宏观的统计数据中做了大量的分析，初步结果如下：\n\n\n全站每日异常统计#\n\n首先我们从每天的全站总体数据进行分析，得到下面这些报表。其中：\n\n * all_pv: 全站所有有效异常次数 (PV)\n * all_uv: 全站所有有效异常人数 (UV)\n * all_pv_rate: 全站所有异常率 (按 PV 统计)\n * all_uv_rate: 全站所有异常率 (按 UV 统计)\n * valid_rate_pv: 有效异常率（按 PV 统计）\n * valid_rate_uv: 有效异常率（按 UV 统计）\n\n\n\n\n\n\n\n\n\n\n\n从趋势图中我们可以明显的看到第 2天和最后一天，异常 PV 有较大波动，这是由于用户 攻击爆发大量异常造成的。\n\n我们在 异常评分算法 的讨论中有提到，即使是少量用户进行攻击，异常 UV 也不应该有波动的（除非页面 UV 本身有较大波动），但是实际上我们看到最后一天的异常\nUV 也有明显波动，因此粗略 分析这个异常 PV 的上升是由于页面访问人数增多造成的。\n\n事后我们查了当天的页面访问 PV 和 UV，可惜并没有明显波动。\n\n实际经过细致的异常日志分析，我们看到攻击用户同时没过一段时间就更换 IP 地址或清理 Cookie，因此全天的综合数据中异常 PV 和异常 UV\n有了一些明显波动。\n\n而且实际上，每天都有攻击造成的异常波动。\n\n * 每天都有攻击造成的异常，累加在一起好像每天都没什么问题。\n * 由于攻击造成异常总数相对一天的异常总数太小，从全天异常总数的层面来看， 无法发现，甚至排除攻击造成的异常。\n * T+1 的统计数据，对于异常监控来说，太迟钝了。\n\n\n全站每分钟异常统计#\n\n从上面每日异常总和的分析我们可以看出，一天的总和数据能发现的问题还是比较有限的。 于是我从分钟的粒度来统计异常。\n\n\n\n图有点大，点击可以看大图。\n\n从图中我们可以看到，凌晨 2点多到 3点多期间，有少量用户发起了猛烈的攻击； 凌晨 4点多到凌晨7点多期间也有少量温和的攻击。攻击时全站异常 PV （绿色）\n和全站有效异常（深红色）明显飙升，但是异常 UV 和有效异常 UV 都没有太大波动， 而且与前后的时间切片有较好的连贯性，没有大起大落。\n\n而如果异常 UV 出现较大波动，在很可能是由于我们正在发布的新代码影响大面积用户。\n\n合适的时间粒度对于及时发现真正有效的异常有非常重要的意义。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-08-02","routePath":"/blog/post/weekly-topic-about-exceptions-3","lang":"zh-CN","toc":[{"text":"全站每日异常统计","id":"全站每日异常统计","depth":2,"charIndex":53},{"text":"全站每分钟异常统计","id":"全站每分钟异常统计","depth":2,"charIndex":737}],"domain":"","frontmatter":{},"version":""},{"id":261,"title":"","content":"","routePath":"/blog/post/weekly-topic-about-exceptions-2","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":262,"title":"","content":"","routePath":"/blog/post/weekly-topic-about-exceptions-2-2","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":263,"title":"每周异常：第 1 期","content":"#\n\n2013-07-15 14:00~14:03，来自北京市时代互联(180.184.99.37) 的\npc/-1|windows/6.2|firefox/22.0|gecko/20100101 用户向支付宝 katongweb 系统发起1480次猛烈的总攻。\n\n详情如下：\n\nKEY          VALUE\nRef          https://ref.example.com/ref.htm\nURL          https://www.example.com/index.htm\nFile         chrome://grabword/content/grabword.js\nLine         0\nMessage      Script error.\nstacktrace   \n\n该用户通过 Ref 页面到目标 URL 之后，连续不断的通过 Firefox 插件脚本触发脚本异常。\n\n--------------------------------------------------------------------------------\n\n通过最近的几次异常报警来看，由客户端连续发起攻击引起的 JavaScript 异常 PV 非正常波动，对异常监控数据有比较大的影响。\n\n因此考虑以下方案来提升监控数据的稳定有效性：\n\n * 监控 JavaScript 异常 UV(根据 Session)\n * 监控 JavaScript 异常独立 IP 数。\n * 排除客户端本地脚本引起的异常（多数攻击是由客户端脚本发起）\n   * 今日客户端脚本异常率：45.14%\n   * 正常情况下客户端脚本异常率：3.45%\n\n--------------------------------------------------------------------------------\n\n下图是排除了客户端本地脚本抛出的异常之后的结果：\n\n\n\n（当天数据对比，图中圆点是开启过滤客户端本地异常的时间点，下同）\n\n\n\n（相近2天数据对比）\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-07-15","routePath":"/blog/post/weekly-topic-about-exceptions-1","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":264,"title":"『已结束』庆祝 Vim 7.4 发布，发起团购 Tee + 团捐活动(2013)","content":"#\n\n> 团购活动已经结束，但你仍然可以自行印制或购买 团捐活动已经结束，但你仍然可以 自行捐助\n\n--------------------------------------------------------------------------------\n\n> 本次活动有 41人参加，团购 Tee 47件。 最终以 @vimcn 的身份 捐赠 159欧元，实际人民币 1377.94元。 参加团捐的同学请查收邮件并于\n> 2013年10月份之前行使您的 Vim 新特性赞同或反对票。\n\n于 2013年08月10日发发布的 Vim 7.4 的主要特性更新如下：\n\n 1. 增强 Python 支持；\n 2. 内置更快的正则表达式引擎；\n 3. bugs fix.\n\n为了庆祝这一重大的事件，发起这次团购 VimTee + 团队捐助的活动。 活动截至 2013年08月15日，请有兴趣的同学火速参与。\n\n\nTee#\n\n * 初步确定为 POLO 男款（店家没有专门的女款，抱歉 :( 如果你不介意，这款女生穿着也很帅 ：)）\n\n * 个人觉得需要适当增大胸前的胶印 LOGO。待讨论确定。\n\n * 增加个性袖标。\n   \n   > :version VIM - Vi IMproved 7.4 (2013 Aug 10) @hotoo\n\n由于袖标需要使用正确的时间，所以 Tee 的印刷需要在 Vim 正式发布之后。\n\n\n\n\n局部特写：#\n\n\n\n\n尺码：#\n\n我个人喜欢穿稍微宽松的 Tee，一般会买大一号的，仅作参考 :)\n\n通用款    M         L         XL        XXL\n适合身高   165~170   170~175   175~180   180~190\n胸围     98        104       116       121\n衣长     67        70        75        78\n肩宽     42        45        48        50\n\n--------------------------------------------------------------------------------\n\n官方推荐的 Tee 要 18.5欧元， 将近 150元人民币，其中每件会捐助 3欧元（相当于24元人民币）给 Vim。\n相对来说很贵，而且还需要从国外运到国内，会麻烦很多（可能还需要关税）。\n\n所以组织在国内自印，会划算靠谱很多。这个 Tee 的质量更好，大概只需要其 2/3 的价格， 就可以捐助给 Vim 多一倍的爱心。\n\n\n捐助#\n\n每件 Tee 需要额外的 20元左右的人民币，以 vimcn 团队的身份捐助给 Vim 以帮助乌干达 可怜的儿童。\n\n\n报名#\n\n * 每件 Tee 的价格在 65~70 元左右；\n * 快递费另外算。可以同城合并快递，线下认识下也不错。\n * 我可以代收杭州的部分。\n * 其他地区的同学如果同意被代收，我会随机选同城的一位同学代收。\n\n邮件发送以下内容到 （点击链接即可）\n\n> 尺码： 颜色：军绿色|蓝色|黑色|白色 袖标信息：例如 @hotoo 件数：默认 1件 联系方式（手机或固话）： 收货人姓名： 收货地址和邮编：\n> \n> 是否同意同城代收或被代收？ 是否有必要适当增大胸前 LOGO？ 袖标印在左手还是右手？\n\n报名截至时间：Vim 7.4 正式发布之日。\n\n费用待团购数量及折扣程度，和快递费用确定之后通知大家。\n\n\n声明#\n\n这是一次庆祝、纪念的活动，另外还兼有公益的团队捐助活动。\n\n如果你对 Tee 的设计不满意，可以自行设计印制。你也可以以个人身份捐助 Vim。\n\n\n有图有真相#\n\n\n\n\n\n\n\n\nVimTee 回顾#\n\n 1. 2010年7月，Vim 7.3 发布的时候，我组织了一次 团购 VimTee 的活动。\n\n 2. 2011年应邀又组织了一次 趣味 Vim Tee 的活动。\n\n 3. 2012年由于种种原因我没有组织。\n\n 4. 2013年5月，Vim 7.4 即将发布，我想再发起一次组织团购 VimTee 的活动。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-05-26","routePath":"/blog/post/vim74-tee","lang":"zh-CN","toc":[{"text":"Tee","id":"tee","depth":2,"charIndex":404},{"text":"局部特写：","id":"局部特写","depth":3,"charIndex":614},{"text":"尺码：","id":"尺码","depth":3,"charIndex":625},{"text":"捐助","id":"捐助","depth":2,"charIndex":1120},{"text":"报名","id":"报名","depth":2,"charIndex":1185},{"text":"声明","id":"声明","depth":2,"charIndex":1494},{"text":"有图有真相","id":"有图有真相","depth":2,"charIndex":1573},{"text":"VimTee 回顾","id":"vimtee-回顾","depth":2,"charIndex":1588}],"domain":"","frontmatter":{},"version":""},{"id":265,"title":"JavaScript 异常档案","content":"#\n\n\n\n\n\n作为前端工程师，看到上面的异常，我们该如何进行排查？\n\n 1. 根据异常所在文件及其异常所在行，找到引发异常的相关代码附近， 对代码进行分析？\n 2. 然后呢？就只能依靠我们以往的经验进行猜测和尝试了。\n 3. 没有这个异常的相关经验？哪有这么巧的事情？好吧，那你悲剧了。\n 4. 呃，Google 吧，也许 Bing 或 Baidu 也有点答案。\n 5. 试过了各种各样的关键词，打开了 N 多个 tab 页。。。\n 6. 然后也许你搜索到了散落在 MSDN，CSDN，蓝色理想，某某个人博客的一些只言片语？\n 7. 看到楼主给出的好多行无关代码，接下来是其他热心观众的猜测，试试这个、试试那个。\n 8. 还是不行啊，急，在线等。\n 9. 然后就没有了然后。。。\n\n\n\n--------------------------------------------------------------------------------\n\n各位同学，我们在排查调试 JavaScript 异常时，是不是经常感觉到乏力呢？\n\n * JavaScript 作为一门弱类型动态编程语言，在调试、排查异常方面一直都非常薄弱。\n * 客户端浏览器种类、版本、用户语言环境繁多，同样一个异常，在不同浏览器中表现和反馈都不同。\n * 尤其面对某某大牌浏览器厂商埋下高质量的坑，一般人还真没办法发现或解决。\n * 每个浏览器厂商的开发者文档或社区都是独立的，各种异常文档或分享散落各个社区或者个人博客中。\n\n凡此种种，我都觉得有必要建立这样的一套异常档案，他可以：\n\n * 对于已知或未知的 JavaScript 异常，都存档有对应的异常信息、场景上下文、源码片段、 对应的分析说明、及核心异常代码演示。\n * 长久的存在，不因时间的流逝、博客的关闭、URL 的变更等等原因而消逝。\n * 开放，分享和交流每个人的异常分析经验，让异常分析经验和知识更为普及和提升。\n\n\n\n--------------------------------------------------------------------------------\n\n因此，我们在 Github 上初步建立了一个 『 JavaScript 异常档案 』 的开源项目。任何人都可以 fork、提交\nissues、评论、邮件、或社区推广等各种方式来参与。\n\n等一下，你突然发现了这么一个页面： 这个页面里有这个异常在各个语种下的异常消息描述，同一个异常代码在不同浏览器里的\n详细分析，还有有血有肉的实际案例分析，关键代码，实际异常演示页，，， 可能还很不完善，还需要我们一起来参与，但是泪奔的感觉有木有~\n\n--------------------------------------------------------------------------------\n\n希望有一天：\n\n * 我们遇到的脚本异常都可以在这个档案中找到原因、解决或规避的方案。\n * 我们分析的脚本异常都可以出现在这个档案中以惠及他人。\n\n最良好的祝愿！\n\n\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-05-22","routePath":"/blog/post/javascript-exceptions-archives","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":266,"title":"JavaScript Strict Mode","content":"#\n\nECMAScript 5 定义了严格模式。开发者在代码中写上 \"use strict\" 标识，浏览器就会 按照严格模式来执行 JavaScript。\n\n而且还非常强大的支持局部作用域，不影响其他外部作用域使用非严格模式。 多么贴心的服务。\n\n很多人（包括我之前）的直觉会认为这是非常好的特性，向前兼容，严格模式也必定是未来的趋势。\n\n但是我想说的是：严格模式是未来的趋势也许没有错，但绝对不会是让开发者手工在各个 作用域中到处写 \"use strict\"。\n\n使用严格模式是开发者的事，所以最重要、也是最直接有效的方式是在开发阶段就完成 严格模式的所需的所有工作，包括代码静态分析、校验等待。\"use strict\"\n选项应该 在 IDE/编辑器中配置而不是写在代码中。\n\n同时像 HTML 的严格模式一样，浏览器运行时使用严格/非严格模式只需要在 DOCTYPE 中声明一次，而无需不同作用域使用不同的模式。\n\n肯定有人站出来说，对于历史遗留的非严格模式的代码怎么办，支持作用域模式不是应该 考虑的兼容性问题么？\n\n确实，历史遗留代码的兼容性问题比较麻烦，我很同情我们。\n\n但是想想我们从 HTML 转到 XHTML 的痛苦经历，难道我们应该允许文档中某些 DOM\n片段是不标准的，另外一些片段写上一些特殊属性声明自己是遵循标准使用严格模式的吗？\n\n完全没有，我们只有一个 DOCTYPE。\n\n不标准的代码只有重写，就是这样。\n\n--------------------------------------------------------------------------------\n\n我认为：\n\n * 严格模式是未来的趋势。\n * 严格模式应该在 IDE/编辑器和浏览器中声明。\n * 严格模式无需也不应该在各个 JavaScript 作用域片段中到处声明。\n\n\n参考#\n\n * ECMA-262-5 in detail. Chapter 2. Strict Mode.\n\n * 译：It’s time to start using JavaScript strict mode\n\n * ECMAScript 5 Strict Mode, JSON, and More\n\n * [Strict Mode\n   (JavaScript)](http://msdn.microsoft.com/en-us/library/ie/br230269(v=vs.94\\).a\n   spx)\n\n * What does “use strict” do in JavaScript?\n\n * What does “use strict” do in JavaScript, and what is the reasoning behind it?\n\n * JavaScript语法支持严格模式：”use strict”\n\n--------------------------------------------------------------------------------\n\nPublished on 2013-05-19","routePath":"/blog/post/use-strict-mode","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":790}],"domain":"","frontmatter":{},"version":""},{"id":267,"title":"就近原则：JavaScript 块级作用域的变量定义","content":"#\n\n> 代码是写给人看的，顺便给机器执行。[1]\n\n\n引子#\n\n上周有位前端同学周报里分享了段 for 循环的『好代码』：\n\n\n\n这位同学是看了 jQuery 里类似下面这种用法之后做的这个分享：\n\n\n\njQuery 还有不少地方使用这种用法，也有不少地方是传统的使用 length 方法。 但是 jQuery 这样用有其特定场景，需要正视。我回复说：\n\n 1. 如果数组项中有 0, false, null, undefined, \"\"，代码就出 bug 了。\n 2. 好像没看到少了变量，一定要少的话，典型的 for 写法也可以少（但是不推荐）。\n 3. 代码是写给人读的，顺便给机器执行。\n 4. 另外，对 list 本身有操作，尤其是长度有影响的操作要特别注意。\n\n我个人推荐下面这种写法：\n\n\n\np.s. 使用 Vim snipMate 的同学可以参考 javascript.snippet 这个代码片段模板。\n\n好了，使用溢出判断数组循环结束的讨论到此就结束了，但是好戏还在后头。\n\n由于 JavaScript 作用域的问题，有同学建议说将 i, l 变量定义在 for 循环之外。 于是进入另一个变量定义的话题。\n\n\n如何定义块级作用域中使用的变量？#\n\n持有变量应前置定义观点的同学，估计有不少是受了《JavaScript 权威指南》或其他权威著作的影响。\n\n《JavaScript 权威指南》第 4 章 4.3.1 小节 [2] 详细分析了块级作用域中变量定义的问题。\n\n由于 JavaScript 只有函数作用域，没有块级作用域，因此在 for, if/else, do/while, switch/case, try/catch\n这些块中定义的变量，实际在块之外也可以使用。\n\n\n\n例如上面的代码，在 for 这个块之中定义的变量，在 for 之外也可以使用。 这在其他支持块级作用域(如C/C++ [3],\nJava)的编程语言中是无法理解，甚至不可接受的。\n\n这是 JavaScript 设计的 BUG，书中作者建议将所有变量声明集中放置在函数开头， 说这是个好习惯。\n\n> This example illustrates why it is good programming practice to place all of\n> your variable declarations together at the start of any function.\n\nJavaScript 传教士老道也有 [类似的教诲](http://javascript.crockford.com/code.html#variable\ndeclarations)：\n\n> The var statements should be the first statements in the function body.\n> \n> ...\n> \n> JavaScript does not have block scope, so defining variables in blocks can\n> confuse programmers who are experienced with other C family languages. Define\n> all variables at the top of the function.\n\n他们的理由是，既然在块级作用域之内定义的变量可以被块级作用域之外使用， 那么就应该把变量定义在块级作用域之外，让它们看起来和它们实际的作用域表现一致。\n\n\n\n--------------------------------------------------------------------------------\n\n但是这个我稍微持不同的观点 ：）\n\n实际上我们定义 i, l 是为了给 for 用的，JavaScript 解释器在执行的时候可以 给块级作用域外面用，不代表就应该定义在外面。\n定义在外面给人的暗示是这个变量是给整个 function 用的，而不只是 for 循环， 就会给人『在外面用也没关系』的错觉。但这其实不是我们定义 i, l\n的本意。\n\n另外变量前置声明，会导致变量声明、定义和使用之间分离，变量含义自我解释性被削弱， 而且容易造成误清理、或遗漏清理变量的问题。\n\n对于 JavaScript 的这个糟粕，让人来适应机器的问题而修改代码，甚至改变本性习惯， 和另一个使用逗号连续定义变量的话题是何其的相似。\n为什么不让机器来适应人，在编辑器中编辑、或在编译器中编译 JavaScript 代码时， 发现块级作用域之外有使用块级作用域内部定义的变量时，给予恰当的警告。\n这是否更合理呢。\n\n如果遵循权威的教诲，把变量定义在函数前面，编辑器和编译器都没有办法帮我们了。\n\n我认为：\n\n 1. 定义在块级作用域之内的变量不应该被块级作用域之外使用。\n 2. 如果被块级作用域之外使用了：\n    \n    1. 要么这是一个错误的用法，会带来隐患。 人、编辑器、编译器、甚至将来的解释器可以发现这个问题并给出警告。\n    \n    2. 或者确实有这样的使用需求，那么这个变量应该被声明在块级作用域之外。\n\n所以我比较认同 就近原则 [4] 这种更合理、更人性的风格。\n\n * 文档、注释应尽可能的靠近代码。\n\n * 变量声明应尽可能的靠近变量使用。\n\n * 应尽量限制变量的作用域。\n\n\n那么#\n\n请问你持什么样的观点呢？\n\n--------------------------------------------------------------------------------\n\n\n注#\n\n 1. 出自《Structure and Interpretation of Computer Programs》，中文版《计算机程序的构造和解释》\n    \n    > Thus, programs must be written for people to read, and only incidentally\n    > for machines to execute.\n    > \n    > -- by Harold Abelson and Gerald Jay Sussman with Julie Sussman\n\n 2. 《JavaScript 权威指南》第六版章节和标题有所变更。第六版对应章节在第 3 章 第 3.10.1 小节：函数作用域和声明提前。\n    第六版中，关于变量声明提前的结束语中相对中立了很多。\n    \n    > In programming languages with block scope, it is generally good\n    > programming practice to declare variables as close as possible to where\n    > they are used and with the narrowest possible scope. Since JavaScript does\n    > not have block scope, some programmers make a point of declaring all their\n    > variables at the top of the function, rather than trying to declare them\n    > closer to the point at which they are used. This technique makes their\n    > source code accurately reflect the true scope of the variables.\n    \n    大意是说： 在支持块级作用域的编程语言中，变量就近定义是一个非常好的编程实践。 变量定义尽量靠近变量使用，变量尽量限制在最小的作用域之内。 由于\n    JavaScript 没有块级作用域，一些程序员提出将变量定义在函数的顶部， 而不是靠近使用变量的地方。这使得源码准确反映了其真正的作用域范围。\n\n 3. 早在 C89 规范 中，规定了变量必须声明在作用域的最前面， 但是 C99 和 C++ 取消了这个限制，支持就近声明变量。\n    \n    由于就近声明可以让变量作用于恰当的作用域之中，而且变量声明更靠近变量的使用， 因此也更容易理解。就近原则\n    在很多编程语言当中都是最佳实践，JavaScript 也不例外。\n\n 4. 就近原则(The Principle of Proximity) 是一项社会心理学 的理论，实际在 计算机编程 、 视觉设计 、 网页设计\n    领域也有很多的延伸与实践。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2013-04-25","routePath":"/blog/post/block-scope-variable-defined","lang":"zh-CN","toc":[{"text":"引子","id":"引子","depth":2,"charIndex":27},{"text":"如何定义块级作用域中使用的变量？","id":"如何定义块级作用域中使用的变量","depth":2,"charIndex":516},{"text":"那么","id":"那么","depth":2,"charIndex":2287},{"text":"注","id":"注","depth":3,"charIndex":2389}],"domain":"","frontmatter":{},"version":""},{"id":268,"title":"Github 的 404 页面是个好路由","content":"#\n\n上周五周会上 @玉伯 做了个微分享：由于新浪微博的 BUG，不会将 https 的 URL 自动 转成可点击的链接，于是玉伯给\nlifesinger.github.com Project 做了个 index.html 页面：\n\n\n\n然后就可以通过 http://lifesinger.github.com/?126 这个链接来访问对应的 issues (玉伯的博客使用 Github 的\nissues 管理发布)\n\n我看到这个 URL 第一感觉是不爽，立即想到可以用 404 页面来做路由跳转页，然后访问 地址可以改成\nhttp://lifesinger.github.com/126 这样。\n\n于是玉伯的分享完败，也为下一个我要做的分享加了分 XD\n\n今天仔细想了想，使用 404 页面做路由跳转的思路本身很不错， 但是 http://lifesinger.github.com/126 这样的 URL\n其实是不具有可扩展性的， 也没有良好的语义性，而且也不是很好验证 URL 的业务合法性。于是可以改成如下：\n\nhttp://lifesinger.github.com/blog/126\n\n好了，根据 URL 前缀信息，404 页面可以扩展成你需要的任意路由跳转页， 或者非路由的 404 原始页了。\n\n散花~\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-03-24","routePath":"/blog/post/github-404-is-a-good-route","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":269,"title":"迁移博客到 Jekyll","content":"#\n\n\n_posts 文件结构#\n\nJekyll 支持两种结构：\n\n 1. 平铺所有文件，每个文件使用日期前缀。\n 2. 按照完整的日期目录结构。\n\n\n静态链接(Permalink)#\n\n我的个人博客并非用于发布新闻，即使非常旧的博客，也会不断更新维护， 所以无需添加时间标识，直接使用 title 即可。\n\n如果需要多个版本，为避免出现冲突，可以在 title 中添加序号。如 II 或 2。\n\n\n草稿(Draft)#\n\nJekyll 支持 published 标记，设置为 false 就可以避免被转换发布。 这本身很不错，但是这些草稿和正常发布的文件混淆在一起，无法清晰区分。\n\n所以我创建了 _draft 目录，用于存放草稿。在文章准备好之后拷贝到 _posts 目录即可。\n\np.s. 话说相比 published 标记，我更喜欢 draft，如果支持的话。\n\n\nmore#\n\nCreating Excerpts in Jekyll with Wordpress-style HTML Comments\n\n\n存档(Archive)#\n\nenaeher / tiered_archives.rb\n\n\n目录(TOC)#\n\nhttp://stackoverflow.com/questions/9602936/how-to-add-a-table-of-contents-to-jek\nyll-blog-post\nhttp://stackoverflow.com/questions/13481572/jekyll-automatic-table-of-contents\nhttp://du1abadd.org/2010/usr/make_toc_support_for_jekyll_with_rdiscount.html\n\n\n标签(Tags)#\n\n\n代码高亮#\n\n\n分页#\n\n\n\n\n参考：#\n\n * Jekyll Draft Publishing Plugin\n * Jekyll Draft Posts\n\n\n与 Vimwiki 结合#\n\n之前的博客使用 Vimwiki 管理，可以无需转换或发布，直接使用 Vim 即可简单浏览。\n\n\n\n\n不足#\n\n_posts/*.md 文档理论上只会作为内容输出，其中的代码（尤其是 Jekyll 使用的模板 代码，及其 pre > code\n中的代码，应该合理转义处理。但是实际上 Jekyll 没有这样 做，导致一些代码没有符合期望。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-02-13","routePath":"/blog/post/start-jekyll-for-blog","lang":"zh-CN","toc":[{"text":"_posts 文件结构","id":"_posts-文件结构","depth":2,"charIndex":3},{"text":"静态链接(Permalink)","id":"静态链接permalink","depth":2,"charIndex":75},{"text":"草稿(Draft)","id":"草稿draft","depth":2,"charIndex":199},{"text":"more","id":"more","depth":2,"charIndex":386},{"text":"存档(Archive)","id":"存档archive","depth":2,"charIndex":458},{"text":"目录(TOC)","id":"目录toc","depth":2,"charIndex":503},{"text":"标签(Tags)","id":"标签tags","depth":2,"charIndex":766},{"text":"代码高亮","id":"代码高亮","depth":2,"charIndex":778},{"text":"分页","id":"分页","depth":2,"charIndex":786},{"text":"参考：","id":"参考","depth":3,"charIndex":794},{"text":"与 Vimwiki 结合","id":"与-vimwiki-结合","depth":2,"charIndex":858},{"text":"不足","id":"不足","depth":2,"charIndex":923}],"domain":"","frontmatter":{},"version":""},{"id":270,"title":"个人资金管理软件","content":"#\n\n过年花掉不少钱，而其中有一部分是喜酒之类的礼金，按照礼尚往来的习俗，这些礼金 早晚都是要被送回来的，而被送回来的途径，则是喜酒回请。\n\n这些俗礼，即使不是为了收回礼金，回请对方也是必须的。\n\n为了避免忘记吃过的酒席（前几年的都忘记差不多了），也为了对自己的资金有更清晰 的掌握，于是开始记账。\n\n我现在用上了 Macbook Pro 和 iPhone，于是想找一个可以运行于 Mac OSX 和 iOS 平台\n的软件，两者同步数据是必须的要求。毕竟移动设备记账有很多的便利优势，而 PC 做 更细致的管理与分析则更为方便和强大。\n\n\nGNUCash#\n\nGNUCash 非常有名，也是我最早知道的开源金融管理软件 之一，复式记账一直是我觉得很厉害但是又不明白的概念。后来看了一些金融相关不入门 的信息，才有所了解。\n\n以前也在 Windows 下使用过 GNUCash，本身还是很不错的，但是当时我没有坚持下来。\n\n这次下载最新版回来在 Mac 上安装好之后发现，除了菜单之外，界面上中文全部是乱码， 一行中文被缩挤到第一列。新建账户或者其他任何操作都是不知所以，完全没法用。\n最奇怪的是，网络上各个搜索引擎居然都搜索不到 GNUCash 乱码的内容，偶尔有一篇， 还是将数据库的。原来 GNUCash 使用的是 MySQL 存储数据？\n\nGNUCash 目前支持 Windows, Mac, Linux, 和 Android 平台。\n\n\niCash#\n\n后来看到有人推荐使用 iCash， Mac 下 i 系列的好像都不错，于是尝试了下。\n\niCash 支持 Windows, Mac 平台，也有中文支持。\n\n但就是觉得操作不算便利，一大堆莫名其妙的表单，有些会自动根据后面的表单自动适配， 不需要显示但居然安排在最前面，后来我才知道可以不填。\n\n界面有点点土，用户体验也不好。概览里管理资金账户，如果需要更新交易，则需要 切换到『交易』页签，然后选择是哪个账户的交易。表单恐惧症~\n\n填了不到 50条左右（存储的 .icash 文件有 23.8M 这么大）就烦了， 于是继续寻找其他软件。\n\n\nMoney#\n\n最后才找到 Money by jumsoft 界面设计非常赞， 大部分使用体验也很棒，有部分瑕疵，而最要命的启动速度非常慢，导入从 iCash 导出的 QIF\n格式数据(.money 文件 500+KB) 启动时间大概需要 10秒。\n\n另外如果上次退出 Money 的时候没有打开的文档（每个 .money 文件是一个文档）的话， 下次启动会要求创建新文档，只好打开最近的文档，再等\n10秒钟。所以建议直接 <Command-q> 退出文档 & 程序，不要使用 <Command-w 之类的关闭文档。\n\n另外还有 iOS(iPhone, iPad)版本，收费也不贵。可以通过 Wi-Fi 或 iCloud 同步数据。 虽然呼声很高，目前还不支持 Dropbox\n同步。不过像其他重要资料一样，我的 .money 文件存储在 Dropbox 中。\n\n总之是很赞啦，如果解决了性能问题就更好了，还有就是缺少中文本地化，另外 Mac 版 显示全部交易也不好，还有那啥~\n\n--------------------------------------------------------------------------------\n\nTags: , , ,\n\nPublished on 2013-02-17","routePath":"/blog/post/personal-financial-manage-soft","lang":"zh-CN","toc":[{"text":"GNUCash","id":"gnucash","depth":2,"charIndex":269},{"text":"iCash","id":"icash","depth":2,"charIndex":622},{"text":"Money","id":"money","depth":2,"charIndex":901}],"domain":"","frontmatter":{},"version":""},{"id":271,"title":"使用 Space 还是 Tab 缩进代码？","content":"#\n\n\n\n这也是一个经典的问题吧。很长一段时间以来我都是被影响为使用空格，而且似乎大多数 人都使用 4 个空格吧。。\n\n\n可视空间#\n\n空格：\n\n * 几乎所有编辑器或代码查看器中的占位一致，缩进风格统一。\n\nTab:\n\n * 每个编辑器可视占位空间可能不一致，但大多数编辑器可以设置，所以每个用户可以 使用自己的视觉习惯。\n\n\n缩进风格#\n\nK&R风格： 由Kernighan & Ritchie 给出的格式而得名，又称“核心风格”，因为UNIX核心应用了这种编程风格。\n每一层缩进使用8个空格（或者一个制表符），有时也使用4个空格，但很少。\n\n\n\nAllman风格： 因Eric Allman而得名，Eric Allman是伯克利的一名黑客，写了大量BSD程序，（这种风格又称BSD风格）\n每一层缩进使用8个空格，4个空格也经常被使用。\n\n\n\nWhitesmiths风格： 这种风格来源于早期一种C语言的商用编译器。 每一层缩进使用8个空格，4个空格也偶尔被使用。\n\n\n\nGNU风格: 不用说，自然是来自GNU了。 每一层缩进总是使用4个空格。在“”号的缩进则使用半个缩进位。\n\n\n\n\n展开阅读#\n\n * Indent style\n * Editor war\n * Tabs versus Spaces: An Eternal Holy War.\n * Why I love having tabs in source code.\n * Tabs versus Spaces: An Eternal Holy War.\n * Tab versus space indentation in C#\n * Tabs versus spaces—what is the proper indentation character for everything,\n   in every situation, ever?\n * Tabs vs. spaces for indentation\n * Death to the Space Infidels!\n * Indent with tabs, align with spaces\n * Indentation: Tabs vs. Spaces\n * tabs or spaces?\n * Why tabs are clearly superior\n * Indent style\n * Indent style\n * C语言编码风格（一）——缩进和空白\n * 文章段落起首空格（缩进）风格的讨论\n\n--------------------------------------------------------------------------------\n\n * 代码缩进 tab space\n\n * 用空格还是制表符缩进有什么好争的？\n\n * 写代码时，缩进使用 tab 还是空格？\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2013-01-06","routePath":"/blog/post/format-by-spaces-or-tabs","lang":"zh-CN","toc":[{"text":"可视空间","id":"可视空间","depth":2,"charIndex":60},{"text":"缩进风格","id":"缩进风格","depth":2,"charIndex":164},{"text":"展开阅读","id":"展开阅读","depth":2,"charIndex":494}],"domain":"","frontmatter":{},"version":""},{"id":272,"title":"使用 MacVim 做 svn diff","content":"#\n\n\n对于终端的 vim#\n\n 1. ~/.subversion/config\n    \n    \n\n \n\n 2. 将下面的代码保存为 svndiff：\n    \n    \n\n 3. 拷贝到 /usr/local/bin/svndiff 并设置权限：\n    \n    \n\n\n对于 MacVim#\n\n修改 /usr/local/bin/svndiff 内容如下：\n\n\n\n之前尝试过修改终端方案中的\n\n\n\n为：\n\n\n\n未遂，右侧的代码会为空。\n\n\nSee Also#\n\n * svn diffの結果をMacVimで。\n   \n   * diffwrap.sh\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2012-10-31","routePath":"/blog/post/macvim-svndiff","lang":"zh-CN","toc":[{"text":"对于终端的 vim","id":"对于终端的-vim","depth":2,"charIndex":3},{"text":"对于 MacVim","id":"对于-macvim","depth":2,"charIndex":138},{"text":"See Also","id":"see-also","depth":2,"charIndex":223}],"domain":"","frontmatter":{},"version":""},{"id":273,"title":"在 Vim 上安装使用 Tagbar","content":"#\n\n\n\n会提示将 NODE_PATH 加入到环境变量 ~/.bash_profile ：\n\n\n\n\nSee Also#\n\n * Tagbar\n\n * Support for additional filetypes\n\n * Vim学习 Jsctags\n\n * Doctor.js - jsctags.\n\n * .ctags\n\n * Awesome vim support for javascript with jsctags and taglist-plus\n\n * 更好的用vim浏览Javascript代码\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2012-10-28","routePath":"/blog/post/vim-install-tagbar","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":49}],"domain":"","frontmatter":{},"version":""},{"id":274,"title":"杭州萧山无人村骑行","content":"#\n\n从驴友哪里知道杭州附近有个无人村，网上看了帖子盘山公路很风景都很吸引人， 但是地图山就是搜索不到在哪里，后来才知道地图上是狮山村，大概是后来没有人住了\n才被大家称为无人村的。\n\n骑行路线：\n\nhttps://ditu.google.com/maps/ms?msa=0&msid=201867621321994349317.0004ccf3731b6db\n4167b5&brcurrent=3,0x344bb629439aaa99:0xa7bfd183824de83a,0%3B5,0,0&ie=UTF8&t=h&l\nl=30.123883,120.152439&spn=0.296055,0.075098&output=embed\n\n\n\n其他同学都有事没能一起，只有一个测试好基友 @peacefulgoose 一起。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2012-10-27","routePath":"/blog/post/wurencun","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":275,"title":"『逻辑与』是个好东西","content":"#\n\n一直很想实现 WebForms2 的语义化表单验证，最近才开始动手，执行力真差啊。\n\n一个表单元素可以同时存在多种校验方案，比如：\n\n * required.\n * data type: number, date, url, email...\n * minlength, maxlength, min, max.\n * pattern\n * 用户自定义验证函数。\n * 异步访问服务器进行业务校验。\n\n通常可以通过逻辑判断进行处理：\n\n\n\n实际代码中，各个 verifyXXX 函数可能内联在 verifyFormInput 函数中， 代码显得多而有点乱，甚至有点冗余。\n\n想起模拟电路课程上学到的『与门』，只有所有电路都是通路时，整个电路才是通路。\n\n而表单验证也是这样：\n\n * 某个表单元素的所有验证逻辑都通过验证时，这个表单元素才算通过验证。\n * 整个表单的所有表单元素都通过验证时，才算这个表单通过验证。\n\n同时基于『逻辑与』表达式的语言特性，一旦前面的条件可以判断逻辑失败，立即返回 失败，不再进行后面的条件判断。\n\nLogicalANDExpression:\n\n> Semantics\n> \n> The production LogicalANDExpression : LogicalANDExpression &&\n> BitwiseORExpression is evaluated as follows:\n> \n>  1. Evaluate LogicalANDExpression.\n>  2. Call GetValue(Result(1)).\n>  3. Call ToBoolean(Result(2)).\n>  4. If Result(3) is false, return Result(2).\n>  5. Evaluate BitwiseORExpression.\n>  6. Call GetValue(Result(5)).\n>  7. Return Result(6).\n\nBitwiseORExpression:\n\n> Semantics\n> \n> The production A : A@B, where @ is one of the bitwise operators in the\n> productions above, is evaluated as follows:\n> \n>  1. Evaluate A.\n>  2. Call GetValue(Result(1)).\n>  3. Evaluate B.\n>  4. Call GetValue(Result(3)).\n>  5. Call ToInt32(Result(2)).\n>  6. Call ToInt32(Result(4)).\n>  7. Apply the bitwise operator @ to Result(5) and Result(6). The result is a\n>     signed 32 bit integer.\n>  8. Return Result(7).\n\n于是验证算法改良如下：\n\n\n\n\n延伸#\n\n以前也 Hack 的用过逻辑与表达式，比如：\n\n\n\n但这个用法只是用到了条件判断的作用，类似于：\n\n\n\n\n参考阅读#\n\n * ECMAScript\n\n * 逻辑与 Logical_conjunction\n\n * 与门 AND_gate\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2012-05-01","routePath":"/blog/post/logical-conjunction","lang":"zh-CN","toc":[{"text":"延伸","id":"延伸","depth":2,"charIndex":1332},{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":1390}],"domain":"","frontmatter":{},"version":""},{"id":276,"title":"千里走单骑","content":"#\n\n今天和 5 个同事一起从公司出发，骑车去径山寺。\n\n\n路线&定位#\n\n * Google Maps for iPhone. 可以自动搜索匹配路线，参考价值还是很高的。\n * Google Maps 手机 Web 版(iPhone) 这个不错，支持 My Places。就是每次动作都可能下载数据会比较费流量，体验也相对下降。\n * My Maps Editor 支持 Google Maps My Places，但是对于用 Google Maps 自动搜索到的路线，保存到 My\n   Places 的数据，这个支持还不行，会被拉成直线。\n * My Place for Google Maps 这个就垃圾了，纯粹骗钱偷窃的货，又不要脸又没种。\n\n\n参考#\n\n * 中国陆路边境口岸列表\n\n * 杭州及周边骑行路线集\n\n * 余杭径山寺\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2012-04-02","routePath":"/blog/post/bicycle-travel","lang":"zh-CN","toc":[{"text":"路线&定位","id":"路线定位","depth":2,"charIndex":29},{"text":"参考","id":"参考","depth":2,"charIndex":327}],"domain":"","frontmatter":{},"version":""},{"id":277,"title":"计算主域名","content":"#\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-12-13","routePath":"/blog/post/primary-domain","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":278,"title":"Confluence Wiki for Vi","content":"#\n\n.ctags / ctags.cnf\n\n\n\n.vimrc / _vimrc\n\n\n\n这玩意很好使，同样是 .wiki 后缀，可以同时支持 Vimwiki 和 Confluence Wiki。\n\n\nSee Also#\n\n * http://www.vim.org/scripts/script.php?script_id=1994\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2011-12-04","routePath":"/blog/post/confluencewiki.vim","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":99}],"domain":"","frontmatter":{},"version":""},{"id":279,"title":"Date.now()","content":"#\n\n以前做过一个 JavaScript 性能测试“框架”，也看过其他人做性能比较的时候，基本上 也都是使用 new Date()\n来记时，会“耍点小花样”的同学会使用 +new Date()。\n\n现在又想做另一种性能监控的方法，便着重考量了下各种记时方案，尽量减少因为 性能监控代码对业务代码的影响。\n\n下面是循环 100000 次，过程中只有计数器操作，得到的时间(ms)对照表 (Demo)。\n\nBROWSER    NEW DATE()   NEW DATE().GETTIME()   NEW DATE().VALUEOF()   +NEW DATE()   DATE.NOW()\nIE8        469          391                    375                    406           -\nFirefox6   266          258                    257                    259           236\nChrome13   46           29                     29                     35            20\nOpera11    246          242                    246                    244           222\nSafari5    256          232                    239                    255           222\n\n由此可以对照出，Date.now() 确实有很明显的性能优势，另外 Date.now() 返回是 number 类型的数值，并不产生 Date 对象。\n\n不过目前只有 IE9, Firefox3+, Chrome5+, Opera10.50+, Safari4+ 支持，对于不支持 的浏览器，可以继续使用 new\nDate().valueOf() 方法（个人不推荐用 +new Date()）：\n\n\n\n\n日期相关#\n\n\n\n\n参考阅读#\n\n * Date.now Function (JavaScript) - MSDN\n\n * Data.now() - MDN\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-09-18","routePath":"/blog/post/Date.now","lang":"zh-CN","toc":[{"text":"日期相关","id":"日期相关","depth":2,"charIndex":935},{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":945}],"domain":"","frontmatter":{},"version":""},{"id":280,"title":"文本宽度 及 文本框滚动偏移量(scrollLeft)","content":"#\n\n\n背景#\n\n最近将多标签输入框进行修改，把原来随光标(caret)移动的自动建议浮动条改为根据当前标签相对左对齐。\n\nhttp://1.bp.blogspot.com/_POl6bUDELqY/SRQ_xx7LXCI/AAAAAAAAFSw/syXjnAQ-RLI/s320/t\nags.jpg\n\n解决方法很简单，计算当前标签前的文本宽度(将需要计算的文本转义后放入一个各字体样式与目标输入框相同的容器，\n如span中，span.offsetWidth即是文本的宽度。注意：文本框中，中文半角空格的宽度和英文半角空格的宽度显示为不同，\n虽然这两个空格本质上相同)，浮动条根据该值定位即可。\n\n\n问题#\n\n当标签文本过长，超出文本框宽度时，标签文本会向左滚动，但是此时当前标签前面的文本宽度不变， 定位浮动条时需要减去文本向左滚动的尺寸。\n\n网页文档对象中，元素都有一个可读写的scrollLeft属性，表示元素内容相当元素容器向左移动的偏移量。\n\n但是 Firefox 和 Opera 有一些例外，如文本框的 scrollLeft 始终为 0，\n[https://developer.mozilla.org/En/DOM/Element.scrollLeft Mozilla] 的描述是：\n\n> If the element can't be scrolled (e.g. it has no overflow), scrollLeft is set\n> to 0.\n\n对于一些不可滚动(scroll，即没有溢出)的元素，scrollLeft始终为0。而单行文本框 （在Gecko引擎看来）是不可滚动的，即使将样式指定为\noverflow:scroll （IE会出现水平和垂直滚动条这样的怪胎）。\n\n虽说单行文本框是不应该出现滚动条这样怪异的形态，但是这不表示它是不可滚动的，\n当文本宽度大于文本框宽度时，（为了将光标caret显示在文本框可见区域）文本势必向左滚动，如图：\n\n\n\n\n解决办法#\n\n对于文本框不支持scrollLeft的浏览器，一个临时的解决办法是，在文本宽度大于文本框宽度时，\n浮动条定位在相对文本框后端若干像素（便于输入）的位置，在增量输入时，体验不是太差， 但是在光标向前移动使文本向右滚动时，就会出现偏差。\n\n最终解决办法是期待浏览器能够得到正确的scrollLeft值，或者其他巧妙的计算方法。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-11-07","routePath":"/blog/post/text-width-and-input-scrollleft","lang":"zh-CN","toc":[{"text":"背景","id":"背景","depth":2,"charIndex":3},{"text":"问题","id":"问题","depth":2,"charIndex":299},{"text":"解决办法","id":"解决办法","depth":2,"charIndex":844}],"domain":"","frontmatter":{},"version":""},{"id":281,"title":"智能同步滚动条","content":"#\n\nBROWSER   DOCUMENTELEMENT.SCROLLTOP   BODY.SCROLLTOP\nIE        √                           ×\nFirefox   √                           ×\nChrome    ×                           √\nSafari    ×                           √\nOpera     √                           ×\n\nTODO: 其他的 get 方式。尝试智能判断是否设置成功，非通过浏览器性别判断。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-09-01","routePath":"/blog/post/smart-sync-scroll","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":282,"title":"面积分割算法","content":"#\n\n做用户点击行为分析的展现时，用了一个透明的层覆盖在页面上，然后覆盖一层 canvas 画布，使用稀疏矩阵算法绘制热点分布图。\n\n预蒙上一层透明蒙版，然后只对需要的区域进行绘制热点图，本是非常不错的方案，我 本机上也一直无问题。但是测试提交了一个 bug，说 IE\n下看到点击热点图及轨迹图背后 一片漆黑，我就猜测滤镜问题，最先猜想的是浏览器安全设置导致的滤镜无效，但是又 发现有些类似的图形有没有问题。\n\n结果发现是某些显卡下，IE 中超大面积的区域滤镜会失效。\n\n首先想到的解决办法就是针对 IE 进行切割蒙版，由多个蒙版拼接而成，类似于铺地板。\n\n普通的算法有两种：\n\n 1. 将整块蒙版区域划分成多个 2000*2000 的蒙版，最后一列和最后一行不足指数，取余 设置宽高。\n 2. 将整块蒙版划分成多个不超过 2000*2000 的等份蒙版。这种算法比较简单，稍微的不足 之处在于，不能除断的情况，无法等分。\n\nTODO: 有更灵巧的算法么，当然有了，只是我还不知道而已。\n\n\n后来想到#\n\n用 canvas 绘制一个透明的区域也未尝不可。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-08-25","routePath":"/blog/post/area-split","lang":"zh-CN","toc":[{"text":"后来想到","id":"后来想到","depth":2,"charIndex":445}],"domain":"","frontmatter":{},"version":""},{"id":283,"title":"计算高度的时机","content":"深入 Iframe 自适应高度#\n\nDOCTYPE(CSS1Compat): HTML5, HTML4.01 Strict, HTML4.01 Transitional, XHTML1.0\nFrameset, XHTML1.0 Strict, XHTML1.0 Transitional, XHTML1.1.\n\nBROWSER   DOCUMENTELEMENT                  BODY           \n          scrollHeight      offsetHeight   scrollHeight   offsetHeight\nIE        √                 ×              √              √\nFF        √                 √              √              √\nChrome    √                 √              √              √\nSafari    √                 √              √              √\nOpera     √                 √              √              √\n\nnon-doctype(BackCompat): 无 DOCTYPE, IE: DOCTYPE 前有非空白字符（包括注释）。\n\nBROWSER      DOCUMENTELEMENT                  BODY           \n             scrollHeight      offsetHeight   scrollHeight   offsetHeight\nIE8          ×                 ×              √              ×\nFF5          √                 √              √              √\nChrome13     √                 √              √              √\nSafari5      √                 √              √              √\nOpera11.50   √                 √              √              ×\n\n测试环境：Windows Server 2003.\n\n综上所述：使用 document.body.scrollHeight 是最合适的。\n\n\n计算高度的时机#\n\n父窗口检测子窗口：\n\n\n\n本窗口自检测：\n\n\n\n\n子窗口获取自身在父窗口的 iframe 元素#\n\n如果父窗口有名字的话，可以直接通过 frames[name] 直接引用。\n\n\n\n\n其他相关#\n\n上面的 getParentFrame 通过窗口名字直接取得元素本身，这里要注意的一点， 以前写代码的时候有这样的代码定义：\n\n\n\n后来要增加一个变量，但是不小心写错标点符号。\n\n\n\n然后 name 就成了全局变量，无意中修改了 window.name 的值。 所以如果使用 name 作为局部变量的时候，千万要小心，否则执行这段代码之后，\na[target=oldName] 的链接会因为找不到 frames[oldName] 而弹出新窗口。\n\n\n延伸阅读#\n\n * 再谈iframe自适应高度\n\n * 三谈Iframe自适应高度\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-08-24","routePath":"/blog/post/iframe-highly-adaptive","lang":"zh-CN","toc":[{"text":"子窗口获取自身在父窗口的 iframe 元素","id":"子窗口获取自身在父窗口的-iframe-元素","depth":2,"charIndex":1208},{"text":"其他相关","id":"其他相关","depth":2,"charIndex":1274},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":1505}],"domain":"","frontmatter":{},"version":""},{"id":284,"title":"获取元素所绑定的事件列表","content":"#\n\n技术上有什么办法获得指定 HTMLElement 上有绑定那些 #JavaScript 函数事件，及其处理函数么？\n\n比如我有一个按钮，想知道他绑定了那些事件？ click 事件的处理函数是什么？\n\nelem.onclick 这种只能绑定唯一的一个事件处理函数，可以直接取到。\n\nDOM Level 3 有\n[http://www.w3.org/TR/2001/WD-DOM-Level-3-Events-20010823/events.html#Events-Eve\nntListenerList eventListenerList] 接口，但是现在还没有浏览器实现。\n\n不过可以通过框架包装的方式获取列表。 另外 Google Chrome 浏览器的开发者工具有提供查看元素绑定了哪些事件的特性， 猜测是通过解析页面及其引入的\nJavaScript 源码得到的 （据我所知，Firebug 的性能分析就是通过 inject 代码到各个函数中来实现的）。\n\n\n延伸阅读#\n\n * http://www.w3.org/TR/2001/WD-DOM-Level-3-Events-20010823/events.html#Events-E\n   ventListenerList\n\n * http://www.quirksmode.org/js/events_advanced.html\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-08-19","routePath":"/blog/post/eventlistenerlist","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":433}],"domain":"","frontmatter":{},"version":""},{"id":285,"title":"宏伟的 Vimlike.js 计划","content":"#\n\n一直在想：网站本身提供的快捷键支持（如 Gmail, GReader, Gplus, Twitter），\n和浏览器插件提供的通用快捷键支持（Vimperator, Vimium, ...），两者如何共存， 相互之间能够相安无事，甚至能够相辅相成？\n\n目前想到两种方案：\n\n 1. 白名单机制。像 AutoProxy 一样，针对不同的网站/网址，屏蔽某些键映射， 使用官方自有映射支持。不过这个要维护这份列表也是一件蛋疼的事。\n 2. 网站根据统一约定的快捷键定义接口实现特有功能，非特有的则默认使用共有实现。\n    另外也提供扩展机制，让第三方插件也可以根据这个接口为特定的网站/页面实现特定功能。\n\n个人觉得第 2 中方案比较好，但这是一项宏大的项目，要各个网站遵循这个接口标准来实现， 不是一件易事。准备先把这个做到\n[https://github.com/hotoo/vimlike.js Vimlike.js] 项目里， 然后请一些 Vim 爱好者的个人博客一起来参与实践。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-08-16","routePath":"/blog/post/vimlike-project","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":286,"title":"Abort HTTP 请求","content":"#\n\n * \n\n英文不好，请教个问题：\n\nabort 这个单词，好像有丢弃，中断之类的意思。\n\nAJAX 发一个请求，然后 abort 掉，那么这个请求只是客户端一厢情愿的丢弃， 服务端仍然可以接收到并处理请求呢；还是直接中断这个请求，\n导致服务器端也会丢弃/忽略这个请求？\n\n如果翻译，应该翻成 丢弃 HTTP 请求 还是 中断 HTTP 请求 ？\n\n-- Update --\n\n搜索了一番，跟想象中的一致，只是客户端的一厢情愿，丢弃服务端的返回而已， 并不是服务端丢弃处理请求。\n\n所以应该翻作： 丢弃 。\n\n\n延伸阅读#\n\n * http://weblogs.asp.net/dwahlin/archive/2007/07/17/aborting-ajax-requests.aspx\n\n * http://stackoverflow.com/questions/446594/kill-ajax-requests-using-javascript\n   -using-jquery\n\n * http://topic.csdn.net/u/20090206/14/c43249df-29a9-4167-9dc3-e3a8f738248d.html\n\n * http://book.51cto.com/art/200810/91493.htm\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-07-22","routePath":"/blog/post/abort-http-request","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":257}],"domain":"","frontmatter":{},"version":""},{"id":287,"title":"日期时间型控件的体验","content":"#\n\n目前支持精确到时分秒输入/选择的日历控件，我总觉得用起来很不爽， 却又想不出更舒适的交互方式。\n\n大家有觉得哪种选择时间（非日期）的方式比较舒服一点的控件么， 或者描述一下自己期望的交互过程也好。\n\n----- Update ----\n\nNote: 我说的是 时间 (时分秒，非 日期 ，年月日 )选择/输入过程， 日期型一般点一下或少量几下就可以完成，基本上是比较自然流畅的一个过程；\n但是输入/选择时间的却是非常不流畅的一个过程。\n\n我只是想体验，或者尝试实现更流畅的时间输入过程， 不是想让推荐某个库的某个控件（这个控件的时间输入过程非常流畅的例外），谢谢。\n\n---- Comment 1 ----\n\nHao zi - 额，我没看错，是时分秒，YUI的链接干扰理解了， 最喜欢的就是能快捷键输入时间了，普通用户应该还是更青睐鼠标。 好多地方用的6:00 am\n6:30am……时间下拉单的形式我觉得不好用， 有的甚至还有6:15am……Google calender一方面可以拉动调整时间段，也不需要精确到秒，\n所以用着还好。时间不是10进制，实际生活中表盘上也还需要三根针才能显示， 设计特别了用户也不好理解，我的展望如图：\n\n\n\n时分使用一个滑动框，秒使用一个滑动框， 时分框移动到PM仍利用AM刻度但背景色改变。\n秒框稍有不同，可只显示部分刻录来避免太密集，滑块拉动到左右边缘时刻录跟着移动。\n\n---- Comment 2 ----\n\n萧星星 - 年月日和时分秒的处理 ： 支持键盘输入和方向增减， 支持鼠标滚轮和点击的增减 ； 滚轮的会是最流畅的， 不过用户需要一个适应过程～\n\n---- Comment 3 ----\n\n黄川 - 用安卓调时间的UI交互，然后鼠标放在上面，用滚轮，我觉得这种方式不错\n\n---- Comment 4 ----\n\n闲耘 - 鼠标滚轮，或者键盘方向键本身是不错的，我很认同。 我主要不满意的地方在于：如果 时间 随同日期的弹出层一起，\n同时需要选择日期和时间时，基本上只能增加一个确定按钮来辅助实现。 现在想想，年历，月历，日历还是和时间部分独立分开的比较合适。\n\n\nSee Also#\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-07-20","routePath":"/blog/post/datatime-picker","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":910}],"domain":"","frontmatter":{},"version":""},{"id":288,"title":"鼠标事件研究(Mouse Event)","content":"#\n\n| Event | type | IE | > | FF | > | Chrome | > | Safari | > | Opera | > |\n\n/             /        BUTTON     WHICH       BUTTON   WHICH   BUTTON     WHICH   BUTTON     WHICH   BUTTON     WHICH\nonmousedown   left     1          undefined   0        1       0          1       0          1       0          1\n/             middle   4          undefined   1        2       1          2       1          2       1          2\n/             right    2          undefined   2        3       2          3       2          3       2          3\nonmouseup     left     1          undefined   0        1       0          1       0          1       0          1\n/             middle   4          undefined   1        2       1          2       1          2       no event   >\n/             right    2          undefined   2        3       2          3       2          3       2          3\nonclick       left     0          undefined   0        1       0          1       0          1       0          1\n/             middle   0          undefined   1        2       1          2       1          2       no event   >\n/             right    no event   >           2        3       no event   >       no event   >       no event   >\n\nWindows 2003 Server. IE8, FF5, Chrome12, Safari5, Opera11.\n\nNote:\n\n * document.onmousedown === document.addEventListener ===\n   document.attachEvent(\"onmousedown\")\n * document.onmouseup === document.addEventListener(\"mouseup\") ==\n   document.attachEvent(\"onmouseup\")\n * document.onclick === document.addEventListener(\"click\") ==\n   document.attachEvent(\"onclick\")\n\n\n\n\nSee Also#\n\n * Event properties - ppk\n\n * Demo\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-07-16","routePath":"/blog/post/mouse-event","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":1589}],"domain":"","frontmatter":{},"version":""},{"id":289,"title":"吐槽","content":"#\n\n上次监控系统计算得分有些非常离谱的结果，然后我就质疑后端的算法， 结果师傅兼小组长突然莫名其妙的说我“怎么老是怀疑别人，我最看不惯这种人了，\n我们是一个开发团队，巴拉巴拉巴拉，，，”。\n\n当时我特无语~~ 只很愤怒的说了一句，“这个明显有问题，为什么还不能质疑！”\n\n 1. 第一，我只是对事不对人的质疑算法，并没有怀疑某个人。\n 2. 第二，其实组长本身貌似对我也很不放心，老怀疑我这个，质疑我那个， 有一些简洁清晰到不可能有问题的代码，还是要我去做各种检验。\n    我一直都没有什么二话去执行的，直到他连续 N 遍说到我烦为止。\n\n自己老怀疑他人，还说最讨厌其他人的怀疑态度的，其实也没什么了， 都这样，人性的双重性格而已。\n\n之前有几次组长来质疑我同一个问题，今天又来了，说我检测到的脚本错误， 前端开发很多都不承认，说他们不能重现，认为不准。说我虽然发现了他们的问题，\n但是他们不愿意、或者没有办法去改，问我怎么办？！这是什么逻辑。\n\n有不能解决的问题也不多搜索，也不群里问，说我的不准也没见来找我辩驳， 一口咬定我的不准，不承认我的工作，这算什么。\n\n然后说让我找一个报的次数最多的错误实例，说让我重现，那个错误是“错误的数量词”， 我去，这个我在常见脚本错误文档里写了那么多都白写的么！\n\n这是一个表单验证函数中使用 new RegExp(str) 导致的错误，str 是来自用户的输入，\n却没有经过转义处理，代码级可以肉眼看出来的错误，说让我那边表单实际试试嘛， 那个表单要邮箱验证，还要好几步才能进去呢。我蛋疼么。\n\n给了个最简单的 new RegExp(\"+\") 还是说让我去表单上试。说“不拿出实际例子出来， 没有资格说别人有问题！”\n\n究竟要多无语，才能说明我无语啊~~~\n\n怒道：有些问题看代码就有明显的问题，根本就无需睁着眼睛瞎测试。 昨天看到热点分布那里使用 evt.clientY 这样的代码，还需要去试一下么，\n难道还需要我去告诉开发你应该滚动下浏览器的滚动条来重现？\n\n终于迎来了艰难的沉默。\n\n\nSee Also#\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nPublished on 2011-07-15","routePath":"/blog/post/tucao","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":869}],"domain":"","frontmatter":{},"version":""},{"id":290,"title":"豆瓣电台，我忍你很久了！","content":"#\n\n豆瓣电台做的太烂，估计算法是一个有怀旧情节的家伙设计的。\n\n听的越多， +1 的歌曲越多，重复播放的可能性越高， 同一个音乐人的歌曲被重放的可能性也越高，导致每天都在听一些听过 N 遍的歌曲。\n\n我 +1 不过是希望算法通过数据能再了解我一点，用来向我推荐其他类似风格的音乐人/乐曲。\n\n如果只是从我已经 +1 的歌曲中重复播放，我要一个电台干什么？！ 我的播放器就已经做的很好啊，稍笨一点，播放器或音乐文件属性中设置标星等级；\n再笨一点，做一个播放列表，把喜欢的音乐加进去；更笨一点，单曲循环播放好了。\n\n登录了在豆瓣电台标星/删除/下一曲，只因为手贱吗？豆瓣，我忍你很久了。\n\n\nComment#\n\n我情愿去听虽然有主持人在啰嗦或煽情，但重复少得多也不那么乏味的国内无线电台。\n\n另外推荐一个国外无主持人的网络电台，有很多风格的频道（非豆瓣分类方式）， 这个是我最喜欢的 NewAge 风格的，请欣赏\nhttp://www.sky.fm/play/newage\n\n前段时间有被墙或网络很不好才勉强听的豆瓣，今天发现又回来了，谢谢国家。\n\n\nSee Also#\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-07-13","routePath":"/blog/post/douban.fm","lang":"zh-CN","toc":[{"text":"Comment","id":"comment","depth":2,"charIndex":294},{"text":"See Also","id":"see-also","depth":2,"charIndex":474}],"domain":"","frontmatter":{},"version":""},{"id":291,"title":"非递归遍历 DOM 结构","content":"#\n\n上次在Google+ 上说 实现了非递归遍历 DOM 结构， 有朋友想让分享，我当然很高兴，但是很遗憾这本身没有什么值得分享的，大致如下， 给大家随便看一下：\n\n常见的递归方式遍历方式，下面是 Douglas Crockford 写的递归实现：\n\n\n\n然后有人自称写出了更快的遍历 DOM 方式。\n\n\n\n最初找到有详细对照的文章地址没有找到，这个是 类似的一篇， 而且也是非递归式的。\n\n确实是很快的，但只是快还是不够的，这个实现有很多弊端：\n\n 1. 注释等元素未必会被遍历。\n 2. 树形数据结构被整理成了平板结构，无法实现遍历过程的 in/out 处理。\n\n然后今天的主角隆重登场：\n\n\n\n上面只是一个精简版，实际过程中还需要考虑节点类型的问题，一般会过滤 1:HTMLElement, 8:Comment, 9:Document Type,\n10:DocType 之外的节点。\n\n其实也不过如此嘛，飘过~~\n\n\nSee Also#\n\n * W3C DOM -Introduction - ppk\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-07-10","routePath":"/blog/post/non-recursion-walk-the-dom","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":412}],"domain":"","frontmatter":{},"version":""},{"id":292,"title":"说说渐进加载","content":"#\n\n 1. google+, quora, twitter... 这些网站都使用渐进加载数据的方式，\n    类似的还有淘宝图片的懒加载，都是等用户真正滚到最后之后才开始去加载， 提前一些预加载体验不是更好么。\n\n \n\n 2. 到最后一页了还是有“更多”，直到点击最后一个更多没加载到数据才告诉用户 没更多数据了，这不是蛋疼么？\n\n估计是基于算法上的考虑，比如每页 10 条：\n\n\n\n这样要查询 2 次。\n\n不过只查数据库一次也是可以的：\n\n\n\n好久不写后端程序，不知道他们这么做是否有基于其他的考虑？\n\np.s. Google+ 个笨蛋居然剔除行首的有效空白，而不剔除行尾的无效空白。。。\n\n\nSee Also#\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-07-08","routePath":"/blog/post/about-lazy-load","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":298}],"domain":"","frontmatter":{},"version":""},{"id":293,"title":"Vimlike.js","content":"#\n\n很久之前做了一个 Vimlike 的 HTML(5) Slide， 很小的一个玩意，但是很好玩。里面支持 normal, search, command,\nhelp 等模式， 最初是每个单独自己 Copy 的一份，然后精简成各个模式自己需要的键映射。\n\n一直想把这个 Vimlike 的键映射部分抽象提取处理，前段时间 Google+ 出来的时候， 看到 mattn 做的一个用来 支持 +, c, s ...\n等快捷键的 user-script， 我就立即提议实现 gg, G, gh, gp, gP 这些键盘映射，并把这个 Vimlike 键映射抽取好了。\n\n抽取的过程基本还顺利，只遇到一点点小问题，另外还做了些优化。\n\n之前为了避免无映射的键 push 到 history 中造成无法正确触发键映射的问题 （比如只映射了 <Esc> 键，其他的 abc 之类的键会 push 到\nhistroy 中， 尝试对应的映射是找不到的，后续的键就无法触发了），采用优先触发当前键事件的方式。\n\n仔细想了想，优先考虑当前 key 是不合理的，比如同时映射了 j 和 gj， 由于优先原则的干扰，造成 gj 永远都不会被触发。\n\n接着以为针对 <Esc>, <CR>, <Tab> 等键特殊处理，遇到这种键直接触发， 不放到 history 中就差不多可以了。\n\n继续深入思考，仍然不够，其实完整的 Vim-like 如果要支持 mark, g+, z+, +, 等一系列的扩展支持，都需要有内置支持，否则就是需要类似\nmap(\"m[a-zA-Z0-9]\", function()) 这样的模糊映射支持了。\n\n实现增强版的内置扩展键支持，还是实现模糊映射支持，这是个问题？\n\n\nSee Also#\n\n * Vimlike.js@github, Demo\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-07-08","routePath":"/blog/post/vimlike.js","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":739}],"domain":"","frontmatter":{},"version":""},{"id":294,"title":"说说支付宝爱心捐助","content":"#\n\n以前我还持续捐助，但是我觉得支付宝爱心捐助 我是越来越没法持续捐助下去了，那该死的 KPI 要求项目达到 XX 数量， 狗日的又没有质量要求。\n\n每天救救这个，帮帮那个，都是一些实体的捐助对象，看这很痛心，但排成一排来展览， 看着就有点恶心了，让人看不下去，吃不下饭。\n\n我知道国内 NGO 很难，靠谱的也不多。但是我还是希望相对靠谱一点的机构 （下面都简称慈善机构，支付宝本身不是也有爱心小组么，虽然好像都是业余的）\n来做这些实体的捐助过程，安排捐助计划，定时公开捐助报表， 普通捐助人只需要持续对这个机构捐助就好了。\n\n像对一个人、或一个家庭这么小的单位，慈善机构自己可以自己列为项目，计划支出， 但捐助人真的无需去直接接触。你说我捐助了某个病人A，不去捐助另一个病人B吗？\n世界上困难的人这么多，每个捐助人都需要一个个去直接指定捐助么？ 这种事情慈善机构能有一点自己的计划么，该不该捐助，该如何捐助，\n你慈善机构没有计划，你还让捐助人信任你什么？！\n\n而对于重大集体性灾难，可以在爱心捐助平台上展示一个项目，让更多的人知晓， 传播给更多的人来支持捐助，而且一般这种项目，捐助人是很希望可以指定捐助的，\n比如上次日本地震+海啸+核污染，中国大陆居然没有可靠方便的捐助方式，简直是匪夷所思。\n\n最后给大家献给一曲《无地自容》\n\n> 策划：雅沫 导演：莞儿 曲：李丹 词：刘咚咚 唱：@土著Walker\n> \n> 美眉她姓郭，爱炫自我； 各种名包，各种好车； 微博经认证，名头热火； 红十字会商业老总； 是否涉嫌炒作，你最清楚； 妹子到底想要揭露什么？\n> 何必东藏西躲，又何必删贴； 迟早有一天你会面对我； 天灾人祸中，常看到你； 宣扬博爱，弘扬道义； 捐款全给你，进出无明细； 庞大帐目谁在审计；\n> 总在自说自话，难自圆其说； 百姓问你到底做了什么？ 不要再装沉默，你实话实说； 我们的爱心多少被挥霍； 商红会无车，清贫如洗； 没有电脑没有手续；\n> 成立十几年，从不会登记； 中红博爱惹人注意； 总在自说自话，难自圆其说； 百姓问你到底做了什么？ 不要再装沉默，你实话实说； 我们的爱心多少被挥霍；\n> 不再相信，相信什么公益； 除非捐款公布明细； 这场危机，怎样才能过去； 不必追究是谁的错； 我曾为你献血，也曾替你开脱； 如今献唱一曲，让你无地自容！\n\n\nSee Also#\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nPublished on 2011-07-04","routePath":"/blog/post/love.alipay.com","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":986}],"domain":"","frontmatter":{},"version":""},{"id":295,"title":"“盗梦空间”","content":"#\n\n前段时间公司发生了好几次盗窃案，虽然很快破案了，但总还是感觉不太安全。 前几天有同事跟我说不要把自己本本放在公司，但是我却不以为然，公司座位那么多，\n而且柜子还锁着，偷到我的位置上的概率没那么高吧！\n\n昨晚做梦，说我心爱的小黑晚上盗了，我悲痛欲绝，无法相信这是真的。\n\n仿佛知道是在夜里做梦似的，或者是因为盗窃案发生在夜里的缘故，我梦里深夜赶到公司， 看到柜子被撬开了，翻乱一地。保安说摄像头有拍下整个过程，然后带我们去监视室。\n\n我们进的应该不是监视室，那种房间我去过，肯定不是。而且我也没有看到录像， 梦里乱七八糟的，盗贼的脸留下了悬念。另外虽然有录像，但是破案又是另外一回事了。\n\n第二天上班，没有电脑，然后师傅天蓬急了，给相关人员（ IT ?） 说好并让我去申请一天小台，但居然又是去的监视室的那个房间。 IT\n给我一台谁谁用过的小白，然后我就出来了。\n\n过了一会儿，我突然想起拿小白的时候仿佛瞟到我的小黑在那监视室的一张很乱的桌子上 放着，我赶紧过去看，果然，是放在那里，我心爱的小黑。\n\n梦里似乎有一个很合理的解释为什么我的小黑在这个房间里，仿佛是已经破案了， “赃物”都放在这里。呃，是这么回事么？可惜我已经记不清了。\n\n\nSee Also#\n\n * @Google+\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-06-30","routePath":"/blog/post/dream-the-thief","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":521}],"domain":"","frontmatter":{},"version":""},{"id":296,"title":"如何取 URL 中第一个单独的问号(?) 位置","content":"#\n\n新版 Arale 通过 nginx 服务支持使用双问号的访问方式：\n\n\n\n访问 https://www.example.com/module.js\n\n通过正则的正向预搜索有办法获得第一个单问号的位置么？\n\n\n\n会匹配双问号的第 2 个问号：\n\n\n\n\n\n目前是通过循环方式计算的，无心比较遍历和正则之间无优劣， 纯粹对于正则的实现很有兴趣 :)\n\n\n答案一：#\n\n\n\n\n答案二：#\n\n上面用了两个相同规则的分组，这里可以减少到一个分组\n\n\n\n但是这种做法对于问号(?)在字符串首尾时没有办法匹配\n\n\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-06-22","routePath":"/blog/post/how-to-get-the-first-single-question-mark","lang":"zh-CN","toc":[{"text":"答案一：","id":"答案一","depth":2,"charIndex":176},{"text":"答案二：","id":"答案二","depth":2,"charIndex":186}],"domain":"","frontmatter":{},"version":""},{"id":297,"title":"使用 Vimwiki 还是 Jekyll 作为博客系统？","content":"#\n\n一直使用 Vimwiki 作为个人博客系统，今天非常荣幸收到加入 Vim 中文星 的邀请，需要我的提供 RSS/Atom 输出。\n\n但是 Vimwiki 本质上是一个 wiki 系统，通常来说都是（个人推荐）作为平板结构\n来放置信息，较少（但也支持）基于目录，尤其是基于日期时间格式的目录结构来存储 词条（或者说日志），所以要支持基于时间的 RSS/Atom\n就有一定的困难，而且貌似 需求本身也不怎么合理，不过 github 的提交记录里是有 RSS 输出的，虽然作为博客 订阅的意义几近于无。\n\n于是想是否有必要在 Wordpress 上同步更新博客（Blogger 被墙的厉害），但是发现 很久以前（还是在拥有 xianyun.org，并使用\nmail@xianyun.org）注册的 Wordpress， 杯具的忘记密码了，注册的邮箱也不再使用，无法索取找回密码了。\n\n于是想：迁移到 Jekyll 怎么样？\n\n由于 github pages 的缘故，很早就大致了解了下 Jekyll，但是没有深入，一直主观的 认为 Jekyll 会根据模板动态转换\nmarkdown/textile 文件。但是更深入的了解之后 发现，Jekyll 只是一个静态文件转换程序，通过模板引擎将数据（博客日志）和模板 转换成静态\nHTML 文件。\n\n * 支持 markdown, textile 语法。\n * 支持生成 RSS, ATOM。\n * ruby 脚本生成静态文件。\n * 需要将安装 ruby 和 jekyll.\n\n而 Vimwiki 是一个基于 Vim 的 wiki 客户端程序，提供便于管理和使用的本地 wiki 支持。\n\n * 支持 wiki 语法。\n * 不支持生成 RSS, ATOM。\n * Vim script 生成静态文件。\n * 需要安装 Vim, Vimwiki.\n\n我个人目前最简单的需求，就是在 Vimwiki 的基础上实现 RSS 输出的支持。不过完整 、完美意义上来说，我还是希望有这样一个博客系统。\n\n * 支持 wiki, markdown, textile 或其他语法。(Vimwiki, Jekyll)\n * 支持生成 RSS/Atom 输出. (Jekyll)\n * 通过 Vim(script) 或其他易于安装使用的程序，将日志+模板自动生成 HTML 文件。(Vimwiki, Jekyll)\n * 日志原始文件通过 Dropbox 或其他云服务自动同步，无需 push 到 github。(Vimwiki)\n * 只将生成好的静态 HTML 文件 push 到 github。(Vimwiki)\n\n\n延伸阅读#\n\n * 像黑客一样写博客\n\n * 使用github作为博客引擎\n\n * 告别wordpress，拥抱jekyll\n\n * 在heroku上用jekyll做博客\n\n * 轻量级博客工具: Jekyll vs ToTo\n\n * 將Wordpress轉移到Jekyll及Disqus\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-06-19","routePath":"/blog/post/blog-system-vimwiki-or-jekyll","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":1125}],"domain":"","frontmatter":{},"version":""},{"id":298,"title":"丢弃图片的 HTTP 请求","content":"#\n\n * \n\nOS         BROWSER          \"\"     NULL   REMOVE   DELETE   STOP   STOPIMAGE   STOP   BUTTON   TIMEOUT\nWindows    IE6,7,8          √(e)   √(e)   II       ×        ×      ×           ×      ×        21s (e)\n/          FF4,5            II     II     II       ×        II     ×           ×      II       21s (e)\n/          Chrome12         ×      ×      ×        ×        II     ×           ×      II       21s (e)\n/          Safari4,5        ×      ×      ×        ×        II     ×           ×      II       21s (e)\n/          Opera9           ×      √(e)   ×        ×        II     ×           ×      II       47s (e)\n/          Opera11          II     √(e)   II       II       II     ×           ×      II       47s (e)\nMac OS X   Safari5          ×      ×      ×        ×        II     ×           ×      II       1.2m (e)\n/          Chrome12         ×      ×      ×        ×        II     ×           ×      II       1.2m (e)\n/          FF4,5            II     II     II       ×        II     ×           ×      II       1m'15s (e)\nUbuntu     FF4,5            II     II     II       ×        II     ×           ×               3m'9s (e)\n/          Chrom(e/ium)12   ×      ×      ×        ×        II     ×           ×               3.2m (e)\n\n * Windows XP, Server 2003, 7.\n * Mac OS X 10.6.7\n * Ubuntu 11.04\n\n标题注解：\n\n\n\n图标注解：\n\n\n\n\n事件回调#\n\n\n\n测试结果：\n\n\n\n\nTODO:丢弃 jsonp 请求？#\n\n为什么不是 script/link?\n\n使用 document.createElement(\"script\") 创建元素并设置 src 属性， appendChild 到 DOM\n中会去请求指定资源，可以到底向日志服务器发送数据的要求。\n\n但是使用这种方式有一下几点弊端：\n\n 1. 创建脚本带来的危险性。\n\n 2. 会向 DOM 中附加元素，影响 DOMLint 校验。\n\n 3. 无法 abort，无论设置 script = null;, script.src=\"\";, script.src=null;,\n    script.removeAttribute(\"src\");, document.body.removeChild(script); 都无法实现\n    abort.\n\n 4. 引入资源不触发 onload/onerror/onabort 事件，除非使用 jsonp 的方式， 对元素本身无法得到回调。\n\n\nSee Also#\n\n * http://stackoverflow.com/questions/930237/javascript-cancel-stop-image-reques\n   ts\n\n * http://www.sysopt.com/forum/archive/index.php/t-177147.html\n\n * http://stackoverflow.com/questions/1671717/javascript-image-onabort-event-not\n   -firing-in-firefox-chrome\n\n * http://stackoverflow.com/questions/4506160/abort-active-image-requests\n\n * http://www.devguru.com/technologies/ecmascript/quickref/image.html\n\n * Javascript: Cancel/Stop Image Requests\n\n * Can't you stop images from loading?\n\n * window.stop()\n   \n   * http://stackoverflow.com/questions/930237/javascript-cancel-stop-image-requ\n     ests\n   * http://stackoverflow.com/questions/3146200/stop-loading-of-images-on-a-hash\n     change-event-via-javascript-or-jquery\n   * https://developer.mozilla.org/en/DOM/window.stop\n\n * execCommand\n   \n   * execCommand Method\n   * http://msdn.microsoft.com/en-us/library/ms536419%28v=vs.85%29.aspx\n   * http://msdn.microsoft.com/en-us/library/ms533049%28v=vs.85%29.aspx\n   * https://developer.mozilla.org/En/Document.execCommand\n\n * IE6下链接ONCLICK事件处理中的请求被ABORTED\n\n * What does (Aborted) mean in HttpWatch? 来源\n\n * http://blog.httpwatch.com/2007/11/20/error_internet_invalid_url-httpwatch/\n\n * HttpWatch工具简介及使用技巧\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-06-23","routePath":"/blog/post/abort-image-request","lang":"zh-CN","toc":[{"text":"事件回调","id":"事件回调","depth":2,"charIndex":1338},{"text":"TODO:丢弃 jsonp 请求？","id":"todo丢弃-jsonp-请求","depth":2,"charIndex":1357},{"text":"See Also","id":"see-also","depth":2,"charIndex":1791}],"domain":"","frontmatter":{},"version":""},{"id":299,"title":"多种不同结果的返回模式","content":"#\n\n探讨个问题哈，我现在再做一个 HTML 校验工具，先将 HMTL 源码解析成 DOM 树，\n其间可能遇到语法错误，为了发现更多的错误，会跳到下一个分界点继续解析； 然后将解析得到的 DOM 树返回给 lint 工具继续进行进一步的语法、语义解析。\n其过程是：\n\n\n\n最终需要将 parse 和 lint 的错误收集到一起反馈给服务端。\n\n请问，parse 有什么好的方式来返回解析时错误信息？\n\n之前先是将 parse 设计成了函数式，但是我觉得下面这种返回方式很不好：\n\n\n\n\n另外一种思路#\n\nHTMLParser 设计成独立的类（而不是上面的函数方式）\n\n\n\n貌似这种方式比上面的稍好一点，不过我又不想为此将原本很简单的函数式改成 对象式。\n\n\n外部数据存储#\n\n\n\n对于只有一个实例（或运行一次）的情况，第三方独立的 console 是合适的。 但是一旦需要多个实例（或运行多次，每次Parse的结果都各自独立，\n每个html的parse和lint的错误结果各自拼接一起，但是不是所有的html的parse+lint错误结果拼接在一起）\n的情况，还是将解析异常信息和解析器本身绑定在一起（比如类）的方式比较合适。\n\n上面的文字有点绕，表达式：\n\n\n\nerr0 和 err1 是各自独立的，实例化多个第三方独立的有专用的Console，不如用类的方式好了。\n\n\n寻求指教#\n\n对于这种需要返回多种不同数据的函数式， 如果你有其他的方案，欢迎回帖、回邮，或回博交流指导 ：）\n\n\n更新 (2013)#\n\n事件机制可能是最好的选择：\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-06-08","routePath":"/blog/post/parser-return-pattern","lang":"zh-CN","toc":[{"text":"另外一种思路","id":"另外一种思路","depth":2,"charIndex":242},{"text":"外部数据存储","id":"外部数据存储","depth":2,"charIndex":328},{"text":"寻求指教","id":"寻求指教","depth":2,"charIndex":586},{"text":"更新 (2013)","id":"更新-2013","depth":2,"charIndex":644}],"domain":"","frontmatter":{},"version":""},{"id":300,"title":"closure-compiler.vim","content":"#\n\nClosureCompiler.vim\n\n\nSee Also#\n\n * Auto compile Javascript with Closure\n\n * Vim 儲存完 JavaScript 檔案後自動用 yuicompressor\n\n * Vim function：使用 closure compiler 壓縮 js 文件\n\n * 在项目中使用Google Closure Compiler\n\n * Closure Compiler 高级模式及更多思考\n\n * Closure Compiler vs YUICompressor\n\n * function to use closure-compiler\n\n * Closure Compiler\n\n * closure-compiler online\n\n * Closure Compiler Documentation\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-05-26","routePath":"/blog/post/closure-compile.vim","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":24}],"domain":"","frontmatter":{},"version":""},{"id":301,"title":"【结束】~~趣味 Vim Tee~~","content":"【结束】趣味 Vim Tee#\n\n去年 [[vim73-tee|【已结束】团购庆祝 Vim 7.3 正式发布的 Tee]] 真是热闹的说，今年刚入夏， 就有 Vim 爱好者提出团购 Tee\n的事了，我本来没准备印 Vim 的 Tee 的，倒是刚印了 2 件“连接被重置”和“连接超时”的 Tee。\n\n偶然又看到这副 Emacs 警追杀 Vim 匪 的漫画，可惜原图太小了。\n\n\n\nVim Talk 群里的“猫猫虫”同学非常给力的描了副大图，几经处理之后，我们终于 有了可以 印刷在 Tee 的创意 了。啊哈，这幅漫画我最爱了。\n\n跟商家初步聊了下，去年 60 多件每件 25 块，今年即使有这么多数量，最便宜也只能到 33 块了（哦，我的口袋，有 33\n块）。现在数量还没确定，而且这次不像去年那么热烈了， 估计人数会少很多。\n\nTee 的设计： 正面：印这幅漫画。 背面：无。 右手袖标：印每个人的 ID，可以自行决定，可以没有。\n\n如果你也想印一件或者几件，请发邮件一下信息至 hotoo.cn+VimTee[AT]gmail.com ， 请将 [AT] 替换成 @，其他保持不变。\n\n注意 ：如果确定要购买，请务必将你 需要的尺码， 邮件地址 ，实际的 收货地址 ， 邮编 ， 收件人姓名 和你要求的 袖标 。\n最好还有即时联系方式，比如手机，快递可能需要。 请确认这些信息能直接联系到你，收件人能收到货。\n\nGmail 最近很难连接上，尤其在公司，只能晚上回家整理订单了 抱歉。\n\n报名 ~还是像去年一样，截至这周末（2011/05/29） 吧~ 截至下周一(2011/05/30)，\n过期自己想印的可以单印，给商家打出我们的旗号，再好好商量，应该有折扣的 ：）\n\n我并非托，不收分毫中介费或者中间利润。如果你不信任的话可以自行拿图去印刷， 版权免费（如果猫猫虫同意的话）。\n\n\n流程#\n\n 1. 网友邮件详细信息给闲耘。\n 2. 闲耘收集统计信息，查漏补缺与确认。\n 3. 闲耘下订单。\n 4. 店家印制 Tee 并发货。\n 5. 闲耘得到快递单号，通知各位团友。\n 6. 团友收到 Tee 之后邮件通知闲耘，并（支付宝/银行）转账给闲耘。\n\n会有快递单号的，到时候我会一一发给各位的。33不是最终价格，看我们最终定的数量，我尽量争取更实惠的价格。邮费是另算的，如果同城其实可以考虑合寄，还可以顺便线下认\n识下。货款我是下单的时候统一给卖家的，到时候大家收到Tee之前/之后支付宝/银行转账都可以。\n\n * @NIX\n * fanke.im\n * @yyfrankyy\n\n\n延伸阅读#\n\n * 去年的贴\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-05-26","routePath":"/blog/post/vim-tee-2","lang":"zh-CN","toc":[{"text":"流程","id":"流程","depth":2,"charIndex":793},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":1091}],"domain":"","frontmatter":{},"version":""},{"id":302,"title":"深入 hasAttribute","content":"#\n\n众所周知，IE 的 HTMLElement 对象不支持 hasAttribute 方法，于是有了如下实现： 它针对不支持 hasAttribute\n方法的浏览器，检查 getAttribute 得到的是否等于 null， 如果是 null 则表明这个 HTMLElement 不存在指定的\nAttribute。很聪明的一个方法。\n\n\n\n最近写了个原理简单的基于 Select+Input 的可编辑 Combox 控件，用到了这个方法来检查目标 select 对象是否存在如 multiple,\neditable 这样的属性，来实现不同的 Combox 版本。其他 浏览器上跑的很好，但是在 IE6 上却总是被初始化为 multiple\n的实例，很明显，这个 hasAttribute 的实现出问题了。\n\n原来针对 IE6，还有稍多一点的特殊性：\n\n * input.getAttribute(\"checked\") 返回 Boolean 值，true/false；\n   * input[type=checkbox|radio].getAttribute(\"checked\") 根据他的 checked 状态相关；\n   * input[type=others...].getAttribute(\"checked\") 始终返回 false；\n * select.getAttribute(\"multiple\") 返回 Boolean 值；\n * select>option.getAttribute(\"selected\") 返回 Boolean 值。\n\n虽然可以通过 getAttribute(\"checked\") 判断 checkbox/radio 的属性状况，但对于 其他类型的 input\n元素，是无法准确获得 checked 属性的。\n\nTODO:\nchecked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,no\nwrap,readonly,selected\n\n下面是比较完整一点的实现：\n\n\n\n\nUpdate 2011/07/26#\n\n继续发现新坑：IE 中下面的代码\n\n\n\n输出：\n\n\n\n所以上面的 hasAttr 函数是无法正确返回这种在脚本中设置 onclick 值的。\n\n对策：\n\n\n\n\nUpdate 2011/10/26#\n\n继续新坑，IE5,6,7 的 script.getAttribute(\"src\") === \"\"，正常的 DOM 方法已经 阻止不了 IE 了，hack\n方案可以解析 wrapHTML(node)， 判断是否有 src 属性。\n\n如果在这里你真的可以忽略 IE，最佳方案还是屏蔽 IE 吧。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-05-19","routePath":"/blog/post/hasattribute","lang":"zh-CN","toc":[{"text":"Update 2011/07/26","id":"update-20110726","depth":2,"charIndex":903},{"text":"Update 2011/10/26","id":"update-20111026","depth":2,"charIndex":1003}],"domain":"","frontmatter":{},"version":""},{"id":303,"title":"window.close()","content":"#\n\n\n\nonclick return false;\n\nIE5.5以下\n\n\n\n\n延伸阅读#\n\n * window.close\n\n * Using the window.close method\n\n * window close\n\n * window.opener=null;window.close()，只支持IE6不支持IE7,IE8的问题\n\n * 怎么去掉使用window.close()时弹出的提示框？（不用按钮）\n\n * window.close关闭窗口，不弹出系统提示，直接关闭\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-04-26","routePath":"/blog/post/window.close","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":39}],"domain":"","frontmatter":{},"version":""},{"id":304,"title":"Vim 神技","content":"#\n\n\n\n\nSee Also#\n\n 1. Vim 神技@slideshare\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2011-04-11","routePath":"/blog/post/vim-share-2011","lang":"zh-CN","toc":[{"text":"See Also","id":"see-also","depth":2,"charIndex":5}],"domain":"","frontmatter":{},"version":""},{"id":305,"title":"JavaScript 异常初步","content":"#\n\n * Error, TypeError, ReferenceError\n * try/catch/finally\n * window.onerror / window.addEventListener(\"error\")\n * on(\"error\") events\n\n--------------------------------------------------------------------------------\n\n异常处理\n\nBROWSER     MESSAGE   DESCRIPTION   LINE   NUMBER   LINENUMBER   NAME   FILENAME   STACK\nIE8         √         √             ×      ×        ×            √      ×          ×\nFirefox 5   √         ×             ×      ×        √            √      √          √\nChrome 12   √         ×             ×      ×        ×            √      ×          √\nSafari 5    √         ×             √      ×        ×            √      ×          ×\nOpera 11    √         ×             ×      ×        ×            √      ×          √\n\n属性描述：\n\nmessage:: 异常消息描述，全部浏览器都支持。 name:: 错误名称，一般等同于错误类型名，如 Error, TypeError,\nReferenceError...。不过实际抛出的同一个错误，不同浏览器的 name 值可能不一致(下面讲述)。 description:: 异常描述，IE\n中同 message，其他浏览器不支持。 line:: 错误行号，仅 Safari 支持。 number:: 错误编号，例如“缺少对象”是\n-2146823281。“xx未定义”是 -2146823279。仅 IE 支持。 lineNumber:: 错误发生所在行号，仅 Firefox 支持。\nfileName:: 发生错误的所在文件地址，仅 Firefox 支持。\n\n构造函数的参数&顺序：\n\n参数        1(个)                      2(个)                      3(个)\nFirefox   Error(message)            Error(message,fileName)   Error(message,fileName,lineNumber)\nIE        Error(<Number> number)    Error(number,message)     >\n/         Error(<String> message)   /                         >\nChrome    Error(message)            >                         >\nSafari    /                         >                         >\nOpera     /                         >                         >\n\nNote: IE, new Error(String message) - <Object,Array,RegExp,...>.toString()\n\nJavaScript 有多种原生异常类型，包括最常见的 Error 和 EvalError, RangeError, ReferenceError,\nSyntaxError, TypeError, URIError. 这些原生异常类型分别对应的 意义是：\n\nError:: 异常的基类。 EvalError:: 发生在 eval() 函数中的异常。 RangeError:: 数值超出 JavaScript\n可表示的范围。 ReferenceError:: 使用了非法的引用。 SyntaxError:: 在 eval()\n中发生了语法错误的异常。除此之外的语法错误异常，均无法通过 try/catch 和 onerror 捕获，这类异常会直接报告给浏览器。 TypeError::\n变量类型不是预期的。 URIError:: 在 encodeURI() 和 decodeURI() 函数中发生异常。\n\nTODO: 每种异常类型都带有以下成员/方法。 message:: line::\n\n值得注意的是，直接掷出 Error 之外的其他原生异常（如 throw new EvalError(\"msg\")） 时，IE\n浏览器是无法捕获异常消息的，统一的异常消息是“例外被抛出且未被接住”。\n\n而在 trycatch(ex) 中可以拿到更详细的异常信息。\n\nJavaScript 也可以掷出其他类型的异常，如 throw \"xx error.\"\n\n\n捕获异常#\n\n推荐的异常捕获方法是 try/catch，不过也可以简单使用全局异常捕获方式：\n\n\n\nwindow.onerror 事件可以捕获浏览器端掷出的所有异常，并可以拿到错误消息，所在文件， 及错误所在行。但是无法获得异常对象本身，及触发异常的事件对象。\n\n注意：onerror 事件不在早期的 HTML4 规范中，只有 IE, Firefox 和后续的 Chrome 才有 支持，Safari, Opera\n至今没有支持这个事件。\n\n一般来说，绑定事件(addEventListener/attachEvent)的方式比给 HTML DOM 元素直接连接事件处理函数的方式要好。\n\n但是为 window 绑定 error 事件却似乎不太理想。 IE 浏览器能得到 4 个参数（比 onerror 多一个），但有效的还是前面 3 个（跟\nonerror 一致）。 而其他浏览器却只能得到一个参数，即错误事件（FF 得到的是 Error，Chrome 得到的 ErrorEvent。\n\n题外话，对于 HTML 元素的 onerror 事件一般会触发在加载外部资源时。\n\n\n无法捕获的异常#\n\n如果 onerror 所在 <script> 块本身有语法错误，会导致 onerror 错误处理脚本本身无法 被执行，也就无法初始化全局异常处理函数。\n\n或者异常发生在初始化全局异常处理函数之前，这个异常也无法被全局处理函数捕获。\n\n\n延伸阅读#\n\n * Error - MDC Doc Center\n\n * window.onerror - MDC Doc Center\n\n * onerror Event\n\n * The onerror event of the window object 2 3 4\n\n * TypeError\n\n * js判断错误类型\n\n * 解析IE浏览器中的Javascript Error对象\n\n * DamnIT\n\n * ExceptionHub\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-04-03","routePath":"/blog/post/javascript-exceptions","lang":"zh-CN","toc":[{"text":"捕获异常","id":"捕获异常","depth":2,"charIndex":2276},{"text":"无法捕获的异常","id":"无法捕获的异常","depth":2,"charIndex":2764},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":2892}],"domain":"","frontmatter":{},"version":""},{"id":306,"title":"JavaScript 分时加载","content":"#\n\n使用原始数据（非副本）和索引访问（非shift()），在IE中性能大幅度提高， 其他浏览器对 concat()，尤其是 shift()\n方法进行了优化，性能差别不大。\n\n分时算法对于需要及时更新 UI 的情况非常有效，但是实际上分时算法性能非常不好 （当然分时算法追求的不是这个），不适合作为巨量数据的实时处理。\n\n譬如说在树形控件中，原始数据提供了一个巨大的数组数据：\n\n\n\n我的处理方式是先将这份数据遍历一次，用 HashMap 进行缓存索引，便于后续的操作\n更加快捷。但是这个遍历本身是非常耗时的，虽然它不产生界面变化，但同样会将页面 卡死。为了提高界面响应速度，我们会想到使用分时计算方式，不过这种方式会延长\n缓存索引的过程变的更久，导致后续创建节点的操作无法及时执行，也就无法更新界面， 界面虽然可以操作，但是没什么可操作的（对于以树本身为主的页面来说）。\n\n后来的做法是，根据树的实时装载能力（目前是十万个节点。经过缓存索引的数据， 跟节点层级深度无关）和实际应用作出判断，对于在超出浏览器处理能力的，使用异步\n装载方式；处理能力以内的，不做要求。\n\n\n延伸阅读#\n\n 1. http://lifesinger.googlecode.com/svn/trunk/lab/2009/array-processing.html\n\n 2. 【优化】分时加载 - Cauma\n\n 3. http://www.nczonline.net/blog/2009/08/11/timed-array-processing-in-javascrip\n    t/\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-03-01","routePath":"/blog/post/timed-array-processing","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":485}],"domain":"","frontmatter":{},"version":""},{"id":307,"title":"树形控件的分时装载","content":"#\n\n异步装载树形控件节点的时机：\n\n 1. 传统方式是展开节点时再装载子节点；\n\n 2. 预装载子节点（即展开节点时，预装载到孙级节点。 任何可见的节点，如果有子节点，则其子节点不是已经装载好，就是在装载的网路上）。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2011-03-01","routePath":"/blog/post/timed-tree-processing","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":308,"title":"JavaScript 千分位算法","content":"#\n\nhttps://gist.github.com/748249\n\nv1:\n\n\n\nv2:\n\n\n\nv3:\n\n\n\n\n参考阅读#\n\n * “千分位”格式化数据的正则\n\n * 以“千分位”格式化数字–JavaScript\n\n * javascript 按千分位划分数字-递归方式\n\n * js数字千分位及取小数点后几位方法测试\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-12-20","routePath":"/blog/post/javascript-commfy","lang":"zh-CN","toc":[{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":56}],"domain":"","frontmatter":{},"version":""},{"id":309,"title":"水平表单的错误消息方式","content":"#\n\n垂直方向的表单，错误消息有很多种呈现方式，放在输入框后面，下面，或上面都挺好， 因为垂直表单本身可用空间较大，而且向下或向右挤也不是什么问题，布局也没什么影响。\n\n但是对于水平方向向右一字排开的表单（自动适应可用宽度，不够则自动折行），搜索表单 比较常用，这种表单会有数个搜索输入框或选项，如图：\n\n[http://farm6.static.flickr.com/5202/5209097632_a2bddacb9f_b.jpg]\n\n这种表单，错误消息无论放在上、下、左、右，都会影响到表单的布局，而悬浮消息 也可能会遮挡住其他的输入框。那这样的表单，错误消息应该如何更好的呈现呢？\n\n我想到一种，即“双重视觉强调”讲的：在表单上/下方给出整体的的错误信息，但输入框 本身，只给出警戒色的边框进行提醒。\n\n[http://farm5.static.flickr.com/4091/5208505527_1a8dd70502_b.jpg]\n\n当用户鼠标悬浮在出错输入框上，或者出错输入框获得焦点时，上/下面的错误信息框 自动高亮当前输入框对应的错误消息。\n\n这种表单本身不会很多选项导致需要翻页，所以放在上面是没有问题的。如果真的需要 很多选项，那就要考虑换成垂直表单了。\n\n高亮而不是更新消息内容，是为了防止消息框高度发生变化，导致表单本身上下跳跃移动； 当然也可以将消息框放在下面，不过直觉上，错误消息放在上面似乎更靠谱。\n\n上面是个人观点，大家可以各抒己见。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-11-26","routePath":"/blog/post/err-msg-for-horizontal-forms","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":310,"title":"placeholder 最佳实践","content":"#\n\nplaceholder 2 是 HTML5 中的标准属性，它用于定义显示在输入框中的简短提示信息，并在适当的时机 （比如在输入框获得焦点时）隐匿起来。\n\n在早期的浏览器中，只能通过 JavaScript 自定义函数来实现。而在早期的实现中又五花八门。\n\n在 HTML 方面，一般是使用自定义的 hint 或者 title 属性放置提示消息。\n\n而在 JavaScript 上，最常见的是通过修改 input 本身的 value 及其 CSS 样式实现。 一般有直接修改 input 的样式，或者添加\nclass 两种，后者从某种程度上来说更好些。\n\n早期的实现中还有一个比较不好的问题是，代码里直接判断 input.value 是否为空，\n或者是否为占位符提示的值，如果用户输入的内容如果碰巧和占位符提示相同，则会出现误判。\n\n下面可以说是早期思想中一个较佳的实现：\n\n\n\n但是即使如此，直接修改 input.value 同样会有一个几乎无法避免的问题：假如用户在必填项中没有\n输入任何内容，但是占位符会填充其内容，在提交表单时，当然也可以通过判断 input 是否包含 placeholder\n样式类来针对性处理。但是特殊地，当页面出现脚本错误（这应该说不少见），导致\n表单验证函数未能正确处理而直接提交到服务器，这时服务器是较难准确确认输入框中的内容是占位符， 还是用户输入的内容的，它只知道这个满足非空条件。\n\n于是后来有了一种更有趣的实现，它不是直接修改 input.value，而是使用一个附加的元素，占位符消息\n放置在这个元素中，并通过恰当控制这个元素的显示/隐藏，来达到更真实和优秀的体验。\n\n这种实现甚至可以轻易的实现只有用户在输入框中输入内容之后，占位符提示消息才消失。\n\n这个实现要注意以下几点：\n\n * 字体大小等样式要尽量和 input 一致（颜色例外）。\n * 使用 label 作为占位符消息的容器标签，可以加上恰当的 for 属性，实现自动关联。\n * 占位符的位置，可以直接使用 CSS 的相对位置实现，也可以使用 JavaScript 计算获得。\n\n比如下面的实现：\n\n$('input[placeholder],textarea[placeholder]').each(function());\n\n另外对于已经支持 placeholder 的浏览器可以忽略上面的代码，而使用浏览器的默认实现。\n\nif(!(\"placeholder\" in document.createElement(\"input\")))\n\n\n延伸阅读#\n\n * diveintohtml5.org#placeholder\n\n * 让所有的浏览器都支持 HTML5 placeholder 属性，基于MooTools\n\n * 跨浏览器的HTML5 placeholder 实现\n\n * Inline Form Labels， Inline Form Labels（2）\n\n * JQuery HTML5 placeholder fix\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-12-06","routePath":"/blog/post/placeholder-in-action","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":1076}],"domain":"","frontmatter":{},"version":""},{"id":311,"title":"联动的设计","content":"#\n\n联动控件一般用于下拉列表，例如省市县的联动。\n\n很早的时候有些初级的实现只做到了固定级别（比如二级、三级）的联动，它们传入固定 的 N 个 <select> DOM 元素，形成固定的 N\n级联动关系。后来有了一些较好的实现， 这些实现做到了动态级别的联动（即无限级联动）。\n\n早期的无限级联动控件，一般实现是通过主动下拉列表在 onchange 触发时主动调用 被动列表的更新 <option> 的方法，或者甚至在 onchange\n处理函数中直接操作从动列表 的 <option>。\n\n主动调用从动列表的更新函数，则需要事先函数名称及传参的约定。 直接操作从动列表的 <option> 就更不靠谱了，灵活性也更差。\n\n另外，这两种实现只能做到一维的线性联动，即一个主动列表对应一个从动列表，要实现 一个主动列表联动多个（不确定数量的）从动列表，则比较麻烦/困难。\n\n另一种更好的实现，则是让从动列表来确定自己的主动列表，并监听主动列表的 change 事件。这种实现可以轻易做到动态级别、动态维度的联动，各个 <select>\n的数据源及 及处理函数都由自身确定。\n\n总结：\n\n> 这里 事件监听 ，比 主动调用 的设计思想更优秀。\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2010-11-23","routePath":"/blog/post/linkage","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":312,"title":"同步客户端时间(续)","content":"#\n\n08 年我就有了这样的 想法，却到今天才开始实践。\n\n公司电脑时间错了好多，但我的账户没有 Internet 同步的权限，遂手动校准。\n\n到 国家授时中心 校准时，发现其服务器时间的 跳跃是受客户端时间影响的，当客户端时间发生修改时，页面上显示的服务器时间也跟着 偏差。\n\n后来到台湾的 國家時間與頻率標準實驗室 发现没有这个问题。\n\n研究了两者的代码，发现跟第一观感不同的是，这两者我更赞赏大陆的做法了，虽然有明显的可见缺陷。 下面简单分析下两者的实现思想及各自的优缺点。\n\n台湾的是使用 setInterval 实现了一个定时器，这个定时器考虑到了调用函数的时间消耗， 但是 setInterval 或 setTimeout\n本身的不确定性，随着跳跃时间变长，页面显示的服务器 时间便有非常大的偏差，尤其在 IE 浏览器中（几十分钟内，Firefox偏差数秒，IE7偏差数分钟）。\n\n而大陆的实现则使用服务器的初始时间，但使用客户端的频率进行跳跃（并在 1 秒中检查 10 次，\n避免跳秒问题）。这样即使经过长时间的跳跃，同样能保持较高的准确度。但问题是，当客户端 时间发生修改时，所谓的服务器时间也会收到影响。\n\n于是我结合两者各自的优点，避开他们的缺点，实现了一个 校时器。 他使用客户端的跳秒，但是当客户端发生时间不正常的跳跃时，自动修正客户端和服务器端之间的 时间差。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-11-15","routePath":"/blog/post/sync-client-time","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":313,"title":"用 Dropbox 做私有 Git 服务器","content":"#\n\n这几记录一下如何做一个本地版本库，关键命令是：git clone --bare test test.git\n\n\n\n\n延伸阅读#\n\n 1. 用dropbox做私有git服务器\n\n 2. 方便而又强大：本地 Git 操作完全指南\n\n 3. Hosting a Git Repo on Dropbox\n\n 4. GitBox - Git repository hosting inside Dropbox folders @github\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-11-12","routePath":"/blog/post/git-on-dropbox","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":60}],"domain":"","frontmatter":{},"version":""},{"id":314,"title":"","content":"","routePath":"/blog/post/the-duplicate-element","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":315,"title":"","content":"","routePath":"/blog/post/form-in-action","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":316,"title":"Vim 爱好者联系资料收集","content":"#\n\n希望通过一些形式让 Vim 爱好者联系更紧密，于是收集 Vim 爱好者的联系资料，并通过 较好的形式展现出来。\n\n目前是通过 面板形式 展现， 并有计划通过 Google 地图展现全国 Vim 爱好者的分布情况。\n\n资料收集方式：\n\n 1. Fork Vimmer 项目(最好是 gh-pages 分支)，并加入自己的资料到 vimmer.json 中。\n\n 2. 填写 Google Spread Sheets ^GFW出没注意^。\n\n 3. 邮件发送到 hotoo.cn+vim[AT]gmail.com ，请将 [AT] 替换成 @，保留 +vim\n    \n    常用的网络ID * 必填，可以是中文或英文，例如我的：hotoo\n    \n    真实姓名 选填\n    \n    昵称 常用的网络昵称，例如我的：闲耘™。选填，默认与ID相同。\n    \n    电子邮箱 * 建议使用 Gmail 邮箱，请使用 [AT] 代替 @ 符合，例如：hotoo.cn[AT]gmail.com\n    \n    博客/个人主页 请输入完整的URL地址(以 http 或其他的协议开头)，例如：http://hotoo.github.com\n    \n    Twitter ID 在 twitter.com 上的 ID，可以不带 @ 起始。例如我的 @hotoo\n    \n    Flickr ID 在 flickr.com 上注册的 ID，例如：hotoo\n    \n    Delicious ID 在 delicious.com 注册的 ID，例如 hotoo\n    \n    Github ID 在 github.com 注册的 ID。\n    \n    豆瓣(Douban) ID 在 douban.com 注册的 ID\n    \n    其他网站上注册的 ID 如果你其他网站上注册的 ID，并希望分享出来，请填写在这里。 网站和ID以冒号分隔，多个站的 ID 请以分号分隔。 例如\n    about.me:hotoo; blueidea.com:hotoo\n    \n    Gravatar ID 在 gravatar.com 注册并上传头像，根据邮箱地址计算MD5的值就是 Gravatar ID。\n    例如：2fdef0a77e4bf207e3ec30660e7896e8\n    \n    目前所在地 可以输入简要的地址，例如：杭州(Hangzhou)； 也可以输入详细的联系地址，甚至卫星坐标，可以通过Google地图获得。\n    \n    其他 你希望留下的任何资料信息。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-10-11","routePath":"/blog/post/vimmer-contact","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":317,"title":"IE6 的 CSS:hover 伪类","content":"#\n\n众所周知，IE6 不支持 a:hover 以外的 CSS 伪类，解决办法一般有 3 种方案：\n\n\n使用 JavaScript 事件#\n\n直接使用 JavaScript 的 onmouseover/onmouseenter 和 onmouseout/onmouseleave\n事件进行针对性开发，这大概没什么好详细介绍的。\n\n\n使用 CSS 表达式#\n\n辅以 CSS 表达式中 JScript 同样也有 onmouseover/onmouseenter 和 onmouseout/onmouseleave\n事件，用以实现 :hover 效果。 注意：其中冒号之前的事件名称可以随意，关键是 expression() 里面的事件。\n\nul li ol li\n\n不过应该说使用 CSS class 是更好的实践。\n\ntable tr table tr.hover td\n\nonmouseout 事件处理函数中加了 try/catch 是为了避免 IE5.5 因为不支持 replace()\n而报脚本错误。当然为了避免这个错误，还是其他的实现方式：\n\ntable tr table tr.hover td\n\n\n使用 CSS behavior 行为#\n\n使用 Whatever:hover\n\ncsshover3.htc\n\n\n延伸阅读#\n\n 1. 强大的CSS表达式 -- expression\n\n 2. CSS Expression 的优化\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-09-15","routePath":"/blog/post/css-hover-for-ie6","lang":"zh-CN","toc":[{"text":"使用 JavaScript 事件","id":"使用-javascript-事件","depth":2,"charIndex":51},{"text":"使用 CSS 表达式","id":"使用-css-表达式","depth":2,"charIndex":165},{"text":"使用 CSS behavior 行为","id":"使用-css-behavior-行为","depth":2,"charIndex":503},{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":559}],"domain":"","frontmatter":{},"version":""},{"id":318,"title":"Diff 模式下，让光标直接跳转到被修改的文本处","content":"#\n\nVim 的 Diff 功能非常优秀。有一个我非常喜欢的特性是：完全相同的地方，\n会被折叠隐藏起来(上下文除外)。还可以很方便的在各个差异点之间做出修改合并和快速跳转。\n\n不过默认的 [c 和 ]c 两种跳转方式，目前只能跳转到差异点的行首。对于只修改了\n行内部分文本内容（一般底色是浅红色）时，我更希望直接跳转到有变化的文本（底色是 深红色的部分）上。\n\n感谢 tocer ，我初步实现了两个版本 gits:556810\n\n 1. v1: 仅支持跳转到 DiffChange 的第一个 DiffText\n 2. v2: 支持 DiffChange 行多个 DiffText\n\n\n参考#\n\n 1. :h synIDattr\n\n 2. :h diff_hlID\n\n 3. @twitter\n\n 4. vimdiff 的跳转\n\n 5. vimdiff: Jump to next difference inside line?\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-08-30","routePath":"/blog/post/jump-to-difftext","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":291}],"domain":"","frontmatter":{},"version":""},{"id":319,"title":"实现文本转语音","content":"#\n\n又是心血来潮，想把文本转为语音朗读，通过听书的方式来多重利用时间。分心听书有效 吗，未可知也。不过还是想折腾下，心血来潮嘛。\n\n刚开始以为一定需要下载个语音软件，用它将文本转成语音，通过调节字词之间的停顿， 来达到较好的视听效果。\n\n因为很久以前有折腾过使用 Word 实现语音朗读的事，朗读效果非常不好，所以不想下载 那些大型的朗读软件，总感觉他们读出来的声音会让人恶心死。\n\n群里请教了一下有没有推荐的，得到 eGuideDog，但是 似乎仍然不甚理想，后来又发现了 NeoSpeech，里面提供\n的试听效果非常好，尤其是日语朗读，跟真人朗读差不多。\n\n于是继续寻找相关资料，在 VeryCD 上得到这些：1 2 3\n\n后来看到一张语音属性的图片，才进控制面板明白了一些事情。\n\n看到有通过微软拼音输入法3.0的语音功能实现的介绍，不过我在微软拼音3.0和 2007 中 都没有找到对应菜单项。\n\n通过 Excel 2007中的文本到语音 知道 Excel 内置了语音朗读的功能，但是 Word 没有找到对应的。便找到了\noffice2007文本到语音命令的问题\n\n\n详细步骤#\n\n 1. 安装语音引擎，我下载的 这个，解压安装 会自动设置控制面板里的语音选择，可以进入“控制面板”->“语音”->“语音选择”， 系统默认是\n    \"Microsoft Sam\"，可以改为刚安装的语音，试听一下。\n 2. 打开 Excel (2007)，点击左上角（靠右侧的）三角下拉菜单（鼠标悬浮提示是 “自定义快速访问工具栏”->“其他命令”->“不在功能区的命令”，\n    添加“朗读单元格”和“朗读单元格 - 停止朗读单元格”， 在单元格中输入文本，点击“朗读单元格”就会听到发声。\n 3. 要想让 Word 朗读发声，可以使用自定义宏：\n    \n    1. 按 <Alt-F11> 启动 Visual Basic 编辑器。\n    \n    2. 创建名为 ReadRec 的宏：\n       \n       Sub ReadSelection() Excel.Application.speech.speak Selection End Sub\n    \n    3. 单击VBE编辑器窗口中的“工具”菜单，选择“引用”命令，在弹出的 “引用-Normal”对话框中选择“Microsoft Excel 12.0\n       Object Library”复选框。\n    \n    4. 确定，关闭Visual Basic编辑器返回Word窗口。\n    \n    5. 右击工具栏，选择“自定义”命令，切换到“命令”选项卡，在“类别”中 选择“宏”，将命令中的“Normal\n       NewMacros.ReadSelection”拖放到工具栏中。\n    \n    6. 现在在 Word 里选中文本，点击工具栏刚加入的按钮，就可以朗读选中文本了。\n\n\n参考 & 延伸阅读#\n\n 1. NeoSpeech\n\n 2. NeoSpeech 语音下载(VeryCD) 2 3\n\n 3. Excel 2007中的文本到语音\n\n 4. office2007文本到语音命令的问题 2\n\n 5. Word 从文本到语音工具栏\n\n 6. Word音标助手COM加载项(更新2009.6.30版)\n\n 7. Word 2003如何实现文本朗读\n\n 8. Google's Text to Speech API : A PHP Wrapper Class\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-09-12","routePath":"/blog/post/tts","lang":"zh-CN","toc":[{"text":"详细步骤","id":"详细步骤","depth":2,"charIndex":488},{"text":"参考 & 延伸阅读","id":"参考--延伸阅读","depth":2,"charIndex":1241}],"domain":"","frontmatter":{},"version":""},{"id":320,"title":"隐私权","content":"#\n\n团购的时候我在邮件和 Google Docs 向所有参与团购的团友公布了各自的详细信息 （包括联系信息）。\n\n我的公布的理由有两个：\n\n 1. 方便自己统一管理，和团友随时审阅；\n 2. 方便同城团友可以合并快递单。\n\n有团友很不高兴。于是我特地看了关于隐私权的一些资料。\n\n根据 维基百科全书：隐私权 和一些其他相关资料上的描述，我似乎并没有侵犯任何隐私权。 我没有把大家的手机号写在电线杆子上，并附上“办证”之类的字样；\n没有入侵并偷窥大家的电子邮件；也没有找到大家的收货地址后非法闯进去。。。 以上纯属玩笑话 :D\n\n隐私权目前来说还是有一些模棱两可的地方，虽然我主观上是支持保护隐私权的。 我也有隐私，但只要不是把我和家人的资料公布在网上，或者提供给某些混蛋，\n以至于我和家人会受到严重的骚扰和恐吓之外，还是没有什么的。\n\n朋友和一些相对比较可靠的人知道我的联系方式，是件好事吧。虽然我小时候曾经很傻的 想住到深山老林里去隐居。\n\n个人认为：有限区域范围内的个人或家庭联系方式，算不上是隐私。 你的邻居知道你家的门牌号码；公司、学校拥有你的详细资料；\n商家索取买家发货地址；快递员直接打你的手机； 参加团购的成员知道你的联系资料。。。\n\n> 好吧，虽然我可能没有犯罪，但是我错了。我只是想偷懒才使用群发邮件的方式的。\n\n另外居然有蛋疼的律师控告电信说“来电显示”损害了其隐私权。\n\n 1. 你没有号码怎么打电话给他人；你拿到他人的号码，是否就侵犯了其隐私？\n 2. 你打电话给他人，这他人没有知情权，无权知道是哪个混蛋在骚扰他？\n\n另外也有人控告移动、联通公司所谓的“恢复”收取来电显示的费用是单方面修改合同、 强制消费行为。想都不用想，最终败诉。\n\n现在好了，你可以关闭来电显示，每月省了 6 块还是几块钱。也就是说现在开通来电显示需要 每月多付几块钱，而这在以前是免费的。\n\n我有一个很不希望相信的“阴谋论”：这起官司是电信或移动公司幕后主使的案件。\n\n我对隐私权的概念还是有点不清晰，希望有人能写出清晰简洁的资讯出来，比如翻译关于隐私权\n的论文和辩论过程之类，而不要像法律条文一样直接给我们模糊不清的强制性规定和结论。\n\np.s. 希望有生之年不要看见“非法持有他人隐私”的罪名或者大帽出现。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-08-22","routePath":"/blog/post/about-privacy","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":321,"title":"SQL LIKE 查询的一个问题","content":"#\n\n在做用户管理的时候，用户表(users) 有一个字段(dept)用来存储用户所在部门的信息， 字段的值一般是这样的，各级部门间使用横杠分隔：\n\n\n\n我们的系统有一个根据用户所在部门进行过滤的功能，所以我们用了类似下面的查询语句：\n\n\n\n这样的性能还好，但是今天发现一个问题是，当有两个部门名称很相似，比如：\n\n\n\n这时在查询 XX宝CEO 的时候就会把 XX宝-CEO办公室 的用户也查询出来。\n\n于是想到正则表达式：\n\n\n\n合并正则表达式的另一解：\n\n\n\n杯具的性能问题。\n\n突然想到\n\n\n\n于是简单有效的解决了这个问题。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-08-13","routePath":"/blog/post/about-sql-like","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":322,"title":"【已结束】 ~~关于团购庆祝 Vim 7.3 正式发布的 Tee~~","content":"【已结束】 关于团购庆祝 Vim 7.3 正式发布的 Tee#\n\n我在 Twitter 上随意说了句相关的 意向， 便有不少回应表示也愿意加入，我本想最好由某个懂行或者牛人来发起活动，我参加就好了，\n不过目前看来，我只能自己扛起这个重担。\n\n\n关于 Tee#\n\n> 初步设想： 正面 ：印 Vim 的 Logo。 投票 背面 ：印 :wq! 或者 :help! 命令，下面还印上版本信息 :version。 投票 右手袖子\n> ：印 :version 信息。 颜色 ：商家唯一指定白色。 P.S. 还有网友提议将自己的 vimrc 打上去，创意不错，但这是一此集体活动。\n> 不过大家还是可以提议一些非常具有 Vim 特色的代码。\n\n![](http://www.flickr.com/photos/hotoo/4893442809/\nhttp://farm5.static.flickr.com/4141/4893442809_aedb31676a_b.jpg)\n\n商家答应可以有 3 种不同的图案，但是考虑到实际操作太麻烦，包括下订单，印刷和发货都非常容易出错，\n所以我们最好是尽量少的使用不同图案。如果有喜欢但是没有选择的图案，各位可以各取所需自行单独印刷。\n\n参考：\n\n * 滇狐很久之前提供的版本 （简易版 ^[1]^ 普通版 ^[2]^ 高级版 ^[3]^）\n * Vim T-shirts, Shirts and Custom Vim Clothing\n   * Tee 图片\n   * 2\n * 另外感谢 阿阳 还提供了一份他找视觉设计师修改过，上次印 Tee 的 AI 文件。\n\n\nTee 的质量#\n\n商家是阿阳推荐的，他之前有在这家定制过，说是材料“比较厚，质量还不赖的”。 而商家说：“我们这只有一种220克的，是属于好的，差的么就是180\n200克的。那二种我们没有在做的。”\n\n\n关于费用#\n\n跟淘宝一个定制 Tee 的 商家 联系，50件以上的话 双面印刷最低能到 28.00 26.00 25.00 元/件（单面 25.00），目前有 50 多人，\n如果有更大的数量级，估计还可以更便宜，到时候我再商量，40 件估计需要一周才可以出货； Tee\n可以直接发到每个人手中，考虑到运费，我提议同城的统一由一个人负责签收并发放， 这样顺便还可以线下认识几个朋友，同城运费最终 AA\n制；自己愿意单独付运费的不在此列。\n\n如果看中这店家的其他 Tee，参加团购的朋友也同样可以以团购的价格购买，直接在 店家商品上拍即可，记得给商家说明情况，另外还要报上我的旺旺ID（请来邮件索取）。\n\n周六我会公布所有同城信息，到时候希望同城统一签收的可以联系我。 除非专门指定，默认情况下，均发或到个人签收。 学校老师或学生会稍晚发货，以确保各位能在学校签收。\n\n目前不支持快递到国外，如果有国内的地址，请使用国内地址。 到台湾的快递费是 35.00 元，3 天之内可以到。\n\n目前还没有确定最终购买人数和打折尺度，而且费用收取方式上也还没有确定，大家可以自由选择\n预付定金，或者我先垫资金的方式，都没有关系的。下周末等情况确定后我会公布收款方式， 请大家静候佳音。\n\n费用收取方式主要采取支付宝收款，或者银行卡汇款。\n\n店家提供的快递运费对照表：\n\n运输方式   1公斤内    加重/公斤   运送到\n快递     8.00    5.00    安徽\n快递     5.00    2.00    上海，江苏，浙江\n快递     10.00   8.00    北京,天津,河北,山西,辽宁,吉林,黑龙江,福建,江西,山东,河南,湖北,湖南,广东,广西,海南,重庆,四川,贵州,云南\n                       ,陕西,甘肃,青海,宁夏\n快递     15.00   ?       大陆其他地区\n速运     35.00   ?       台湾\n\n默认使用圆通快递，台湾地区使用顺风速运，3天内可以到达。\n\n\n【已结束】 关于报名#\n\n为避免报名时间过短，或等待时间过长，初步计划报名截止到下周末，如果中途有事没有时间也没有关系， 只要确认购买，我可以预付费用的。\n\n一旦确定购买名单，我们就开始下订单订货。\n\n由于我第一次搞这样的活动，有经验的老师请一定多多指导。\n\n> 注意 ：如果确定要购买，请务必将你 [http://www.flickr.com/photos/hotoo/4890597770/ 需要的尺码]， 邮件地址\n> ，实际的 收货地址 ， 邮编 和 收件人姓名 。 最好还有即时联系方式，比如手机，快递可能需要。 请确认这些信息能直接联系到你，收件人能收到货。\n\n如果在截止时间之前没有给出详细联系地址导致无法发货的，一律认为不参加这次活动，请谅解。\n\n如果有些没所谓的小失误的话请多多包含，大失误我会尽力承担的。\n\n\n活动结束语#\n\n这次活动过程几经波折，把我、团友，和商家都折腾的够呛。主要是由于我经验不足造成， 事先的准备工作也不够，导致有数次变更，甚至有些不尽如人意。\n\n不管怎么样，报名活动总算是结束了，我这里不再接收任何报名，仍希望购买的朋友可以尝试 这个链接， 运气好的话仍然可以得到团购的待遇。\n\n最后：这样的人生经历一次就够了，谢谢大家。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-08-14","routePath":"/blog/post/vim73-tee","lang":"zh-CN","toc":[{"text":"关于 Tee","id":"关于-tee","depth":2,"charIndex":121},{"text":"Tee 的质量","id":"tee-的质量","depth":2,"charIndex":699},{"text":"关于费用","id":"关于费用","depth":2,"charIndex":802},{"text":"【已结束】 ~~关于报名~~","id":"已结束-关于报名","depth":2,"charIndex":-1},{"text":"活动结束语","id":"活动结束语","depth":2,"charIndex":2037}],"domain":"","frontmatter":{},"version":""},{"id":323,"title":"整合状态按钮和导向按钮","content":"#\n\nDemo\n\n\n延伸阅读#\n\n * 状态按钮和导向按钮\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-07-31","routePath":"/blog/post/integrate-guide-button-and-status-button","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":9}],"domain":"","frontmatter":{},"version":""},{"id":324,"title":"用 gvim 比较 git diff","content":"#\n\n\nfor Windows#\n\n参考 [http://gist.github.com/502217 gist:502217]\n\n 1. 在用户目录下的 .gitconfig 中加入：\n    \n    [diff] external = git_diff_wrapper.bat [pager] diff =\n\n 2. 创建 git_diff_wrapper.bat 文件放到 $PATH 目录下，内容为：\n    \n    path\\to\\gvim.exe -d \"%2\" \"%5\"\n    \n    gvim -d \"$2\" \"$5\"\n    \n    注意其中的 path\\to\\ 要改为 gvim.exe 所在目录。\n\n\nfor Linux#\n\n参考 Git Diff with Vimdiff\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-08-01","routePath":"/blog/post/gitdiff-with-vim","lang":"zh-CN","toc":[{"text":"for Windows","id":"for-windows","depth":2,"charIndex":3},{"text":"for Linux","id":"for-linux","depth":2,"charIndex":316}],"domain":"","frontmatter":{},"version":""},{"id":325,"title":"使用 calendar.vim","content":"#\n\n最初看到明城 推荐使用 Vim Calendar 插件， 于是很小白的尝试了一下，然后就没有了然后。\n\n最初尝试的过程已经基本忘记，恍惚记得在 Calendar 的日期上回车，窗户貌似在右侧窗口 打开的（后来发现我记错了，这是\nVimwiki-diary的支持）；至于明城推荐设置的 ca 快捷键，后来才知道是与 text-object 冲突的。\n\n再后来就用上了 Vimwiki，做个人 Wiki 之余，还用它的 diary 写日记。总体来说，Vimwiki 的 diary\n是比较强大的，我甚至还提了几个被接受的建议。\n\n但是随着使用的深入，发现通常 Wiki 项目下是不需要 diary 的，而 diary 也基本不需要\nWiki，把这两种整合在一起也许就是个错误。我们真正需要的是一个更强的 Calendar diary， 而不是 Wiki 附加的 diary 支持。\n\n如果真的希望 Vimwiki 有 diary 的支持，我也希望这个 diary 和 Wiki 是相互独立的， Wiki 项目中无需 diary，diary\n无需包含在每个 Wiki 项目里。\n\n另外基于 Wiki 的原因，所有的 diary-wiki 文件都放在同一个目录下，当 diary 日渐增多， 目录变得臃肿起来也不是什么好事。\n\n我需要的是一个更强的 Vim Calendar。基于这个想法，我便尝试着手增强 Calendar。 目前已经支持 :CalendarSearch 和更好的\ndiary 打开方式。更多的想法见 这里。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-07-23","routePath":"/blog/post/use-vim-calendar","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":326,"title":"","content":"","routePath":"/blog/post/open-files-in-vim-tabs","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":327,"title":"Vim 自动补全成对的括号和引号","content":"#\n\n炫日分享了一个 自动补全成对的括号 的脚本，【注】：原文代码中引号被转义成了中文引号，下面是修正后的脚本。\n\n\n\n经启发我增加了对括号和引号更为智能的补全支持， 不过中文全角的括号和引号目前无法通过映射来实现， 对于转义的符号对的支持不佳。\n\n支持 2000 行以内（可以根据系统性能自行配置）文档的全局括号对识别能力。 也就是 2000\n行以内的文档，支持跨行的括号对智能匹配能力；当文档行数超出预设值， 则使用行内括号对智能补全。\n\n * OpenPair:\n   1. 如果当前行的括号已经成对匹配，则自动补全右括号 (I)\n   2. 如果左括号比右括号多，则自动补全 I(() (I() ((I) (()I\n   3. 如果左括号比右括号少， I()) 原样输出，不自动补全 (I)) 同上 ()I) 同上 ())I\n      自动补全：左括号较少，且光标之后字符串进行一次递归上面的条件\n * ClosePair:\n   1. 如果光标之后是一个右括号，向右移动一列 (I) ((I) (I)) ()I)\n   2. 否则原样输出。\n\n代码见 gist: 449512\n\n\n更新 (2010/6/24)#\n\n\n最后更新 (2010/7/9)#\n\n\n相关脚本#\n\n * delimitMate.vim (src)\n\n * Making Parenthesis And Brackets Handling Easier\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-06-20","routePath":"/blog/post/vim-autocomplete-pairs","lang":"zh-CN","toc":[{"text":"更新 (2010/6/24)","id":"更新-2010624","depth":2,"charIndex":496},{"text":"最后更新 (2010/7/9)","id":"最后更新-201079","depth":2,"charIndex":514},{"text":"相关脚本","id":"相关脚本","depth":2,"charIndex":533}],"domain":"","frontmatter":{},"version":""},{"id":328,"title":"在 Google Maps 的街景视图里看实况足球","content":"#\n\n我承认我标题党了，这只是我的一个 idea 而已，并没有实际实现。\n\n前几天有新闻称日本要申办 2022 年的世界杯，承诺将以 3D 转播赛况， 还以全息技术将赛况投影到足球场上，任何一个足球场都可以模拟现场实况，\n并准备研发全息电视，把赛况以全息技术在家庭里播放。 而实际上，日本在某些音乐会已经使用全息技术的实际应用 （X-Japan的 Art of Life 的\n15:36 至 19:13 之间都是以全息技术 制作的演出，直接观看19:10，然后等几秒钟就会明白）。\n\n我的个神啊，这是一种怎样的未来。\n\n在看南非世界杯的几个球场街景视图时，我突然想到如果模拟实况足球游戏， 根据比赛实况，将比赛情形在类似的视图中展现出来，会爽到什么程度啊。\n\n伊丽莎白港\n\n内尔斯普雷特\n\np.s. 现在的 Google Maps 街景视图，比 Google Earth 的 3D 模型要爽要逼真， 不过街景视图无法以 3D 效果看鸟瞰图。\n\n\n延伸阅读：#\n\n * 日本申办2022世界杯 许诺提供3D比赛直播\n\n * 日本研发全息电视：用激光投射飘浮图像\n\n * Google Trike\n\n * 初音未来3D全息演唱会 | 宅映像\n\n * 初音未来全息演唱会 - 初音ミク\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-06-16","routePath":"/blog/post/3d-game-in-google-maps","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":422}],"domain":"","frontmatter":{},"version":""},{"id":329,"title":"让 Vim 支持 LOG 文件","content":"#\n\n日志(.LOG)文件的基本上无章可循，各成风格。所以一般都是在纯文本模式下查看。 以普通文本的方式显示日志，基本没有清晰度和阅读舒适感。\n\n不过一般来说，日志中是会有日期时间（格式非常多样），错误产生的地址，行号，\n列号，日志类型（错误(ERROR)，信息(INFO)，调试(DEBUG)，警告(WARN)等）\n\n据此，我为 .LOG 文件定义了一些语法着色的规则，将 log.vim 放至 $VIM\\vimfiles\\syntax(Windows) 目录，并在\n$VIM\\vim72\\filetype.vim 中加入：\n\n\n\n现在就可以在 Vim 中较清晰的查看 .LOG 日志了。\n\n\n\n你也可以针对自己的实际情况，来自定义语法。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-05-13","routePath":"/blog/post/log-syntax-4-vim","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":330,"title":"Vim 学习路线","content":"#\n\n因为是完全自学，身边没有这方面的导师，所以在真正入门之前，我是完全不理解 Vim 是个什么玩意的，其中最大的障碍，遇到的第一个问题就是：“我怎么输入文字？”\n\n鼠标乱点，双击，右键，胡乱击键，应该是偶尔击到 \"a\" 键上而进入插入模式，但是 当时觉得又无章可循。新手在找一款趁手的工具时，一般很少太有耐心的，尤其面对\n这么怪异不可理解、还未接受的东西。这是个什么鸟玩意，我说，就离开了。\n\n所以第一个要点是，理解“多模式”编辑方式。\n\n能熟练进出插入模式并输入内容后，中文用户遇到的另一个重要问题就是编码问题了， 除非你直接拣了他人的 vimrc。Vim\n的编码支持是非常好的，重要的是理解并设置好 Vim 的编码选项。\n\n这两个门槛跨过之后，对新手来说 Vim 就和其他编辑器（如Editplus，Notepate++等） 大致没什么差别了。\n\n我于此踏上了 Vim 之旅，进入疯狂的学习期。\n\n这个学习期是无章可循的，不过大致是先学习凌波微步，各种快速移动的技巧；找别人 的 vimrc 参考设置，命令，快捷键，自定义的键盘映射，看别人推荐的插件介绍并\n亲身体验，搜索 Vim Wiki，看台湾大牛林佑安的 PPT，论坛和群组里交流学习， 搜索收集各种有趣、有用的小玩意。乱七八糟一堆东西，沉迷其中，不可收拾。\n\n逐渐的我也可以给新手一些指导帮助了，由于射手座，O型血的缘故，崇尚自由开放，在 力所能及的领域还算热心人，我便成了我。\n\nVim 是一个大宝藏，里面有太多太多的宝贝，Vim doc 就是一本 Vim 的百科全书，对 Vim\n的注解精悍而又无所不包，你几乎可以找到任何需要的帮助，如果实在找不到， Vim Script 和 Wiki 上也有其他人非常多的智慧。\n\n不过对于普通用户，只需要掌握快速移动，文本对象，少量的寄存器，搜索、替换技巧， 和微量的宏技术，基本就差不离了，这些是最常用的技巧，可以大幅度提高编辑、阅读\n效率。\n\n偶尔有一些特殊需求可以搜索或找人帮忙，如果喜欢，也可以学习脚本技术来扩展自己的 Vim。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-04-11","routePath":"/blog/post/vim-tutor","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":331,"title":"有中国特色的社会主义笑话","content":"#\n\n笑料：\n\n * 广电总局禁止电视节目用“NBA”等外语和缩略词\n\n笑点：\n\n * 三个达不溜点后头没有点卡姆。 ref\n\n * 注：其实根据一项 最新指示， 我们的标题是违规的，正确的写法应该是 “最受推特微博客网站和脸谱社交网站网友欢迎的美国职业男子篮球联赛球队”。 最受\n   Twitter 和 Facebook 网友欢迎的 NBA 球队\n\n * 我是用窗牌操作系统第七版回复的\n\n * 我是用因特网探索者第八代浏览器回复的\n\n * 剧院浏览器第十代半用户飘过……\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-04-08","routePath":"/blog/post/china-joke","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":332,"title":"欢迎加入 Vim 的 Gtalk 群","content":"#\n\n> 声明： 由于能力&精力有限，我已不再是 vim-cn@appspot.com 群管理员。 平时工作很忙，我已经退出这个群，无心参与这个群的讨论。\n> 大家有什么想和我交流、分享的话题，欢迎来邮件交流。\n> \n> 这篇日志的所谓群规，不再适用于 vim-cn@appspot.com ，对其管理员&群成员没有任何约束力。\n> \n> 2011/10/22\n\n欢迎加入 Vim Talks™(vimcn@chatterous.com 已迁移到 vim-cn@appspot.com) 这个 Gtalk 群，\n任何人可以随意加入，没有任何限制。\n\n给对 Vim 感兴趣的朋友推荐一些 有用或有趣的资源。\n\n> 警告： 所有可用命令都已在 //help 中列出，入群后请不要自作聪明尝试未知的命令， 给群其他成员带来无谓的打扰，谢谢。\n\n\n加入方法：#\n\n在 Gtalk 里加 vim-cn@appspot.com 为好友，然后给大家打个招呼 :)\n\n\n使用帮助(针对Gtalk)：#\n\n下面的命令，机器人会单独针对你进行回复，包括你的命令和回复的消息，都不会被其他 群成员接受到（除非你的命令有错误，被当作消息发送）。\n\nhelp:: 查看所有可用的命令。\n\n最新的命令前缀以横线 - 开始（help 命令可以不带前缀），你也可以修改为适合 自己的设置。\n\n更多内容参考 [http://io43.com/io43.GtalkGroup/cmds/] 和\n[http://wiki.hotoo.me/Gtalk.html GTalk]。\n\n\n《群规》#\n\n>  0. 自由开放，自重互爱。\n>  1. 管理员不得将 vim-cn@appspot.com 设置为私有状态，保证入、退群都没有任何障碍。\n>  2. 管理员不得以任何理由审查聊天信息，禁言、踢人须得至少 2 位管理员同意。\n>  3. 允许偏见，不要求中立；但尽量不要有歧视，侮辱，诽谤或人身攻击行为。\n>  4. 允许闲聊，不禁止灌水，但抽水机除外，请至少言之有物。 【注意】有技术话题时请积极参与，并暂停闲聊（可以去私聊）。\n\n我之前也有试玩过将 vimcn@chattous.com 群设置为 Private，记得当时感觉非常不好， 作为新用户会遇到很多麻烦。另外 Private\n群也不出现在 chatterous.com 列表中， 新人很难找到，@join 的时候也会遇到问题。\n\n之前的因为不了了之，没有记录和反思，偶尔手贱便会有“复辟”的念头，甚至还写了 用来检验新用户的程序，完全违背了群组 创立之初所坚信的自由开放精神，和这个 投票。\n\n于是立此群规，约束管理员和群友的行为。以上为立群之根本，管理员不得私自修改， 必须经全部管理员同意，及群友投票数达到 50 票，并有 60%\n以上的投票同意方可修订。\n\n群规细则视需要再补充。\n\n延伸阅读\n\n“公民论坛”对话守则： 1989年的冬天，哈维尔等捷克知识分子在布拉格成立了“公民论坛”，制定了8条《对话守则》，\n在街头巷尾、居住区、大学校园到处张贴，希望广为人知，以便监督。（1993年 瓦茨拉夫·哈韦尔\n当选捷克第一任总统。瓦茨拉夫·哈韦尔出生于1936年，作为一名持不同政见者，长期从事反对前政府的活动，\n曾3次入狱。他是“七七宪章”和“公民论坛”的创始人。）内容是：\n\n 1. 对话的目的是寻求真理，不是为了斗争。\n 2. 不做人身攻击。\n 3. 保持主题。\n 4. 辩论时要用证据。\n 5. 不要坚持错误不改。\n 6. 要分清对话与只准自己讲话的区别。\n 7. 对话要有记录。\n 8. 尽量理解对方。\n\n(注：我没有找到原始出处，但我很认同。)\n\n《提问的智慧》 简体中文 2 繁体中文 En\n\n独门绝技： 直接提问，最好一次描述清楚问题。不要预热说：“谁熟悉 XX？”\n\n不要伤害新手。\n\n== 技巧 == 群 LOGO 将下面（或者任何你喜欢）的图片保存到本地，到 Gmail 的联系人(Contacts)、或者你的客户端里修改群机器人的头像即可。\n\n白色背景   透明背景\n       \n\n修改昵称 建议加入群组之后立即修改昵称，和 FID，一来可以标识和展现你的身份，二来可以避免长用户名好 FID 影响群聊效果。\n\n\n缺陷 & 不足#\n\n不能像 QQ 一样方便的发送图片并直接预览。GTalk 已经支持发送文件， 而且在新版的 Pidgin 中发送图片也支持直接预览，这跟平台相关。\n如果确实需要分享图片/截图，可以使用第三方的图片服务 （如 Flickr， Dropbox 的Public目录， Yupoo\n等），将图片所在的链接发送到群里即可。\n\n没有群空间，用来存储/分享文件。当然你同样可以使用第三方存储服务（Dropbox， Windows Live Sync ^SkyDrive^， Google\nDocs ^支持上传任意类型的文件^， RapidShare 等）来实现。\n\n\nGtalk 群的使用：#\n\n鉴于 Gtalk 的特殊性，大段代码最好不要作为聊天内容直接发送，推荐的方法是， 将代码贴到专业的第三方网站（如 Snipt, PasteBay,\nCopyTaste, Ubuntu Paste, Pastebin）， 然后将网址贴到聊天消息里。这有个好处是，\n避免大段内容影响阅读，专业的第三方服务能保持代码原文不被转义，支持代码着色， 甚至可以直接运行并得到结果，如果是第三方服务的会员，也可以方便管理自己的代码。\n\n有些 *nix 高手偶尔会频繁的尝试一些高级命令，例如 \"@online\", \"@ls\" 之类。\n我个人希望群聊是本着分享和讨论交流的宗旨进行，当然闲聊也可以，话唠也行， 但是垃圾信息不要太多以至影响大家正常的交流。\n\n\n为什么不是 QQ 群？#\n\n米兰达警告(Miranda Warning)：\n\n> “你有权使用 QQ，但是你在 QQ 上所说的一切将被作为呈堂证供。Do you understand?”\n\nGTalk 没有人数限制，不需要冲Q币来增加某些服务，而受到更多不可理喻的限制；可以轻易的加入或退出群，\n或随时暂停接收他人的讨论；具有完整的开放性，有非常多的官方或第三方客户端可以用，包括Windows,Linux,Mac平台； 更尊重 言论自由，\n没有无理取闹的审查制度， 不会因为胡萝卜、李子和温习功课而被敏感词。\n\n== Vim Talks™大事記 == 2010/4/9:: Vim Talks™Gtalk 群创立于深夜。之前我加入“Vim 草堂”QQ\n群，是比较活跃的成员， 因为不喜欢腾讯的所作所为，创立此群。不久后，重度删除腾讯的各种软件。\n\n2010/6/12:: 关于“群隐私”及 Vim Talks™要处于 Public 还是 Private 状态的讨论。 (link)\n\n2010/9/15:: 百合仙子(依云,lilydjwg) 成为管理员。不久 [http://davidx.me/ davidx] 也成为管理员。\n\n2010/11/3:: “我刚做了一个艰难的决定，如果群里明天还有聊QQ和360的，禁止发言24小时。” (#5132176862502009)\n\n2010/11/4:: 临时邀请“Vim 草堂”堂主 张九天 成为 Vim Talks™的管理员。#5145129995941272\n\n2010/11/10:: 创立群规。邀请 shrek 和 春棍 为管理员。\n\n2010/11/24:: 群出现严重的丢消息情况，迁移到 GAE，由开源项目搭建的群组服务\nvim-cn@appspot.com，机器人由百合仙子搭建&维护，任何人都可以参与提交代码。\n\n2011/1/1:: 删除 vimcn@chatterous.com 群，全面迁移到 vim-cn@appspot.com，对于未主动迁移的群友，请自行迁移。\n\n2011/10/22:: 自行删除管理员身份，退出群。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-04-09","routePath":"/blog/post/gtalk-group-for-vim","lang":"zh-CN","toc":[{"text":"加入方法：","id":"加入方法","depth":2,"charIndex":369},{"text":"使用帮助(针对Gtalk)：","id":"使用帮助针对gtalk","depth":2,"charIndex":426},{"text":"《群规》","id":"群规","depth":2,"charIndex":671},{"text":"缺陷 & 不足","id":"缺陷--不足","depth":2,"charIndex":1784},{"text":"Gtalk 群的使用：","id":"gtalk-群的使用","depth":2,"charIndex":2070},{"text":"为什么不是 QQ 群？","id":"为什么不是-qq-群","depth":2,"charIndex":2406}],"domain":"","frontmatter":{},"version":""},{"id":333,"title":"表单设计","content":"#\n\n * \n\n表单元素有新增、修改、删除的状态（新增和修改可以参考 svn 的图标，删除则直接从页面上删除 DOM）\n\n\nRef:#\n\n * 如何精简用户界面\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2010-04-08","routePath":"/blog/post/form-design","lang":"zh-CN","toc":[{"text":"Ref:","id":"ref","depth":2,"charIndex":61}],"domain":"","frontmatter":{},"version":""},{"id":334,"title":"轉換編碼筆記","content":"#\n\n今天發現一個顯示為亂碼的 html 頁面，發現是當前頁面和 reference 頁面編碼 不一致造成的，reference 編碼為 gbk，當前頁面編碼是\nutf8。\n\n雖然各自 head 里的 charset 和其文件存儲的編碼一致，但某些瀏覽器（如Firefox） 從 reference 轉過來時，默認當前頁面的\ncharset 和 reference 的一致，導致亂碼 顯示。\n\n由于 reference 所使用的編碼是整站的基準編碼，所以把當前頁面的 fileencoding 轉成和 reference\n一致即可，不過轉碼時遇到一個問題是，文件中存在特殊字符，無法 由 utf8 正常轉碼為 gbk。\n\n文檔中無法用肉眼看出那些特殊字符，于是備份后使用 notepad 或 editplus 強行轉碼\n（注：會丟失那些特殊的字符），然后將轉碼后的文檔和原始備份檔比較，來查找特殊 字符，編輯（刪除無意義的，轉義有用的）保存即可。\n\n注：Vim :set fenc=gbk，可以轉碼，但 :wq! 無法正常保存；UltraEdit 本身的編碼 支持不夠好，不建議用來轉碼。\n\n注2：Vim diff 可以比較出不同，找出特殊字符，但可能無法正常編輯（如刪除）它們， 特殊字符是非常怪異的；BeyondCompare 和 WinMarge\n基本可以勝任。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-04-07","routePath":"/blog/post/convert-encoding-note","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":335,"title":"周数(Week Number, WeekNum)计算","content":"#\n\njQuery UI v1.8rc 版的日历控件已经非常完善，比之 v1.7.1 已经支持显示周数(WeekNum)， 而且计算 WeekNum\n的算法可以自定义；而 My97DatePicker 的算法又有Bug。对于两年交接的周，有两种常见的算法：\n\n每年 1月 1日所在的周均为该年的第 1周（如MS Excel的WeekNum()函数和 jQuery 实现）；\n\n\n\n每年最后 1天所在的周\n\n\n\n而从自然语言中来说，这交接的一周即可以是头一年的最后一周，也可以是后一年的第 1周。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-03-16","routePath":"/blog/post/weeknumber","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":336,"title":"","content":"","routePath":"/blog/post/use-vimwiki-for-blog","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":337,"title":"Vim 中文帮助文档","content":"#\n\n前两天不知道为什么，帮助文档又跑会英文了（隐约是用 Vimball 安装了 Vimwiki 或者 重复安装了 TwitVim 的缘故）。\n\n\n\n无效。\n\n\n\n亦无效。\n\n很早以前不知道从哪里抄来的这个：\n\n\n\n从一开始就是报错的，一直被注释，从未被启用。\n\n在注册表中找到两个相关的项：\n\n\n\n将默认值修改为：\n\n\n\n或：\n\n\n\n重启系统，均无效。\n\n另一个注册表项的路径是正确的，无需改变：\n\n\n\n万般无奈，只好重装了中文文档。\n\n中文文档可以从 vimCdoc.sf.net 下载，也可以从 vimdoc.sf.net 找到链接，下载回来的是一个 .exe\n可执行安装文件，研究了下安装过程：\n\n 1. 前面都是在抽取中文文档文件(.cnx)，并放至合适的位置：(如 D:\\Vim\\vim72..\\vimfiles\\doc)\n 2. 抽取 tags-cn 并输出到文档同一目录 D:\\Vim\\vim72..\\vimfiles\\doc\n 3. 抽取 help_cn.vim 输出到 D:\\Vim\\vim72..\\vimfiles\\syntax\n 4. 抽取 vimcdoc.vim 输出到 D:\\Vim\\vim72..\\vimfiles\\plugin\n 5. 抽取 README,INSTALL,LICENSE,AUTHORS,guides.txt 到 C:\\Program Files\\vimcdoc\n\n其中设置 Vim 帮助的默认语言的步骤，即是在 vimcdoc.vim 中，因为 plugin 比 vimrc 加载要晚(参考)， 所以在 vimrc\n中的设置会被 vimcdoc.vim 覆盖掉。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-03-15","routePath":"/blog/post/vim-chinese-doc","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":338,"title":"CSS 实现有限不确定背景","content":"#\n\n2 个嵌套的 html 元素，分别用个两个背景图交替叠加， 形成固定高度，有限、不确定宽度的元件，\n或固定宽度，有限、不确定高度的元件（比如实现简单的圆角效果）， 要求将有限延伸的背景图放置在内层元素上（如图中 b 区）， 避免 b\n区的背景图多出的备延伸部分（b' 区）影响到固定的背景图（a 区）的透明部分会被影响。 可以使用外层的 padding-left 或内层的\nmargin-left 来处理。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-02-20","routePath":"/blog/post/css-limit-bg","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":339,"title":"禁用CNNIC的所谓安全证书","content":"#\n\n我个人是不信任 CNNIC 的，这里只是记录一下自己的学习过程，对 CNNIC 仍抱有幻想的同学可以无视。\n\n我都是在他人的教学指导下学习实践的，有兴趣的可以参考下面的链接：\n\n * CNNIC CA：最最最严重安全警告！\n\n * CNNIC，我不信任你！——从“受信任的根证书”里赶走CNNIC\n\n * 如何阻止不信任的 CNNIC 证书\n\n * Mac 下禁用 CNNIC CA 证书\n\n * linux下的chromium删除CNNIC的CA\n\n * 投票\n\n * 结果\n\n\n延伸阅读#\n\n * CNNIC,流氓!\n\n * 360的可怕\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-02-02","routePath":"/blog/post/forbid-cnnic","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":243}],"domain":"","frontmatter":{},"version":""},{"id":340,"title":"“正则表达式”分享资料","content":"#\n\n这周三做了一次内部“正则表达式”分享活动，本来是针对小组成员的分享， 结果部门很多高手也来捧场，非常荣幸。\n\n有兴趣的朋友可以下载 RegExp.zip 这个资料。 我使用 XMind 做的一个分享大纲，从简介，基础、高级语法，一些经典的案例和有趣的用法。\n另外还附有一些有用或有趣的资料。\n\n这是我生平第一次较正式的分享（上次是项目启动，没有什么实质的分享内容），\n由于没有什么经验，所以准备的相对比较充分，不过分享过程中的演说和演示的比提纲中的更丰满， 同事参与的探讨也非常热情。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-01-31","routePath":"/blog/post/regex-share","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":341,"title":"","content":"","routePath":"/blog/post/editplus-and-everything","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":342,"title":"arguments to Array 之效率","content":"#\n\n怿飞昨天发有一篇《如何将函数的实际参数转换成数组》 的日志，其实核心不是讲“如何如何”，而是比较了几种算法/语法的效率。 说到算法本身的性能，我和 army\n的看法 一样，对这篇日志的观点提出质疑。\n\n从语法原理上，Array.prototype.slice.call(arguments)是对数组的slice方法的原型直接引用，而[].slice.call(a\nrguments)则需要创建数组对象。没有理由后者比前者的性能还要高的。\n\n不过我还是写了 测试 来证实自己的观点，为了尽量少的避免其他干扰（包括函数调用带来的消耗）， 算法/语法都直接内联写在计时器一起。\n\n这几个例子分别比较了：\n\n * Array.apply(this,arguments)\n * Array.prototype.slice.call(arguments)\n * [].slice.call(arguments)\n * Prototype 的 $A(arguments)\n * jQuery 的 makeArray(arguments)\n * 和最土的循环算法。\n\n并在各个浏览器（Multi IE 6, IETester 5.5, IETester 6, IE 7, FF 3.5, Chrome 4, Safari 4,\nOpera 10）下一一测试。也欢迎各位参与测试并将结果提交给我， 如果你觉得测试有不公平合理的地方也可以提出。\n\n至于结论，也不是那么好确定，不过大致如下： Array.apply(this,arguments) 在大部分情况下都能取得优胜；\n而Prototype和jQuery其次，不过这两者不仅仅是针对arguments编写而且是直接调用其函数\n（稍有消耗），这里只拿来比较一下，这两个还是非常出色的； Array.prototype.slice.call(arguments) 和\n[].slice.call(arguments)则旗鼓相当， 并没有说谁比谁一定更强，更浏览器实现有关，在部分浏览器中前者有稳定的微量优势；\n至于老土的循环法，arguments.length 较小时表现不俗，较大时也更浏览器有关系。 而怿飞说的那点（不确定的）非关键或巨大性能优势，其实意义不大。\n\n\n延伸阅读：#\n\n * 正则表达式拼接和构建零长度对象\n\n * Javascript String 方法效率大比拼\n\n * Javascript 相等符(==)与完全相等符(===)之效率\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-01-07","routePath":"/blog/post/performance-of-arguments-to-array","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":955}],"domain":"","frontmatter":{},"version":""},{"id":343,"title":"正则表达式重复子模式前、后倾的性能比较","content":"#\n\n在准备内部的正则表达式 (Regular Expression)分享的过程中， 注意到一个细节问题：重复的子模式，是应该前倾还是后倾，这两者在性能上有什么差异？\n\n前倾和后倾是我胡诌的两个词，我的定义如下：\n\n> 前倾 就是前面的子表达式使用贪婪匹配或较大的量词，尽可能多的匹配内容，\n> 导致前面匹配的内容较多而使“天平”前倾。例如：/(?:\\d{1,3}\\.){3}\\d{1,3}/。 后倾\n> 则相反，后面的子表达式使用贪婪匹配或较大的量词。如：/\\d{1,3}(?:\\.\\d{1,3}){3}/。\n\n \n\n前倾和后倾在实际应用中很常见，如时间，主机名等，中间以某特殊字符（串?）分隔， 被分隔部分的规则又相同的情况下，一般都是使用这两种实现方式之一。\n\n上面定义中的两个例子只是简例，可以用来大致匹配 IPv4 地址，完整的 IPv4 地址正则式如下， 它要求每段都在 0-255 之间： 前倾：\n\n\n\n后倾：\n\n\n\n我写了一个测试比较这两个正则性能 的页面，在 IE7, FF3.6, Safari 4, Opera 10 下测试均为前倾的性能较高，Chrome 4\n下则不相伯仲。\n\np.s. 这种重复子模式，要有语法上的简写就好了，像 Perl 正则的递归引用（或类似运行时反向引用）， 维护起来就方便多了。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-01-26","routePath":"/blog/post/performance-for-regex-repeat-sub-pattern","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":344,"title":"电梯楼层选项板的位置","content":"#\n\n每天电梯使用的高峰期，相信许多人都体验，甚至主演过，许多人进门就堵在门口找自己要去的楼层。\n由于中国人勤劳自主的缘故，选楼层一般都倾向于自己来做，不过这不如尽快的让大家进电梯， 然后请站在选项板旁边的人帮按一下，再谢谢对方。\n\n作为选项板本身，也应该引导用户这样来乘电梯，所以将自己挪到电梯最内侧，也可以在两侧，但最忌在电梯门旁边。\n\n\n\n@flickr\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-01-06","routePath":"/blog/post/place-of-lift-floor-control-panel","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":345,"title":"","content":"","routePath":"/blog/post/safari-4-select-bug","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":346,"title":"反向搜索的设计","content":"#\n\n文本搜索是一项非常常用的功能，在文本编辑器中更是一个不可或缺的功能。\n\n而反向搜索（搜索光标之前的文本）的设计，最初也非常原始：\n\n\n\nWindows Notepad\n\nEditplus 2.3\n\nUltraEdit 11\n\nEclipse 3.4\n\n这基本算是可用了，不过还是有一些非常用心的改进的：\n\nEditplus 3\n\nWindows Internet Explorer 7\n\nGoogle Chrome 4\n\nApple Safari 4\n\nMozilla Firefox\n\n这些细小的改进都有一个共性，就是可以快捷的反向搜索，快速定位到上次匹配到的地方。 作为 Vim\n爱好者，她的反向搜索功能（包括搜索功能）更是华丽的惊人，normal 模式下 正向搜索(/keyword)， n 键下一个匹配， N\n键前一个匹配；如果是反向搜索(?keyword)， 则相反。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-12-31","routePath":"/blog/post/reverse-search","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":347,"title":"","content":"","routePath":"/blog/post/cpp-check-type","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":348,"title":"","content":"","routePath":"/blog/post/impoved-fold-for-vim","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":349,"title":"让 Vim 支持 CSS3","content":"#\n\n和 HTML5 一样，CSS3 也是目前热门的技术，为了在 Vim 中更舒适的编辑 CSS ，我整理补充了 CSS3 的语法高亮和自动补全部分。\n\n\n语法高亮#\n\n下载这个 css.vim ，放至 $VIM/vimfiles/syntax/ (Windows) 或 ~/.vim/syntax/ (*nix) 目录下即可。\n\n更新 ：\n\n将 css.vim 下载放置 $VIM/vim72/syntax/ 下，覆盖源文件，这个版本补充和修正了CSS3的伪类支持。\n\n\n自动补全#\n\n下载这个 csscomplete.vim 放至 $VIM/vim72/autoload/ 目录下，覆盖原文件即可。\n\n其中 vim72 中的 72 是 Vim 版本号。\n\n如果安装有 snipMate，可以参考这个 css.snippets\n\n\n语法验证#\n\n可以参考这篇 在 Vim 中验证 X/HTML, Javascript 和 CSS\n\n\n参考：#\n\n * CSS 3.0 参考手册 (中文版)\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2009-11-06","routePath":"/blog/post/vim-css3","lang":"zh-CN","toc":[{"text":"语法高亮","id":"语法高亮","depth":2,"charIndex":77},{"text":"自动补全","id":"自动补全","depth":2,"charIndex":236},{"text":"语法验证","id":"语法验证","depth":2,"charIndex":366},{"text":"参考：","id":"参考","depth":2,"charIndex":417}],"domain":"","frontmatter":{},"version":""},{"id":350,"title":"让Vim支持html5","content":"#\n\nhtml5 呼之已出，众多的现代浏览器也已支持其大半新特性。\n\n\nHTML5 语法高亮#\n\n网上已有让 Vim 支持新的标签和属性的语法文件，安装好语法文件即可正确的高亮显示 HTML5 标记和属性。\n\n详细方法参考 VIM syntax highlight para HTML 5， 下载其 html.vim 语法文件， 放至\n$VIM/vimfiles/syntax/ 目录下即可。\n\n注：因为 html5 本身在不断更新，所以上面的脚本并不完整，我将持续关注并更新这个 html.vim 脚本。\n\n\nhtml5 自动补全#\n\n不过貌似目前还未有让 Vim 完整支持 html5 自动完成（又称自动补全）之脚本。\n\n我初步研究并修改了 $VIM/vim72/autoload/htmlcomplete.vim ，使其支持 html5\n的自动完成。目前这个脚本逻辑基本可用，不过针对 html5 自动完成的数据 （ $VIM/vim72/autoload/xml/html5.vim\n）还在收集调整中， 我也趁此机会深入学习一些 html5 知识。\n\n\n安装详情#\n\n将 htmlcomplete.vim 下载放至 $VIM/vim72/autoload/ 目录下，覆盖原文件即可， 再将 html5.vim 下载放至\n$VIM/vim72/autoload/xml/ 目录下即可。\n\n注：这个 html5.vim近期会做一些更新补充，以支持更完整正确的 html5 语法。\n\n\nhtml5 合法性验证#\n\n参考我的前一篇 在 Vim 中验证 X/HTML, Javascript 和 CSS。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-11-01","routePath":"/blog/post/vim-html5","lang":"zh-CN","toc":[{"text":"HTML5 语法高亮","id":"html5-语法高亮","depth":2,"charIndex":35},{"text":"html5 自动补全","id":"html5-自动补全","depth":2,"charIndex":255},{"text":"安装详情","id":"安装详情","depth":2,"charIndex":480},{"text":"html5 合法性验证","id":"html5-合法性验证","depth":2,"charIndex":643}],"domain":"","frontmatter":{},"version":""},{"id":351,"title":"让 Vim 支持 cue","content":"#\n\n\n自动识别文件类型#\n\n在 $VIM/vim72/filetype.vim 中加入以下代码：\n\n\n\n\n语法高亮#\n\n下载 cue.vim 放至 $VIM/vimfiles/syntax/ 目录下。\n\n\n自动补全#\n\n如果已安装 snipMate。 下载 cue.snippets 放至 $VIM/vimfiles/snippets/ 目录下即可。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-11-06","routePath":"/blog/post/vim-cue","lang":"zh-CN","toc":[{"text":"自动识别文件类型","id":"自动识别文件类型","depth":2,"charIndex":3},{"text":"语法高亮","id":"语法高亮","depth":2,"charIndex":53},{"text":"自动补全","id":"自动补全","depth":2,"charIndex":103}],"domain":"","frontmatter":{},"version":""},{"id":352,"title":"","content":"","routePath":"/blog/post/fuck-gfw-with-tor","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":353,"title":"","content":"","routePath":"/blog/post/validator-for-vim","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":354,"title":"Firefox Profile 及多实例运行","content":"#\n\n * \n\n之前就知道Firefox 支持多账户，并允许各账户安装不同的插件，会话信息也完全独立。\n\n方法是制作快捷方式，目标指向Firefox的安装路径，并加上 -P 参数：\n\n\n\n加引号是为了防止空格问题。这样会启动选择账户的对话框，如果想直接指定账户启动， 而不出现对话框，可以在 -P 参数后直接带账户的名称，如默认的 default：\n\n\n\n如果想同时启动多个Firefox独立的账户实例，可以加上 -no-remote 参数。\n\n\n\n受 Editplus 的影响，其<C-b> 快捷键可以使用内置的IE核心浏览器预览和 html 源码间快速切换（也可以使用外部浏览器）。\n\n最近在定义 vimrc 时映射了 Cpp 的快速编译和运行快捷键，顺手一并映射了批处理和 X/HTML 文件类型的运行/预览快捷键，如下：\n\n\n\n由于 default 和 debug 账户都加上了 -no-remote 参数，Firefox 被设置为默认浏览器， 并使用外部程序打开链接是，会弹出如下警告：\n\n> “Firefox 已经在运行，但是没有响应。如要打开新窗口，您必须先关闭该 Firefox 进程，或者重新启动您的系统。”\n\n确定后会被直接退出，打开链接失败。\n\n解决办法是的主账户启动时不带 -no-remote 参数，其他账户带此参数启动，此时从 外部程序打开的链接，会在此不带 -no-remote\n参数的主账户中启动，另外还可以 带上 -new-window 或 -new-tag 参数。\n\n另外还有一个问题是，每次按 <F5> 都会从新的页签或窗口中打开，而不是刷新已有的同路径页。\n\n\n参考#\n\n * 同时运行两个 Firefox实例\n * Geek to Live: Manage multiple Firefox profiles\n * Command line arguments\n * Profiles\n * firefox 啟動參數\n\n另：\n\n * “Firefox 已经在运行，但是没有响应。”\n\n * Firefox 已经在运行，但是没有响应 2\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-10-22","routePath":"/blog/post/firefox-profile-and-multi-instance","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":700}],"domain":"","frontmatter":{},"version":""},{"id":355,"title":"Vim映射Home键到首个非空字符","content":"#\n\n许多编辑器有相关选项，可以直接设置让 <Home> 键在首个非空字符和行首之间跳转。\n\nVim 也有快捷键，normal 模式下：\n\n * 0 跳转到行首；\n * ^ 跳转到首个非空字符；\n * $ 跳转到行尾。\n\n目前未知跳转到最后一个非空字符的快捷键，有个网友提供了一个很好玩的技巧：\n\n\n\n为了将 <Home>和 End> 键映射到其他编辑器常用的设置，我写了个可以用的代码，请高手不吝赐教。\n\n\n\n\n参考#\n\n这里还有几个实现很优雅，但稍有问题的脚本：\n\n * SmartHome and SmartEnd over wrapped lines\n\n * Crazy Home Key blog\n\n * c9s: smart_home_end.vim\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-10-22","routePath":"/blog/post/map-home-key-for-vim","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":206}],"domain":"","frontmatter":{},"version":""},{"id":356,"title":"asx snippets for vim","content":"#\n\n前段时间写了个 asx (Windows Media Player 的播放列表格式) 的 snipMate 的模板语法文件。\n\n本身很简单，分享在此。\n\n安装snipMate之后，将上面的 asx.snippets 文件丢进 $VIM/vimfiles/snippets/ 文件夹即可。\n\n\n什么是asx?#\n\n * asx – 百度百科\n\n * ASX 文件格式全功略\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-10-20","routePath":"/blog/post/asx-snippets-for-vim","lang":"zh-CN","toc":[{"text":"什么是asx?","id":"什么是asx","depth":2,"charIndex":148}],"domain":"","frontmatter":{},"version":""},{"id":357,"title":"配置 Vim 作为 C++ 开发环境初步","content":"#\n\n一般来说，如果你使用 Vim 开发完整的项目，使用 Makefile 并直接 :make 就可以了。\n\n将下面的代码写入到 vimrc 中， Vim 会捕获编译过程中出现的消息并显示在 Quickfix 窗口。\n\n\n\n但是如果你是 C/C++ 新手，目前较多书写单个的 C/C++ 代码文件，或者只是想快速测试 某段代码的话，使用 gcc/g++\n直接编译或许是更简单的方式。你可以直接在 Vim 中执行 外部 gcc/g++ 命令，也可以想这样映射快捷键：\n\n\n\n不过这样使用外部命令， Vim 并不能捕获编译过程的输出消息，就无法在 Vim 中根据 错误消息有效的定位到错误行了。\n\n有更好的方法：\n\n\n\n再补充映射一些 Quickfix 模式中快速跳转的快捷键：\n\n\n\n完整的设置可以参考 我的 vimrc\n\n更多讨论 看这里。\n\n\n参考#\n\n * vim 使用进阶: 剑不离手 – quickfix 2\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-10-19","routePath":"/blog/post/vim-for-cpp-dev","lang":"zh-CN","toc":[{"text":"参考","id":"参考","depth":2,"charIndex":372}],"domain":"","frontmatter":{},"version":""},{"id":358,"title":"Vim 字体设置","content":"#\n\n明城有 “苹果的 Courier 字体不错” 和“Windows 下 gVim 的雅黑字体配置” 两篇介绍 Vim\n下设置推荐字体的文章，里面提供的设置代码及提高的下载资源都很赞。\n\n家里的 Windows 7 用了 Courier New 字体后，体验很好。\n\n但是搬到公司的 Windows XP 上却比原来 Windows 自身的 Courier New 没多大提高。\n\n今天看了蟠盛写的“几种不错的编程字体”， 顺便看了下 使用 ClearType 增强屏幕字体，按步骤 果然好了很多。\n\n这里记录完整的设置：\n\n 1. 下载 Apple Courier字体 2 3 ，并安装。安装方法：\n    * for Windows 7: 右键字体文件，安装即可。\n    * for Windows XP:\n      1. 资源管理器中打开系统盘下的 fonts 目录（如C:\\WINDOWS\\Fonts，或运行 fonts）\n      2. 文件 -> 安装新字体；\n      3. 驱动器和文件夹定位到字体所在位置，字体列表将自动列出找到的字体；\n      4. 选中要安装的字体，点击确定即可。\n      5. 或直接将字体文件拷贝到Fonts文件夹亦可，系统将自动启动安装过程。\n 2. ClearType\n    1. 控制面板 -> 显示（或右键桌面 -> 属性） -> 外观 -> 效果；\n    2. 选中“☑ 使用下列方式使屏幕字体的边缘平滑”；\n    3. 并切换下面的下拉框，选中“清晰(ClearType)”；\n    4. 确定即可。\n 3. Vim设置\n    1. 在 _vimrc 中加入如下代码：\n    \n    \n    \n    1. 中文的宋体已经非常好了，不过仍然可以单独设置中文字体：\n    \n    \n    \n    1. 此时，新启动vim即可使用新设置的字体了。\n\n\n\nref\n\n\n白露非提供的字体#\n\n下载\n\n设置：\n\nguifont=Microsoft_YaHei_Mono:h11:cANSI\n\n\nSee Also#\n\n * @twitter\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-09-14","routePath":"/blog/post/vim-fonts","lang":"zh-CN","toc":[{"text":"白露非提供的字体","id":"白露非提供的字体","depth":2,"charIndex":828},{"text":"See Also","id":"see-also","depth":2,"charIndex":889}],"domain":"","frontmatter":{},"version":""},{"id":359,"title":"让 gvim 访问网络资源","content":"#\n\n当我还是 Vim 超级菜鸟的时候，我就知道 Vim 可以和 Editplus、UltraEdit 一样， 访问网络资源，操作方式也很类似：\n\n * 使用菜单栏的“文件”->“打开”命令；\n * 或者使用工具栏的“打开”按钮；\n * 会打开“编辑文件”对话框，此时在默认光标获焦的“文件名”文本框中输入网络资源定位符；\n * 回车，或点击“打开”按钮；\n * Vim 就会加载网站资源文件的内容。\n\n没有错，作为超级菜鸟，我们就是这样被当作什么都不懂，什么都不会的小孩一样来教导的。\n\n本来这样已经可以了，我们还有强求什么呢？真是得寸进尺啊，我发现 gvim 使用命令 是无法正常访问网络资源的。\n\n\n\n虽说 Vim 从 7.0 就已经默认集成安装了 netrw. Vim 了，支持网络资源访问， 但是如果使用上面的命令，gvim 会告诉你说：\n\n> error (netrw) neither the wget nor the fetch command is available\n> ——————————————————————————————– “NetrwMessage” –缓冲区无内容–\n\n向人请教得到解答： 这是因为缺少访问网络资源的程序（wget） Windows下需要下载 WGET for Windows (win32)， 将\nwget.exe 放到某个系统环境变量 Path 包含的位置（如 c:\\windows）即可。 如果是Linux，直接安装wget即可。\n\n现在还有一点问题，gvim使用上面的某个命令访问网络资源时，会打开命令行窗口：\n\n\n\n需要再敲一个键，才能关闭这个命令行窗口（Windows 7因为安全的原因，还有更多一步麻烦）， 并将网络资源的内容读到\nVim，目前不知有什么完美的方法，不需要打开，或者能够自动关闭这个窗口？ 而使用菜单或功能按钮等 gui 操作方式，是没有这些东西的，只是在同步加载远程资源时，\n不能进行其他操作。\n\n\n参考讨论#\n\n * Vim 网络读写功能的问题\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-09-12","routePath":"/blog/post/let-vim-to-access-remove-resources","lang":"zh-CN","toc":[{"text":"参考讨论","id":"参考讨论","depth":2,"charIndex":841}],"domain":"","frontmatter":{},"version":""},{"id":360,"title":"老家的粳米茶","content":"#\n\n * \n\n我的老家在江西九江瑞昌市南义镇， 有非常多独特的乡村美食，大多只能用老家土话叫名字，普通话都不知道该怎么说， 汉字也不知道该怎么写才正确。\n\n比如说粳(Jing)米茶，老家土话的发音应该是“箭米茶”，箭米其实就是粳米， 粳米茶是老家的习惯叫法，因为大都是在炎热的夏日中午，咕嘟咕嘟炖几个钟头，\n然后让它自然凉掉，到下午的时候当晚餐，或下午茶喝。实际上我想应该属于粳米粥。\n\n我搜了一下粳米茶，大都是九江的做法，用粳米和绿茶煮成，这完全不同于我老家的材料和做法。\n\n西祠胡同有一篇《辉婶学艺–粳米茶》的做法和老家的非常相似：\n\n * 先要有炒熟的粳米。这是整个过程中最为关键的一步， 我没有专门学， 当然不会，熟粳米是从老家带过来的，老妈很辛苦。\n   \n   \n\n * 还要有晒熟的红薯，或白薯粒。这个也很关键，过程有点漫长，大概几天吧， 一般是夏天把挖回来的红、白薯洗净切成正方体颗粒，放在外面让太阳暴晒，\n   晒干之后可以存储很久。老家还有纯粹煮红、白薯，或薯粒的做法， 叫薯茶或薯粒茶，当早茶或下午茶都可以。\n\n * 白砂糖，红糖也可以。\n\n如果上面的原材料都具备了的话，煮法就没什么好说的了，直接放到锅里煮就行了， 先用猛火煮开，然后用文火慢慢炖，到薯粒变软和，粳米煮开花就可以了。\n\n\n\n干薯粒本身就很甜，不过如果喜欢，加糖后味道会更佳。\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-09-05","routePath":"/blog/post/jingmi-tea","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":361,"title":"谦逊","content":"#\n\n谦逊，刚回家路上想起这个词。\n\n前段时间，公司包车组织出游，大客车在及其陡峭的山路上行驶，在每个转弯处都会事先鸣笛示意，\n一般来往的车辆都会这样做，但在一处锐角转弯处，一辆小卡车居然冒冒失失的闯过来，而没有鸣笛。\n在这样险峻的山路上，刺耳的刹车声让整车人都吓呆了，要是按照我的脾气，那辆小破卡车司机\n就要被我骂死（尽管对方无理，但却不保证被骂不生气，骂人，不知道有什么用！）。\n\n大概游山玩水累了，下山的路上，我们许多人都在车上睡着了，不知不觉，已经下得山来，\n行驶在平坦的大路上。然后就听到导游就向我们介绍司机师父，称赞他的驾车技术和为人。 我们一车人，都对他报以热烈的掌声，和发自内心的敬意。\n\n另一次出游，也需要上下山，虽然没有第一次的路崎岖，但是单行山道， 两辆大客车插身过路（老家土话：即两辆汽车对开）需要非常有\n\n * 技术：两辆车最近的距离近10厘米，最难开的时候还需要三番五次的下车目测，这是细活；\n * 远见：前方有车来时，事先停靠在合适的位置；\n * 忍让：甚至经常需要倒车让对方；\n * 合作：一方做的不到位，就有可能将双方堵死在路上。\n\n有空出游的机会毕竟较少，而日常生活中却经常见到横冲直撞的小车，为了一点点的时间， 或者车位，造出极大的危险。不敢肯定说这些小车司机的技术不如大客车司机\n（虽然事实上的确如此，大客车司机需要经过严格的训练和考核，拿的是A照， 只这一点拿C照的小车司机就比不了），但是对比那种谦让的态度，\n确是让人记忆深刻（让我想起小时候经常看见汽车上写的“礼让三先”）。\n\n不止是汽车，摩托车、电动车、自行车也有太多和小汽车司机态度一样的， 我一直就是这样一个态度恶劣的自行车爱好者，自认为车技很棒，什么飚车，慢速行驶，\n双手离开车把，车头跃起，漂移，都会来。\n\n以前看到街上一骑电动车的，洋到不行，甚至频繁的左右摇摆车把，让车身像水蛇一般扭动前行。\n这是及其危险的动作，无论对人对己。每天我上下班路上，也经常能看到一些在车流中频繁左右穿梭的人， 看似车技不错，其实很多连基本功——车把都扶不稳。\n我个人觉得，判断一个人的非机动车（包括自行车，电动车，摩托车在内）的技术能力， 只看他在慢速行驶时，能否扶稳车把即可（其实这也就是在考验控制平衡的能力）。\n\n谦逊的车手，大概应该是这样：尽量靠右行；从左侧超车；超车前鸣铃声； 尽量双手扶车把；控制好刹车系统和刹车时机，让车速保持在可控的范围之内；\n面对逆车道行驶，或占道的行人和车辆，也不必过于气愤（这一点我做的非常不好）。\n\n我最看不惯的是行人或车辆（主要是非机动车辆）闯红灯，这些人甚至在比较繁忙的十字路口见缝插针，\n他们可能抢得了一点自己的时间，却耗费了此时效率更高的汽车时间，把汽车堵在十字路口，\n另外其他驴友也做同样的事，被浪费的就是他的时间了。这种人被撞了我是不屑一顾的， 这是找死，只憎恶他造成交通堵塞，又浪费国家钱财（我又不谦逊了）。\n\n另外，我的房间有一堵墙与楼梯相连，平时总能听见蛮响的脚步声。其实这跟墙的质量 和隔音效果有很大关系，不过想起自己平时也大大咧咧，不顾及他人的感受时，\n够汗颜的，是应该放稳自己的脚步，走谦逊的路了。\n\n非机动车驾驶注意事项：\n\n> 行驶： 右行，并注意靠右，方便赶时间者超车； 行驶过程中千万不要过多S型游动前行。 高速行驶时，注意扫视远方，把握大局； 保持车速在可控的范围内，注意安全；\n> 控制刹车系统和刹车时机。\n> \n> 拐弯： 控制刹车系统，减速。 拐弯前，向转向的一方旁边观察。\n> \n> 超车： 从左侧超车，超车前鸣铃声示意；\n> \n> 被超车： 听到后面鸣铃想超车时，注意扶稳车把，保持前行； 向合适的边靠拢，但不要太急； 注意两边，但不要向后看\n> \n> 其他： 面对逆车道/占道的行人车辆，鸣铃示警，但不必介怀。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-09-08","routePath":"/blog/post/humility","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":362,"title":"博客日(blogday)2009","content":"#\n\n今天(每年8月31日)是 博客日， 照例是要分享/推荐5个博客的。\n\n * 互联网，请记住我 我也俨然快要成为vim重度爱好者了，今天搜索vim的相关知识时发现了 这个博主分享的vimrc，这个博客好像主要涉及php, c,\n   vim等方面， 我也不算太熟悉，对我来说是新的，基本符合博客日推荐精神，特此推荐。\n\n * GMATZ – The “official” blog of Gustava Tandeciorz\n   这个是Twitter上推友分享的jQuery壁纸时看到的,博客好像涉及Window 7, jQuery, Apple, Game,涉猎广泛.\n\n * Matrix67 我是这个博客的订阅者,博主读文科,但是精通数学,发布了很多的数学经典证明, 算法和数学趣题.\n\n * 情书 我是通过和菜头的[情书]书评才知道此博的, 博客主要涉及政治, 民主, 自由方面.\n\n * 阿阳的个人博客 博主貌似是应届毕业生,但是前端开发阅历不浅, 大概属于很有前途的那种. 通过淘宝小马 Twitter 分享知道此博.\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-08-31","routePath":"/blog/post/blogday-2009","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":363,"title":"使用 Vim 查看 HTML 源码","content":"#\n\n收集到一些修改浏览器 html编辑器，用vim从浏览器查看源代码的方法，其中有一些是较佳的解决方法， 这里将相关技巧一并整理于此。\n\n\n针对Internet Explorer：#\n\n\n快捷方式+注册表^1^#\n\n * 创建 gvim 快捷方式，例如重命名为 ieVim，并置于 Vim 安装目录($VIMRUNTIME，如 D:\\Vim\\vim72)。\n * 右键该快捷方式，属性，目标文本框中加入参数：\n   \n   \n\n * 修改注册表： [Explorer\\View Source Editor\\Editor\n   Name](HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet)=D:\\\\Vim\\\\vim72\\\\ieVim.l\n   nk 注意最后要加上 .lnk 后缀。\n   \n   \n   \n   另外也可以将如下代码保存为 .reg 文件，引号中路径改成 Vim 安装路径即可\n   \n   \n   \n   或者下载这个 注册表文件， 双击运行，或右键“合并”即可。\n * 现在在IE里使用右键，“查看源代码”就可以使用 Vim 打开 html 源码。\n\n\n批处理+注册表^2^#\n\n * 将如下代码保存为批处理文件，如 ievim.bat，例如放到 $VIMRUNTIME 下。\n   \n   \n\n * 参照第 1 个方法的第 3 步，修改注册表的值为这个批处理文件的地址，如 D:\\Vim\\vim72\\ievim.bat。\n * 现在就可以使用 Vim 或其他外部编辑器打开 IE 的页面源代码了。\n * 缺点：打开的批处理命令行窗口不会自动关闭，直到被打开的页面源代码编辑器被关闭。\n\n\n针对Firefox^3^#\n\n * 修改浏览器配置\n   * 在 Firefox 地址栏输入 about:config 并回车。\n   * 点击“我保证会小心”按钮，确认进入。\n   * 在“过滤器”输入 view_source，筛选出查看代码的部分选项。\n   * 双击 view_source.editor.external 项，将值变成 true。\n   * 双击 view_source.editor.path，输入 gvim.exe 安装（绝对）路径，如我的是 E:\\Vim\\vim72\\gvim.exe。\n   * 现在就可以使用 Vim 查看 Firefox 页面源代码了\n * 使用插件\n   * 安装 ViewSourceWith 插件后，重启 Firefox。\n   * 配置系统已有文本编辑器，如 D:\\Vim\\vim72\\gvim.exe\n   * 即可使用 Vim 或其他任意外部编辑器打开 Firefox 的页面源代码。\n   * 缺点：需要安装插件，且所在右键菜单的层级较深。\n\n\n针对Opera^4^#\n\n * 在 Opera 地址栏输入 opera:config 并回车。\n * 在 Quick find 输入source viewer，筛选出查看代码部分的选项。\n * 在 Source Viewer 中填入欲使用的外部编辑路径，如 D:\\Vim\\vim72\\gvim.exe。\n * 并将 Source Viewer Mode 改为 2 源码显示模式： 1 表示使用系统默认程序查看源码 2 表示使用自定义程序查看源码 3\n   表示使用Opera查看源码\n * 保存即可，现在可以使用 Vim 或其他外部编辑器打开 Opera 的网页源代码了。\n\n\n参考阅读#\n\n * 用 vim查看ie源代码的问题\n\n * View Source from Internet Explorer in gvim\n\n * Use gvim to view page source in Internet Explorer ^vbs^\n\n * 改变查看页面源代码的程序\n\n * Opera首选项编辑器（opera:config）详解\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-09-05","routePath":"/blog/post/use-vim-view-html-src","lang":"zh-CN","toc":[{"text":"针对Internet Explorer：","id":"针对internet-explorer","depth":2,"charIndex":70},{"text":"快捷方式+注册表^1^","id":"快捷方式注册表1","depth":3,"charIndex":94},{"text":"批处理+注册表^2^","id":"批处理注册表2","depth":3,"charIndex":510},{"text":"针对Firefox^3^","id":"针对firefox3","depth":2,"charIndex":728},{"text":"针对Opera^4^","id":"针对opera4","depth":2,"charIndex":1184},{"text":"参考阅读","id":"参考阅读","depth":2,"charIndex":1473}],"domain":"","frontmatter":{},"version":""},{"id":364,"title":"疯狂的性能","content":"#\n\n> Performance is Everything. 工作中最重要的是提高效率。– 约·艾迪生\n\n单元测试是开发人员必做的功课之一，而精益求精的开发人员又会为性能而癫狂。\n\n目前很少有发现 JavaScript 的性能测试工具，程序员在比较几段为同一目标， 但实现方式不同的代码效率时，总需要一行行的写new\nDate()和document.write()。 应该说，这不是什么大不了的事，因为 JavaScript 的性能测试本身就很简单，代码量也不算多。\n\n不过，如果我们可以做的更好，更简单，更直观的话，那就动手吧。\n\n这里我初步写了一个 性能测试的框架， 实话实说，是抛砖引玉，因为这个本身没有什么值得骄傲的， 请大家多提意见和建议，来共建一个更好的性能测试框架。\n\n\n延伸阅读：#\n\n * Performance is Everything\n\n * Javascript performance test\n\n * Chrome称王 五款浏览器性能大比拼－软件评测\n\n * 浏览器 JavaScript 大比拼，Opera 9.5胜出！\n\n * 主流浏览器JS性能大比拼\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-08-23","routePath":"/blog/post/crazy-performance","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":343}],"domain":"","frontmatter":{},"version":""},{"id":365,"title":"菜单项图标","content":"#\n\n新装的Windows 7总有一些因为暂时不习惯或无知而遇到的问题，例如网络链接就经常出问题， 右键一个网络适配器，我们大概可以看到这样的菜单。\n\n\n\n看到这一连串代表着安全的图标你作何感想？\n\n图标可以增强视觉效果，加深记忆印象；合理的图标可以到底一目了然的功效， 而不用看后面的介绍性文本；但是糟糕或者不合理的图标，只会适得其反。\n\n所以说，这几个图标，用的确实让人雷到，（几乎？）没有一个能确切表达对应菜单项功能的。\n\n如果没有合适的图标用来表达菜单项的功能，就不要使用图标。\n\n当然Windows 7的右键菜单图标并不是都用的这么烂。\n\n\n\n之前的Windows系统也做的很好，选用的图标都很恰当，留白也留的很性感。\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-08-16","routePath":"/blog/post/menu-item-icons","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":366,"title":"CSS字体中文、英文、Unicode名对照表","content":"#\n\n * \n\ncss字体名可以使用2种Unicode格式来书写，以“微软雅黑”为例: 微软雅黑 和 \\5FAE\\8F6F\\96C5\\9ED1都可以。\n如果未找到需要的字体名称，可以到 这里 把简体中文转换为Unicode编码。\n\n另外注意：繁体中文字体名，在简体中文系统中是不能被识别的。\n\n查看 详细的字体名称对照表。\n\n\n参考阅读：#\n\n * CSS中 常见中文字体的英文名称\n\n * 中文字体在 CSS 中的写法\n\n * 谈谈网页设计中的字体应用（系列）\n\n * 中文转Unicode\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-08-14","routePath":"/blog/post/css-names-with-cn-en-unicode","lang":"zh-CN","toc":[{"text":"参考阅读：","id":"参考阅读","depth":2,"charIndex":163}],"domain":"","frontmatter":{},"version":""},{"id":367,"title":"重复的书签","content":"#\n\n项目需求要做一个收藏夹，供用户收藏项目中的功能点。开发人员先给了个初步的设计文稿，\n基本上是参考IE的设计方案（当然其他浏览器的方案也差不离），后来在讨论如何对待\n用户收藏重复的功能点这个细节问题时，也没有经过太多的争论，照例抄袭了IE的处理方式：\n\n * 同一文件夹下不允许收藏重复的功能点，只将新的信息（如名称）覆盖到旧有的信息上；\n * 不同文件夹下可以收藏同一个已收藏的功能点。\n\n但是经过讨论，后来摒弃了这个方案，因为我们看到了Firefox的优秀设计：\n\n * 同一账户不允许重复收藏同一书签；\n * 当用户收藏一个已收藏的书签时，覆盖已有信息（如名称）；\n * 如果被收藏到另一个不同的文件夹时，则将旧的收藏移动到新文件夹。\n\n\n\nChrome包括智能地址栏和收藏夹都吸收了Firefox的优秀设计。\n\n\n\nSafari则表现的不同凡响：\n\n * 用户可以收藏重复的书签；\n * 甚至在同一个文件夹中，以相同的名称存放。\n\n\n\nOpera和Safari表现完全一致，或许他们认为，这是用户的自由。\n\n\n\nIE7和我们所熟悉的一样：\n\n * 用户可以重复收藏已有的书签；\n * 仅当这两个书签放在不同的文件夹；\n * 或者以不同名称，放在同一个文件夹中。\n\n\n\nMaxthon最初是从IE学习并扩展而来，可想而知，并且实际上也是， 它们在对待重复的书签上，也是一致的。\n\n面对这些主流浏览器对待重复书签的态度，像Safari和Opera这样给用户充分的自由，\n或Firefox和Chrome这样“所谓”的智能，以及IE及Mathon取两者（自由或相对不自由） 之中庸，作为经常使用书签的普通用户，你觉得哪种设计更合理？\n\n这里我表达一点自己的想法：\n\n * 不受约束的自由，不是什么好自由；过分的灵活，只会给用户带来迷茫。\n * 书签本身的作用，就是给用户一个记录、并能够快速打开常用或优秀的网址的地方。 如果收藏夹，甚至同一个文件夹中存在（看起来）相同的书签，\n   用户就需要停下来思考自己要的是哪一个。\n * 书签一般都需要记录用户使用的次数，并根据算法排序提供给智能地址栏， 收藏夹存在多个副本也会存在歧义。\n\n从这个角度来讲，Opera和Safari是做的最烂的，IE和Maxthon则做的一般。\n很幸运，这个想法也博得了我们项目组开发人员和PM的赞同，并应用与项目设计中。\n\n\n关键字：#\n\n * 收藏夹(Favorite)：指浏览器用来管理书签集合的工具。\n\n * 书签(Bookmark)：指单个被收藏的网址信息。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-08-14","routePath":"/blog/post/duplicate-bookmarks","lang":"zh-CN","toc":[{"text":"关键字：","id":"关键字","depth":2,"charIndex":1003}],"domain":"","frontmatter":{},"version":""},{"id":368,"title":"未来的前端设计","content":"#\n\n今天基本完成了用户首页，用户可以拖放管理自定义布局 （类似 igoogle）。\n\n在PM试体验的时候，发现他的拖放方式都（跟部门主管一样）是“丢放式”的， 鼠标抓起一个模块，带有速度的往某个位置一扔，有时在没有到达目标区域就放手了，\n导致实际上没有被扔到目标区域。不仅仅是拖放模块，甚至连拖放改变边侧栏宽度也是使用这种手法。\n可以想象他们使用桌面应用程序（比如改变窗口大小）也是这样操作的。^1^\n\n我当时指出这两种拖放手法的不同，然后我们就短暂的畅想了关于“丢放式”的前端设计。\n\n如果你看过微软未来操作系统的视频^2^，或者腾讯未来QQ的演示视频^3^，大概能了解这是怎样的一种情形。\n\n这种模拟现实，并超越现实的操作体验，比目前任何的3D游戏都要精致、逼真得多，\n它是如此的流畅（非性能），以至于让人感觉不到操作系统和软件的存在，仿佛在摆弄实物一般。\n\n目前的大多数web前端设计，还只是初步模拟操作系统或桌面应用程序2D时代的作品，\n受浏览器的约束，也有一些做出了还不错的3D及流畅的动态效果，然而即使是flash也做的很不够。\n就3D效果本身来说，这只不过是未来设计中很基本的一种特性，另外包括手势动作及趋势，\n操作的速度及方向，还有现实世界中力学，人体工程学，甚至心理学等等众多科学的渗入，\n辅助以多点触摸屏，声控等，展现层的设计会越来越逼真，操作方式跟现实世界会越来越无差异。\n\n更进一步的，我曾经似乎看过，也传播过这样一句话：最好的界面，就是没有界面。\n我虽然只是随便说说，但是心里还是蛮认真的。当然这里说的没有，只是说对操作用户来说几乎透明，\n几乎感觉不到，而当用户希望有感觉时，他可以自己拼出符合自己期望的界面来。\n\n\n参考与延伸欣赏：#\n\n * Twitter@hotoo:3241383666 发现部门两个老大的拖放手法都是“丢放式”， 未来操作系统在触摸屏的辅助下，已经有这样的抽象设计。\n   我想，web前端也可以尝试这样的抽象设计。^1^\n\n * 视频: 超酷的微软操作系统 ^2^\n\n * 超炫的未来QQ版本（视频集合） ^3^\n\n * 未来的操作系统将采用3D用户界面和触摸操作\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-08-12","routePath":"/blog/post/web-design-for-feature","lang":"zh-CN","toc":[{"text":"参考与延伸欣赏：","id":"参考与延伸欣赏","depth":2,"charIndex":722}],"domain":"","frontmatter":{},"version":""},{"id":369,"title":"论广告窗口的弹出","content":"#\n\n弹窗广告，这（和页面漂浮广告）是上个世纪用的最频繁的广告方式，这种广告之所以“流行”，\n是因为它引人注目的特性，广告商也正是看中这一点。而这也是最讨人厌的一种广告方式，\n因为它未经用户同意，擅自弹出新窗口，一来每次都要手动关闭窗口很烦，二来它不尊重用户的意愿。\n\n既然服务商不尊重用户，用户当然说服务商很讨厌。\n\n后来通过服务商，广告商，开发人员和用户等大众的共同努力，这种弹窗方式逐渐受到质疑：\n\n 1. 这种广告方式真的很有效吗？\n 2. 有更好更受欢迎的广告模式吗，为什么(Google) 内联的 ， 精确匹配的广告模式会受广告商和普通用户的一致好评？\n\n同时这（两）种广告模式逐渐退出广告历史的舞台，只有非常小众的网站才偶尔， 或非常恶劣的网站才频繁出现。\n\n并且，即使链接本身是否在新窗口弹出都成了讨论的热点话题。w3c 已经不建议使用 target 属性了，\n是否在新窗口、新页签中打开，这应该是用户可控的，属于用户的偏好问题，应该尊重用户的选择。\n\n不过，用过淘宝的人应该都知道，淘宝首页 是会弹出广告窗口的， 即使默认情况下被浏览器自动屏蔽掉，在用户点击页面时还是会被弹出，此时因为带有用户行为，\n浏览器较难判断是否应该屏蔽。\n\n真是令人发指，淘宝这样出色的公司，居然做出这么卑劣的事情，而且还费尽心机。\n\n前些时候我发现淘宝首页的拼音索引和商品详细信息等都不可用了，于是在 Twitter 上对 @TaobaoUED 发了句牢骚，然后 @Macji\n很主动的跟我联系了解情况。 后来发现问题出在 Adblock plus 2 的 ChinaList 直接将淘宝用的 tbra 框架屏蔽了， 然后我和 Macji\n进行了“深入的激辩”，大致情况如下：\n\n> Macji: 对于 china list 这种不负责的乱禁用 js 框架, 而不是只是禁用广告. 所以我们也无办法 闲耘:\n> 我觉得在弹窗这一点上，chinalist 是负责任的，是淘宝不负责任 Macji: chinalist 应该专业点的, 只是禁用弹出广告 闲耘:\n> 也许淘宝应该专业点，不要用弹窗广告 ... Macji: 弹出广告 严重邮箱用户体验, 其实我们一直再争取, 但我们不是高层 Macji: 我会写信给\n> chinalist 给出禁用弹窗的解决方案\n\n最后想说：淘宝是个很有责任感的公司，这个弹窗广告除外；淘宝是个很注重用户体验的公司，\n这个弹窗广告除外；淘宝是个很尊重用户的公司，这个弹窗广告除外。淘宝是个很注重细节的公司， 包括这个弹窗在内；淘宝是个很注重技术的团队，包括这个弹窗在内。\n\n--------------------------------------------------------------------------------\n\n更新：可喜的是，经过努力，新版淘宝已经戒掉了这个恶习。\n\n\n延伸阅读：#\n\n * 万恶的弹窗广告\n\n * 符合国情的链接新窗口打开\n\n * 在新窗口打开链接是流氓行为\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-08-07","routePath":"/blog/post/talk-about-popup-window","lang":"zh-CN","toc":[{"text":"延伸阅读：","id":"延伸阅读","depth":2,"charIndex":1212}],"domain":"","frontmatter":{},"version":""},{"id":370,"title":"搜索的体验","content":"#\n\n准备升级博客模板，用js提供高级特性，比如和vim类似的键盘命令模式，和内联搜索模式。 主要提高搜索的体验，包括一下几点。\n\n * 检查来自Google,Baidu等搜索引擎和本地搜索的搜索关键字，并高亮之。\n * 内联搜索模式，在底部fixed搜索框，并支持快捷键，最好能支持正则匹配模式，参考vim。\n * 使用搜索框附近fixed工具按钮，提供下一个、上一个搜索关键字的跳转，参考Eclipse。\n * 在滚动条附近使用(fixed)条纹，标识每个搜索结果在整屏中对应的大概位置， 点击条纹可以跳转到对应结果项，拖放滚动条到对应的条纹处，\n   页面也正好滚动到对应的结果项，参考Eclipse, Chrome。\n\n这里只是初步想法，受我“[[the-god-of-editor|编辑器之神]]”的想法发散而来，\n目前已经初步模拟了滚动条附近的搜索大纲，和命令模式的命令列表(完全模仿vim)。\n\nhttp://farm4.static.flickr.com/3475/3768956114_2562cf5b10_o.png\n\nhttp://farm4.static.flickr.com/3470/3768173303_ffbf2028cb_o.png\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-07-29","routePath":"/blog/post/search-expreience","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":371,"title":"右键菜单的细节","content":"#\n\n在 Web 客户端编程中，绑定 JavaScript 的 contextmenu 事件来驱动触发自定义右键菜单，\n并通过停止事件冒泡来阻止Windows默认菜单，是一种比较常见的自定义菜单实现方式， 自定义菜单的基准位置是基于事件的触发位置得来的。\n\nhttp://farm3.static.flickr.com/2475/3761004107_8f9f25efc1_o.png\n\n就右键菜单的本意来说，这基本没什么问题，不过Windows PC键盘上有一个右键功能键。\n\nhttp://farm3.static.flickr.com/2583/3760929801_31e0e4b6c8_o.png\n\n通过按这个功能键来触发右键菜单，除了Firefox （v3.5，其他版本未测试）外，均表现不正常。\n\nhttp://farm4.static.flickr.com/3529/3761023363_50cd93a685_o.png\n\nIE 事件触发对象的坐标仍是鼠标所在的坐标位置。\n\nhttp://farm4.static.flickr.com/3529/3761015003_552bdedc82_o.png\n\nSafari和Chrome均不能触发自定义右键菜单，呈现浏览器默认菜单\n（Safari在使用鼠标邮件激活自定义右键菜单后，自定义右键菜单消失前，不呈现浏览器默认菜单）。\n\nOpera不支持contextmenu事件，默认情况下也禁止脚本控制右键菜单。\n\n而标准的桌面应用程序中使用这个键，和右击鼠标是基本一致的，基准位置参照焦点对象的位置。\n\nhttp://farm3.static.flickr.com/2591/3760955767_8fb08f8007_o.png\n\n右键功能键是为无鼠标或鼠标不可用情况设计的，所以使用右键功能键激活的右键菜单， 应该呈现在焦点对象附近，并且自定义菜单应该（至少在视觉上）获得焦点，\n以便于通过方向键控制选中的菜单项。\n\n这在很大程度上应该属于浏览器的问题，不过在现实的情况下，如果前端开发者可以解决掉这个问题， 就不要寄希望于浏览器将来的新版本。\n\n> 不过更好的方式也许是：严谨区分鼠标和键盘事件。\n\n\n参考阅读：#\n\n * Opera下自定义右键菜单的研究\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-07-27","routePath":"/blog/post/particulars-of-right-click-menu","lang":"zh-CN","toc":[{"text":"参考阅读：","id":"参考阅读","depth":2,"charIndex":935}],"domain":"","frontmatter":{},"version":""},{"id":372,"title":"引导用户升级/切换浏览器","content":"#\n\n * \n\n虽然我不“赞同”强行拒绝IE6，但是“认同”推进Web及浏览器的发展进程。 一直想做引导用户升级/切换浏览器的工作，现在是做些实事的时候了。\n我们承受的苦难太多了，朋友们，这是抉择的时刻，是你作出改变是时候了，为了我们，干杯！\n\n\n升级/切换您的浏览器#\n\n鉴于您使用的浏览器过于陈旧，影响您的上网体验，我们向您推荐以下浏览器：\n\n * Firefox 来自开源Mozilla公司，安全可靠，拥有众多强大的插件和开源社区支持。 适合喜爱DIY的人士。\n * Chrome 来自誉满全球的互联网公司Google，安全快速，界面简洁、灵活、新颖， 使用开源的Webkit渲染引擎和强劲的V8\n   Javascript解析引擎， 给你飞一般的感觉，适合普通用户。\n * Safari cn 来自设计界著名的苹果(Apple)公司，使用自主开发、开源的Webkit渲染引擎， 适合普通用户。\n * Opera 一直以来默默无闻的引领着浏览器的设计潮流，其移动设备上的Mini版亦深受大众欢迎， 是一款值得尊重的、实用的浏览器，适合各类人群。\n * Internet Explorer 8 来自大名鼎鼎的微软(Microsoft)公司，是迄今为止IE家族最优秀的浏览器，\n   但目前有少量第三方插件支持不够友好，相信很快会有所改善。\n * Internet Explorer 7 隶属IE家族，相对IE8来说，第三方插件支持稍成熟。\n\nIE 、 浏览器 和 因特网 ：因特网是连接世界资讯的数字化网络。 我们使用浏览器是来浏览网页、上网冲浪，尽情使用互联网。 而Internet\nExplorer(IE)则只是浏览器的一种。\n\n完整 演示。\n\n\n参考阅读：#\n\n * Web技术要发展，IE6必须先消失！\n\n * 能支持IE6的前端更牛，还是敢对IE6说不的更牛？\n\n * 我该选用什么浏览器？\n\n * 升级您的Internet Explorer 6\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-07-26","routePath":"/blog/post/upgrad-your-browser","lang":"zh-CN","toc":[{"text":"升级/切换您的浏览器","id":"升级切换您的浏览器","depth":2,"charIndex":123},{"text":"参考阅读：","id":"参考阅读","depth":2,"charIndex":727}],"domain":"","frontmatter":{},"version":""},{"id":373,"title":"未知选项的表单设计","content":"#\n\n发现许多的注册表单设计中，性别部分的设计大都这样：使用单选按钮（radio） 并默认选中一个（大都为男性，某些女性频道为主的可能为女性）。例如：\n\n\n\n网页申请QQ （qq.com）帐号\n\n\n\n注册网易（163.com）通行证\n\n雅虎（yahoo.com）的设计比较特立独行，使用选择框（select）， 并默认不选中任何一个。\n\n\n\n而雅虎中国（yahoo.cn）的设计也是使用单选框（radio）， 但是不选中任何一个。\n\n\n\n按常理来说，注册系统并不知道用户的性别是什么，默认选中任何一个都不合理。 yummy有一篇文章《中文按1，For English, press 2》\n提到“如果用户必须做出选择，那就先给他做好一个选择。”，这个道理在某些情况很不错， 但是用在这里不合适。\n\n如果不足够了解用户，就不要替用户做选择。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-05-09","routePath":"/blog/post/form-design-for-unknow-options","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":374,"title":"状态模式","content":"#\n\n现有的IM软件都有状态设置功能，常见的默认状态有：在线，忙碌，离开，隐身，离线，\n但是这些状态对应的选项是不可设置的，例如TM/QQ，选择在线或者忙碌，对应的通知铃声，\n接收消息方式都是指定、不可改变的，虽然这些默认设置在某些情景下可能很合理，但不总是这样。\n\n\n\nTM/QQ 状态：可以使用默认状态作为模板附加消息来添加状态。\n\n\n\nGtalk 状态：可以直接在状态写状态信息，但是只有在线，离开和离线三种状态。\n\n\n\nWangWang 状态：可以添加状态信息。\n\n可以看出，基本上IM软件的状态信息只能向好友展示文本消息，告诉好友你当前的状态，\n有时候并不能真正帮助我们在某些需要的时候过滤某些信息，例如老板告诉秘书，帮我回绝所有约会和电话。\n\n最近工作的时候发现，我希望工作的时候设置状态为在线，或者忙碌也可以， 而且不想接收所有或某些群消息。\n\n例如上班工作的时候不想接受技术探讨群或娱 乐群的叽歪消息，\n\n但是要聆听部门或项目组的群消息，尤其要注意老板发来的消息， 当然手工修改每个群的消息设置也可以做到，但是每次改都非常不方便，如果可 以保存为模式\n（如命名为“工作模式”，寂寞的时候想找人聊天可以设置一个“寂寞模式”），在模式之间切换就更实用了。\n\n智能手机（如我的Smartphone）在这方面就做的不错，值得学习。 Smartphone上有各种“情景模式”，如普通，静音，会议，室外，自\n动，耳机，车载和免提， 每一种模式的铃声类型，音量，包括模式名称等多项设置都可以根据用户自身情况改变\n（当然默认的情景模式设置也已经很合理了，但我也有在一些特殊的时候，做一些适当的修改）。\n\n\n\n下面使用Windows Mobile 2003的相关屏幕截屏\n\n\n\n\n\n\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-05-08","routePath":"/blog/post/status-pattern","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":375,"title":"編輯器之神","content":"#\n\n最初的时候我一直使用 Editplus，这是一款轻量级， 效率极高，可配置性稍强的编辑器，而且有内嵌的(IE6)浏览器内核， 使用快捷键 <Ctrl-b>\n就可以在 html 代码和预览效果之间快速切换， 甚至可以无需保存html 文件到指定磁盘位置（默认保存在浏览器临时目录）。 我仍然很喜欢\nEditplus，但是不经常用了。\n\n后来使用的 Eclipse 在项目管理和强大的插件支持下， 如神器一般。这是一个足够伟大的IDE，不过如果单纯的作为编辑器来用，就有点大材小用了。\n\n最后，就是 Vim 了，Vim 和 Emacs 两款编辑器我都试用过， 最开始不理解多模式，没有适应这种使用习惯，心想：这是什么破编辑器！？\n\n来来回回丢弃过几次，后来有一次不小心心智大开，迅速的习惯了多模式编辑， 并从此爱上了 Vim，经过一段时间的学习和练习，更是无法自拔。\n\n上面三款编辑器如此优秀，Vim更有神器的美称，但即使是神器也有美中不足之处。 下面是我期待中的编辑神器的主要功能点。\n\n * 代码着色\n * 现代化的代码折叠方式\n * 大纲视图\n * 代码压缩与格式化\n * 文本比较\n * 文本书签\n * 文本拖放\n * 多模式编辑\n * 内联搜索模式\n * 在滚动条或附近使用彩色条纹标识状态\n * 自动识别文件编码\n * 可扩展\n * 项目管理支持\n * 二进制编辑支持\n * 代码着色 基本上现在的编辑器都支持代码着色，虽然使用方式各不相同， 但是使用效果基本可以达到一致，没什么要挑剔的。不过 Vim 的配色模式不错，\n   另外应该提供导入到处配色模式。\n * 现代化的代码折叠方式 代码折叠是一项如此受人喜爱的创造发明，不支持代码折叠你都不好意思更人打招呼。 不过 Editplus 和 Vim\n   的代码折叠方式比较原始，默认情况下只识别缩进后的文本/代码， 而且Vim左边的折叠按钮更是土到掉渣。\n * 大纲视图 Eclipse精于此道，自带的大纲视图对 Java，C++，PHP 等支持都很好， 而 Aptana 对 Javascript\n   的大纲视图更是令人称道。\n * 代码压缩与格式化 Vim的代码格式化做的很不足，有很多时候格式化不到位。Eclipse及其插件做的比较完美。\n * 文本比较。 Vim 和 Eclipse 都做的很好。\n * 文本书签 要在大段、篇幅很长的文本/代码中跳跃阅读，并能轻松回到原来的位置上， 书签就显得尤为重要。Vim 的 mark 插件对文本书签支持的很好。\n * 文本拖放 在不想使用复制/剪贴影响剪贴板内容的情况下很有用。 不过 Vim 默认不支持，Editplus 和 Eclipse 做的很好。\n * 多模式编辑 Vim 和 Emacs 的多模式编辑，舒适到不行。\n * 内联搜索模式 Vim 的内联搜索模式是如此的浑然天成，并且支持强劲的正则表达式匹配模式。\n * 在滚动条或附近使用彩色条纹标识状态 Eclipse的全局搜索，Chrome浏览器的搜索，Beyond Compare 2的文本比较，\n   都有在恰当的位置标识出所有结果集在编辑器的全局大体位置， 使用滚动条拖放到某位置，即可看到对应的搜索结果。\n * 自动识别文件编码 Ediplus 做的最为精湛，Vim 也有一个不错的插件支持。\n * 可扩展 Eclipse 和 Vim 的扩展性较强。\n * 项目管理支持 作为 IDE，Eclipse 当然表现强劲。Editplus 也有一个原始的项目管理功能。\n   编辑器本身可以没有项目管理功能集成，这个可以交给更专业的项目管理软件来做， 编辑器可以实现某些接口来集成或挂载项目管理功能。\n * 二进制编辑支持 一般人并不常用，如果在不影响前面的功能和编辑器效率的情况下， 加上这个功能也未尝不可。\n\n如果我们有一个编辑器，他启动像 Editplus和Vim一样迅捷， 使用Eclipse或类似的现代代码折叠方式，有Eclipse那样成熟的大纲视图、\n代码压缩工具和文本比较功能，像 Vim一样的多模式编辑和内联搜索模式， 支持如Perl一般的正则表达式匹配模式，并将搜索结果集在文档全局中对应的位置\n在恰当的位置（如滚动条底带）呈 现，支持文本书签，另外有像Eclipse一样， 或更好的更专业的项目管理工具支持，这将是怎么一款伟大的现代编辑器。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-07-24","routePath":"/blog/post/the-god-of-editor","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":376,"title":"用 Google Code 管理与发布 Wiki","content":"#\n\n由于 Dropbox 的墙掉，https 协议访问 dl 或 dl-web 子域 的方法也随之失效，虽然可以通过修改 hosts 来继续同步文件，但是\nPublic 目录再也 不能输出文化了。\n\n我之前 在 Dropbox Public 目录搭建的博客和 Wiki 系统 也无法在线浏览了，为了能够继续 辅助文化局输出文化，我便利用万恶的资本主义国家 的\nGoogle Code 来为我们服务了。\n\n由于可以继续使用 Dropbox 来自动同步私有文件，所以可以保持 .wiki 文件在 Dropbox 中，其他自动同步的软件也可以用来做类似的事情。\n\n将 Vimwiki 的 path_html 修改为 Google Code 的某个 svn 或 Hg 目录：\n\n\n\n虽然 Vimwiki 目前的 toHTML 方法还不支持重新生成仅更新过的 wiki 文件，但是 svn 可以判断文件是否有真正被修改过。\n\n另外 http://hotoo.googlecode.com/svn/wiki 目录存放的是 Google Code 的 Wiki 文件， 这里面的 wiki\n文件无需通过 Vimwiki 导出 HTML，Google Code 会自动完成这一工作， 并可以通过\nhttp://code.google.com/p/hotoo/w/list 浏览。而 Vimwiki 是 Google Code Wiki\n语法的一个子集，所以基本可以天衣无缝的配合使用。\n\n这也是不错的一个方案，除了需要 commit 之外，Google Code 比 Dropbox 的 Public 有过之而无不足，域名也是杠杠的。\n\n另外不小心发现还有其他的托管方案，让防火墙筑的更高些吧，当局者把自己当猪圈养起来 比较好，做个专职的脑子又笨，目光又短浅的墙脚之猪也可以提高幸福指数的。\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2010-05-20","routePath":"/blog/post/vimwiki-google-code","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":377,"title":"Dropbox 的墙掉","content":"#\n\n其他的都不想说，只希望 Dropbox 的开放性能更强大，比如 API 或者分布式 的云技术再上台阶，第三方服务风起云涌，像 Twitter 那样。我深信：\n\n> 开放到极致的世界，无视大独裁者。 让 XX 去万岁，我只要真理，真理使我们自由。 -- 闲耘™\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2010-05-10","routePath":"/blog/post/dropbox-died-in-china","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":378,"title":"如何削铅笔","content":"#\n\n看了 JunChen 翻译的 Adaptive Path：我们最爱的草图工具， 我很受启发。之前也有让公司买彩色铅笔用，但现在已经离开用不着了。\n而且一直都很想买个 GTD 记事本以及其他文具，今天抽空就把装备给差不多备齐了。\n\n回来削铅笔的时候，想起自己以前的经历：小时候用过转笔刀和小刀，都会把笔尖削的很尖锐， 跟书本上的引导、同学的同化、以及思维定势都有关，而且也\n基本适合那时候的使用场景。 后来高考使用2B铅笔，也受一些美术专业朋友的影响，学会了把笔尖削得平板愚钝一点 （有点返璞归真，大智若愚的感觉），这种削 法也一直\n使用到现在。\n\n这里要讲的就是这种削法。\n\n * 削表面木头时，先不要削炭芯，倾斜度建议平滑一点，大概15°，也就是圆锥体切面角度大概为30°。\n   大概完成的时候，被削的表皮为2cm长，露出的笔芯部分0.5cm。\n   \n   \n\n * 然后是削笔芯，先在圆柱体的两边削出平行（渐进微斜）的两个平面，尖端厚度大概为0.15cm (1.5mm)。\n   \n   \n\n * 再把笔尖顶端的一侧削（刮）出一点弧度，以便于书写和素描。\n   \n   \n\n * 最后在稿纸上试笔，顺便打磨一下笔尖两侧，使之更便于使用就可以了。 笔尖平时一般不用削，用的时候就可以把笔尖磨成舒适的形状，直到笔尖变短。\n   \n   \n\np.s. 1. 不知道白色笔芯的铅笔用来华什么，一般都用白纸，而且她也不能遮盖掉其他颜色， 不然用做橡皮功能也不错。 p.s. 2.\n文具店的阿姨也在讲求用户体验呢，正准备装修外面的广告招牌， 对店里放笔的盒子的设计细节也有研究。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-04-14","routePath":"/blog/post/how-to-peel-pencil","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":379,"title":"电梯按钮设计","content":"#\n\n * 外面选择“上”或“下”的按钮换成“开门”，这样外面也可以中断自动关闭的电梯门， 并增加选择楼层按钮。这样电梯系统可以预知各个起始楼层和目标情况，\n   可以结合历史数据合理调整运转过程，对用户来说，也不必都挤在电梯里忙着（或忘记）选择目标层；\n\n * 选择“上”、“下”以及楼层的按钮可以取消选中。建议如下：当前被选中，则按一下取消选中，否则选中。\n   目前有一些稍人性化的电梯可以取消操作，但是要按N下，而一般用户又不知道N等于几？\n   其实按一下就够了，不过避免误操作，连续按两、三下取消也可以，并在旁边给出提示；\n\n * 里面保留选择上、下和楼层按钮（用户可以中途改变目标），但是选择楼层的按钮应该放到开、\n   关门按钮的下面，方便儿童和残障人士使用（开、关门是自动的，影响不大）。\n\n这个改造成本不知道算不算大，每一层都需要增加选择楼层的按钮，不过这对用户和系统都是有利的， 为电梯系统设计的合理也做了准备。我觉得这是未来电梯的最低配置。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-04-08","routePath":"/blog/post/lift-button-design","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":380,"title":"笔试后双方最好能当面讨论题解","content":"#\n\n最近有好几次进阿里集团的笔试经验，有一个小体会：笔试后招聘方和应聘方最好能一起交流讨论题解\n（记得学校考试的时候，对题目有疑问时可以举手提问，老师也有出错题的时候，但是考场上发现后会立即处理。\n不过由于笔试时间短，出现意外再改的话时间会很仓促，所以建议在笔试后讨论，题可以先按照“常理”解答）。\n\n前两次分别在 淘宝UED 和 阿里妈妈 的笔试题里，有一道很相似的题：给数值对象（Number）扩展一个原型方法，\n将数值格式化为指定长度的字符串（另外还有一个条件，淘宝UED给的是“能指定格式最好”， 阿里妈妈则是“能指定进制最好”）。\n\n淘宝UED： 想到数值可能是小数，但题目没有知道小数保留长度等条件，这里只考虑整数位。\n\n\n\n阿里妈妈： 同样有小数问题，而且小数转进制的话也有特殊的地方，这里忽略小数。\n\n\n\n好在两个部门笔试后都有相关讨论，对这一问题做了及时的初步探讨。\n\n今天又去参加了 阿里巴巴 的笔试，这次的题没有重复的， 但是也有一个问题压轴题。\n\n大意是用CSS控制3个DIV，布局如下图（图是随手画的，不计较大小比例）：\n\n\n\n当时解答的时候，在我看来，似乎是只给3个兄弟关系的div，没有辅助标记，让写css控制布局。\n\ncss虽不是我所最擅长，但是这个布局还是可以做出来的，但是难点只在于不使用辅助标记，哪怕是div。\n当时我的解法如下（这里是调试后正确的代码，当时思想相同，但代码没有写完整，也没有经过调试验证）：\n\n\n\n\n\n虽然效果基本相同，而且没有使用辅助标签，但总觉得有点ugly，因为这里的区域尺寸都是固定像素的，\n所以较好控制，当遇到未知高度时，#box2的top就不知道要设置为多少了，还是加一个辅助标签简单灵活。\n\n如果可以使用辅助标记，我的题解如下：\n\n\n\n\n\n还有一个问题是，因为有边框和间隔的关系，左右两个区域是无法上下对齐的。 另外实际应用中还要考虑到清除浮动，父级元素等情况。\n\n当时有想过打破（可能是自己臆想的）规则，用辅助div实现，但是由于尝试在规则之中实现， 结果用了过多的时间，还答的一塌糊涂。\n\n由于这次有多人一同笔试，而且时间很晚（预约18:30分），无法安排讨论，我对这道题也耿耿于怀， 回来请教我那 牛逼的朋友，第一选择也是使用辅助div。\n不知道阿里巴巴这道题的作者是怎么想的，难道是故意的？\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-03-26","routePath":"/blog/post/after-written-examination","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":381,"title":"由邮件排序想到的","content":"#\n\n目前的电子邮件系统，均是使用倒序列出邮件列表，最新的邮件总是在第一封。 这样做也并没有什么不好，不过这是最好的排列方式吗？\n\n新邮件很容易将较早的邮件挤到下面甚至是后面的页面中，导致最先收到的邮件反而最后被看到，\n这就出现了公平性问题，当然并不是先到的邮件就一定要先看，甚至邮件被直接无视也有可能。\n而另一个问题是，同一个人连续发了多封相关邮件，这就出现了错误阅读顺序的问题， 如果是最后一封修正前面错误的，而最后一封又有全文引用的话，看这最后一封就可以了，\n但如果没有引用呢，不看前面的邮件确实会摸不着头脑（Gmail的会话功能对这一问题处理较好）。\n\n一般来说，有效率的人不会在收件箱保留过多未读邮件，所以收件箱邮件被分页的情况会比较少见 （受欢迎的收件人例外），所以按顺序排序是个不错的选择。\n\n另外如果收件箱或者存档箱中确实需要分页该如何排序？我的想法是“总倒序，分顺序”， 即总体数据是按倒序排列的，而被分页的页面则使用顺序排列显示。\n效果：第一页就是最后一页，而显示页每一封邮件则按顺序排列。\n\n后来在 VeryCD 看到一个更好的方案：所有数据按顺序排列， 但是默认（首次）显示的是最后一页。细节上可以有一个更好的改进：默认页将尽可能多的显示内容。\n例如默认每页显示 50条评论，当总共有 60条评论时，默认显示第 2页，而第 2页按顺序排列显示 50条， 第一页显示 10条。\n\n当然最好的情况是综合类似Gmail会话功能的方式，将相同主题归为同一个会话中， 这类似于Wordpress的一个评论插件（效果参看 aw's blog， 新版\nWordpress 已经内置该功能）。\n\n个人意见综述：\n\n * 收件箱邮件列表完全使用顺序排列。 先到先被看，这样我就不会因为希望得到重视， 在周日写好的邮件，却等到周一才发出去了； 处理较早有邮件也合乎常理。\n\n * 评论、留言、邮件存档箱使用顺序排序，默认显示最后一页。 这样的话，像 Wordpress 这样使用英文语言，放在底部左侧的 Older Posts\n   也不会觉得别扭了。\n\np.s. 另外发现 draft.blogger.com 的自动保存还是很人性化的，不是使用定时自动保存，\n在用户输入过程中不会瞎保存影响用户，而是在输入停顿时才自动保存。 这有点类似我的节奏感知器上运用的思想。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-03-15","routePath":"/blog/post/idea-from-email-srot","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":382,"title":"标签模式","content":"#\n\n目前的标签有以下几种模式(形式)：\n\n\n手动外联标签模式。#\n\n这种模式将标签和内容分离，用户需要为指定文档/内容贴上不同的标签。 例如Gmail和新版Wordpress的标签。\n\n\n\n * 优点：简单易用，可控性强。\n\n * 缺点：需要为每个内容设置标签。\n\n\n手动内联标签模式。#\n\n这种模式将标签和内容融合，用户同样需要为文档/内容贴上不同的标签， 并且这种模式因为没有明确的标签输入区（标签输入区和内容输入区在一起），\n容易导致忘记贴标签，对于及时性和不可修改性的应用不太理想。\n\n如Twitter就有这方面的第三方应用，参考 hashtags。\n\n\n\n * 优点：内容被语义化；标签本身简单易用，可控性也很强。\n * 缺点：需要辅助标记，内容被干扰；容易忘记使用标签。\n\n\n自动内联标签模式。#\n\n这种模式需要用户手动设置标签集合，系统根据内容自动匹配标签。 目前还没有发现这种模式的实际应用，比较接近的有 关键字替换 和 对局部文本进行评论\n（忘记怎么称呼了，请指教）。 关键字替换只是展示层的，用户可以根据内容发现（暂且称之为）标签， 但无法通过标签找到匹配的内容 （由此想到了搜索引擎）。\n\n\n\n * 优点：标签自动化，用户无需操心内容和标签之间的关系。\n * 缺点：要匹配到正确的标签并不容易，大概到真正的语义时代可以解决。\n\n由此扩展另一种：\n\n\n内联标签兼容模式。#\n\n系统根据用户设置的标签集合管理标签与内容之间的关系，另外用户也可以手动管理标签。\n\n * 优点：标签自动化；可控性强。\n * 缺点：简单问题变复杂，包括系统实现复杂度和用户使用复杂度。\n\n不过回头想想，标签本身很简单，有必要把它变复杂吗？自动化就是不想手动控制， 如果需要手动控制还要自动化干嘛？\n\n--------------------------------------------------------------------------------\n\nUPDATE: 未尝不可一试. (2010/10/24)\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-05-02","routePath":"/blog/post/tags-pattern","lang":"zh-CN","toc":[{"text":"手动外联标签模式。","id":"手动外联标签模式","depth":2,"charIndex":22},{"text":"手动内联标签模式。","id":"手动内联标签模式","depth":2,"charIndex":134},{"text":"自动内联标签模式。","id":"自动内联标签模式","depth":2,"charIndex":344},{"text":"内联标签兼容模式。","id":"内联标签兼容模式","depth":2,"charIndex":586}],"domain":"","frontmatter":{},"version":""},{"id":383,"title":"让对方介绍一下工作的情况，对方对现在的工作有什么看法。","content":"淘宝应聘后记#\n\n前段时间在北京做项目，期间看到一篇关于 \"如何做好一份前端工程师的简历？\"， 又在 blueidea\n看到一些感兴趣的招聘帖，就参照着简要写了一份简历，并随手投了一些。\n\n口碑 UED 因为已经招好了人，就帮我转投给了淘宝 UED（其实好像我本身也有投）。\n\n后来就接到淘宝 UED 部门的面试电话，由于身在外地，以及一些特殊原因，我不能立即赶回杭州面试，\n结果一直拖着，好在最后有hr玄渡给我留了联系电话，让我可以回杭州后直接联系。\n\n昨日(3/9)打电话给玄渡，约好今天(3/10)10点左右去面试，他还特地发来邮件邀请函。 结果我却十分遗憾的迟到了10多分钟（按10点整计算）。\n\n前台给了一份简历表让填，这是我没想到的，因为之前包括网上的网页简历和电子档附件给\n小马的电子简历都有事先发过来，我想淘宝应该有打印件，不过这也在情理之中，是我太山寨了。\n\n我虽然也算是久经沙场，但是现在竟拿不稳笔杆。。\n\n忐忑不安的填好简历，过了有一段时间，圆心才送来一份笔试题，3页总共7题30分钟时间。\n\n这次的笔杆跳得更厉害，我甚至怀疑过几天我自己是否能看懂。\n\n好在题不是很难，用了不到一半的时间就做完了。为了缓解压力，就走到大厅的电子屏前 看中国地图上闪烁的圆点。\n\n面试我的有三个人，小马，圆心和正淳，算是技术调查，主要是探讨简历和笔试内容。 不过我的准备真的很不足（其实也没有专门做准备，都是平时的积累），结果有不少问题\n我答不上来，比如说标签语义化，em是做什么用的，这些特殊的标签我还真是用的少， 而且我回来查了一下 XHTML\n和标签语义化的资料，发现我掌握的实在太少，还有js和框架的内容， 我也答的支支吾吾，虽然我并不是不知道，但老是思维中断，连数组的 push, pop\n都没想起来。\n\n还有让我给自己的js,css,x/html程度打分，我很恬不知耻的给自己掌握的js和x/html打95分，\n在我看来，越往上，要加分越难，所以这相差的5分也是一个难以逾越的高度。 但是事后想起来，自己真实的分数差不多应该是js 80分，x/html 70分。\ncss则打75分也有点偏高，应该大概是65分，。其实在回答这样的问题前，要先问清楚标准，\n给出几个“标杆”，如60分和100分各是什么程度？对方能给出其自身的打分最好。 如果按自己的单方面标准或者根本不经过大脑，则很容易高估自己。\n\n说到我的性格，应该是内外各半，或者稍向内偏一点（在我看来这是缺点，我也有努力）。 缺点的话，有朋友说我心思太细密，有敏感的嫌疑，也有说我太实在，直性子，冲动。\n优点则说我总体上是好的，待人诚恳，热情，有上进心，勤劳，是个好人。我自己则觉得偏内向了点。\n\n最后我也象征性的回问了几个问题，因为还不是淘宝员工，也不好问太内部的问题。 现在想想，是应该事先想好几个有质量一点的问题。例如：\n\n\n对我的简历有什么看法；#\n\n\n对我的笔试有什么见解，给打个分；#\n\n\n自己给对方的印象如何；#\n\n\n让对方介绍一下工作的情况，对方对现在的工作有什么看法。#\n\n已经12点半，hr已经去吃饭，便约我下午1点半复试（主要是和hr谈）。\n\n随便扒了几口饭，提前来到淘宝大厅。\n\n玄渡人不错，从电话里都能感觉出来，很热情，说话也字正腔圆。\n\n大概因为经过上午的历练，也和玄渡个人有关，一对一的谈话中我再也没有感到紧张， 但是却把实话一句不漏的说了出来，被玄渡的笔记了个正着。\n\n说是一周内给答复，不知道是不是委婉的拒绝，听天由命吧，自己准备的也不算太好。 但是如果错过这次，我就再也没有这样的机会了吧。\n\n-- 闲耘 (xianyun.org) 如果自以为了不起，那一定是高估了自己，或者是给自己定的标准过低。 Sent from: Hangzhou 33\nChina.\n\nblog:datetime=2009/3/10 19:33:33:tags=\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-03-10","routePath":"/blog/post/after-nterview","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":384,"title":"JavaScript 无块级作用域","content":"#\n\n最近在做一系列JavaScript压缩工具，语法压缩，语义压缩，字符串压缩均有涉及（p.s.有趣的是，\n压缩变量名之类的“有损压缩”不影响代码执行，但是字符串压缩这样的“无损压缩”却总是需要解压消耗）。\n\n在实现压缩局部变量名时，最初的实现是将 if/else, for/in, do/while, switch/case/default,\ntry/catch/finally, with和Object实例对象（后面统称为“块级作用域”）与function一样，\n都作为独立的作用域，但是测试发现在JavaScript中并不是这么回事。\n\n尝试着在块级作用域里声明定义变量：\n\n\n\n会发现输出true，而且不论嵌套多深，也不论使用任何块级作用域进行嵌套，最后变量\n依然如同在调用处之前，而且同级的作用域中定义的一样；值为在此之前，在块级作用域中所做改变的结果。\n注意：如果块级作用域未被执行，则其中声明定义的变量会被声明（var name），但不被定义\n（即未被初始化，此时name为undefined，引用name时不抛异常）。\n\n\n\n之前虽知道，IE里for(var i=0;...)里定义的i，在for之外也是可以使用的，但是现在才知道这种情况更为猖獗， 大出我的意料之外，而更意外的是，IE\n7(IE6?), Firefox 3(FF1,FF2?), Opera 9, Chrome 1, Safari 3表现均丝毫不差。\n\n虽然与某些编程规范不同，但是js就是这样了，唉。早知道这样，压缩变量名这部分也就不用那么费劲了，只得重写了。\n\n另外还有一些JavaScript作用域方面的文章： [http://www.blueidea.com/tech/web/2007/4855.asp\nJavaScript中的作用域]，好像是realazy翻译的， 文章很好，虽然有点文不对题（主要阐述this的作用域链问题）。\n[http://www.cnblogs.com/3zfp/archive/2008/10/24/528644.html js变量作用域及可访问性的探讨]，\n详细介绍了各种变量的作用域及其可访问性问题。\n\n附A 测试代码：\n\n\n\n附B 测试结果（IE 7, FF 3, Opera 9, Safari 3, Chorme 1均同）：\n\n\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-01-06","routePath":"/blog/post/javascript-vars-scope","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":385,"title":"尊严","content":"#\n\n * \n\n看了Twitter上有推李普曼的《没有感到的尊严》 一文，想起自己也有类似的经历。\n\n高中时在外面读书，和一个在我看来很赖皮很讨厌的同学关系不合，一天他挑衅被我回击，\n晚上他叫了一个人过来跟我“讲道理”，寝室恰巧没电，没看清对方的面容，但是身体不比我弱。\n当他们把我逼到墙角时，我借助墙壁的力量将对方踢了出去，不知道对方是不是本身就没什么底气，\n叫了一声“不要这么嚣张”之后就再也没有回来。如果对方狠一点，我可能就要吃亏， 但是如果当时我软一点，我在这个讨厌鬼面前就永远都抬不起头。\n\n当然我并不总是那么“英勇”，学校当地有一个死胖子同学老挑衅我，我就回敬了一句，\n并且不礼貌的骂了对方。死胖子好像抓到把柄了一样，老要我道歉，在寝室里我们还打了一架， 当时我被打的很惨，不过没有道歉，上课的时候他总坐到我旁边捣乱影响我学习。\n终于有一节课上我再也容受不了，向他低了头。到现在我还对这事耿耿于怀，想当时如果不低头会怎么样？\n\n为什么老是想到打架呢？当对方无理取闹时，暴力确实是直接有效的解决办法呢，如果能比对方更暴力的话。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2009-01-02","routePath":"/blog/post/dignity","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":386,"title":"开放篮球场地.地标工程","content":"#\n\n作为业余篮球爱好者，作为他乡游子，每到一个陌生的地方，都想尽快找到一个能施展球技、\n或者仅是活动一下筋骨的场地。就地解决当然也可以，但是如果有自由开放的美好世界，为什么不加入进去呢？\n\n一般来说，大多数开放的篮球场地都在学校里（大学最多，中小学一般不对外开放），\n有一些公益场所也有简易的设施，所以希望能有一些学生朋友能给予帮助，我将尽力争取得到帮助。\n\n基于这样的想法，我展开了一个“开放篮球场地.地标工程”的想法，为广大篮球爱好者服务。\n首先做好了几个我所知道的地标：http://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketba\nllField.All.in.One.kmz\n\n将地址复制粘贴到Google Maps（谷歌地图）搜索栏，回车即可；或是下载到本地，使用Google Earth打开。\n\n全国现有完整地标(All in One)：\nhttp://labs.xianyun.org/OpenBasketballField/landmark/OpenBasketballField.All.in.\nOne.kmz\n\n杭州： http://labs.xianyun.org/OpenBasketballField/landmark/HangZhou.kmz\n\n北京： http://labs.xianyun.org/OpenBasketballField/landmark/BeiJing.kmz\n\n另有在线地标，直接Google Maps上编辑即可（所有登录了Google账户的网友都可以编辑）\n\n主要定位开放的篮球运动场地，默认为室外，尤其是免费的场地，室内或收费场地另附说明。\n\n标题格式：地名[.开放封闭未知][.室外室内][.免费收费]\n\n使用默认图标（期待志同之士提供更形象的图标） 红色不带圆点： 蓝色不带圆点： 紫色不带圆点：开放程度未知 红色带圆点：开放，人气旺 蓝色带圆点：开放，人气一般\n紫色带圆点： 黄色不带圆点：封闭\n\n以卫星地图为准。所有地标和文字描述仅作参考，欢迎修正（所有登录了Google帐号的朋友都可以进行修订）。\n\n在线地标列表： http://maps.google.com/maps/user?uid=108314985261981078822&hl=en\n\n北京：\nhttp://maps.google.com/maps/ms?hl=en&ie=UTF8&lr=lang_zh-CNlang_zh-TW&oe=UTF8&msa\n=0&msid=108623690175354072173.00045480d1fa17e9056ac\n\n杭州：\nhttp://maps.google.com/maps/ms?hl=en&ie=UTF8&lr=lang_zh-CNlang_zh-TW&oe=UTF8&msa\n=0&msid=108623690175354072173.00045f6778d694e0d3cc3\n\nblog:datetime=2010/10/25 13:57:33:tags=Maps,Sports\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-01-02","routePath":"/blog/post/open-basketball-field","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":387,"title":"Javascript String 方法效率大比拼","content":"#\n\n最初是通过 梅子（梅花雪） 关于大型字符串拼接效率（1， 2）的研究得到启发， 最近又看到 never-online 的 从 trim\n原型函数看js正则表达式的性能， 里面有介绍正则表达式效率陷阱等问题，并提出解决方法。\n我向来对这些鸡毛蒜皮感兴趣，也开始对大型字符串各种方法实现的效率进行比较， 并尝试提高这些方法的效率。\n\n\n大型字符串拼接#\n\n如梅子所言， 使用数组的join方法确实是最好的实现，可以根据这个思路设计StringBuilder, StringBuffer类。\n\n\n大型字符串trim#\n\n其实never-online在他的文章里有一些说的不准确的地方，代码也不算很精炼。 既然这是鸡毛蒜皮的小事，这些零碎东西当然要斤斤计较了。\n我很久以前有收集到这样一些实现，I：\n\n\n\n为了避免正则表达式使用括号带来的消耗，可以写成这样，II：\n\n\n\n另外有一套实现是这样的，III：\n\n\n\n其实调用函数也会多少有一点消耗，写成这样或许会快一点点（开个玩笑，这样写会带来\n一些冗余代码，这时候就需要基于效率（时间）、代码量（空间）和可维护性方面的考量了），IV：\n\n\n\n后来我对正则表达式有了更多的了解，知道了贪婪与非贪婪匹配，于是自作聪明写了这一段：\n\n\n\n我曾经为这段代码自鸣得意了好长一段时间，不过后来想到点号不包括换行符，字符串中间有换行符时，返回值就不正确了，于是不情愿的改成这样（多行模式效率也很低），V：\n\n\n\n谁知，这样的代码遇到大家伙时效率会一落千丈，哎，失败。\n\n原以为String.replace方法比String.substr、String.substring效率低，于是想，只使用正则表达式获得两头（或者一头）的索引位\n置，然后使用substring方法取出子串，VI：\n\n\n\n而最土的方法，莫过于两头都使用循环获得索引了，VII：\n\n\n\n代码里老是for啊for的一大串，为了节省字节，而且有可能的话，也准备再优化一下循环，\n就实现了$indexOf和$lastIndexOf两个方法，可以传递一个返回boolean值的函数作为参数\n（本来还想也支持正则表达式参数的，想想以前扩展indexOf和lastIndexOf方法后的效率，\n就算了），这样就可以求得第一个非空白和最后一个非空白字符的位置了。\n\n\n\n至于说要扩展到支持更长子串和起始索引，以后有需要再说了（顺便说一下，子串越长， 有优化算法可以得到更高效率）。\n\n另一个辅助方法：\n\n\n\n到了永不在线(Google Translate翻译为“永远在线”)的算法，VIII：\n\n\n\n最初这个算法让我很兴奋，直觉上，感觉这样效率肯定要高，不过事实并不是这么简单。\n\n说到这些实现的效率，无法一概而论，因为不同的字符串，它们的效率比也大不同，甚至异乎寻常。\n\n影响trim方法效率的，主要与字符串的总长度，前面空白字符串长度，后面空白字符串长度， 以及前中后的比例有关。详细的效率对比表有时间再上，这里只简要提一下：\n\n对于较小的字符串，各种实现都有不错的表现，而对于大型字符串，则实现III,\nIV表现较为稳定，甚至可以处理超大型字符串（修正：之前有误写成I，II两个较为稳定）。\n\n\n大型字符串字节长度#\n\n即双字节长度为2。注意：这个提法其实也不正确，Javascript是使用Unicode字符集的，\n所有的字符都（有可能）是双字节字符。将汉字等转换为双字节长度主要是为了某些应用。 最土的方法还是循环遍历所有字符，I：\n\n\n\n这里判断字符是否双字节有很多方法，效率较高的之间相差（大概）不大。\n\n另一种实现则看起来很轻灵，寥寥几行，II：\n\n\n\n多动脑子，则想法愈多（也常把简单的事情复杂化），我想如果可以快速取得表达式 (双字节/单字节)匹配次数，两值相加应该比较高效，III：\n\n\n\nIV：\n\n\n\n另外看到梅花雪用数组能提供字符串拼接速度，也想：把字符串split为数组， 不想对大型字符串而言，这split一步就慢得不行。\n\nbytes方法的效率：使用Javascript脚本循环大型字符串（I），确实远不如内置的\nreplace方法（II）快，而使用正则表达式match方法（IV）又比replace方法（III）稍快， 排名第二。\n\n\n总结：#\n\n * replace方法因匹配而被替换的子串愈长，效率愈低。\n\n * 根据目标字符串，选择合适的实现。\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2008-12-29","routePath":"/blog/post/javascript-string","lang":"zh-CN","toc":[{"text":"大型字符串拼接","id":"大型字符串拼接","depth":2,"charIndex":168},{"text":"大型字符串trim","id":"大型字符串trim","depth":2,"charIndex":247},{"text":"大型字符串字节长度","id":"大型字符串字节长度","depth":2,"charIndex":1342},{"text":"总结：","id":"总结","depth":2,"charIndex":1776}],"domain":"","frontmatter":{},"version":""},{"id":388,"title":"汉化Family Tree Builder","content":"#\n\n前文有言 理想的族谱软件Family Tree Builder 说虽有中文站， 但是软件本身没有中文化，因为很喜欢并且很需要这款软件，就自己动手汉化了过来。\n\n\n\n汉化原理很简单：\n\n * 备份软件安装目录下，Lang子目录中的English.lang（也可以是其他国家的语言文件）。\n * English.lang其实属于一种属性文件（properties），将每一行的第二部分翻译成中文 （或合适的文本）即可。\n * 备份安装目录下，Res子目录中的English.bmp图片。\n * 制作一张32x28像素，bmp格式的中国国旗图片，命名为English.bmp，放到Res目录。\n * 启动程序，菜单“工具(Tools)”-“选项(Options)”， “名字(Names)”-“Display people's names”设置为\n   Last First (Armstong John)， 即让姓氏(Last Name)放在名字(First Name)之前，符合中文习惯。\n   “日期(Dates)”，Day/Month/Year format 设置为 %y%-%m%-%d%， “Month/Year format”设置为\n   %y%-%m%。可以根据自己的习惯设置， 其中 %m% 是使用英文短格式，如Mon，在English.lang改为数字即可。\n\n注意：部分文本不可以翻译为中文，如日期选择按钮类的，提示文本为中文时，显示乱码。 另外程序本身左侧的列表(List)的姓名列，中文也显示列表（好像所有List\nView都不支持中文）。\n\n下载文件 托管在Google Code 上， 同时支持SNV提交，有兴趣的朋友联系我，希望大家来共同完成。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-11-21","routePath":"/blog/post/chinese-localization-family-tree","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":389,"title":"Family Tree Builder:理想的族谱/家谱软件","content":"#\n\n去年春节回家，老爸让我把家谱（族谱）放到电脑上，但当时家里不能上网， 手头又没有理想的家谱软件，只能把一些文本输入到电脑上。\n\n后来又尝试使用树型结构（当时使用梅花雪树）临时模拟，但是族谱是一种双亲（甚至多亲： [古代可同时]结婚多次）树型结构，使用普通的单亲树型结构就显得很别扭，\n最后使用纯文本拼成一个简易版本。\n\n\n\n这个版本也算理想，但是涉及到详细资料，尤其是当这棵树变得更大而复杂，盘根错节时， 这个纯文本拼凑起来的双亲树就显得力不从心。\n\n后来回杭州工作时，找了一些软件试用，大都不怎么理想（大概是我崇洋媚外的缘故， 国内确实还没看到什么让我觉得有脸拿出来使用的族谱作品），只是找到一个仅支持\n联机使用的Flash版本：中国传家宝， 只能联机使用让我觉得很不方便，而更不方便的是\n设计上有一些（大概）不合理，操作不便，并且速度也不行，让我满意的大概只有显示效果不错。\n\n过了很长时间，零星的找找也没得到什么结果。\n\n后来无意在VeryCD上看到一下族谱软件，是外国专业公司制作的产品，不过给人的感觉有点\n太强而大的样子，而且收费挺贵。顺手又上Google搜寻一番，收获不小，这个市场貌似现在很活跃的样子。\n\n于是就发现了这个相当理想的免费软件：Family Tree Builder （这是它的 英文网站），号称支持29中本地化语言（事实上也是如此）。\n不过遗憾的是，虽然它有中文网站，但是软件本身却没有中文本地化版本，刚安装在Windows Server 2008\n上时崩溃了好几次（大概是我没有摸清它的脾性），而且更糟糕的是程序左侧的List成员列表视图显示中文乱码。\n不过它的优点也相当可观，免费，启动速度快，自动备份（崩溃后可以恢复），支持多国语言，视觉效果好，\n操作方便，功能齐全，而且可以导入导出标准系谱数据格式gedcom，这里是它的 中文官方介绍，\n传说是族谱学家级别的人士和专业软件设计专家创造出来的（事实上看起来应该也是如此）， 适用于管理大型及小型的族谱。\n\n\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-11-15","routePath":"/blog/post/family-tree-builder-professional-genealgy-software","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":390,"title":"Firefox本地化及其切换","content":"#\n\n昨天用Firefox内置的下载管理器下载一个较大的文件，而且新搬来这边的网速慢到让我想起\n令人怀念的大学时期（那时候的校园网，不是一般人能够忍受的），无意中我看到下载管理器里\n当前下载的文件下显示着“第x小时，剩余x分钟”的提示（不超过一小时时，只显示“剩余x分钟”）。 看到这个提示，我当时有两种想法：\n\n * Firefox下载管理器的剩余时间计算方法比较有趣，将每小时的下载分段， 所以就有了第1小时，剩余20分钟的说法；\n\n * 翻译问题，实际应该是剩余1小时又20分钟的意思。\n\n这两种理解方式都有其道理，而且在我最初看来，是各占 50% 的。\n\n为了打消疑问，我Google，Baidu试了个遍，但是没有找到一条符合的记录，\n于是又尝试问一些对Firefox有/无兴趣的朋友，以及mozine的Gtalk群友， 但是大伙都没有注意到这个，只能给个猜测的结果。\n\n为了找到答案，就需要知道Firefox英文版是怎么说的，但是我还不想为此再装一个英文版Firefox，\n那么怎么切换本地化语言呢，又是大肆搜罗一番，找到一些近似的，这里整理如下：\n\n\n切换方法 I:#\n\n * about:config\n * general.useragent.locale由zh-CN改为en-US。\n   （前提：Firefox/chrome/目录下有en-US.jar和en-US.manifest）\n\n\n切换方法 II:#\n\n * http://releases.mozilla.org/pub/mozilla.org/firefox/releases/下载安装对应的语言包(.xpi)\n   。\n * 启用该语言包（安装后默认启用）并重启Firefox。\n\n例如我的Firefox版本3.0.3，Windows，则语言包文件地址为：\nhttp://releases.mozilla.org/pub/mozilla.org/firefox/releases/3.0.3/win32/xpi/en-\nGB.xpi （粗体为Firefox对应的版本号）。\n\n注意：http://releases.mozilla.org/pub/mozilla.org/firefox/releases/\n下的目录并不会列出xpi文件，将正确的版本号替换粗体部分，直接拷贝到地址栏回车即可。\n\n安装并重启之后，可以看到Add-ons - 语言页签下会列出刚安装的English(GB) Language\nPack语言包，想撤回中文时，禁用此语言包，重启Firefox即可。\n\n\nIII:#\n\n另外还有几个用来切换本地化语言的扩展，Locale Switcher 和 Quick Locale Switcher，\n它们可以让Firefox直接在菜单栏切换语言。\n\n言归正传，话说回来，切换为英文语言后，尝试大文件下载发现原文是类似于 2 hours, 8 minutes remaining\n这样的提示，意思是剩余2小时8分钟。\n\nFirefox 中文版的这个翻译确实不怎么样。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2008-11-14","routePath":"/blog/post/firefox-localization","lang":"zh-CN","toc":[{"text":"切换方法 I:","id":"切换方法-i","depth":2,"charIndex":481},{"text":"切换方法 II:","id":"切换方法-ii","depth":2,"charIndex":603},{"text":"III:","id":"iii","depth":2,"charIndex":1079}],"domain":"","frontmatter":{},"version":""},{"id":391,"title":"PANDA-glGo，完美的围棋软件","content":"#\n\n我的围棋水平虽然很差，但是这一点也不影响我对围棋的喜爱程度。 而今天意外的发现一款让我满意度达到100%的围棋软件，它就是 PANDA-glGo， （这是它在\nGNU 和 SourceForge 上的地址，不过 sf 上已经过期）。\n\nhttp://www.pandanet.co.jp/English/glgo/images/glgoshot15_thumb.jpg\n\nPANDA-glGo是一个GUN自由软件，支持Windows，Linux和Macintosh平台，不论外观，还是内涵，\n无一不是完美绝伦。PANDA-glGo支持2D和3D的风格，界面简洁大方，操作方便。 可以设置棋盘背景图和更换棋子，支持多语种，包括中文。\n\nPANDA-glGo默认没有机器人，如果想要人机对战，需要另外下载GNU Go（解压至PANDA-glGo安装目录即可，\n也可以放在其他位置）。机器人跑起来一点都感觉不到慢，即使设置棋力为最高级别（机机对战除外），\n至于算法是否高明，机器人棋力能达到什么程度，我不（需要）知道，目前我还没赢过。 可以设置机器人的棋力级别，棋盘大小（纵横数目）和对战让子目数。另外\nPANDA-glGo还支持网络对战， 或者观看他人对战。联机时，可以查看棋手级别等资料，正在进行的棋局。 可以这么说，PANDA-glGo\n不仅仅是一款围棋软件，更是一个围棋平台。\n\n帮助文档 很完整，只是缺少中文文档。\n\n如果你也是围棋爱好者，这是不容错过的一款软件。好想找一份和这类似的中国象棋软件， 因为我的象棋水平比围棋稍好，可以坚持久一点。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-10-24","routePath":"/blog/post/panda-glgo-the-perfect-igo","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":392,"title":"电子图书管理软件幻想","content":"#\n\n一直以来，稍微好点的电子图书管理软件是特别的少，而做很不错的更是少之又少， 要说真正让用户喜欢，或者至少还满意的，到目前为止，没有。\n\n而与之功能相似，状态却截然相反的是，图片和音乐文件的管理软件却如此兴旺发达。\n\n下面先介绍一下图片管理软件，它们大致有以下几个特点（这里以个人最偏爱的 Picasa 3 Beta 作参照）：\n\n * 看图。图片管理软件最好能（方便快捷的）阅读各种格式的图片。（Picasa 3的看图模块很炫很优秀，\n   半透明状态悬浮在窗口上，附有一些播放，翻转，标星，打开在Picasa中编辑等快捷功能。 不过Picasa对GIF动画支持很烂，甚至会毁掉动画的动态特性）\n\n * 管图。每一张图片都不是独立存在的，它们存在于一些相关/无关的相册中。 对于一个图片管理软件来说，对相册的管理能力尤为重要。\n   （Picasa可以动态扫描整个磁盘/指定目录的所以支持的图片， 还可以建立独立于存放目录物理路径之外的虚拟相簿功能，感觉就像管理你的家庭相册一样）\n\n * 搜图。搜索功能对于任何一个信息系统来说都必不可少，而对于图片搜索，还有一些有待探索的领域。\n   （以搜索著称的Google生产的Picasa自然有这个功能，虽然还有待提高）\n\n * 写图。这是对单张/多张图片进行微量/智能调整的高级特性。 这个可以交给专业的图片处理软件，对图片管理软件来说非必要，但是一定要提供快速定位到系统资源、\n   直接由这些专业的处理软件打开的特性。（Picasa有一些像改变色相，去除“红眼”这样的简单功能，\n   另外，和Google搜索的“手气不错”一样，Picasa也有这样自作主张的功能）\n\n而我所期待的图书管理软件，就像上面列出来的这些特性一致：\n\n * 看书。软件最好能支持多种图书格式，因为现在的图书格式繁多，一一支持不太现实， 也没有必要，让管理者做好管理的事情就够了，当然还需要能够方便的定位资源，\n   并能与其他专业的看书软件配合。另外最重要的，是有一些读书计划方面的规划系统 （可以结合一些读书技巧/理论）。\n * 管书。每个人都会有自己的个人图书库，当这个库越来越多时，管理则是势必施行，\n   在管理方面，图书有它和图片的不同之处，比如分类（可以参考但不拘泥于图书馆的管理方式），\n   加一些现流行使用的小标签，图书的名称，ISBN，缩略图，作者等，软件最好，或者说最起码能像 Picasa\n   一样支持动态扫描指定位置的所有支持/指定格式的图书。\n * 搜书。并不是每个人都能够/需要看并记住所有收集的电子图书的， 在需要时快速定位的指定位置，或者至少找到匹配的书。\n * 写书。编辑书名，作者，缩略图，分类，标签，ISBN，给喜欢的书标星等， 另外像编辑PDF的书签或添加评语/附注，非必须，有专业的编辑软件支持就可以了。\n\n目前发现最好的有 Foxit Library，它支持静态扫描和书架归类，并能够使用自己的 Fixit Reader 打开PDF文件，但是在使用它管理图书时，\n操作不便到简直不可用的地步，而且速度很慢（可能是因为我的书太多， 但是Picasa管理我更多的 图片时，一点都不显胖），并且不支持搜索（有一个索引功能）。\n\n另外 SSReader 也有一个“本地图书馆”，可以导入本地目录。 它会按照目录结构生成默认归类（跟系统资源管理器差不多，建议还是用资源管理器比较好）。\n\n不知道为什么现行的图书格式都不支持（像音乐文件一样）将书名，作者，缩略图， ISBN等信息存储在图书属性中，这方面难道没有对应的规范，还是牛仔太多了？\n\n这样的软件是一个梦吗。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-10-15","routePath":"/blog/post/dream-for-ebooks-manager","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":393,"title":"同步Web客户端的时间","content":"#\n\n富客户端应用的普遍流行，许多操作直接在客户端完成，而一些跟时间相关的操作， 客户端时间的正确性就显得尤为重要，一个和标准时间相差得离谱的时间，\n可能会带来滑稽甚至严重的错误。\n\n在C/S构架下，对时间有要求的应用程序一般解决方法是同步客户端和服务器端的时间， 一些要求较高的应用甚至需要专门的时间戳技术。\n\n普通的B/S应用程序一般没有权限同步客户端的时间（也不一定有这个必要）， 这个问题也有一些解决办法。\n\n 1. 响应用户请求时返回服务器时间，并使用计时器（如：window.setInterval）做一个虚拟时钟。\n    但是考虑到浏览器消耗和脚本计时器本身并不精准，长时间运行后时钟会出现较大的误差，予以忽略。\n 2. 响应用户请求时返回服务器时间，并计算服务器与客户端之间的时间差， 每次时间操作均以该差值进行修正（可以专门做一个接口）。或者考虑只有在\n    差值较大的情况下才进行修正（并提醒用户修正客户机时间）。\n\n另外还要考虑用户所在不同时区的情况（Date.getTimezoneOffset）。\n\n但是对于较精准的时间需求，这样仍然有一个问题，即从服务器端响应到客户端返回过程中\n的网络传输时间。这是一个随机数，根据网络情况和其他偶然因素有关，从几十毫秒到几十秒不等， 有时达数分钟之久，最惨的是整个页面超时，当然同步也就没有必要了：）\n\n\n\n如上图，客户端从客户机的t0时刻发送请求到服务端，然后服务端在T0时刻得到请求，\n经过连接数据、计算等操作，最终在T1时刻响应完成，客户端最后在t1时刻加载完成。\n\n此时我们最关心的是服务器返回到客户端加载完成这段时间的网络传输耗时， 但是暂时无法精确求得，只有一个相当不凑和方法：客户端发生请求时，\n带上当时的客户机时间（t0，浏览器请求头信息里一般带有，也可以通过客户端脚本 new Date()，此时则需要通过异步请求），服务器计算所耗时间也可以得到，\n响应时返回服务器计算耗时（T1-T0）以及浏览器请求的时刻（t0）以及服务器时间，\n客户端加载完成时刻（t1）计算网络传输总共耗时为：(t1-t1)-(T1-T0)， 之后以一定比例（如1:1）计算响应的网络传输耗时。\n\n结果相当不凑和，而过程又相当麻烦，所以只作为抛砖引玉之篇。\n\n\n\n图片来自 Baidu图片 搜索。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-09-01","routePath":"/blog/post/correct-web-client-datetime","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":394,"title":"Rating for Foobar2000 columns UI","content":"#\n\n给 Foobar2000 的 Columns UI 设置标星功能：\n\n\nI. 显示歌曲标星级别。#\n\n * 文件 -> 参数设置。\n * 显示 -> Columns UI -> Playlist view。\n * 切换到Columns页签，新建（New）一个列。\n\n\n\n如图，Display里的代码是：\n\n\n\n其实也可以简单是输入：%rating%。\n\n\nII. 设置标星级别功能。#\n\n * 右键播放列表某首歌曲 -> 标签 -> 管理脚本。\n\n * 打开“批量标签”窗口。\n\n * 点击“准备的任务”中的“添加”按钮，选择动作类型为“从另一个字段格式化值...”，确定。\n\n * 目标字段名：RATING 格式化原型：$if($greater(6,$add(%RATING%,1)),$add(%RATING%,1),5)\n\n * 保存为rating++，名称可以自定，点击“运行”按钮。\n\n * 重复第3步。\n\n * 重复第4步，目标字段名：RATING 格式化原型： $if($greater(%RATING%,0),$sub(%RATING%,1),0)\n   保存为：rating-- 点击“运行”按钮。\n\n\nIII. 设置标星界面（操作按钮）：#\n\n * 右键工具栏，点击 Customise...\n * 添加(Add)一个按钮(button)，并点击Change...按钮。\n * Command group中选择“Context menu items”，Item group中选择“Now Playing item”，\n   Command中选择“标签/脚本/rating++”。OK保存后回到Command picker窗口，设置按钮图片什么。\n   注：支持bmp和png格式的图片，但是png图片如果有透明的部分，则可能不会显示。\n * 重复第2步。Command中选择“标签/脚本/rating--”其他雷同。\n * 最后OK保存就可以了，下面是配置完成的界面，两个带星星的按钮功能分别是标星自减和自增。\n\n\n\n--------------------------------------------------------------------------------\n\nTags: , ,\n\nPublished on 2008-08-14","routePath":"/blog/post/rating-for-foobar2000-columns-ui","lang":"zh-CN","toc":[{"text":"I. 显示歌曲标星级别。","id":"i-显示歌曲标星级别","depth":2,"charIndex":38},{"text":"II. 设置标星级别功能。","id":"ii-设置标星级别功能","depth":2,"charIndex":180},{"text":"III. 设置标星界面（操作按钮）：","id":"iii-设置标星界面操作按钮","depth":2,"charIndex":513}],"domain":"","frontmatter":{},"version":""},{"id":395,"title":"IM 软件互联畅想","content":"#\n\n现在的IM软件（如QQ, MSN, Gtalk...）都有各种支持的新邮件，日志/博客更新及\n好友联系资料更新的检查功能，它们各自为政，互不相干，每个IM服务商都只支持自己提供的服务。\n\n而现在的IM领域愈来愈趋向于互联互通，相互开放。这也是众心所向，大势所趋。\n\n在这个时候，IM软件的检查用户更新的功能也应该相互开放，相互支持。\n\n就拿新邮件检查来说，其实 mail notify 的相关软件相当多，它们有的具有针对性，只对某些邮件服务商服务 （如 gnotify (仅支持单个帐号)，\nGmail Manager (Firefox插件，支持多个Gmail帐号)），\n有的具有开放性，同时支持若干个不同服务商和多个不同帐号。当然最好是能同时支持多个服务商和多个帐号了。\n由于不同邮件服务商（为不同用户）提供的服务不同，获取新邮件的方式不一而足，一般服务商只提供pop服务\n（如126，163邮箱。另外某些服务商该功能需要收费），而Google同时提供Atom格式（gnotify支持该格式）。\n以pop方式实现的检查新邮件功能总觉着不那么舒服（但至少能实现），Atom 格式比较合适（但其他服务商不支持）。\n如果IM软件能提供多邮件帐号、多服务商的新邮件检查支持，这将是相当棒的了。 （注：Pidgin，原Gaim，支持检查登录帐号各自新邮件的功能。）\n\n再就是日志/博客（以下简称博客）更新，现在的博客都支持RSS/Atom输出，检查更新应该没有技术难度。\n\n用户资料更新的话，可能还需要出新标准才行，最好能支持第三方应用 （比如我在某个专业提供个人联系资料服务的服务商那里公开某部分资料给某些好友，\n这些有权限的用户就可以得到相关更新）。\n\n最后关于IM本身的互联互通，希望有一天能做的真正的互联，就像我有Gmail可以发邮件到163一样， 之间只有通信标准，没有其他阻碍。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-08-03","routePath":"/blog/post/dream-for-im","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":396,"title":"参考","content":"阶乘(factorial) & 尾递归(Tail Recursion)#\n\n * \n\n今天看了dennis的《用递归计算阶乘咋不行呢？》 受益良多，这里做下小结。\n\n传统的递归算法写起来很漂亮，代码很简洁，但是每递归一次就需要更深一层的堆栈支持， 可能会造成内存溢出而失败，所以递归和goto语句一样声名狼藉。\n\n> 甚至《代码大全》的作者有这样一句话：如果为我工作的程序员用递归去计算阶乘，那么我宁愿换人。\n> 作者对递归的态度相当谨慎，这在静态命令式语言中显然是正确的，但是在函数式语言中，\n> 由于有尾递归优化的存在，递归反而是最自然的形式，况且我打心里认为递归更符合人类思维。 (by dennis)\n\n尾递归就是从最后开始计算，每递归一次就算出相应的结果， 也就是说，函数调用出现在调用者函数的尾部，因为是尾部，\n所以根本没有必要去保存任何局部变量，直接让被调用的函数返回时越过调用者， 返回到调用者的调用者去。举例说明。\n\n线性递归（传统递归方式）：\n\n\n\n尾递归：\n\n\n\n这里将基于尾递归的求数值阶乘算法贴下：\n\n\n\n效率上和循环迭代、阶乘改进算法 相当甚至稍胜出（ie6,firefox2,safari3），普通递归的效率最为底下，且需要深入堆栈。\n\n\n参考#\n\n * 《尾递归》-百度百科\n\n * 《用递归计算阶乘咋不行呢？》-dennis\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2008-04-08","routePath":"/blog/post/factorial-recursion","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":397,"title":"正则表达式拼接和构建零长度对象","content":"#\n\n之前在网上收集到一个正则表达式拼接的方法/函数，一直没有注意，直到昨天用 jsdoc 生成 api 文档时才看到。\n心里想这样的方法实际应用中大概没什么意义，但是出于好奇就拿出来玩了一下， 这一玩不要紧啊，这么精炼的东西差点成垃圾。\n\n可能是网络编辑器的原因，原始代码有bug，经过修正和测试，现在的代码如下：代码I\n\n\n\n原方法名是contact，现在为了和字符串类的一致，换为concat，至于bug/不足这里不做解读。 这个实际应用意义不大的小程式却有值得称道的几点：\n\n * 正向预搜索匹配第一个表达式里左括号（不包括非捕获组(?:)）的个数。\n * 当第一个表达式没有匹配时返回 0 长度对象（再求其长度）， 可以构建空数组（[]）和空字符串（\"\"），这里使用空字符串，理由下面再解释。\n * 修正反向引用时用的位运算（），这里将匹配到的数值字符串与0位或没有其他意义， 只是将数值字符串转型为数值，相当于 parseInt() 函数。\n\n下面介绍为什么使用空字符串而不是空数组构建0长度对象。代码II\n\n\n\n一万次循环叠加可以发现构建空字符串比构建空数组求长度快1到3倍。\n\n再将代码改为：代码III\n\n\n\n可以发现，求空字符串长度与空数组长度的过程效率相当。可见，代码 II 处空数组效率 多余的消耗主要在构建空数组对象上。\n\n--------------------------------------------------------------------------------\n\nTags: ,\n\nPublished on 2008-03-31","routePath":"/blog/post/regexp-and-zero-width-object","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":398,"title":"改进的菜单按钮","content":"#\n\n一直想写关于菜单按钮的设计，但是太懒惰的原因，老是拖着不做。当然今天也没勤快到哪里去， 下面第二个改进图是用 Pencil 画的，并没有用脚本实现，哎，懒啊。\n\n先看QQ/TM的设计，无论选项是什么，按钮上都没有体现出来。\n\n\n\n我觉得其实不论是文本，还是图标，都可以把当前选中状态体现在按钮上的，便于用户确认按钮当前的状态。 下面是改进后的菜单按钮（以QQ/TM为例）。\n\n\n\n一般来说，菜单按钮都应该做用户“最后一次”使用选择的动作。 例如早期QQ的视频、语音菜单按钮，MSN的菜单按钮，还有旺旺的菜单按钮，都应该如此。\n\n\n\n\n延伸阅读#\n\n * @blogspot\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-04-17","routePath":"/blog/post/menu-button-improved","lang":"zh-CN","toc":[{"text":"延伸阅读","id":"延伸阅读","depth":2,"charIndex":269}],"domain":"","frontmatter":{},"version":""},{"id":399,"title":"陀螺","content":"#\n\n在被抽打中不羁执着， 在痛苦里继续发现快乐。 信仰唯有围绕我心， 才能实现不倒的自我。\n\n-- 闲耘\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2004-02-01","routePath":"/blog/post/top","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":400,"title":"天目山拓展活动","content":"#\n\n公司组织了一次天目山野外拓展活动，收益良多，这里稍事记录。\n\n“信任背摔”：如果信任队友，笔直倒下，这无论对自己，对队友都是最佳选择。 在队友的保护下倒下90度并不会造成什么伤害，8个队友的平均分摊也使受力最小。\n但如果不信任队友，撅着屁股坐下去，队友不堪其苦，手可能会受伤，因为承受 不住而将自己扔在地上，自己也会摔的很惨。\n\n感受：把适当的工作放手交给队友，信任他们，自己可以得到最大程度的释放， 队友也可以表现到最好。否则自己心力交瘁，队友也不堪其苦。\n\n“齐头并进”：我们小组获得了最大程度的失败，中途两次中断排头有一定的责任， 但各位队友心力不齐是更大的问题，而最大的毛病是不能保持平和的心态，很好的\n势头，但急于求成，越走越快，直至完全失控，乱掉方寸。\n\n“天桥”（真正的名称未知，具体是爬上10米高架，从断桥跳跃抓住单杠）：据教练 说最快速度是从爬上到跳下总共14秒，我第一次玩这个，作为压阵选手，我准备挑战\n一下，让同事用我的手机秒表记时，可惜他不是很熟练，没记上，说大概是25秒， 看来还是有差距。这个游戏最刺激的是下落那一刻，负责保险绳的教练，非常好玩，\n他说了，只负责队员的生命安全，其他不管，弄哭了好几个女生（不包括在上面还 没有开跳就开哭的）。我在自由下落那一刻，眼前一片模糊，四肢没有知觉，不知道\n有没有很挫的蜷缩。\n\n“电网”：我第一个出发，在队友的帮助下从下面的窟窿安全穿过，然后帮助几乎 所有队友通过，好累，也揩了好多油，美女都是我抱过来的，很多男的也是（挫）。\n\n经验：第一个需要身体适中（不是太壮大，但身体较强壮，比如我 ：D）；再辅助 几个能派上用场的男队员过来，中间把所有女队员抱过来，瘦的要留在最后，并且\n一定要记得要在下面给他留一个可以钻过的窟窿。衣服要很小心注意。\n\n“逃生墙”：没有绳子辅助，要翻过 4.2米的高墙是不可能的，团队合作尤为重要。 我被选为第一个逃生者，踩在队友的大腿和肩膀上是不够的，我没想到他们会将我\n托起来，太伟大了！我（被女生称为）“像猴子一样”迅速翻过，然后协助了超过一半 的队友完成逃生，先上来的又积极协助后面的队友，而下面作为基石的队友更是伟大，\n有些基石托起了超过一半人。逃生 过程非常火爆，最终我们81人全部在 13分8秒完成了翻墙逃生。\n\n技巧：两名基石队员半蹲准备，逃生队员通过其大腿踩到肩膀上，然后身体贴这墙 直起身体，向上伸手求助（第一名队员千万不要通过弹跳来抓上面，这样基石队员\n的肩膀非常容易受伤），翻墙时脚的协助非常重要，侧身攀延。最后一个队员的逃生 最为困难，本来准备让我倒挂救援的，结果据说是让其抓住倒数第二名队员的脚\n拉上来的，我没有看到，不过人多力量大，这个绝对可以做到。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2010-04-17","routePath":"/blog/post/outreach-activities-2010-04","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""},{"id":401,"title":"关于面包屑导航","content":"#\n\n一直都很喜欢 千鸟志 的标题面包屑导航方式， 我准备在自己的博客主题中使用这种导航。\n\n\n\n不过，千鸟志的导航部分和标题有重复（另外我比较倾向于使用标签而不是分类）。 下面将导航和标题融合，去除标题部分。\n\n\n\n这里使用了语义化的标签，并且在字体和颜色上突出当前的状态，与标题融合的也算恰当。 不过当标签较多时会将标题挤到很靠后。\n\n另外想到有一些Unix论坛使用的树形导航也不错，稍加改进如下：\n\n\n\n标签应用比上面稍合理，而且css裸奔情况下表现也略如人意（话说“差强人意”这个词的“差” 是“甚，殊”的意思）。对于导航层级不太深的应用，还是不错的。\n\n--------------------------------------------------------------------------------\n\nTags:\n\nPublished on 2009-04-19","routePath":"/blog/post/crumb-navigation","lang":"zh-CN","toc":[],"domain":"","frontmatter":{},"version":""}]